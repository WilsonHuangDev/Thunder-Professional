module.exports=function(e){var n={};function t(i){if(n[i])return n[i].exports;var o=n[i]={i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(i,o,function(n){return e[n]}.bind(null,o));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=11)}([function(e,n,t){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.Critical=1]="Critical",e[e.Error=2]="Error",e[e.Warning=3]="Warning",e[e.Information=4]="Information",e[e.Verbose=5]="Verbose"}(i=n.LogLevel||(n.LogLevel={})),n.outputLoggerConsole=((o={})[i.Critical]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return console.error.apply(console,e)},o[i.Error]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return console.error.apply(console,e)},o[i.Warning]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return console.warn.apply(console,e)},o[i.Information]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return console.info.apply(console,e)},o[i.Verbose]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return console.log.apply(console,e)},o);var o,r=function(){function e(e){this.level=process.env.TL_LEVEL?parseInt(process.env.TL_LEVEL,10):i.Information,this.moduleName="",this.moduleName=e}return e.getLogger=function(n){return new e(n)},e.hook=function(n,t){n&&t&&"function"==typeof t&&(e.hooks[n]=(e.hooks[n]||[]).concat([t]))},e.callHook=function(n,t,i){for(var o=[],r=3;r<arguments.length;r++)o[r-3]=arguments[r];n in e.hooks&&e.hooks[n].forEach(function(e){return e.apply(void 0,[t,i].concat(o))})},e.prototype.critical=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.log.apply(this,[i.Critical].concat(e))},e.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.log.apply(this,[i.Error].concat(e))},e.prototype.warning=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.log.apply(this,[i.Warning].concat(e))},e.prototype.information=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.log.apply(this,[i.Information].concat(e))},e.prototype.verbose=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.log.apply(this,[i.Verbose].concat(e))},e.prototype.log=function(n){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];e.callHook.apply(e,["beforeLog",n,this.moduleName].concat(t)),this.checkShouldLog(n)&&(this.writeLog.apply(this,[n,"["+this.moduleName+"]"].concat(t)),e.callHook.apply(e,["logged",n,this.moduleName].concat(t)))},e.prototype.writeLog=function(n){for(var t,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];(t=e.outputLogger)[n].apply(t,i)},e.prototype.checkShouldLog=function(n){return e.enableLogger&&n<=this.level&&this.checkfilter()},e.prototype.checkfilter=function(){return"all"===e.moduleFilter||e.moduleFilter.includes(this.moduleName)},e.outputLogger=n.outputLoggerConsole,e.hooks={},e.enableLogger="1"===process.env.TL_ENABLE,e.moduleFilter=process.env.TL_MODULE_FILTER||"all",e}();n.default=r},function(e,n){e.exports=require("path")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ThunderChannelList=void 0,function(e){e.channelBase="ChannelBase",e.channelRMNewTaskSetTaskData=e.channelBase+"1",e.channelRMPreNewTaskSetTaskData=e.channelBase+"2",e.channelRMNewTaskCreateNewTask=e.channelBase+"3",e.channelRMNewTaskSetBTInfo=e.channelBase+"4",e.channelRMNewTaskDownloadTorrent=e.channelBase+"5",e.channelRMNewTaskCreateBtTask=e.channelBase+"6",e.channelRMNewTaskCancleMagnet=e.channelBase+"7",e.channelRMImportTorrent=e.channelBase+"8",e.channelRMGetConfigValueResolve=e.channelBase+"9",e.channelRMGetConfigValueReject=e.channelBase+"10",e.channelMRTrayMenuClick=e.channelBase+"11",e.channelMRNewTaskMagnetTaskCreated=e.channelBase+"12",e.channelMRNewTaskDownloadTorrentResult=e.channelBase+"13",e.channelMRNewTaskCreateNewTaskResult=e.channelBase+"14",e.channelMRNewTaskCreateBtTaskResult=e.channelBase+"15",e.channelMRGetConfigValue=e.channelBase+"16",e.channelMRSetConfigValue=e.channelBase+"17",e.channelRMCommitPlanTask=e.channelBase+"18",e.channelRMPerformePlanTask=e.channelBase+"19",e.channelRMProcessSend=e.channelBase+"20",e.channelRMGetPrivateSpaceInfo=e.channelBase+"21",e.channelMRGetPrivateSpaceInfoResult=e.channelBase+"22",e.channelRMFileCopy=e.channelBase+"23",e.channelRMFileMove=e.channelBase+"24",e.channelMRFileCopyResult=e.channelBase+"25",e.channelMRFileMoveResult=e.channelBase+"26",e.channelRMGetSutitleByCid=e.channelBase+"27",e.channelMRGetSutitleByCidResult=e.channelBase+"28",e.channelRMGetSutitleByName=e.channelBase+"29",e.channelMRGetSutitleByNameResult=e.channelBase+"30",e.channelRMDownloadSutitle=e.channelBase+"31",e.channelMRDownloadSutitleSuc=e.channelBase+"32",e.channelMRDownloadSutitleFail=e.channelBase+"33",e.channelRMGetDisplayName=e.channelBase+"34",e.channelMRGetDisplayNameResult=e.channelBase+"35",e.channelMRBringWindowToTop=e.channelBase+"36",e.channelRMDownloadXmp=e.channelBase+"37",e.channelMRFixXmpSuc=e.channelBase+"38",e.channelMRFixXMPFail=e.channelBase+"39",e.channelMRAPlayerCreated=e.channelBase+"41",e.channelMRMainRendererNativeCallInited=e.channelBase+"42",e.channelMRShowWindow=e.channelBase+"43",e.channelMRCreateTopView=e.channelBase+"44",e.channelMRSendTopView=e.channelBase+"44.1",e.channelMRDestroyTopView=e.channelBase+"44.5",e.channelMRCreateTopViewReadyFinish=e.channelBase+"45",e.channelMRCreateTopViewFinish=e.channelBase+"45.5",e.channelMRCreateCtrlView=e.channelBase+"46",e.channelMRSendCtrlView=e.channelBase+"46.1",e.channelMRDestroyCtrlView=e.channelBase+"46.5",e.channelMRCreateCtrlViewReadyFinish=e.channelBase+"47",e.channelMRCreateCtrlViewFinish=e.channelBase+"47.5",e.channelMRCreateSideBar=e.channelBase+"48",e.channelMRCreateSideBarFinish=e.channelBase+"49",e.channelMRExpandListWindow=e.channelBase+"52",e.channelMRExpandListVue=e.channelBase+"53",e.channelMRSetChangeViewSize=e.channelBase+"54",e.channelMRSyncShowMode=e.channelBase+"55",e.channelMRAPWindowUpdate=e.channelBase+"56",e.channelMRUpdateAPlayerPos=e.channelBase+"57",e.channelMRXmpVideoTipCreated=e.channelBase+"58",e.channelMRXmpVideoTipDestroy=e.channelBase+"59",e.channelMRShowSettingCenterWindow=e.channelBase+"60",e.channelRMSetPosition=e.channelBase+"61",e.channelRMShowPlaySettingWindow=e.channelBase+"62",e.channelRMShowCursor=e.channelBase+"63",e.channelRMAPlayerState=e.channelBase+"64",e.channelRMAPlayerProgress=e.channelBase+"65",e.channelRMPlayAction=e.channelBase+"66",e.channelRMSetFoucs=e.channelBase+"67",e.channelMRSetZorder=e.channelBase+"68",e.channelRMGetBrowserStartType=e.channelBase+"69",e.channelMRGetBrowserStartTypeResult=e.channelBase+"70",e.channelMRWindowPopUp=e.channelBase+"71",e.channelMRUpdateTipWindowZorder=e.channelBase+"72",e.channelMRSetShadowWindowResize=e.channelBase+"73",e.channelMRBrowserWindowChange=e.channelBase+"74",e.channelMRChangeFullScreen=e.channelBase+"75",e.channelMRTabNumberChange=e.channelBase+"76",e.channelMRThumbTaskBarAction=e.channelBase+"77",e.channelMRThumbTaskBarButtonStatus=e.channelBase+"78",e.channelRMOpenFolder=e.channelBase+"79",e.channelRReCreateCtrlWindow=e.channelBase+"80",e.channelRReCreateTopWindow=e.channelBase+"81",e.channelRMSetEnvironmentVariable=e.channelBase+"82",e.channelRMServerStarted=e.channelBase+"83",e.channelRMOpenDevTools=e.channelBase+"84",e.channelEnterEditMode=e.channelBase+"85",e.channelUpdateEditRect=e.channelBase+"86",e.channelMessageBoxClose=e.channelBase+"87",e.channelPreventSleep=e.channelBase+"88",e.channelCancelPreventSleep=e.channelBase+"89",e.channelCloseEffectWindow=e.channelBase+"90",e.channelPopUpMenu=e.channelBase+"91",e.channelHideTray=e.channelBase+"92",e.channelEmbedMoveResize=e.channelBase+"94",e.channelTimeTipPos=e.channelBase+"95",e.channelUpdateVideoTip=e.channelBase+"96",e.channelGetBrowserView=e.channelBase+"97",e.channelGetBrowserViewResult=e.channelBase+"98",e.channelBrowserViewLoad=e.channelBase+"99",e.channelBrowserViewOpenDev=e.channelBase+"100",e.channelApplyBrowserView=e.channelBase+"101",e.channelCreateBrowserView=e.channelBase+"102",e.channelCreateBrowserViewResult=e.channelBase+"103",e.channelBrowserViewCall=e.channelBase+"104",e.channelBrowserViewCallRet=e.channelBase+"105",e.channelEmbedWindowRgn=e.channelBase+"106",e.channelRMUpdateLogEnviroment="RM_UPDATE_LOG_ENVIRONMENT",e.channelMRUpdateLogEnviroment="MR_UPDATE_LOG_ENVIRONMENT"}(n.ThunderChannelList||(n.ThunderChannelList={}))},function(e,n){e.exports=require("electron")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return require(e)}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DisplayCardInfo=n.DetailIndex=n.PanelID=n.XmpPlaySoure=n.WindowParams=n.CombineRgnType=n.ZOrderChangedType=n.WindowTopMode=n.XmpMode=n.ShowWindowCmd=n.VirtualKeyCode=n.HitTestPositionCode=n.GWCmd=n.WindowMessage=n.SetWindowType=n.WindowStyleEx=n.WindowStyle=n.CmdShow=n.Uflag=n.OptionOfHWNDInAfter=void 0,function(e){e[e.HWND_NOTOPMOST=-2]="HWND_NOTOPMOST",e[e.HWND_TOPMOST=-1]="HWND_TOPMOST",e[e.HWND_TOP=0]="HWND_TOP",e[e.HWND_BOTTOM=1]="HWND_BOTTOM"}(n.OptionOfHWNDInAfter||(n.OptionOfHWNDInAfter={})),function(e){e[e.SWP_ASYNCWINDOWPOS=16384]="SWP_ASYNCWINDOWPOS",e[e.SWP_DEFERERASE=8192]="SWP_DEFERERASE",e[e.SWP_DRAWFRAME=32]="SWP_DRAWFRAME",e[e.SWP_FRAMECHANGED=32]="SWP_FRAMECHANGED",e[e.SWP_HIDEWINDOW=128]="SWP_HIDEWINDOW",e[e.SWP_NOACTIVATE=16]="SWP_NOACTIVATE",e[e.SWP_NOCOPYBITS=256]="SWP_NOCOPYBITS",e[e.SWP_NOMOVE=2]="SWP_NOMOVE",e[e.SWP_NOOWNERZORDER=512]="SWP_NOOWNERZORDER",e[e.SWP_NOREDRAW=8]="SWP_NOREDRAW",e[e.SWP_NOREPOSITION=512]="SWP_NOREPOSITION",e[e.SWP_NOSENDCHANGING=1024]="SWP_NOSENDCHANGING",e[e.SWP_NOSIZE=1]="SWP_NOSIZE",e[e.SWP_NOZORDER=4]="SWP_NOZORDER",e[e.SWP_SHOWWINDOW=64]="SWP_SHOWWINDOW"}(n.Uflag||(n.Uflag={})),function(e){e[e.SW_FORCEMINIMIZE=11]="SW_FORCEMINIMIZE",e[e.SW_HIDE=0]="SW_HIDE",e[e.SW_MAXIMIZE=3]="SW_MAXIMIZE",e[e.SW_MINIMIZE=6]="SW_MINIMIZE",e[e.SW_RESTORE=9]="SW_RESTORE",e[e.SW_SHOW=5]="SW_SHOW",e[e.SW_SHOWDEFAULT=10]="SW_SHOWDEFAULT",e[e.SW_SHOWMAXIMIZED=3]="SW_SHOWMAXIMIZED",e[e.SW_SHOWMINIMIZED=2]="SW_SHOWMINIMIZED",e[e.SW_SHOWMINNOACTIVE=7]="SW_SHOWMINNOACTIVE",e[e.SW_SHOWNA=8]="SW_SHOWNA",e[e.SW_SHOWNOACTIVATE=4]="SW_SHOWNOACTIVATE",e[e.SW_SHOWNORMAL=1]="SW_SHOWNORMAL"}(n.CmdShow||(n.CmdShow={})),function(e){e[e.WS_BORDER=8388608]="WS_BORDER",e[e.WS_CAPTION=12582912]="WS_CAPTION",e[e.WS_CHILD=1073741824]="WS_CHILD",e[e.WS_CHILDWINDOW=1073741824]="WS_CHILDWINDOW",e[e.WS_CLIPCHILDREN=33554432]="WS_CLIPCHILDREN",e[e.WS_CLIPSIBLINGS=67108864]="WS_CLIPSIBLINGS",e[e.WS_POPUP=2147483648]="WS_POPUP",e[e.WS_THICKFRAME=262144]="WS_THICKFRAME"}(n.WindowStyle||(n.WindowStyle={})),function(e){e[e.WS_EX_TOOLWINDOW=128]="WS_EX_TOOLWINDOW",e[e.WS_EX_APPWINDOW=262144]="WS_EX_APPWINDOW",e[e.WS_EX_TOPMOST=8]="WS_EX_TOPMOST",e[e.WS_EX_WINDOWEDGE=256]="WS_EX_WINDOWEDGE",e[e.WS_EX_NOACTIVATE=134217728]="WS_EX_NOACTIVATE"}(n.WindowStyleEx||(n.WindowStyleEx={})),function(e){e[e.GWL_EXSTYLE=-20]="GWL_EXSTYLE",e[e.GWL_HINSTANCE=-6]="GWL_HINSTANCE",e[e.GWL_ID=-12]="GWL_ID",e[e.GWL_STYLE=-16]="GWL_STYLE",e[e.GWL_USERDATA=-21]="GWL_USERDATA",e[e.GWL_WNDPROC=-4]="GWL_WNDPROC"}(n.SetWindowType||(n.SetWindowType={})),function(e){e[e.WM_CREATE=1]="WM_CREATE",e[e.WM_DESTROY=2]="WM_DESTROY",e[e.WM_MOVE=3]="WM_MOVE",e[e.WM_SIZE=5]="WM_SIZE",e[e.WM_ACTIVATE=6]="WM_ACTIVATE",e[e.WM_SETFOCUS=7]="WM_SETFOCUS",e[e.WM_KILLFOCUS=8]="WM_KILLFOCUS",e[e.WM_ENABLE=10]="WM_ENABLE",e[e.WM_KEYDOWN=256]="WM_KEYDOWN",e[e.WM_KEYUP=257]="WM_KEYUP",e[e.WM_SYSKEYDOWN=260]="WM_SYSKEYDOWN",e[e.WM_MOUSEMOVE=512]="WM_MOUSEMOVE",e[e.WM_SETCURSOR=32]="WM_SETCURSOR",e[e.WM_LBUTTONDOWN=513]="WM_LBUTTONDOWN",e[e.WM_LBUTTONUP=514]="WM_LBUTTONUP",e[e.WM_LBUTTONDBLCLK=515]="WM_LBUTTONDBLCLK",e[e.WM_RBUTTONUP=517]="WM_RBUTTONUP",e[e.WM_MOUSEWHEEL=522]="WM_MOUSEWHEEL",e[e.WM_MOUSELEAVE=675]="WM_MOUSELEAVE",e[e.WM_DPICHANGED=736]="WM_DPICHANGED",e[e.WM_GETMINMAXINFO=36]="WM_GETMINMAXINFO",e[e.WM_NCHITTEST=132]="WM_NCHITTEST",e[e.WM_NCMOUSEMOVE=160]="WM_NCMOUSEMOVE",e[e.WM_NCLBUTTONDOWN=161]="WM_NCLBUTTONDOWN",e[e.WM_NCLBUTTONUP=162]="WM_NCLBUTTONUP",e[e.WM_NCLBUTTONDBLCLK=163]="WM_NCLBUTTONDBLCLK",e[e.WM_NCRBUTTONDOWN=164]="WM_NCRBUTTONDOWN",e[e.WM_NCRBUTTONUP=165]="WM_NCRBUTTONUP",e[e.WM_NCRBUTTONDBLCLK=166]="WM_NCRBUTTONDBLCLK",e[e.WM_NCMBUTTONDOWN=167]="WM_NCMBUTTONDOWN",e[e.WM_NCMBUTTONUP=168]="WM_NCMBUTTONUP",e[e.WM_NCMBUTTONDBLCLK=169]="WM_NCMBUTTONDBLCLK",e[e.WM_WINDOWPOSCHANGED=71]="WM_WINDOWPOSCHANGED",e[e.WM_WINDOWPOSCHANGING=70]="WM_WINDOWPOSCHANGING",e[e.WM_ACTIVATEAPP=28]="WM_ACTIVATEAPP",e[e.WM_DWMCOMPOSITIONCHANGED=798]="WM_DWMCOMPOSITIONCHANGED"}(n.WindowMessage||(n.WindowMessage={})),function(e){e[e.GW_HWNDFIRST=0]="GW_HWNDFIRST",e[e.GW_HWNDLAST=1]="GW_HWNDLAST",e[e.GW_HWNDNEXT=2]="GW_HWNDNEXT",e[e.GW_HWNDPREV=3]="GW_HWNDPREV",e[e.GW_OWNER=4]="GW_OWNER",e[e.GW_CHILD=5]="GW_CHILD",e[e.GW_ENABLEDPOPUP=6]="GW_ENABLEDPOPUP"}(n.GWCmd||(n.GWCmd={})),function(e){e[e.HTERROR=-2]="HTERROR",e[e.HTTRANSPARENT=-1]="HTTRANSPARENT",e[e.HTNOWHERE=0]="HTNOWHERE",e[e.HTCLIENT=1]="HTCLIENT",e[e.HTCAPTION=2]="HTCAPTION",e[e.HTSYSMENU=3]="HTSYSMENU",e[e.HTGROWBOX=4]="HTGROWBOX",e[e.HTSIZE=4]="HTSIZE",e[e.HTMENU=5]="HTMENU",e[e.HTHSCROLL=6]="HTHSCROLL",e[e.HTVSCROLL=7]="HTVSCROLL",e[e.HTMINBUTTON=8]="HTMINBUTTON",e[e.HTMAXBUTTON=9]="HTMAXBUTTON",e[e.HTLEFT=10]="HTLEFT",e[e.HTRIGHT=11]="HTRIGHT",e[e.HTTOP=12]="HTTOP",e[e.HTTOPLEFT=13]="HTTOPLEFT",e[e.HTTOPRIGHT=14]="HTTOPRIGHT",e[e.HTBOTTOM=15]="HTBOTTOM",e[e.HTBOTTOMLEFT=16]="HTBOTTOMLEFT",e[e.HTBOTTOMRIGHT=17]="HTBOTTOMRIGHT",e[e.HTBORDER=18]="HTBORDER",e[e.HTREDUCE=8]="HTREDUCE",e[e.HTZOOM=9]="HTZOOM",e[e.HTSIZEFIRST=10]="HTSIZEFIRST",e[e.HTSIZELAST=17]="HTSIZELAST",e[e.HTOBJECT=19]="HTOBJECT",e[e.HTCLOSE=20]="HTCLOSE",e[e.HTHELP=21]="HTHELP"}(n.HitTestPositionCode||(n.HitTestPositionCode={})),function(e){e[e.VK_LBUTTON=1]="VK_LBUTTON",e[e.VK_RBUTTON=2]="VK_RBUTTON",e[e.VK_MBUTTON=4]="VK_MBUTTON",e[e.VK_BACK=8]="VK_BACK",e[e.VK_TAB=9]="VK_TAB",e[e.VK_RETURN=13]="VK_RETURN",e[e.VK_SHIFT=16]="VK_SHIFT",e[e.VK_CONTROL=17]="VK_CONTROL",e[e.VK_MENU=18]="VK_MENU",e[e.VK_ESCAPE=27]="VK_ESCAPE",e[e.VK_SPACE=32]="VK_SPACE",e[e.VK_PRIOR=33]="VK_PRIOR",e[e.VK_NEXT=34]="VK_NEXT",e[e.VK_END=35]="VK_END",e[e.VK_LEFT=37]="VK_LEFT",e[e.VK_UP=38]="VK_UP",e[e.VK_RIGHT=39]="VK_RIGHT",e[e.VK_DOWN=40]="VK_DOWN",e[e.VK_DELETE=46]="VK_DELETE",e[e.VK_F1=112]="VK_F1",e[e.VK_F2=113]="VK_F2",e[e.VK_F3=114]="VK_F3",e[e.VK_F4=115]="VK_F4",e[e.VK_F5=116]="VK_F5",e[e.VK_F6=117]="VK_F6",e[e.VK_F7=118]="VK_F7",e[e.VK_F8=119]="VK_F8",e[e.VK_F9=120]="VK_F9",e[e.VK_F10=121]="VK_F10",e[e.VK_F11=122]="VK_F11",e[e.VK_F12=123]="VK_F12",e[e.VK_OEM_1=186]="VK_OEM_1",e[e.VK_OEM_PLUS=187]="VK_OEM_PLUS",e[e.VK_OEM_COMMA=188]="VK_OEM_COMMA",e[e.VK_OEM_MINUS=189]="VK_OEM_MINUS",e[e.VK_OEM_PERIOD=190]="VK_OEM_PERIOD",e[e.VK_OEM_2=191]="VK_OEM_2",e[e.VK_OEM_3=192]="VK_OEM_3",e[e.VK_OEM_4=219]="VK_OEM_4",e[e.VK_OEM_5=220]="VK_OEM_5",e[e.VK_OEM_6=221]="VK_OEM_6",e[e.VK_OEM_7=222]="VK_OEM_7",e[e.VK_PROCESSKEY=229]="VK_PROCESSKEY"}(n.VirtualKeyCode||(n.VirtualKeyCode={})),function(e){e[e.SW_HIDE=0]="SW_HIDE",e[e.SW_SHOWMAXIMIZED=3]="SW_SHOWMAXIMIZED",e[e.SW_SHOW=5]="SW_SHOW"}(n.ShowWindowCmd||(n.ShowWindowCmd={})),function(e){e[e.UNKNOWN_MODE=-1]="UNKNOWN_MODE",e[e.INDEPENDENT_MODE=0]="INDEPENDENT_MODE",e[e.MAGNETIC_MODE=1]="MAGNETIC_MODE",e[e.EMBED_MODE=2]="EMBED_MODE"}(n.XmpMode||(n.XmpMode={})),function(e){e[e.NO_TOPMOST_MODE=0]="NO_TOPMOST_MODE",e[e.PLAYING_TOPMOST_MODE=1]="PLAYING_TOPMOST_MODE",e[e.ALWAYLS_TOPMOST_MODE=2]="ALWAYLS_TOPMOST_MODE"}(n.WindowTopMode||(n.WindowTopMode={})),function(e){e[e.ZORDER_CHANGED_TYPE_UNKNOW=-1]="ZORDER_CHANGED_TYPE_UNKNOW",e[e.ZORDER_CHANGED_TYPE_BEFORE=0]="ZORDER_CHANGED_TYPE_BEFORE",e[e.ZORDER_CHANGED_TYPE_AFTER=1]="ZORDER_CHANGED_TYPE_AFTER"}(n.ZOrderChangedType||(n.ZOrderChangedType={})),function(e){e[e.RGN_AND=1]="RGN_AND",e[e.RGN_OR=2]="RGN_OR",e[e.RGN_XOR=3]="RGN_XOR",e[e.RGN_DIFF=4]="RGN_DIFF",e[e.RGN_COPY=5]="RGN_COPY"}(n.CombineRgnType||(n.CombineRgnType={})),function(e){e[e.DEFAULT_WIDTH=850]="DEFAULT_WIDTH",e[e.DEFAULT_HEIGHT=550]="DEFAULT_HEIGHT",e[e.MIN_WINDOW_WIDTH=350]="MIN_WINDOW_WIDTH",e[e.MIN_WINDOW_HEIGHT=200]="MIN_WINDOW_HEIGHT",e[e.TOPCTRL_HEIGHT=42]="TOPCTRL_HEIGHT",e[e.PLAYCTRL_HEIGHT=62]="PLAYCTRL_HEIGHT"}(n.WindowParams||(n.WindowParams={})),function(e){e[e.PLAY_UNKNOWN=0]="PLAY_UNKNOWN",e[e.PLAY_BY_DOWNLOAD=1]="PLAY_BY_DOWNLOAD",e[e.PLAY_BY_PAN=2]="PLAY_BY_PAN"}(n.XmpPlaySoure||(n.XmpPlaySoure={})),function(e){e.Download="download-panel",e.Cloud="pan-plugin-view",e.Browser="find-page",e.Message="message-page"}(n.PanelID||(n.PanelID={})),function(e){e.Preview="Preview",e.Speed="TaskChart",e.Attribute="Attribute"}(n.DetailIndex||(n.DetailIndex={}));n.DisplayCardInfo=class{}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=t(19),o=t(1);n.getDefaultPrex=function(){return o.basename(process.execPath,".exe")},n.getSockPath=function(e){const n=i.tmpdir();let t=e;e||(t=o.basename(process.execPath,".exe"));let r=o.join(n,`${t}-xunlei-node-net-ipc-{FD196984-2591-4588-AA6F-5C8AC1266290}.sock`);return"win32"===process.platform&&(r="\\\\.\\pipe\\"+(r=(r=r.replace(/^\//,"")).replace(/\//g,"-"))),r},n.serverContextName="xunlei-node-net-ipc-server-{46105371-DE78-4442-B59F-FDA1D6D7D430}",n.mainProcessContext="main-process",n.mainRendererContext="main-renderer",n.isObjectEmpty=function(e){let n=!0;do{if(!e)break;if(0===Object.keys(e).length)break;n=!1}while(0);return n}},function(e,n){e.exports=require("events")},function(e,n,t){"use strict";var i=this&&this.__awaiter||function(e,n,t,i){return new(t||(t=Promise))(function(o,r){function a(e){try{s(i.next(e))}catch(e){r(e)}}function l(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,l)}s((i=i.apply(e,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0}),n.ThunderHelper=void 0;const o=t(1),r=t(4),a=t(5),l=t(0).default.getLogger("XMP.ThunderHelper"),s=r.default(o.join(__rootDir,"../bin/ThunderHelper.node"));!function(e){function n(e){return i(this,void 0,void 0,function*(){if(!e||(yield e.isDestroyed()))return 0;let n=0,t=yield e.getNativeWindowHandle();return t&&(n=t.readUIntLE(0,4)),n})}function t(e,n,t,i,o,r,l,d){if(!s||!e)return;let c="";d&&d.length>3&&(c=d.substring(0,d.length-3)),l|=a.Uflag.SWP_ASYNCWINDOWPOS,s.setWindowPos(e,n,t,i,o,r,l)}function o(){return s.getDPIAwareSupport()}function r(e){return s.getMonitorDPIFactor(e)}function d(){return s.getSysDPIFactor()}e.getDriveInfo=function(e){return s.getDriveInfo(e)},e.getFreePartitionSpace=function(e){return s.getFreePartitionSpace(e)},e.getLogicalDriveStrings=function(){return s.getLogicalDriveStrings()},e.getPartitionSpace=function(e){return s.getPartitionSpace(e)},e.getSystemTempPath=function(){return s.getSystemTempPath()},e.getTaskTypeFromUrl=function(e){return s.getTaskTypeFromUrl(e)},e.dwmIsCompositionEnabled=function(){return s.dwmIsCompositionEnabled()},e.setWindowLong=function(e,n,t){return s.setWindowLong(e,n,t)},e.showCursor=function(e){s&&s.showCursor(e)},e.isWindowVisible=function(e){return!!s&&s.isWindowVisible(e)},e.isWindowEnable=function(e){return!!s&&s.isWindowEnable(e)},e.enableWindow=function(e,n){return!!s&&s.enableWindow(e,n)},e.shChangeNotify=function(){if(s)return s.refreshIcon()},e.getBrowserWindowHandle=n,e.setTopMostWindow=function(e){return i(this,void 0,void 0,function*(){s&&e&&t(yield n(e),a.OptionOfHWNDInAfter.HWND_TOPMOST,0,0,0,0,a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOMOVE)})},e.getGraphicsAdapterList=function(){return s?s.getGraphicsAdapterList():null},e.getFileVersion=function(e){return s&&e?s.getFileVersion(e):""},e.getCursorPos=function(){return s?s.getCursorPos():{x:0,y:0}},e.getPowerInfo=function(){return s?s.getPowerInfo():null},e.setWindowRectRgn=function(e,n,t,i,o){s&&s.setWindowRectRgn(e,n,t,i,o)},e.createRectRgn=function(e,n,t,i){return s?s.createRectRgn(e,n,t,i):0},e.combineRgn=function(e,n,t=a.CombineRgnType.RGN_OR){return s?s.combineRgn(e,n,t):-1},e.deleteObject=function(e){return!!s&&s.deleteObject(e)},e.setWindowRgn=function(e,n,t=!0){return s?s.setWindowRgn(e,n,t):-1},e.hitCaption=function(e){return!!s&&s.hitCaption(e)},e.isWindowForeGround=function(e){return i(this,void 0,void 0,function*(){if(!s)return!1;let n=s.getForegroundWindow();return e===n})},e.getForegroundWindow=function(){return s?s.getForegroundWindow():0},e.isWindowForceGroundEx=function(e){return!!s&&e===s.getForegroundWindow()},e.setListExpandMode=function(e){return s?s.setListExpandMode(e):0},e.setTopMostWindowEx=function(e){s&&e&&t(e,a.OptionOfHWNDInAfter.HWND_TOPMOST,0,0,0,0,a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOMOVE)},e.cancelTopMostWindow=function(e,o){return i(this,void 0,void 0,function*(){if(!s||!e)return;let i=yield n(e),r=a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOMOVE|a.Uflag.SWP_NOACTIVATE;o&&(r|=o),t(i,a.OptionOfHWNDInAfter.HWND_NOTOPMOST,0,0,0,0,r)})},e.cancelTopMostWindowEx=function(e,n){if(!s||!e)return;let i=a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOMOVE|a.Uflag.SWP_NOACTIVATE;n&&(i|=n),t(e,a.OptionOfHWNDInAfter.HWND_NOTOPMOST,0,0,0,0,i)},e.getTempPath=function(){return s?s.getSystemTempPath():""},e.switchToThisWindow=function(e,n=!1){s&&s.switchToThisWindow(e,n)},e.setScreenSaveActive=function(e){if(s)return s.setScreenSaveActive(e)},e.getDiskFreeSpace=function(e){return s?s.getFreePartitionSpace(e):0},e.getMemInfoByPointer=function(e,n){return s?s.getMemInfoByPointer(e,n):null},e.setMinTrackSize=function(e,n,t){return s?s.setMinTrackSize(e,n,t):null},e.setWindowPos=function(e,n,i,o,r,a,l,d){if(!s||!e||e.isDestroyed())return;t(e.getNativeWindowHandle().readUIntLE(0,4),n,i,o,r,a,l,d)},e.moveWindowGently=function(e,n,t,i,o,r,a){s&&n&&s.moveWindowGently(e,n,t,i,o,r,a)},e.moveWindow=function(e,n){s&&e&&s.moveWindow(e,n.x,n.y,n.width,n.height,!0)},e.setWindowFocus=function(e,n=!0){s&&e&&s.setWindowFocus(e,n)},e.getWindowRect=function(e){return s&&e?s.getWindowRect(e):{x:0,y:0,width:0,height:0}},e.getClientRect=function(e){return s&&e?s.getClientRect(e):{x:0,y:0,width:0,height:0}},e.getCurrentScreenRect=function(e){return s&&e?s.getCurrentScreenRect(e):{x:0,y:0,width:0,height:0}},e.getCurrentWorkRect=function(e){return s&&e?s.getCurrentScreenRect(e,!0):{x:0,y:0,width:0,height:0}},e.getChildWindow=function(e){return s&&e?s.getChildWindow(e):0},e.getParentWindow=function(e){return s&&e?s.getParentWindow(e):0},e.getKeyState=function(e){return s?s.getKeyState(e):0},e.setWindowPosEx=t,e.beginDeferWindowPos=function(e){return s&&e?s.beginDeferWindowPos(e):0},e.endDeferWindowPos=function(e){return s&&e?s.endDeferWindowPos(e):0},e.deferWindowPos=function(e,n,t,i,o,r,a,l){return s&&e?s.deferWindowPos(e,n,t,i,o,r,a,l):0},e.bindChildWindow=function(e,n,t){if(!s||!n||!e)return;let i=n.getNativeWindowHandle().readUIntLE(0,4),o=e.getNativeWindowHandle().readUIntLE(0,4);t?s.bindChildWindow(o,i,t.x,t.y,t.width,t.height):s.bindChildWindow(o,i)},e.bindChildWindowEx=function(e,n,t){s&&n&&e&&(t?s.bindChildWindow(e,n,t.x,t.y,t.width,t.height):s.bindChildWindow(e,n))},e.setDllDirectory=function(e){s&&e&&s.setDllDirectory(e)},e.bringWindowToTop=function(e){if(!e)return;let n=e.getNativeWindowHandle().readUIntLE(0,4);s.bringWindowToTop(n)},e.bringWindowToTopEx=function(e){e&&s.bringWindowToTop(e)},e.modifyStyleEx=function(e,n,t){e&&s.modifyStyle(e,n,t)},e.modifyStyle=function(e,n,t){if(!e)return;let i=e.getNativeWindowHandle().readUIntLE(0,4);s.modifyStyle(i,n,t)},e.registerSliderCreate=function(e){s.registerSliderCreate(e)},e.showSlider=function(e){s.showSlider(e)},e.initSideBar=function(e,n,t,i){s.initSideBar(e,n,t,i)},e.uninitSideBar=function(){return i(this,void 0,void 0,function*(){return new Promise(e=>{s.uninitSideBar(()=>{e()})})})},e.createSideBar=function(){s.createSideBar()},e.destroySideBar=function(){s.destroySideBar()},e.readRegValue=function(e,n,t){return s?s.readRegString(e,n,t):""},e.setForcegroundWindow=function(e){if(!e)return;let n=e.getNativeWindowHandle().readUIntLE(0,4);s.setForegroundWindow(n)},e.setActiveWindowEx=function(e){s&&e&&s.setActiveWindow(e)},e.setForcegroundWindowEx=function(e){e&&s.setForegroundWindow(e)},e.is64BitWindows=function(){return!!s&&s.is64bitSystem()},e.setSideBarExpandState=function(e){s.setExpandState(e)},e.unBindChildWindow=function(e,n){if(!s||!n||!e)return;l.information("unBindChildWindow");let t=n.getNativeWindowHandle().readUIntLE(0,4),i=e.getNativeWindowHandle().readUIntLE(0,4);s.unBindChildWindow(i,t)},e.unBindChildWindowEx=function(e,n){s&&n&&e&&(l.information("unBindChildWindowEx"),s.unBindChildWindow(e,n))},e.addBrowserWindowClipStyle=function(e){if(!s||!e)return!1;let n=e.getNativeWindowHandle().readUIntLE(0,4),t=s.findChildWindow(n,"Intermediate D3D Window");return t&&s.setWindowLong(t,a.SetWindowType.GWL_STYLE,a.WindowStyle.WS_CLIPSIBLINGS),s.setWindowLong(n,a.SetWindowType.GWL_STYLE,a.WindowStyle.WS_CLIPCHILDREN),!!t},e.addBrowserWindowClipStyleEx=function(e){if(!s)return!1;let n=s.findChildWindow(e,"Intermediate D3D Window");return n&&s.setWindowLong(n,a.SetWindowType.GWL_STYLE,a.WindowStyle.WS_CLIPSIBLINGS),s.setWindowLong(e,a.SetWindowType.GWL_STYLE,a.WindowStyle.WS_CLIPCHILDREN),!!n},e.getDoubleClickTime=function(){return s?s.getDoubleClickTime():50},e.invalidateRect=function(e,n,t){s&&s.invalidateRect(e,n,t)},e.isIconic=function(e){return!!s&&s.isIconic(e)},e.isZoomed=function(e){return!!s&&s.isZoomed(e)},e.showWindow=function(e){return!!s&&s.showWindow(e,a.ShowWindowCmd.SW_SHOW)},e.hideWindow=function(e){return!!s&&s.showWindow(e,a.ShowWindowCmd.SW_HIDE)},e.setZorderWindow=function(e,n,t){if(s)return s.setZorderWindow(e,n,t)},e.getWindowLong=function(e,n){return s?s.getWindowLong(e,n):0},e.getHelperObject=function(){return s},e.getPeerID=function(){return s.getPeerID()},e.getDPIAwareSupport=o,e.getMonitorDPIFactor=r,e.getSysDPIFactor=d,e.getDpi=function(e){let n=1;return n=o()?r(e):d()}}(n.ThunderHelper||(n.ThunderHelper={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.hideRoundRectWindow=n.showRoundRectWindow=n.detachAllRoundRectWindow=n.setShadowWindowResizable=n.detachRoundRectWindow=n.roundRectWindow=void 0;const i=t(1),o=t(3),r=t(5),a=t(0),l=t(4),s=t(2),d=t(8),c=l.default(i.join(__rootDir,"../bin/ThunderHelper.node")),u=a.default.getLogger("round-rect-window");let h=new Map;function p(e){let n=1;return n=c.getDPIAwareSupport()?c.getMonitorDPIFactor(e):c.getSysDPIFactor()}class S{constructor(){this.win=null,this.shadowHandle=0,this.winHandle=0,this.area=16,this.closeHandler=null,this.resizeHandler=null,this.moveHandler=null,this.focusHandler=null,this.blurHandler=null,this.showHandler=null,this.hideHandler=null,this.updateTipWindowZorderHandler=null}cancelTopMost(){d.ThunderHelper.setWindowPosEx(this.shadowHandle,r.OptionOfHWNDInAfter.HWND_NOTOPMOST,0,0,0,0,r.Uflag.SWP_NOMOVE|r.Uflag.SWP_NOSIZE|r.Uflag.SWP_NOACTIVATE)}getParentWindowRect(){let e=this.area/2,n=c.getWindowRect(this.winHandle),t=p(this.winHandle),i={x:0,y:0,width:0,height:0};return i.x=Math.floor(n.x-e*t),i.y=Math.floor(n.y-e*t),i.width=Math.floor(n.width+2*e*t),i.height=Math.floor(n.height+2*e*t),i}updateShadowWindowPos(e){let n=this.getParentWindowRect(),t=c.getWindowRect(this.shadowHandle);if(t.x===n.x&&t.y===n.y&&t.width===n.width&&t.height===n.height||c.moveWindow(this.shadowHandle,n.x,n.y,n.width,n.height,!0),d.ThunderHelper.setWindowPosEx(this.shadowHandle,this.winHandle,0,0,0,0,r.Uflag.SWP_NOSIZE|r.Uflag.SWP_NOMOVE|r.Uflag.SWP_NOACTIVATE|r.Uflag.SWP_NOSENDCHANGING|r.Uflag.SWP_NOOWNERZORDER|r.Uflag.SWP_NOREDRAW),e){let e=p(this.winHandle);u.information("drawShadowWindow dpi",e),c.drawShadowWindow(this.winHandle,100*e)}}onWindowClose(){f(this.win)}onWindowResize(){this.updateShadowWindowPos(!0)}onWindowMove(){this.updateShadowWindowPos()}onWindowFocus(){this.updateShadowWindowPos()}onWindowBlur(){this.updateShadowWindowPos()}onWindowShow(){this.updateShadowWindowPos(),c.showWindow(this.shadowHandle,r.CmdShow.SW_SHOWNOACTIVATE)}onWindowHide(){c.showWindow(this.shadowHandle,r.CmdShow.SW_HIDE)}onUpdateTipWindowZorder(e,n){n||this.cancelTopMost(),this.updateShadowWindowPos()}onWindowPosChanged(){if(this.shadowHandle&&!this.win.isDestroyed()&&this.win.isVisible()){c.getNextWindow(this.shadowHandle,r.GWCmd.GW_HWNDPREV)!==this.winHandle&&this.updateShadowWindowPos()}}attach(e,n,t,i,a,l,d){do{this.win=e;let h=e.getNativeWindowHandle();this.winHandle=h.readUIntLE(0,4);let S=0;n&&(S=n.getNativeWindowHandle().readUIntLE(0,4));let w=p(this.winHandle);if(u.information("attachShadowWindow",this.winHandle,a,S,t,i,100*w,l,d),this.shadowHandle=c.attachShadowWindow(this.winHandle,a,S,t,i,100*w,l,d),!this.shadowHandle){u.warning("attachShadowWindow failed!",this.winHandle);break}if(c.setShadowWindowResizable(this.winHandle,e.isResizable()),this.closeHandler=this.onWindowClose.bind(this),e.on("close",this.closeHandler),t)break;this.updateShadowWindowPos(!0),e.isVisible()||c.showWindow(this.shadowHandle,r.CmdShow.SW_HIDE),this.resizeHandler=this.onWindowResize.bind(this),this.moveHandler=this.onWindowMove.bind(this),this.focusHandler=this.onWindowFocus.bind(this),this.blurHandler=this.onWindowBlur.bind(this),this.showHandler=this.onWindowShow.bind(this),this.hideHandler=this.onWindowHide.bind(this),this.updateTipWindowZorderHandler=this.onUpdateTipWindowZorder.bind(this),e.on("resize",this.resizeHandler),e.on("move",this.moveHandler),e.on("focus",this.focusHandler),e.on("blur",this.blurHandler),e.on("show",this.showHandler),e.on("hide",this.hideHandler),o.ipcMain.on(s.ThunderChannelList.channelMRUpdateTipWindowZorder,this.updateTipWindowZorderHandler),e.hookWindowMessage(r.WindowMessage.WM_WINDOWPOSCHANGED,this.onWindowPosChanged.bind(this))}while(0);return this.shadowHandle}detach(){this.win&&!this.win.isDestroyed()&&(u.information("detach win.id:",this.win.id),this.closeHandler&&(this.win.removeListener("close",this.closeHandler),this.closeHandler=null),this.resizeHandler&&(this.win.removeListener("resize",this.resizeHandler),this.resizeHandler=null),this.moveHandler&&(this.win.removeListener("move",this.moveHandler),this.moveHandler=null),this.focusHandler&&(this.win.removeListener("focus",this.focusHandler),this.focusHandler=null),this.blurHandler&&(this.win.removeListener("blur",this.blurHandler),this.blurHandler=null),this.showHandler&&(this.win.removeListener("show",this.showHandler),this.showHandler=null),this.hideHandler&&(this.win.removeListener("hide",this.hideHandler),this.hideHandler=null),this.updateTipWindowZorderHandler&&(o.ipcMain.removeListener(s.ThunderChannelList.channelMRUpdateTipWindowZorder,this.updateTipWindowZorderHandler),this.updateTipWindowZorderHandler=null),this.win.unhookWindowMessage(r.WindowMessage.WM_WINDOWPOSCHANGED),c.destroyShadowWindow(this.winHandle))}}function w(e,n,t=!0,i=!0,o=16,r="",a=null){let l=0;do{if(!e||e.isDestroyed()){u.warning("win is already destroyed! win id:",e.id);break}let s=h.get(e.id);if(s){u.warning("shadowWindow is already attached! win id:",e.id);break}if(s=new S,!e||e.isDestroyed()){u.warning("win is already destroyed! win id:",e.id);break}h.set(e.id,s),l=s.attach(e,n,t,i,o,r,a)}while(0);return l}function f(e,n){do{let t=0,i=null;if(e&&!e.isDestroyed()?(t=e.id,i=h.get(e.id)):(t=n,i=h.get(n)),!i){u.warning("shadowWindow is not attached! win id:",t);break}i.detach(),h.delete(t)}while(0)}n.roundRectWindow=function(e,n,t=!0,i=!0,o=16,r=0){let a=0,l=i?`${__rootDir}/static/shadow-corner.png`:`${__rootDir}/static/shadow.png`,s={left:17,top:17,right:17,bottom:17};return r>0?setTimeout(()=>{w(e,n,t,i,o,l,s)},r):a=w(e,n,t,i,o,l,s),a},n.detachRoundRectWindow=f,n.setShadowWindowResizable=function(e,n,t){if(!e||e.isDestroyed())return;let i=e.getNativeWindowHandle().readUIntLE(0,4);n.setShadowWindowResizable(i,t)},n.detachAllRoundRectWindow=function(){h.forEach(e=>{e.detach()}),h.clear()},n.showRoundRectWindow=function(e){if(!e||e.isDestroyed())return;let n=h.get(e.id);n&&n.onWindowShow()},n.hideRoundRectWindow=function(e){if(!e||e.isDestroyed())return;let n=h.get(e.id);n&&n.onWindowHide()}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.information=((...e)=>{}),n.error=((...e)=>{}),n.warning=((...e)=>{}),n.critical=((...e)=>{}),n.verbose=((...e)=>{})},function(e,n,t){t(12),t(13),e.exports=t(15)},function(e,n,t){"use strict"},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=t(0),o=t(14),r=t(1),a=t(4).default(r.join(__rootDir,"../bin/ThunderHelper.node")),l=t(2),s=t(3);function d(){"console"===process.env.TL_OUTPUT?i.default.outputLogger=i.outputLoggerConsole:i.default.outputLogger=function(){function e(e){return function(...n){a.printEtwLog(e,function(...e){return e.map(e=>o.inspect(e)).join(" ").replace(/%/g,"%%")}(...n))}}return{[i.LogLevel.Critical]:e(i.LogLevel.Critical),[i.LogLevel.Error]:e(i.LogLevel.Error),[i.LogLevel.Warning]:e(i.LogLevel.Warning),[i.LogLevel.Information]:e(i.LogLevel.Information),[i.LogLevel.Verbose]:e(i.LogLevel.Verbose)}}()}function c(){i.default.enableLogger="1"===process.env.TL_ENABLE,d()}d(),"browser"===process.type?s.ipcMain.on(l.ThunderChannelList.channelRMUpdateLogEnviroment,()=>{c()}):"renderer"===process.type&&s.ipcRenderer.on(l.ThunderChannelList.channelMRUpdateLogEnviroment,()=>{c()})},function(e,n){e.exports=require("util")},function(e,n,t){"use strict";var i=this&&this.__awaiter||function(e,n,t,i){return new(t||(t=Promise))(function(o,r){function a(e){try{s(i.next(e))}catch(e){r(e)}}function l(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,l)}s((i=i.apply(e,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const o=t(0).default.getLogger("XMP.MainProcess");(function(){return i(this,void 0,void 0,function*(){o.information("main enter"),t(16)})})().catch()},function(e,n,t){"use strict";var i=this&&this.__awaiter||function(e,n,t,i){return new(t||(t=Promise))(function(o,r){function a(e){try{s(i.next(e))}catch(e){r(e)}}function l(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,l)}s((i=i.apply(e,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const o=t(17),r=t(8),a=t(5),l=t(18),s=t(6),d=t(9),c=t(20),u=t(0),h=t(3),p=t(25),S=t(2),w=u.default.getLogger("XmpPluginMain");let f=!1,g=a.XmpMode.UNKNOWN_MODE,W=null,m=null,T=0,C=a.XmpPlaySoure.PLAY_UNKNOWN,O=null,E=null,_=null,M=null,P=void 0,I=!1,y=new Map,v=0,D=!1,b=!1;function N(){if(g===a.XmpMode.INDEPENDENT_MODE){let e=O.getNativeWindowHandle().readUIntLE(0,4),n=r.ThunderHelper.getClientRect(e),t=r.ThunderHelper.getDpi(e);w.information("independWindowResize independWindow clientRect",n,"dpi",t),r.ThunderHelper.setWindowPosEx(T,0,0,0,n.width,n.height,a.Uflag.SWP_NOZORDER|a.Uflag.SWP_NOACTIVATE);let i=r.ThunderHelper.getWindowRect(T),o=O.isFullScreen(),l=O.isMaximized();if(w.warning("cqm independWindowResize isFullScreen",o,"isMaximized",l,"floatWindowRect",i),o||l){V({x:-99999,y:-99999,width:i.width,height:i.height}),setTimeout(()=>{V(i)},100)}else V(i);B()}}function R(){if(g===a.XmpMode.INDEPENDENT_MODE){let e=O.getNativeWindowHandle().readUIntLE(0,4),n=r.ThunderHelper.getClientRect(e),t=r.ThunderHelper.getDpi(e);w.information("independWindowMove independWindow clientRect",n,"dpi",t),V(r.ThunderHelper.getWindowRect(T))}}function L(e,...n){W=n[0],w.warning("updateDownloadEmbedRect rect",W)}function H(e,...n){m=n[0],w.warning("updatePanEmbedRect rect",m)}function F(e,...n){return i(this,void 0,void 0,function*(){M&&clearTimeout(M),M=setTimeout(()=>i(this,void 0,void 0,function*(){do{if(w.information("thunderResize mode",g,"aplayerHwnd",T,"downloadEmbedRect",W,"panEmbedRect",m),g!==a.XmpMode.EMBED_MODE)break;if(_.isFullScreen())break;let e=_.getNativeWindowHandle().readUIntLE(0,4),n=C===a.XmpPlaySoure.PLAY_BY_DOWNLOAD?W:m,t=r.ThunderHelper.getDpi(e);if(n={x:Math.floor(n.x*t),y:Math.floor(n.y*t),width:Math.floor(n.width*t),height:Math.floor(n.height*t)},w.warning("cqm enterModeChanging",D),D)break;w.information("thunderResize playSoure",C,"targetRect",n,"dpi",t),r.ThunderHelper.setWindowPosEx(T,0,n.x,n.y,n.width,n.height,a.Uflag.SWP_NOZORDER|a.Uflag.SWP_NOACTIVATE),V(r.ThunderHelper.getWindowRect(T)),B()}while(0)}),5)})}function A(){return i(this,void 0,void 0,function*(){b||C!==a.XmpPlaySoure.PLAY_BY_DOWNLOAD||42!==W.y?(c.client.callRemoteClientFunction(s.mainRendererContext,o.XmpPlayerFunction.showAplayerAndFloatWindow).catch(),w.information("#### showAplayerAndFloatWindow",b)):(c.client.callRemoteClientFunction(s.mainRendererContext,o.XmpPlayerFunction.hideEmbedAplayerAndFloatWindow).catch(),w.information("#### hideEmbedAplayerAndFloatWindow",b))})}function B(){r.ThunderHelper.setWindowPosEx(T,a.OptionOfHWNDInAfter.HWND_TOP,0,0,0,0,a.Uflag.SWP_NOACTIVATE|a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOMOVE,"thunderResize_"+__filename)}function V(e){w.warning("cqm setFloatWindowRect rect",e),r.ThunderHelper.setWindowPos(E,0,e.x,e.y,e.width,e.height,a.Uflag.SWP_NOACTIVATE|a.Uflag.SWP_NOZORDER)}function x(e,...n){let t=n[0];E&&!E.isDestroyed()&&E.id===t||((E=h.BrowserWindow.fromId(t)).once("close",()=>{E=null}),E.on("resize",()=>{K()}),E.on("move",()=>{K()}),K())}function k(e,...n){T=n[0]}function U(e,...n){C=n[0],w.warning("updatePlaySource playSoure",C)}function X(e,n,t){w.information("addXmpVideoTipPos hwnd",n,"pos",t),y.set(n,t)}function G(e,n){y.delete(n)}function K(){if(y&&y.size>0){let e=r.ThunderHelper.getWindowRect(T),n=0;y.forEach((t,o)=>i(this,void 0,void 0,function*(){let i=Math.floor(e.x+t.x),l=Math.floor(n||e.y+t.y);-99999===t.x&&(i=e.x+(e.width-t.width)/2),-99999===t.y&&(l=e.y+(e.height-t.height)/2);let s=Math.floor(t.width>0?t.width:e.width+t.width),d=Math.floor(t.height),c=r.ThunderHelper.getWindowRect(o);if(c.x===i&&c.y===l&&c.width===s&&c.height===d)return;let u=r.ThunderHelper.getDpi(T);if(w.warning("hwnd",o,"x",i,"y",l,"width",s,"height",d),r.ThunderHelper.setWindowPosEx(o,0,i,l,Math.floor(s*u),Math.floor(d*u),a.Uflag.SWP_NOZORDER|a.Uflag.SWP_NOACTIVATE,"updateXmpVideoTipPos_"+__filename),E&&!E.isDestroyed()){let e=E.getNativeWindowHandle().readUIntLE(0,4);r.ThunderHelper.setWindowPosEx(e,o,0,0,0,0,a.Uflag.SWP_NOMOVE|a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOACTIVATE,"updateXmpVideoTipPos_"+__filename)}}))}}function Z(e){return!!(r.ThunderHelper.getWindowLong(e,a.SetWindowType.GWL_EXSTYLE)&a.WindowStyleEx.WS_EX_TOPMOST)}function j(){if(!I&&P){I=!0;let e=O.getNativeWindowHandle().readUIntLE(0,4);r.ThunderHelper.setZorderWindow(a.ZOrderChangedType.ZORDER_CHANGED_TYPE_AFTER,P,"shadow-window"),c.client.attachServerEvent(l.XmpEvent.onWindowZOrderChanged,(n,t,i)=>{if(t===a.ZOrderChangedType.ZORDER_CHANGED_TYPE_AFTER&&i&&i.length>0)for(let n=0;n<i.length;++n)P===i[n]&&(Z(P)&&!Z(e)&&r.ThunderHelper.setWindowPosEx(i[n],a.OptionOfHWNDInAfter.HWND_NOTOPMOST,0,0,0,0,a.Uflag.SWP_NOMOVE|a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOACTIVATE,"cancelTopMost_"+__filename),r.ThunderHelper.setWindowPosEx(i[n],e,0,0,0,0,a.Uflag.SWP_NOMOVE|a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOACTIVATE,"updateShadowWindowPos_"+__filename))})}}function z(e=!0,n){return i(this,void 0,void 0,function*(){if(P)return void w.error("cqm doShadowWindow is exist",P);if(!r.ThunderHelper)return void w.error("cqm ThunderHelper is not exist");let t=r.ThunderHelper.getHelperObject();t?e?setTimeout(()=>i(this,void 0,void 0,function*(){P=d.roundRectWindow(O,n,!1,!1),j(),d.setShadowWindowResizable(O,t,!0)}),500):(P=d.roundRectWindow(O,n,!1,!1),j(),d.setShadowWindowResizable(O,t,!0)):w.error("cqm helpObject is not exist")})}function Y(e){do{if(g!==a.XmpMode.INDEPENDENT_MODE)break;let n=r.ThunderHelper.getHelperObject();if(!n){w.error("cqm helpObject is not exist");break}O&&!O.isDestroyed()&&(w.warning("cqm setIndependShadowWindowResizable resize",e),d.setShadowWindowResizable(O,n,e),e?d.showRoundRectWindow(O):d.hideRoundRectWindow(O))}while(0)}(function(){return i(this,void 0,void 0,function*(){if(w.information("registerPluginFunction isRegister",f),!f){f=!0;let e={[o.XmpPlayerFunction.updateDownloadEmbedRect]:L,[o.XmpPlayerFunction.updatePanEmbedRect]:H,[o.XmpPlayerFunction.thunderResize]:F,[o.XmpPlayerFunction.updateFloatWindow]:x,[o.XmpPlayerFunction.updateAplayerHwnd]:k,[o.XmpPlayerFunction.updatePlaySource]:U,[o.XmpPlayerFunction.addXmpVideoTipPos]:X,[o.XmpPlayerFunction.removeXmpVideoTipPos]:G,[o.XmpPlayerFunction.updateScrollShowOrHide]:A};c.client.registerFunctions(e),c.client.attachServerEvent("CanShowStateByScroll",(e,...n)=>{b=n[0]})}c.client.attachServerEvent(l.XmpEvent.onMaxmized,()=>{Y(!1)}),c.client.attachServerEvent(l.XmpEvent.onUnMaxmized,()=>{Y(!0)}),c.client.attachServerEvent(l.ModeChangeEvent.onXmpEnterFullScreen,()=>{Y(!1)}),c.client.attachServerEvent(l.ModeChangeEvent.onXmpLeaveFullScreen,()=>{Y(!0)}),c.client.attachServerEvent(l.XmpEvent.onXmpClose,()=>i(this,void 0,void 0,function*(){C=a.XmpPlaySoure.PLAY_UNKNOWN,O&&(O.removeListener("resize",N),O.removeListener("move",R),O.removeListener("focus",B)),g=a.XmpMode.UNKNOWN_MODE})),c.client.attachServerEvent(l.ModeChangeEvent.onXmpModeChanging,(e,n,t,o)=>i(this,void 0,void 0,function*(){D=!0,w.warning("cqm onXmpModeChanging enterModeChanging",D)})),c.client.attachServerEvent(l.ModeChangeEvent.onXmpModeChanged,(e,n,t,o)=>i(this,void 0,void 0,function*(){if(w.information("onXmpModeChanged oldMode",n,"newMode",t,o),D=!1,g=t,t===a.XmpMode.INDEPENDENT_MODE||t===a.XmpMode.UNKNOWN_MODE)do{if(w.information("onXmpModeChanged independWindow ",O),O&&(O.removeListener("resize",N),O.removeListener("move",R),O.removeListener("focus",B),d.detachRoundRectWindow(null,v),P=null,O=null,w.information("independWindow destory")),void 0===o)break;if(!(O=h.BrowserWindow.fromId(o))){w.information("independWindow is null");break}w.information("shadowHandle",P),v=o,O.on("resize",N),O.on("move",R),O.on("focus",B),z(!1).catch()}while(0)}));do{let e=global;if(!e)break;if(!(_=e.mainRendererWindow))break;_.on("move",()=>i(this,void 0,void 0,function*(){if(!T||!E||E.isDestroyed())return;if(g!==a.XmpMode.EMBED_MODE)return;let e=_.isFullScreen();w.warning("mainWindowObject move isFullScreen",e),e||(V(r.ThunderHelper.getWindowRect(T)),B())})),_.on("focus",()=>i(this,void 0,void 0,function*(){B()})),_.on("hide",()=>i(this,void 0,void 0,function*(){g===a.XmpMode.EMBED_MODE&&(yield c.client.callRemoteClientFunction(s.mainRendererContext,o.XmpPlayerFunction.showOrHideXmpWindow))})),_.on("show",()=>i(this,void 0,void 0,function*(){g===a.XmpMode.EMBED_MODE&&(w.information("mainWindowObject show"),yield c.client.callRemoteClientFunction(s.mainRendererContext,o.XmpPlayerFunction.showOrHideXmpWindow))})),_.on("minimize",()=>i(this,void 0,void 0,function*(){g===a.XmpMode.EMBED_MODE&&(w.information("mainWindowObject minimize"),yield c.client.callRemoteClientFunction(s.mainRendererContext,o.XmpPlayerFunction.showOrHideXmpWindow))})),_.on("maximize",()=>i(this,void 0,void 0,function*(){g===a.XmpMode.EMBED_MODE&&(w.information("mainWindowObject maximize"),yield c.client.callRemoteClientFunction(s.mainRendererContext,o.XmpPlayerFunction.showOrHideXmpWindow))})),_.on("restore",()=>i(this,void 0,void 0,function*(){g===a.XmpMode.EMBED_MODE&&(w.information("mainWindowObject restore"),yield c.client.callRemoteClientFunction(s.mainRendererContext,o.XmpPlayerFunction.showOrHideXmpWindow))})),p.initMessageBox(null,r.ThunderHelper)}while(0)})})().catch(),h.ipcMain.on(S.ThunderChannelList.channelRMShowCursor,(e,n)=>{r.ThunderHelper.showCursor(n)})},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SubtitleFunction=n.TimeTipFunction=n.VipBufferTipFunction=n.XmpPluginFunction=n.XmpSubtitleFunction=n.XmpPlayerFunction=n.XmpPlayType=n.VideoTipFunction=n.UIFunction=n.MainMenuFunction=n.SnapshotFunction=n.LoginSDKFunction=n.LoginFunction=n.DKFunction=n.ConfigFunction=void 0,function(e){e.saveConfig="SaveConfig",e.getConfigValue="GetConfigValue",e.setConfigValue="SetConfigValue",e.isConfigInitFinish="IsConfigInitFinish",e.getConfigModules="GetConfigModules",e.setXmpAndThunderConfigValue="SetXmpAndThunderConfigValue"}(n.ConfigFunction||(n.ConfigFunction={})),function(e){e.getTaskChannelInfo="GetTaskChannelInfo",e.getTaskBaseInfo="GetTaskBaseInfo",e.getTaskBaseInfos="GetTaskBaseInfos",e.getTaskAttribute="GetTaskAttribute",e.getTaskStatus="GetTaskStatus",e.findTask="FindTask",e.isTaskExist="IsTaskExist",e.isSupportPlay="IsSupportPlay",e.getTaskDownloadSpeed="GetTaskDownloadSpeed",e.enableDcdnWithVipCert="EnableDcdnWithVipCert",e.updateDcdnWithVipCert="UpdateDcdnWithVipCert",e.disableDcdnWithVipCert="DisableDcdnWithVipCert",e.getTpPeerId="GetTpPeerId",e.execSqlite="ExecSqlite",e.querySqlite="QuerySqlite",e.getCategoryViewTaskList="GetCategoryViewTaskList",e.getCategoryViewTaskListForSuspensionWnd="GetCategoryViewTaskListForSuspensionWnd",e.isLoadStorageTaskFinish="IsLoadStorageTaskFinish",e.isSingleBtTask="IsSingleBtTask",e.setTaskExtStat="SetTaskExtStat"}(n.DKFunction||(n.DKFunction={})),function(e){e.login="Login",e.logout="Logout",e.getUserID="GetUserID",e.getSessionID="GetSessionID",e.getSessionIDAw="GetSessionIDAw",e.getLoginOption="GetLoginOption",e.isLogined="IsLogined",e.getAllUserInfo="GetAllUserInfo",e.getAllUserInfoAw="GetAllUserInfoAw",e.getUserInfoEx="GetUserInfoEx",e.getUserInfo="GetUserInfo",e.getUserInfoAw="GetUserInfoAw",e.getUserHeader="GetUserHeader",e.showLoginDlg="ShowLoginDlg",e.createPersonalInfoWnd="CreatePersonalInfoWnd",e.createRetryLoginWnd="CreateRetryLoginWnd",e.switchAccount="SwitchAccount",e.updateHeader="UpdateHeader",e.pingThroughXLUserServer="PingThroughXLUserServer",e.retryLogIn="RetryLogIn",e.createWebWnd="CreateWebWnd",e.isAutoLoginAw="IsAutoLoginAw",e.channel="Channel",e.getVipInfo="GetVipInfo",e.getUserInfoByKeyAw="GetUserInfoByKeyAw"}(n.LoginFunction||(n.LoginFunction={})),function(e){e.getDeviceID="GetDeviceID",e.getInitData="GetInitData",e.saveData="SaveData"}(n.LoginSDKFunction||(n.LoginSDKFunction={})),function(e){e.subtitleIsSupportJpeg="XmpSubtitleIsSupportJpeg",e.queryMediaInfo="QueryMediaInfo",e.openVideoEdit="OpenVideoEdit",e.openGifEdit="OpenGifEdit",e.createSnapShotEx="CreateSnapShotEx",e.createSnapShot="CreateSnapShot",e.createHDPicture="CreateHDPicture",e.isHDPicCreating="IsHDPicCreating",e.openClearBlack="OpenClearBlack",e.closeClearBlack="CloseClearBlack",e.clearBlackWindow="ClearBlackWindow",e.getBlackCollectCount="GetBlackCollectCount",e.getCollectData="GetCollectData",e.getClearBlackRect="GetClearBlackRect",e.createPreViewSnapshot="CreatePreViewSnapshot",e.getPreViewSnapshot="GetPreViewSnapshot"}(n.SnapshotFunction||(n.SnapshotFunction={})),function(e){e.showSystemMenu="ShowSystemMenu"}(n.MainMenuFunction||(n.MainMenuFunction={})),function(e){e.createButton="CreateButton",e.updateButton="UpdateButton",e.createWebview="CreateWebview",e.setDefaultVipSpeedStatus="SetDefaultVipSpeedStatus",e.updateVipSpeedStatus="UpdateVipSpeedStatus",e.getWebviewInfo="GetWebviewInfo",e.createVipView="CreateVipview",e.showCurveChart="showCurveChart",e.applyBrowserView="ApplyBrowserView",e.getBrowserViewId="GetBrowserViewId",e.initBrowserViewConfig="initBrowserViewConfig",e.createVipMenu="CreateVipMenu",e.getMenuSlot="GetMenuSlot",e.openNewTab="OpenNewTab",e.videoPause="DoVideoPause",e.videoPlay="DoVideoPlay",e.videoPauseEx="DoVideoPauseEx",e.videoPlayEx="DoVideoPlayEx",e.setPlaySpeed="SetPlaySpeed",e.setProgressColor="SetProgressColor",e.getProgressColor="GetProgressColor",e.showBufferingEntry="ShowBufferingEntry",e.isBufferingEntryShow="IsBufferingEntryShow",e.showOpenVipEntry="ShowOpenVipEntry",e.registerFunctionCall="RegisterFunctionCall",e.executeFunctionCall="ExecuteFunctionCall",e.videoGetPlayState="VideoGetPlayState",e.setXmpFocus="SetXmpFocus",e.leaveFullScreen="LeaveFullScreen"}(n.UIFunction||(n.UIFunction={})),function(e){e.addItem="VideoTipLeftTopAddItem",e.addLinkItem="VideoTipLeftTopAddLinkItem",e.updateItemText="VideoTipLeftTopUpdateItemText",e.removeItem="VideoTipLeftTopRemoveItem",e.showTip="VideoTipLeftTopShowTip",e.closeTip="VideoTipLeftTopCloseTip",e.hideTip="HideTip"}(n.VideoTipFunction||(n.VideoTipFunction={})),function(e){e.unKnow="UnKnow",e.localFile="LocalFile",e.downloadAndPlay="DownloadAndPlay",e.yunBo="YunBo"}(n.XmpPlayType||(n.XmpPlayType={})),function(e){e.init="XmpPlayerInit",e.showAPlayerWindow="XmpShowAPlayerWindow",e.createXmpMedia="XmpPlayerCreateXmpMedia",e.open="XmpPlayerOpen",e.openFile="XmpPlayerOpenFile",e.addFile="XmpPlayerAddFile",e.openFolder="XmpPlayerOpenFolder",e.openBt="XmpPlayerOpenBt",e.openUrl="XmpPlayerOpenUrl",e.openMedia="XmpPlayerOpenMedia",e.close="XmpPlayerClose",e.stop="XmpPlayerStop",e.play="XmpPlayerPlay",e.pause="XmpPlayerPause",e.getVersion="XmpPlayerGetVersion",e.getState="XmpPlayerGetState",e.isPlaying="XmpPlayerIsPlaying",e.getDuration="XmpPlayerGetDuration",e.getPosition="XmpPlayerGetPosition",e.setPosition="XmpPlayerSetPosition",e.getVideoWidth="XmpPlayerGetVideoWidth",e.getVideoHeight="XmpPlayerGetVideoHeight",e.getVolume="XmpPlayerGetVolume",e.setVolume="XmpPlayerSetVolume",e.isSeeking="XmpPlayerIsSeeking",e.getBufferProgress="XmpPlayerGetBufferProgress",e.getConfig="XmpPlayerGetConfig",e.setConfig="XmpPlayerSetConfig",e.setCurrentMedia="XmpPlayerSetCurrentMedia",e.getCurrentMedia="XmpPlayerGetCurrentMedia",e.getMediaAttribute="XmpPlayerMediaAttribute",e.getCurrentMediaAttribute="XmpPlayerGetCurrentMediaAttribute",e.clearCurrentMedia="XmpPlayerClearCurrentMedia",e.openPreMedia="XmpPlayerOpenPreMedia",e.openNextMedia="XmpPlayerOpenNextMedia",e.isPlayOrderFirstMedia="XmpPlayerIsPlayOrderFirstMedia",e.isPlayOrderLastMedia="XmpPlayerIsPlayOrderLastMedia",e.isFirstMedia="XmpPlayerIsFirstMedia",e.isLastMedia="XmpPlayerIsLastMedia",e.isMediasLoadFinished="XmpPlayerIsMediasLoadFinished",e.getMediasInfo="XmpPlayerGetMediasInfo",e.removeMedia="XmpPlayerRemoveMedia",e.removeAllMedia="XmpPlayerRemoveAllMedia",e.setASpectRatioAtive="XmpPlayerSetASpectRatioAtive",e.setPlayForward="XmpPlayerSetPlayForward",e.postionChange="XmpPlayerPostionChange",e.getBufferRange="XmpPlayerGetBufferRange",e.fireKeyDown="XmpPlayerFireKeyDown",e.fireKeyUp="XmpPlayerFireKeyUp",e.setAudioTime="XmpPlayerSetAudioTime",e.setProportion="XmpPlayerSetProportion",e.setVlomue="XmpPlayerSetVlomue",e.getCurView="XmpPlayerGetCurView",e.recordStat="XmpPlayerRecordStat",e.getHostWnd="XmpPlayerGetHostWnd",e.startWindowZorderChecker="StartWindowZorderChecker",e.stopWindowZorderChecker="StopWindowZorderChecker",e.setZOrderCheckerWindowHandle="SetZOrderCheckerWindowHandle",e.removeZOrderCheckerWindowHandle="RemoveZOrderCheckerWindowHandle",e.getVideoDuration="GetVideoDuration",e.getDownloadState="GetDownloadState",e.getResConfig="GetResConfig",e.queryTaskState="QueryTaskState",e.shareMediaInfo="ShareMediaInfo",e.getThunderDirState="GetThunderDirState",e.setThunderDirState="SetThunderDirState",e.showSyncDig="ShowSyncDig",e.isXmpLite="IsXmpLite",e.handleVipPlaySpeed="handleVipPlaySpeed",e.getMediaInfo="GetMediaInfo",e.getCurrentMediaInfo="GetCurrentMediaInfo",e.setMediaAttribute="XmpPlayerSetMediaAttribute",e.updateDownloadEmbedRect="UpdateDownloadEmbedRect",e.updatePanEmbedRect="UpdatePanEmbedRect",e.createIndependentWindow="CreateIndependentWindow",e.thunderResize="ThunderResize",e.updateScrollShowOrHide="UpdateScrollShowOrHide",e.updateFloatWindow="IpdateFloatWindow",e.updateAplayerHwnd="UpdateAplayerHwnd",e.updatePlaySource="UpdatePlaySource",e.setXmpCurrentMode="SetXmpCurrentMode",e.getXmpCurrentMode="GetXmpCurrentMode",e.destroy="XmpDestroy",e.maximize="XmpMaximize",e.unmaximize="XmpUnmaximize",e.minmized="XmpMinmized",e.setPlaySpeed="SetPlaySpeed",e.getPlaySpeed="GetPlaySpeed",e.setWindowTopMode="SetWindowTopMode",e.calcelWindowTopMode="CalcelWindowTopMode",e.enterFullScreen="EnterFullScreen",e.leaveFullScreen="LeaveFullScreen",e.setFullcScreen="SetFullcScreen",e.getIsFullScreen="GetIsFullScreen",e.setPlayingTaskId="SetPlayingTaskId",e.setlayPingPanFileId="SetPlayingPanFileId",e.setSelectTaskId="SetSelectTaskId",e.setSelectPanel="SetSelectPanel",e.setSelectTab="SetSelectTab",e.setSelectPanFileId="SetSelectPanFileId",e.getPlayingTaskId="GetPlayingTaskId",e.getPlayingPanFileId="GetPlayingPanFileId",e.getSelectTaskId="GetSelectTaskId",e.getSelectPanel="GetSelectPanel",e.getSelectTab="GetSelectTab",e.getSelectPanFileId="GetSelectPanFileId",e.getXmpPlayType="GetXmpPlayType",e.getDownloadAndPlayTaskData="GetDownloadAndPlayTaskData",e.openDLNA="OpenDLNA",e.disConnectDLNA="DisConnectDLNA",e.addXmpVideoTipPos="AddXmpVideoTipPos",e.removeXmpVideoTipPos="RemoveXmpVideoTipPos",e.addXmpVideoTipPosMainRenderer="AddXmpVideoTipPosRenderer",e.removeXmpVideoTipPosMainRenderer="RemoveXmpVideoTipPosRenderer",e.switchSilent="XmpSwitchSilent",e.isSilent="XmpIsSilent",e.cancelDownloadCodecs="OnCancelDownloadCodecs",e.getCachedDownloadCodecInfo="OnGetCachedDownloadCodecInfo",e.onTaskStopped="OnTaskStopped",e.showOrHideXmpWindow="OnShowOrHideXmpWindow",e.getPlayingSoure="OnGetPlayingSoure",e.userLogout="OnUserLogout",e.isCurrentBuffingIsByDrag="IsCurrentBuffingIsByDrag",e.thunderQuit="ThunderQuit",e.getLastPlayError="GetLastPlayError",e.showAplayerAndFloatWindow="ShowAplayerAndFloatWindow",e.hideAplayerAndFloatWindow="HideAplayerAndFloatWindow",e.hideEmbedAplayerAndFloatWindow="HideEmbedAplayerAndFloatWindow",e.isPlayMusic="IsPlayMusic",e.getMediaById="GetMediaById",e.setPlayEndInfo="SetPlayEndInfo"}(n.XmpPlayerFunction||(n.XmpPlayerFunction={})),function(e){e.isSubtitleShow="XmpSubtitleIsSubtitleShow",e.isSubtitle2Show="XmpSubtitleIsSubtitle2Show",e.showSubtitle="XmpSubtitleShowSubtitle",e.showSubtitle2="XmpSubtitleShowSubtitle2",e.getCurrentSubtitle="XmpSubtitleGetCurrentSubtitle",e.getCurrentSubtitle2="XmpSubtitleGetCurrentSubtitle2",e.getSubtitleList="XmpSubtitleGetSubtitleList",e.loadSubtitleFile="XmpSubtitleLoadSubtitleFile",e.setCurrentSubtitle="XmpSubtitleSetCurrentSubtitle",e.setSubtitleLanguageIndex="XmpSubtitleSetSubtitleLanguageIndex",e.setSubtitlePosition="XmpSubtitleSetSubtitlePosition",e.getSubtitlePosition="XmpSubtitleGetSubtitlePosition",e.setSubtitleFontStyle="XmpSubtitleSetSubtitleFontStyle",e.getSubtitleSize="XmpSubtitleGetSubtitleSize",e.getSubtitleColor="XmpSubtitleGetSubtitleColor",e.getSubtitleFont="XmpSubtitleGetSubtitleFont",e.setSubtitleTimming="XmpSubtitleSetSubtitleTimming",e.getSubtitleTimming="XmpSubtitleGetSubtitleTimming",e.setSubtitle3DMode="XmpSubtitleSetSubtitle3DMode",e.setUseHardware="XmpSubtitleSetUseHardware",e.reportSubTitle="ReportSubTitle",e.uploadSubTitle="UploadubTitle",e.onSubtitleInit="XmpSubtitleInit",e.onSubtitleLoadSuc="XmpSubtitleLoadSuc",e.createSuppress="CreateSuppress",e.getSuppressState="GetSuppressState",e.getSuppressPlayUrl="GetSuppressPlayUrl",e.getSuppressProgress="GetSuppressProgress",e.getSuppressNeedTime="GetSuppressNeedTime",e.showSubtitleSuppressDialog="ShowSubtitleSuppressDialog",e.continueSuppress="ContinueSuppress",e.getFullState="GetFullState",e.isSettingDefaultSecondSubtitle="IsSettingDefaultSecondSubtitle",e.isSecondSubtitle="IsSecondSubtitle"}(n.XmpSubtitleFunction||(n.XmpSubtitleFunction={})),function(e){e.getTaskInfo="GetTaskInfo",e.shellOpen="ShellOpen",e.openFolderWithSelectFile="OpenFolderWithSelectFile",e.getFileMd5="GetFileMd5",e.getPeerID="GetPeerID",e.getDeviceID="GetDeviceID",e.getThunderVersion="GetThunderVersion",e.getXmpVersion="GetXmpVersion",e.trackEvent="TrackEvent",e.getCurInternetState="GetCurInternetState",e.getCurPlatform="GetCurPlatform",e.getXmpShowMode="GetXmpShowMode",e.isModuleEnable="IsModuleEnable",e.updateTabSelectState="UpdateTabSelectState",e.getMouseShow="getMouseShow",e.updateFullFill="UpdateFullFill",e.getWindowTopMode="GetWindowTopMode",e.isVideoEditMode="IsVideoEditMode",e.showCtrlView="ShowCtrlView",e.showTopView="ShowTopView",e.showMoreAbout="ShowMoreAbout",e.setMenuPopUp="SetMenuPopUp",e.setWindowPopUp="SetWindowPopUp",e.isListExpand="IsListExpand",e.isMenuPopUp="IsMenuPopUp",e.isWindowPopUp="IsWindowPopUp",e.isMouseInFloat="IsMouseInFloat",e.switchtoNormalMode="SwitchtoNormalMode",e.switchToTransparentMode="SwitchToTransparentMode",e.dropOpenFiles="DropOpenFiles",e.dropOpenUrl="DropOpenUrl",e.getShowCondition="GetShowCondition",e.utf8StringEncodeToBinary="Utf8StringEncodeToBinary",e.utf8StringDecodeFromBinary="Utf8StringDecodeFromBinary",e.getErrorCodeConfigMessage="GetErrorCodeConfigMessage",e.quitProcess="QuitProcess",e.associate="Associate",e.checkXmpUpdate="CheckXmpUpdate",e.changeVideoRatio="ChangeVideoRatio",e.getVideoScaleRate="GetVideoScaleRate",e.getHoverPos="GetHoverPos",e.setHoverPos="SetHoverPos",e.getCurrentDevice="GetCurrentDevice",e.activeDevice="ActiveDevice",e.setCurrentDevice="SetCurrentDevice",e.getDeviceList="GetDeviceList",e.searchDevice="SearchDevice",e.isDeviceSupport="IsDeviceSupport",e.getInitUserLoginParam="GetInitUserLoginParam",e.handleMouseTimeOut="HandleMouseTimeOut",e.getOpenFrom="GetOpenFrom",e.setHideAndPauseWindow="SetHideAndPauseWindow",e.setHideWindowNotPause="SetHideWindowNotPause",e.setFullWindowMouseEnter="SetFullWindowMouseHover",e.setDragMove="SetDragMove",e.isEmbedMode="IsEmbedMode",e.getBackUpValue="getBackUpValue"}(n.XmpPluginFunction||(n.XmpPluginFunction={})),function(e){e.getVideoStuckVipData="GetVideoStuckVipData",e.openPayVipUrl="OpenPayVipUrl",e.actionPreOpen="ActionPreOpen"}(n.VipBufferTipFunction||(n.VipBufferTipFunction={})),function(e){e.showTimeTips="ShowTimeTips",e.destroyTimeTips="DestroyTimeTips"}(n.TimeTipFunction||(n.TimeTipFunction={})),function(e){e.loadSubtitle="LoadSubtitle",e.onlineSubtitleMatch="OnlineSubtitleMatch",e.showOrHideSubtitle="ShowOrHideSubtitle",e.isEnableHideSubtitle="IsEnableHideSubtitle",e.isSubtitleHided="IsSubtitleHided",e.loadEmbedSubtitle="LoadEmbedSubtitle",e.loadOnlineSubtitle="LoadOnlineSubtitle",e.loadLocalSubtitle="LoadLocalSubtitle",e.getOnlineSubtitleList="GetOnlineSubtitleList",e.getEmbedSubtitleList="GetEmbedSubtitleList",e.getLocalSubtitleList="GetLocalSubtitleList",e.getManualSubtitleList="GetManualSubtitleList",e.getCurrentTitle="GetCurrentTitle",e.getCurrentTitle2="GetCurrentTitle2",e.manualLoadSubtitle="ManualLoadSubtitle"}(n.SubtitleFunction||(n.SubtitleFunction={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ModeChangeEvent=n.ClientProcessEvent=n.XmpEvent=void 0,function(e){e.onWindowMessage="OnWindowMessage",e.onStateChanged="OnStateChanged",e.onCreateMediaError="OnCreateMediaError",e.onOpenSucceeded="OnOpenSucceeded",e.onVideoSizeChanged="OnVideoSizeChanged",e.onAPlayerCreated="OnAPlayerCreated",e.onAllStoped="OnAllStoped",e.onSeekCompleted="OnSeekCompleted",e.onBuffer="OnBuffer",e.onDownloadCodec="OnDownloadCodec",e.onDownloadCodecProgress="OnDownloadCodecProgress",e.onDropFiles="OnDropFiles",e.onEvent="OnEvent",e.onGetPlayUrl="OnGetPlayUrl",e.onOpenFailed="OnOpenFailed",e.onPlayFailed="OnPlayFailed",e.onClearError="OnClearError",e.onError="OnError",e.onPlaying="OnPlaying",e.onPreOpen="OnPreOpen",e.onPaused="OnPaused",e.onPlayCompleted="OnPlayCompleted",e.onPreStop="OnPreStop",e.onStop="OnStop",e.onForceLoadingState="OnForceLoadingState",e.onVipStruckPlayState="OnVipStruckPlayState",e.onShowFloatWindow="OnShowFloatWindow",e.onTimeDesChange="OnTimeDesChange",e.onPositionChanged="OnPositionChanged",e.onSnapShotCreated="OnSnapShotCreated",e.onXmpPlayerEvent="OnXmpPlayerEvent",e.onXmpAplayerCrash="OnXmpAplayerCrash",e.onUpdateMediaCid="OnUpdateMediaCid",e.onUpdateMediaGcid="OnUpdateMediaGcid",e.onSpeedChange="OnSpeedChange",e.onFullScreenStateChange="OnFullScreenStateChange",e.onSetConfig="OnSetConfig",e.onVolumeChange="OnVolumeChange",e.onPlayStateChange="OnPlayStateChange",e.onCurViewChanged="OnCurViewChanged",e.onUserLogin="OnUserLogin",e.onDwmCompositionChanged="OnDwmCompositionChanged",e.onDpiChanged="OnDpiChanged",e.onGPUProcessCrashed="OnGPUProcessCrashed",e.onSetCurrentDevice="OnSetCurrentDevice",e.onXmpPlayerRemoveMedias="OnXmpPlayerRemoveMedias",e.onOpenMediaNotExist="OnOpenMediaNotExist",e.onSwitchModeError="OnSwitchModeError",e.onDlnaEvent="OnDlnaEvent",e.onSubtitleInit="OnSubtitleInit",e.onSubtitleUnInit="onSubtitleUnInit",e.onEmbedSubInitFinish="OnEmbedSubInitFinish",e.onEntertCurrentDevice="OnEntertCurrentDevice",e.onWindowZOrderChanged="OnWindowZOrderChanged",e.onAplayerSeekFrameChanged="OnAplayerSeekFrameChanged",e.onModeBarChange="OnModeBarChange",e.onThunderTaskRemove="OnThunderTaskRemove",e.onXmpClose="OnXmpClose",e.onXmpStartFailed="OnXmpStartFailed",e.onVipViewInitFinish="OnVipViewInitFinish",e.onModeEvent="OnModeEvent",e.onMaxmized="OnMaxmized",e.onUnMaxmized="OnUnMaxmized",e.onSetWindowTopMost="OnWindowTopMost",e.onCancelWindowTopMost="OnCancelWindowTopMost",e.onOpenOrCloseSettingCenter="OnOpenOrCloseSettingCenter",e.onUpdateBufferingUI="OnUpdateBufferingUI",e.onOpenSucceededCreateTask="OnOpenSucceededCreateTask"}(n.XmpEvent||(n.XmpEvent={})),function(e){e.onMainWindowSize="OnMainWindowSize",e.onTabSelectChange="OnTabSelectChange",e.onThunderQuit="OnThunderQuit"}(n.ClientProcessEvent||(n.ClientProcessEvent={})),function(e){e.onXmpModeChanging="OnXmpModeChanging",e.onXmpModeChanged="OnXmpModeChanged",e.onXmpEnterFullScreen="OnXmpEnterFullScreen",e.onXmpLeaveFullScreen="OnXmpLeaveFullScreen"}(n.ModeChangeEvent||(n.ModeChangeEvent={}))},function(e,n){e.exports=require("os")},function(e,n,t){"use strict";var i=this&&this.__awaiter||function(e,n,t,i){return new(t||(t=Promise))(function(o,r){function a(e){try{s(i.next(e))}catch(e){r(e)}}function l(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){e.done?o(e.value):new t(function(n){n(e.value)}).then(a,l)}s((i=i.apply(e,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const o=t(7),r=t(21),a=t(6),l=t(10);function s(e){l.information("on object freeer"),global.__xdasIPCClienInstance.notifyFreer(e.remoteId,e.callbackId)}let d=void 0;global.__xdasIPCClienInstance||(global.__xdasIPCClienInstance=new class extends o.EventEmitter{constructor(){super(),this.rid=0,this.apis={},this.singletonMap={},this.connectedMap={},this.retCallbackMap={},this.eventCallbackMaps={},this.contextCallbackMap={}}start(e,n,t,i){do{if(n||(n=a.getDefaultPrex()),this.singletonMap.hasOwnProperty(n.toLowerCase())){if(i)if(this.connectedMap.hasOwnProperty(n.toLowerCase()))i("connect");else{let e=this.singletonMap[n.toLowerCase()];e.on("error",e=>{i("error",e)}),e.on("connect",()=>{i("connect")}),e.on("end",()=>{let n=e.isInprocess();i("end",e.getContext(),t,n)})}break}if(global.__xdasPluginConfig&&global.__xdasPluginConfig.name?e={name:global.__xdasPluginConfig.name,version:global.__xdasPluginConfig.version}:void 0!==e&&null!==e||(e=this.parseContext()),!e){if(!this.client||!this.client.getContext())throw new Error("no suitable context for client, please specify context with start function");e={name:this.client.getContext().name,version:this.client.getContext().version}}if(e.name===a.serverContextName)throw new Error("client context must difference from server");if(t&&!this.client)throw new Error("connect to other product must start self firstly");global.__xdasPluginConfig||(global.__xdasPluginConfig=e);let o=new r.Client({context:e,socketPrex:n});this.singletonMap[n.toLowerCase()]=o,t||(this.client=o),o.on("message",e=>{if("fire_event"===e.action)this.fireServerEvent(o,e.name,[e.__context].concat(e.args));else if("client_context_freer"===e.action)do{let n=e.rid;if(n){if(!this.contextCallbackMap[n])break;delete this.contextCallbackMap[n]}}while(0);else if("call_client_by_id"===e.action)this.callFunctionById(o,e.rid,e.s_rid,e.args);else if("call_client_api"===e.action)this.callRegisterFunction(o,e);else if("check_client_function"===e.action){let n=e.method,t=!0;n&&this.apis&&this.apis[n]||(t=!1),this.sendAdapter(o,{s_rid:e.s_rid,action:"check_client_function_callback",success:!0,data:t})}else if(void 0!==e.success&&null!==e.success){let n=e;this.client===o&&this.emit("stat_call_function_back",o.getContext(),e);const t=this.retCallbackMap[n.rid].callback;if(t)if(n.success)do{if("remote_client_callback"===e.action&&e.__context&&e.__context.name&&e.__context.productId){let i=`${e.__context.productId}-${e.__context.name}`.toLowerCase();t(null,this.decodeParameter(n.data,i));break}t(null,n.data)}while(0);else t(n.error,n.data);delete this.retCallbackMap[n.rid]}}),o.on("error",e=>{i&&i("error",e),this.emit("socket-error",e,o.getContext(),t,o.isInprocess()),delete this.singletonMap[n.toLowerCase()],delete this.connectedMap[n.toLowerCase()],t||(this.client=null)}),o.isInprocess()?(this.connectedMap[n.toLowerCase()]=o,i&&i("connect"),this.emit("connect",o.getContext(),t,!0)):o.on("connect",()=>{this.connectedMap[n.toLowerCase()]=o,i&&i("connect"),this.emit("connect",o.getContext(),t,!1)}),o.on("end",()=>{let e=o.isInprocess();l.information("server is ended, and this client emit end",n,t,e),i&&i("end",o.getContext(),t,e),this.emit("end",o.getContext(),t,e),delete this.singletonMap[n.toLowerCase()],delete this.connectedMap[n.toLowerCase()],t||(this.client=null)}),this.registry(o)}while(0)}registerFunctions(e){do{if(!e)break;let n=void 0;for(let t in e)if(this.apis.hasOwnProperty(t)){n=t;break}if(n)throw new Error(`try to coverd function ${n}`);this.apis=Object.assign({},this.apis,e)}while(0)}checkServerFunction(e){return i(this,void 0,void 0,function*(){return this.internalCheckServerFunction(this.client,e)})}callServerFunction(e,...n){return i(this,void 0,void 0,function*(){let t=null,i=yield this.callServerFunctionEx(e,...n);return i&&(t=i[0]),t})}callServerFunctionEx(e,...n){return this.internalCallServerFunctionEx(this.client,e,...n)}isRemoteClientExist(e){return this.internalIsRemoteClientExist(this.client,e)}checkRemoteFunction(e,n){return this.internalCheckRemoteFunction(this.client,e,n)}callRemoteClientFunction(e,n,...t){return this.internalCallRemoteClientFunction(this.client,e,n,...t)}notifyFreer(e,n){this.sendAdapter(this.client,{action:"client_context_freer",dst:e,rid:n})}callRemoteContextById(e,n,...t){this.sendAdapter(this.client,{dst:e,action:"call_remote_context_by_id",rid:n,args:t})}attachServerEvent(e,n){return this.internalAttachServerEvent(this.client,e,n)}detachServerEvent(e,n){this.internalDetachServerEvent(this.client,e,n)}broadcastEvent(e,...n){this.sendAdapter(this.client,{action:"broadcast",name:e,args:n})}crossCheckServerFunction(e,n){return i(this,void 0,void 0,function*(){{if(!e)throw new Error("An argument for 'productId' was not provided");let t=this.singletonMap[e.toLowerCase()];if(!t)throw new Error("Please call the 'start' interface first");return this.internalCheckServerFunction(t,n)}})}crossCallServerFunction(e,n,...t){return i(this,void 0,void 0,function*(){let i=null,o=yield this.crossCallServerFunctionEx(e,n,...t);return o&&(i=o[0]),i})}crossCallServerFunctionEx(e,n,...t){{if(!e)throw new Error("An argument for 'productId' was not provided");let i=this.singletonMap[e.toLowerCase()];if(!i)throw new Error("Please call the 'start' interface first");if(!n)throw new Error("An argument for 'funcName' was not provided");return this.internalCallServerFunctionEx(i,n,...t)}}crossIsRemoteClientExist(e,n){return i(this,void 0,void 0,function*(){{if(!e)throw new Error("An argument for 'productId' was not provided");let t=this.singletonMap[e.toLowerCase()];if(!t)throw new Error("Please call the 'start' interface first");return this.internalIsRemoteClientExist(t,n)}})}crossCheckRemoteFunction(e,n,t){return i(this,void 0,void 0,function*(){{if(!e)throw new Error("An argument for 'productId' was not provided");let i=this.singletonMap[e.toLowerCase()];if(!i)throw new Error("Please call the 'start' interface first");if(!n)throw new Error("An argument for 'remoteId' was not provided");if(!t)throw new Error("An argument for 'funcName' was not provided");return this.internalCheckRemoteFunction(i,n,t)}})}crossCallRemoteClientFunction(e,n,t,...i){{if(!e)throw new Error("An argument for 'productId' was not provided");let o=this.singletonMap[e.toLowerCase()];if(!o)throw new Error("Please call the 'start' interface first");if(!n)throw new Error("An argument for 'remoteId' was not provided");if(!t)throw new Error("An argument for 'funcName' was not provided");return this.internalCallRemoteClientFunction(o,n,t,...i)}}crossAttachServerEvent(e,n,t){let i=void 0;{if(!e)throw new Error("An argument for 'productId' was not provided");let o=this.singletonMap[e.toLowerCase()];if(!o)throw new Error("Please call the 'start' interface first");if(!n)throw new Error("An argument for 'eventName' was not provided");i=this.internalAttachServerEvent(o,n,t)}return i}crossDetachServerEvent(e,n,t){{if(!e)throw new Error("An argument for 'productId' was not provided");let i=this.singletonMap[e.toLowerCase()];if(!i)throw new Error("Please call the 'start' interface first");if(!n)throw new Error("An argument for 'eventName' was not provided");this.internalDetachServerEvent(i,n,t)}}crossBroadcastEvent(e,n,...t){{if(!e)throw new Error("An argument for 'productId' was not provided");let i=this.singletonMap[e.toLowerCase()];if(!i)throw new Error("Please call the 'start' interface first");if(!n)throw new Error("An argument for 'eventName' was not provided");this.sendAdapter(i,{action:"broadcast",name:n,args:t,__context:Object.assign({},this.client.getContext())})}}registry(e){let n=this.getFullContextName(this.client);return new Promise((t,i)=>{do{if(!n){t(!1);break}let i=this.generateId();const o={alias:n,action:"register",rid:i};let r=(e,i)=>{e?(l.error("register error",e.message),t(i)):t(n)};this.retCallbackMap[i]=Object.assign({callback:r},o),this.sendAdapter(e,o)}while(0)})}getNow(){return Date.now()}sendAdapter(e,n){do{if(!n)break;let t=this.getNow();if(n.timestamp?n.timestamp=[...n.timestamp].concat(t):n.timestamp=[].concat(t),!n.__context){let t=e.getContext();t&&(n=Object.assign({__context:t},n))}e.isInprocess()?(l.information("send to server in process"),global.__xdasIPCServer.emit("message",n,e)):e.send(n)}while(0)}parseContext(){let e=void 0;do{let n="";for(let e=0;e<process.argv.length;e++){let t=process.argv[e];if(0===t.indexOf("--xdas-plugin-name=",0)){n=t.substr("--xdas-plugin-name=".length);break}}if(!n)break;e={name:n}}while(0);return e}generateId(){return this.rid++}getFullContextName(e,n){let t="";do{if(n===a.serverContextName){t=n;break}if(void 0===n){t=`${e.getContext().productId}-${e.getContext().name}`.toLowerCase();break}t=`${e.getContext().productId}-${n}`.toLowerCase()}while(0);return t}internalCheckServerFunction(e,n){return new Promise((t,i)=>{do{if(!e){t(!1);break}if(!n){t(!1);break}let i=this.generateId();const o={action:"check_server_function_exist",method:n,rid:i};let r=(e,n)=>{t(!e&&n)};this.retCallbackMap[i]=Object.assign({callback:r},o),this.sendAdapter(e,o)}while(0)})}internalCallServerFunctionEx(e,n,...t){return new Promise((i,o)=>{do{if(!e){i([null,"client doesn't ready"]);break}if(!n){i([null,"funcName is not specifed"]);break}e===this.client&&this.emit("stat_call_function",this.client.getContext(),n);let o=this.generateId();if(t)for(let e=0;e<t.length;e++)t[e]=this.convertFunction2IdEx(t[e]);const r={rid:o,method:n,args:t};let a=(n,t)=>{n?(l.error("callServerFunction error",n,e.getContext()),i([null,n])):i([t,void 0])};this.retCallbackMap[o]=Object.assign({callback:a},r),this.sendAdapter(e,r)}while(0)})}internalIsRemoteClientExist(e,n){return new Promise((t,i)=>{do{if(!n){t([!1,"remote client alias is not specifed"]);break}if(e===this.client&&n.toLowerCase()===e.getContext().name.toLowerCase()){t([!0,"self is exist"]);break}let i=this.generateId();const o={dst:this.getFullContextName(e,n),action:"check_client_exist",rid:i};let r=(e,n)=>{t(e?[!1,e]:[n,"success"])};this.retCallbackMap[i]=Object.assign({callback:r},o),this.sendAdapter(e,o)}while(0)})}internalCheckRemoteFunction(e,n,t){return new Promise((i,o)=>{do{if(!e){i(!1);break}if(!n){i(!1);break}if(!t){i(!1);break}if(e===this.client&&n.toLowerCase()===e.getContext().name.toLowerCase()){i(!(!this.apis||!this.apis[t]));break}let o=this.generateId();const r={action:"check_client_function_exist",method:t,rid:o,src:this.getFullContextName(this.client),dst:this.getFullContextName(e,n)};let a=(e,n)=>{i(!e&&n)};this.retCallbackMap[o]=Object.assign({callback:a},r),this.sendAdapter(e,r)}while(0)})}internalCallRemoteClientFunction(e,n,t,...i){return new Promise((o,r)=>{do{if(!e){o([null,"client doesn't ready"]);break}if(!n){o([null,"remote client alias is not specifed"]);break}if(!t){o([null,"funcName is not specifed"]);break}let r=(e,n)=>{e?(l.information("callRemoteClientFunction",e.message),o([null,e])):o([n,void 0])};if(i)for(let e=0;e<i.length;e++)i[e]=this.convertFunction2IdEx(i[e]);let a=this.generateId();const s={src:this.getFullContextName(this.client),dst:this.getFullContextName(e,n),action:"call_remote_client_api",method:t,args:i,rid:a};this.retCallbackMap[a]=Object.assign({callback:r},s),this.sendAdapter(e,s)}while(0)})}internalAttachServerEvent(e,n,t){let i=e.getContext().productId.toLowerCase();this.eventCallbackMaps.hasOwnProperty(i)||(this.eventCallbackMaps[i]={}),this.eventCallbackMaps[i].hasOwnProperty(n)||(this.eventCallbackMaps[i][n]={}),a.isObjectEmpty(this.eventCallbackMaps[i][n])&&this.sendAdapter(e,{action:"attach_event",name:n});let o=this.generateId();return this.eventCallbackMaps[i][n][o]=t,o}internalDetachServerEvent(e,n,t){let i=e.getContext().productId.toLowerCase();do{if(!this.eventCallbackMaps.hasOwnProperty(i))break;if(!this.eventCallbackMaps[i].hasOwnProperty(n))break;delete this.eventCallbackMaps[i][n][t],a.isObjectEmpty(this.eventCallbackMaps[i][n])&&this.sendAdapter(e,{action:"detach_event",name:n})}while(0)}fireServerEvent(e,n,...t){let i=e.getContext().productId.toLowerCase();do{if(!this.eventCallbackMaps.hasOwnProperty(i))break;if(!this.eventCallbackMaps[i].hasOwnProperty(n))break;let e=this.eventCallbackMaps[i][n];for(let n in e){let i=e[n];i&&i.apply(null,...t)}}while(0)}callFunctionById(e,n,t,...i){let o=void 0,r=!1;do{const a=this.contextCallbackMap[n];if(!a){l.error("the context function has been freeer",n),o={s_rid:t,action:"call_client_by_id_callback",success:!1,error:"the context function has been freeer"};break}let s=void 0,d=void 0;try{s=a.apply(null,...i)}catch(e){d=e.message;break}if(void 0===t||null===t)break;if(o={s_rid:t,action:"call_client_by_id_callback",success:!1},void 0!==d){o.error=d;break}if(s&&s.then){s.then(n=>{o.data=this.convertFunction2IdEx(n),o.success=!0,this.sendAdapter(e,o)}).catch(n=>{o.error=n instanceof Error?n.message:n,this.sendAdapter(e,o)}),r=!0;break}o.success=!0,o.data=this.convertFunction2IdEx(s)}while(0);!r&&o&&this.sendAdapter(e,o)}convertFunction2IdEx(e){let n=e;if("function"==typeof e){let t=this.generateId();this.contextCallbackMap[t]=e,n={"__nodeipc_callback_id__{A9C9D760-14E8-42CB-A3CB-9C0A0DDFD732}":t}}else if(e&&"object"==typeof e){n=Array.isArray(e)?[...e]:Object.assign({},e);for(let e in n){let t=n[e];if("function"==typeof t){let i=this.generateId();this.contextCallbackMap[i]=t,n[e]={"__nodeipc_callback_id__{A9C9D760-14E8-42CB-A3CB-9C0A0DDFD732}":i}}else t&&"object"==typeof t&&(n[e]=this.convertFunction2IdEx(t))}}return n}decodeParameter(e,n){let t=e;do{if(!e)break;if(!n)break;if("object"!=typeof e)break;let i=e["__nodeipc_callback_id__{A9C9D760-14E8-42CB-A3CB-9C0A0DDFD732}"];if(i){t=((...e)=>{this.callRemoteContextById(n,i,...e)}),global.__xdasObjectLiftMonitor&&global.__xdasObjectLiftMonitor.setObjectFreer(t,{remoteId:n,callbackId:i},s);break}for(let t in e){let i=e[t];e[t]=this.decodeParameter(i,n)}}while(0);return t}callRegisterFunction(e,n){let t=void 0,i=!1;do{if(!n)break;let o=n.method;if(!o)break;let r=this.getNow();if(t={s_rid:n.s_rid,action:"remote_client_callback",success:!1,rid:n.rid,method:n.method,src:n.src,timestamp:n.timestamp?n.timestamp.concat(r):[].concat(r)},!this.apis||!this.apis[o]){t.error=`callRegisterFunction ${o} is undefined`;break}let a=void 0,l=this.decodeParameter(n.args,n.src);try{a=this.apis[o].apply(null,[n.src].concat(l))}catch(e){t.error=e.message;break}if(a&&a.then){a.then(n=>{t.data=this.convertFunction2IdEx(n),t.success=!0,this.sendAdapter(e,t)}).catch(n=>{t.error=n instanceof Error?n.message:n,this.sendAdapter(e,t)}),i=!0;break}t.success=!0,t.data=this.convertFunction2IdEx(a)}while(0);l.information("callRegisterFunction",t),!i&&t&&this.sendAdapter(e,t)}}),d=global.__xdasIPCClienInstance,n.client=d},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=t(22),o=t(7),r=t(10),a=t(23),l=t(6);n.Client=class extends o.EventEmitter{constructor(e){if(e=e||{},super(),this.inprocess=!1,this.context=void 0,e.context&&(this.context=Object.assign({},e.context),this.context.productId=e.socketPrex),e.socket)this.socket=e.socket,this.bind();else if(global.__xdasIPCServer&&global.__xdasIPCServer.getProductId().toLowerCase()===e.socketPrex.toLowerCase())this.inprocess=!0;else{let n=l.getSockPath(e.socketPrex);this.socket=i.connect(n),this.bind()}}isInprocess(){return this.inprocess}getContext(){return this.context}bind(){const e=new a.Parser,n=this.socket;n.on("data",n=>{e.feed(n)}),n.on("connect",()=>{this.emit("connect")}),n.on("end",()=>{r.information("socket is ended"),this.socket=null,this.emit("end")}),n.on("error",e=>{this.socket=null,this.emit("error",e)}),e.on("message",e=>{this.emit("message",e)}),this.parser=e}send(e){if(this.socket)try{this.socket.write(this.parser.encode(e))}catch(e){r.error(e.message)}else r.information("This socket has been ended by the other party",this.context&&this.context.name)}}},function(e,n){e.exports=require("net")},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=t(24),o=t(7);n.Parser=class extends o.EventEmitter{constructor(){super(),this.decoder=new i.StringDecoder("utf8"),this.jsonBuffer=""}encode(e){return JSON.stringify(e)+"\n"}feed(e){let n=this.jsonBuffer,t=0,i=(n+=this.decoder.write(e)).indexOf("\n",t);for(;i>=0;){const e=n.slice(t,i),o=JSON.parse(e);this.emit("message",o),t=i+1,i=n.indexOf("\n",t)}this.jsonBuffer=n.slice(t)}}},function(e,n){e.exports=require("string_decoder")},function(e,n,t){"use strict";var i=this&&this.__awaiter||function(e,n,t,i){return new(t||(t=Promise))(function(o,r){function a(e){try{s(i.next(e))}catch(e){r(e)}}function l(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,l)}s((i=i.apply(e,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0}),n.confirm=n.initMessageBox=void 0;const o=t(3),r=t(9),a=t(26),l=t(2);let s={};function d(e,n={},t,l,d){return i(this,void 0,void 0,function*(){let i=Object.assign({width:400,height:174,frame:!1,resizable:!1,maximizable:!1,parent:t,show:!1,modal:!0,alwaysOnTop:!0,title:"",webPreferences:{nodeIntegration:!0}},n);if(i.modal&&s.confirm)return;i.modal&&(s.confirm=!0);let l="development"===process.env.RUN_ENV?"http://localhost:9080/message-box-renderer/":`file:///${__dirname}/message-box-renderer/index.html`;if(l+=`?boxId=${e.boxId}`,e.parentID){let n=o.BrowserWindow.fromId(e.parentID);n&&(i.parent=n,t=n)}let d=new o.BrowserWindow(i);yield d.loadURL(l),d.on("ready-to-show",()=>{d.setAlwaysOnTop(!1),r.roundRectWindow(d,t),d.webContents.once("crashed",(e,n)=>{d.isDestroyed()||d.close(),n||a.CrashHandlerNS.recordCrashEvent("confirm-msg-crashed",l)})}),d.on("close",()=>{s.confirm=!1,t.focus()})})}n.initMessageBox=function(e,n){const t={};let c=new Map;o.ipcMain.on("xmp-message-box-confirm-create",(n,t)=>i(this,void 0,void 0,function*(){yield d(t.options,t.dialogConf,e)})),o.ipcMain.on("xmp-message-box-pop-create",(n,t)=>i(this,void 0,void 0,function*(){let n=Object.assign({frame:!1,resizable:!1,maximizable:!1,parent:e,show:!1,modal:!0,alwaysOnTop:!0,title:"",webPreferences:{nodeIntegration:!0}},t.dialogConf);if(n.modal&&s.pop)return;n.modal&&(s.pop=!0);let i="development"===process.env.RUN_ENV?"http://localhost:9080/message-box-renderer/":`file:///${__dirname}/message-box-renderer/index.html`;i+=`?boxId=${t.boxId}`;let l=new o.BrowserWindow(n);yield l.loadURL(i),l.on("ready-to-show",()=>{l.setAlwaysOnTop(!1),r.roundRectWindow(l,e),l.webContents.once("crashed",(e,n)=>{l.isDestroyed()||l.close(),n||a.CrashHandlerNS.recordCrashEvent("pop-msg-crashed",i)}),l.show()}),l.on("close",()=>{s.pop=!1,e.focus()})})),o.ipcMain.on("xmp-message-box-custom-create",(n,d)=>i(this,void 0,void 0,function*(){let n="#FFF";d.backgroundColor&&(n=d.backgroundColor);let i=Object.assign({width:300,height:100,frame:!1,resizable:!1,maximizable:!1,parent:e,show:!1,modal:!0,alwaysOnTop:!1,backgroundColor:n,title:"",webPreferences:{nodeIntegration:!0}},d.dialogConf);if(i.modal&&s[d.popType])return;if(i.modal&&(s[d.popType]=!0),d.options.singleton){if(c.get(d.popType))return void t[d.popType].show();c.set(d.popType,!0)}if(d.options.parentID){let e=o.BrowserWindow.fromId(d.options.parentID);e&&(i.parent=e)}let u="development"===process.env.RUN_ENV?"http://localhost:9080/message-box-renderer/":`file:///${__dirname}/message-box-renderer/index.html`;u+=`?boxId=${d.boxId}`;let h=new o.BrowserWindow(i);yield h.loadURL(u),h.on("ready-to-show",()=>{h.setAlwaysOnTop(!!d.options.topMost),d.options.noshadow||r.roundRectWindow(h,e),h.webContents.once("crashed",(e,n)=>{h.isDestroyed()||h.close(),n||a.CrashHandlerNS.recordCrashEvent("custom-msg-crashed",u)})}),h.on("close",()=>{s[d.popType]=!1,d.options.singleton&&c.set(d.popType,!1);let n=global;n.mainRendererWindow&&!n.mainRendererWindow.isDestroyed()&&n.mainRendererWindow.send(l.ThunderChannelList.channelMessageBoxClose),e&&!e.isDestroyed()&&e.focus()}),t[d.popType]=h})),o.ipcMain.on("xmp-message-box-open",(e,n)=>{const i=n.name,o=n.position;t[i]&&(o&&t[i].setPosition(o.x,o.y),t[i].show())})},n.confirm=function(e,n,t,r){return i(this,void 0,void 0,function*(){let i=String(Math.random()).replace(/\D/,"");return o.ipcMain.once(`xmp-message-box-init-${i}`,n=>{n.sender.send("xmp-message-box-init-reply",{popType:"confirm",options:e})}),yield d(e,n,t),new Promise(e=>{o.ipcMain.once(`xmp-message-box-resolve-${i}`,(n,t,i)=>{e({action:t,checkboxChecked:i})})})})}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.CrashHandlerNS=void 0,function(e){e.recordCrashEvent=function(e,n){e&&(e=e+"-"+(new Date).getTime().toString())}}(n.CrashHandlerNS||(n.CrashHandlerNS={}))}]);