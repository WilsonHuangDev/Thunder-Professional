module.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=77)}([function(e,t,i){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Critical=1]="Critical",e[e.Error=2]="Error",e[e.Warning=3]="Warning",e[e.Information=4]="Information",e[e.Verbose=5]="Verbose"}(n=t.LogLevel||(t.LogLevel={})),t.outputLoggerConsole=((o={})[n.Critical]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.error.apply(console,e)},o[n.Error]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.error.apply(console,e)},o[n.Warning]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.warn.apply(console,e)},o[n.Information]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.info.apply(console,e)},o[n.Verbose]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.log.apply(console,e)},o);var o,r=function(){function e(e){this.level=process.env.TL_LEVEL?parseInt(process.env.TL_LEVEL,10):n.Information,this.moduleName="",this.moduleName=e}return e.getLogger=function(t){return new e(t)},e.hook=function(t,i){t&&i&&"function"==typeof i&&(e.hooks[t]=(e.hooks[t]||[]).concat([i]))},e.callHook=function(t,i,n){for(var o=[],r=3;r<arguments.length;r++)o[r-3]=arguments[r];t in e.hooks&&e.hooks[t].forEach(function(e){return e.apply(void 0,[i,n].concat(o))})},e.prototype.critical=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.log.apply(this,[n.Critical].concat(e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.log.apply(this,[n.Error].concat(e))},e.prototype.warning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.log.apply(this,[n.Warning].concat(e))},e.prototype.information=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.log.apply(this,[n.Information].concat(e))},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.log.apply(this,[n.Verbose].concat(e))},e.prototype.log=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];e.callHook.apply(e,["beforeLog",t,this.moduleName].concat(i)),this.checkShouldLog(t)&&(this.writeLog.apply(this,[t,"["+this.moduleName+"]"].concat(i)),e.callHook.apply(e,["logged",t,this.moduleName].concat(i)))},e.prototype.writeLog=function(t){for(var i,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(i=e.outputLogger)[t].apply(i,n)},e.prototype.checkShouldLog=function(t){return e.enableLogger&&t<=this.level&&this.checkfilter()},e.prototype.checkfilter=function(){return"all"===e.moduleFilter||e.moduleFilter.includes(this.moduleName)},e.outputLogger=t.outputLoggerConsole,e.hooks={},e.enableLogger="1"===process.env.TL_ENABLE,e.moduleFilter=process.env.TL_MODULE_FILTER||"all",e}();t.default=r},function(e,t){e.exports=require("path")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=i(12),r=i(87),a=i(6),s=i(35);function l(e){s.information("on object freeer"),global.__xdasIPCClienInstance.notifyFreer(e.remoteId,e.callbackId)}let d=void 0;global.__xdasIPCClienInstance||(global.__xdasIPCClienInstance=new class extends o.EventEmitter{constructor(){super(),this.rid=0,this.apis={},this.singletonMap={},this.connectedMap={},this.retCallbackMap={},this.eventCallbackMaps={},this.contextCallbackMap={}}start(e,t,i,n){do{if(t||(t=a.getDefaultPrex()),this.singletonMap.hasOwnProperty(t.toLowerCase())){if(n)if(this.connectedMap.hasOwnProperty(t.toLowerCase()))n("connect");else{let e=this.singletonMap[t.toLowerCase()];e.on("error",e=>{n("error",e)}),e.on("connect",()=>{n("connect")}),e.on("end",()=>{let t=e.isInprocess();n("end",e.getContext(),i,t)})}break}if(global.__xdasPluginConfig&&global.__xdasPluginConfig.name?e={name:global.__xdasPluginConfig.name,version:global.__xdasPluginConfig.version}:void 0!==e&&null!==e||(e=this.parseContext()),!e){if(!this.client||!this.client.getContext())throw new Error("no suitable context for client, please specify context with start function");e={name:this.client.getContext().name,version:this.client.getContext().version}}if(e.name===a.serverContextName)throw new Error("client context must difference from server");if(i&&!this.client)throw new Error("connect to other product must start self firstly");global.__xdasPluginConfig||(global.__xdasPluginConfig=e);let o=new r.Client({context:e,socketPrex:t});this.singletonMap[t.toLowerCase()]=o,i||(this.client=o),o.on("message",e=>{if("fire_event"===e.action)this.fireServerEvent(o,e.name,[e.__context].concat(e.args));else if("client_context_freer"===e.action)do{let t=e.rid;if(t){if(!this.contextCallbackMap[t])break;delete this.contextCallbackMap[t]}}while(0);else if("call_client_by_id"===e.action)this.callFunctionById(o,e.rid,e.s_rid,e.args);else if("call_client_api"===e.action)this.callRegisterFunction(o,e);else if("check_client_function"===e.action){let t=e.method,i=!0;t&&this.apis&&this.apis[t]||(i=!1),this.sendAdapter(o,{s_rid:e.s_rid,action:"check_client_function_callback",success:!0,data:i})}else if(void 0!==e.success&&null!==e.success){let t=e;this.client===o&&this.emit("stat_call_function_back",o.getContext(),e);const i=this.retCallbackMap[t.rid].callback;if(i)if(t.success)do{if("remote_client_callback"===e.action&&e.__context&&e.__context.name&&e.__context.productId){let n=`${e.__context.productId}-${e.__context.name}`.toLowerCase();i(null,this.decodeParameter(t.data,n));break}i(null,t.data)}while(0);else i(t.error,t.data);delete this.retCallbackMap[t.rid]}}),o.on("error",e=>{n&&n("error",e),this.emit("socket-error",e,o.getContext(),i,o.isInprocess()),delete this.singletonMap[t.toLowerCase()],delete this.connectedMap[t.toLowerCase()],i||(this.client=null)}),o.isInprocess()?(this.connectedMap[t.toLowerCase()]=o,n&&n("connect"),this.emit("connect",o.getContext(),i,!0)):o.on("connect",()=>{this.connectedMap[t.toLowerCase()]=o,n&&n("connect"),this.emit("connect",o.getContext(),i,!1)}),o.on("end",()=>{let e=o.isInprocess();s.information("server is ended, and this client emit end",t,i,e),n&&n("end",o.getContext(),i,e),this.emit("end",o.getContext(),i,e),delete this.singletonMap[t.toLowerCase()],delete this.connectedMap[t.toLowerCase()],i||(this.client=null)}),this.registry(o)}while(0)}registerFunctions(e){do{if(!e)break;let t=void 0;for(let i in e)if(this.apis.hasOwnProperty(i)){t=i;break}if(t)throw new Error(`try to coverd function ${t}`);this.apis=Object.assign({},this.apis,e)}while(0)}checkServerFunction(e){return n(this,void 0,void 0,function*(){return this.internalCheckServerFunction(this.client,e)})}callServerFunction(e,...t){return n(this,void 0,void 0,function*(){let i=null,n=yield this.callServerFunctionEx(e,...t);return n&&(i=n[0]),i})}callServerFunctionEx(e,...t){return this.internalCallServerFunctionEx(this.client,e,...t)}isRemoteClientExist(e){return this.internalIsRemoteClientExist(this.client,e)}checkRemoteFunction(e,t){return this.internalCheckRemoteFunction(this.client,e,t)}callRemoteClientFunction(e,t,...i){return this.internalCallRemoteClientFunction(this.client,e,t,...i)}notifyFreer(e,t){this.sendAdapter(this.client,{action:"client_context_freer",dst:e,rid:t})}callRemoteContextById(e,t,...i){this.sendAdapter(this.client,{dst:e,action:"call_remote_context_by_id",rid:t,args:i})}attachServerEvent(e,t){return this.internalAttachServerEvent(this.client,e,t)}detachServerEvent(e,t){this.internalDetachServerEvent(this.client,e,t)}broadcastEvent(e,...t){this.sendAdapter(this.client,{action:"broadcast",name:e,args:t})}crossCheckServerFunction(e,t){return n(this,void 0,void 0,function*(){{if(!e)throw new Error("An argument for 'productId' was not provided");let i=this.singletonMap[e.toLowerCase()];if(!i)throw new Error("Please call the 'start' interface first");return this.internalCheckServerFunction(i,t)}})}crossCallServerFunction(e,t,...i){return n(this,void 0,void 0,function*(){let n=null,o=yield this.crossCallServerFunctionEx(e,t,...i);return o&&(n=o[0]),n})}crossCallServerFunctionEx(e,t,...i){{if(!e)throw new Error("An argument for 'productId' was not provided");let n=this.singletonMap[e.toLowerCase()];if(!n)throw new Error("Please call the 'start' interface first");if(!t)throw new Error("An argument for 'funcName' was not provided");return this.internalCallServerFunctionEx(n,t,...i)}}crossIsRemoteClientExist(e,t){return n(this,void 0,void 0,function*(){{if(!e)throw new Error("An argument for 'productId' was not provided");let i=this.singletonMap[e.toLowerCase()];if(!i)throw new Error("Please call the 'start' interface first");return this.internalIsRemoteClientExist(i,t)}})}crossCheckRemoteFunction(e,t,i){return n(this,void 0,void 0,function*(){{if(!e)throw new Error("An argument for 'productId' was not provided");let n=this.singletonMap[e.toLowerCase()];if(!n)throw new Error("Please call the 'start' interface first");if(!t)throw new Error("An argument for 'remoteId' was not provided");if(!i)throw new Error("An argument for 'funcName' was not provided");return this.internalCheckRemoteFunction(n,t,i)}})}crossCallRemoteClientFunction(e,t,i,...n){{if(!e)throw new Error("An argument for 'productId' was not provided");let o=this.singletonMap[e.toLowerCase()];if(!o)throw new Error("Please call the 'start' interface first");if(!t)throw new Error("An argument for 'remoteId' was not provided");if(!i)throw new Error("An argument for 'funcName' was not provided");return this.internalCallRemoteClientFunction(o,t,i,...n)}}crossAttachServerEvent(e,t,i){let n=void 0;{if(!e)throw new Error("An argument for 'productId' was not provided");let o=this.singletonMap[e.toLowerCase()];if(!o)throw new Error("Please call the 'start' interface first");if(!t)throw new Error("An argument for 'eventName' was not provided");n=this.internalAttachServerEvent(o,t,i)}return n}crossDetachServerEvent(e,t,i){{if(!e)throw new Error("An argument for 'productId' was not provided");let n=this.singletonMap[e.toLowerCase()];if(!n)throw new Error("Please call the 'start' interface first");if(!t)throw new Error("An argument for 'eventName' was not provided");this.internalDetachServerEvent(n,t,i)}}crossBroadcastEvent(e,t,...i){{if(!e)throw new Error("An argument for 'productId' was not provided");let n=this.singletonMap[e.toLowerCase()];if(!n)throw new Error("Please call the 'start' interface first");if(!t)throw new Error("An argument for 'eventName' was not provided");this.sendAdapter(n,{action:"broadcast",name:t,args:i,__context:Object.assign({},this.client.getContext())})}}registry(e){let t=this.getFullContextName(this.client);return new Promise((i,n)=>{do{if(!t){i(!1);break}let n=this.generateId();const o={alias:t,action:"register",rid:n};let r=(e,n)=>{e?(s.error("register error",e.message),i(n)):i(t)};this.retCallbackMap[n]=Object.assign({callback:r},o),this.sendAdapter(e,o)}while(0)})}getNow(){return Date.now()}sendAdapter(e,t){do{if(!t)break;let i=this.getNow();if(t.timestamp?t.timestamp=[...t.timestamp].concat(i):t.timestamp=[].concat(i),!t.__context){let i=e.getContext();i&&(t=Object.assign({__context:i},t))}e.isInprocess()?(s.information("send to server in process"),global.__xdasIPCServer.emit("message",t,e)):e.send(t)}while(0)}parseContext(){let e=void 0;do{let t="";for(let e=0;e<process.argv.length;e++){let i=process.argv[e];if(0===i.indexOf("--xdas-plugin-name=",0)){t=i.substr("--xdas-plugin-name=".length);break}}if(!t)break;e={name:t}}while(0);return e}generateId(){return this.rid++}getFullContextName(e,t){let i="";do{if(t===a.serverContextName){i=t;break}if(void 0===t){i=`${e.getContext().productId}-${e.getContext().name}`.toLowerCase();break}i=`${e.getContext().productId}-${t}`.toLowerCase()}while(0);return i}internalCheckServerFunction(e,t){return new Promise((i,n)=>{do{if(!e){i(!1);break}if(!t){i(!1);break}let n=this.generateId();const o={action:"check_server_function_exist",method:t,rid:n};let r=(e,t)=>{i(!e&&t)};this.retCallbackMap[n]=Object.assign({callback:r},o),this.sendAdapter(e,o)}while(0)})}internalCallServerFunctionEx(e,t,...i){return new Promise((n,o)=>{do{if(!e){n([null,"client doesn't ready"]);break}if(!t){n([null,"funcName is not specifed"]);break}e===this.client&&this.emit("stat_call_function",this.client.getContext(),t);let o=this.generateId();if(i)for(let e=0;e<i.length;e++)i[e]=this.convertFunction2IdEx(i[e]);const r={rid:o,method:t,args:i};let a=(t,i)=>{t?(s.error("callServerFunction error",t,e.getContext()),n([null,t])):n([i,void 0])};this.retCallbackMap[o]=Object.assign({callback:a},r),this.sendAdapter(e,r)}while(0)})}internalIsRemoteClientExist(e,t){return new Promise((i,n)=>{do{if(!t){i([!1,"remote client alias is not specifed"]);break}if(e===this.client&&t.toLowerCase()===e.getContext().name.toLowerCase()){i([!0,"self is exist"]);break}let n=this.generateId();const o={dst:this.getFullContextName(e,t),action:"check_client_exist",rid:n};let r=(e,t)=>{i(e?[!1,e]:[t,"success"])};this.retCallbackMap[n]=Object.assign({callback:r},o),this.sendAdapter(e,o)}while(0)})}internalCheckRemoteFunction(e,t,i){return new Promise((n,o)=>{do{if(!e){n(!1);break}if(!t){n(!1);break}if(!i){n(!1);break}if(e===this.client&&t.toLowerCase()===e.getContext().name.toLowerCase()){n(!(!this.apis||!this.apis[i]));break}let o=this.generateId();const r={action:"check_client_function_exist",method:i,rid:o,src:this.getFullContextName(this.client),dst:this.getFullContextName(e,t)};let a=(e,t)=>{n(!e&&t)};this.retCallbackMap[o]=Object.assign({callback:a},r),this.sendAdapter(e,r)}while(0)})}internalCallRemoteClientFunction(e,t,i,...n){return new Promise((o,r)=>{do{if(!e){o([null,"client doesn't ready"]);break}if(!t){o([null,"remote client alias is not specifed"]);break}if(!i){o([null,"funcName is not specifed"]);break}let r=(e,t)=>{e?(s.information("callRemoteClientFunction",e.message),o([null,e])):o([t,void 0])};if(n)for(let e=0;e<n.length;e++)n[e]=this.convertFunction2IdEx(n[e]);let a=this.generateId();const l={src:this.getFullContextName(this.client),dst:this.getFullContextName(e,t),action:"call_remote_client_api",method:i,args:n,rid:a};this.retCallbackMap[a]=Object.assign({callback:r},l),this.sendAdapter(e,l)}while(0)})}internalAttachServerEvent(e,t,i){let n=e.getContext().productId.toLowerCase();this.eventCallbackMaps.hasOwnProperty(n)||(this.eventCallbackMaps[n]={}),this.eventCallbackMaps[n].hasOwnProperty(t)||(this.eventCallbackMaps[n][t]={}),a.isObjectEmpty(this.eventCallbackMaps[n][t])&&this.sendAdapter(e,{action:"attach_event",name:t});let o=this.generateId();return this.eventCallbackMaps[n][t][o]=i,o}internalDetachServerEvent(e,t,i){let n=e.getContext().productId.toLowerCase();do{if(!this.eventCallbackMaps.hasOwnProperty(n))break;if(!this.eventCallbackMaps[n].hasOwnProperty(t))break;delete this.eventCallbackMaps[n][t][i],a.isObjectEmpty(this.eventCallbackMaps[n][t])&&this.sendAdapter(e,{action:"detach_event",name:t})}while(0)}fireServerEvent(e,t,...i){let n=e.getContext().productId.toLowerCase();do{if(!this.eventCallbackMaps.hasOwnProperty(n))break;if(!this.eventCallbackMaps[n].hasOwnProperty(t))break;let e=this.eventCallbackMaps[n][t];for(let t in e){let n=e[t];n&&n.apply(null,...i)}}while(0)}callFunctionById(e,t,i,...n){let o=void 0,r=!1;do{const a=this.contextCallbackMap[t];if(!a){s.error("the context function has been freeer",t),o={s_rid:i,action:"call_client_by_id_callback",success:!1,error:"the context function has been freeer"};break}let l=void 0,d=void 0;try{l=a.apply(null,...n)}catch(e){d=e.message;break}if(void 0===i||null===i)break;if(o={s_rid:i,action:"call_client_by_id_callback",success:!1},void 0!==d){o.error=d;break}if(l&&l.then){l.then(t=>{o.data=this.convertFunction2IdEx(t),o.success=!0,this.sendAdapter(e,o)}).catch(t=>{o.error=t instanceof Error?t.message:t,this.sendAdapter(e,o)}),r=!0;break}o.success=!0,o.data=this.convertFunction2IdEx(l)}while(0);!r&&o&&this.sendAdapter(e,o)}convertFunction2IdEx(e){let t=e;if("function"==typeof e){let i=this.generateId();this.contextCallbackMap[i]=e,t={"__nodeipc_callback_id__{A9C9D760-14E8-42CB-A3CB-9C0A0DDFD732}":i}}else if(e&&"object"==typeof e){t=Array.isArray(e)?[...e]:Object.assign({},e);for(let e in t){let i=t[e];if("function"==typeof i){let n=this.generateId();this.contextCallbackMap[n]=i,t[e]={"__nodeipc_callback_id__{A9C9D760-14E8-42CB-A3CB-9C0A0DDFD732}":n}}else i&&"object"==typeof i&&(t[e]=this.convertFunction2IdEx(i))}}return t}decodeParameter(e,t){let i=e;do{if(!e)break;if(!t)break;if("object"!=typeof e)break;let n=e["__nodeipc_callback_id__{A9C9D760-14E8-42CB-A3CB-9C0A0DDFD732}"];if(n){i=((...e)=>{this.callRemoteContextById(t,n,...e)}),global.__xdasObjectLiftMonitor&&global.__xdasObjectLiftMonitor.setObjectFreer(i,{remoteId:t,callbackId:n},l);break}for(let i in e){let n=e[i];e[i]=this.decodeParameter(n,t)}}while(0);return i}callRegisterFunction(e,t){let i=void 0,n=!1;do{if(!t)break;let o=t.method;if(!o)break;let r=this.getNow();if(i={s_rid:t.s_rid,action:"remote_client_callback",success:!1,rid:t.rid,method:t.method,src:t.src,timestamp:t.timestamp?t.timestamp.concat(r):[].concat(r)},!this.apis||!this.apis[o]){i.error=`callRegisterFunction ${o} is undefined`;break}let a=void 0,s=this.decodeParameter(t.args,t.src);try{a=this.apis[o].apply(null,[t.src].concat(s))}catch(e){i.error=e.message;break}if(a&&a.then){a.then(t=>{i.data=this.convertFunction2IdEx(t),i.success=!0,this.sendAdapter(e,i)}).catch(t=>{i.error=t instanceof Error?t.message:t,this.sendAdapter(e,i)}),n=!0;break}i.success=!0,i.data=this.convertFunction2IdEx(a)}while(0);s.information("callRegisterFunction",i),!n&&i&&this.sendAdapter(e,i)}}),d=global.__xdasIPCClienInstance,t.client=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubtitleFunction=t.TimeTipFunction=t.VipBufferTipFunction=t.XmpPluginFunction=t.XmpSubtitleFunction=t.XmpPlayerFunction=t.XmpPlayType=t.VideoTipFunction=t.UIFunction=t.MainMenuFunction=t.SnapshotFunction=t.LoginSDKFunction=t.LoginFunction=t.DKFunction=t.ConfigFunction=void 0,function(e){e.saveConfig="SaveConfig",e.getConfigValue="GetConfigValue",e.setConfigValue="SetConfigValue",e.isConfigInitFinish="IsConfigInitFinish",e.getConfigModules="GetConfigModules",e.setXmpAndThunderConfigValue="SetXmpAndThunderConfigValue"}(t.ConfigFunction||(t.ConfigFunction={})),function(e){e.getTaskChannelInfo="GetTaskChannelInfo",e.getTaskBaseInfo="GetTaskBaseInfo",e.getTaskBaseInfos="GetTaskBaseInfos",e.getTaskAttribute="GetTaskAttribute",e.getTaskStatus="GetTaskStatus",e.findTask="FindTask",e.isTaskExist="IsTaskExist",e.isSupportPlay="IsSupportPlay",e.getTaskDownloadSpeed="GetTaskDownloadSpeed",e.enableDcdnWithVipCert="EnableDcdnWithVipCert",e.updateDcdnWithVipCert="UpdateDcdnWithVipCert",e.disableDcdnWithVipCert="DisableDcdnWithVipCert",e.getTpPeerId="GetTpPeerId",e.execSqlite="ExecSqlite",e.querySqlite="QuerySqlite",e.getCategoryViewTaskList="GetCategoryViewTaskList",e.getCategoryViewTaskListForSuspensionWnd="GetCategoryViewTaskListForSuspensionWnd",e.isLoadStorageTaskFinish="IsLoadStorageTaskFinish",e.isSingleBtTask="IsSingleBtTask",e.setTaskExtStat="SetTaskExtStat"}(t.DKFunction||(t.DKFunction={})),function(e){e.login="Login",e.logout="Logout",e.getUserID="GetUserID",e.getSessionID="GetSessionID",e.getSessionIDAw="GetSessionIDAw",e.getLoginOption="GetLoginOption",e.isLogined="IsLogined",e.getAllUserInfo="GetAllUserInfo",e.getAllUserInfoAw="GetAllUserInfoAw",e.getUserInfoEx="GetUserInfoEx",e.getUserInfo="GetUserInfo",e.getUserInfoAw="GetUserInfoAw",e.getUserHeader="GetUserHeader",e.showLoginDlg="ShowLoginDlg",e.createPersonalInfoWnd="CreatePersonalInfoWnd",e.createRetryLoginWnd="CreateRetryLoginWnd",e.switchAccount="SwitchAccount",e.updateHeader="UpdateHeader",e.pingThroughXLUserServer="PingThroughXLUserServer",e.retryLogIn="RetryLogIn",e.createWebWnd="CreateWebWnd",e.isAutoLoginAw="IsAutoLoginAw",e.channel="Channel",e.getVipInfo="GetVipInfo",e.getUserInfoByKeyAw="GetUserInfoByKeyAw"}(t.LoginFunction||(t.LoginFunction={})),function(e){e.getDeviceID="GetDeviceID",e.getInitData="GetInitData",e.saveData="SaveData"}(t.LoginSDKFunction||(t.LoginSDKFunction={})),function(e){e.subtitleIsSupportJpeg="XmpSubtitleIsSupportJpeg",e.queryMediaInfo="QueryMediaInfo",e.openVideoEdit="OpenVideoEdit",e.openGifEdit="OpenGifEdit",e.createSnapShotEx="CreateSnapShotEx",e.createSnapShot="CreateSnapShot",e.createHDPicture="CreateHDPicture",e.isHDPicCreating="IsHDPicCreating",e.openClearBlack="OpenClearBlack",e.closeClearBlack="CloseClearBlack",e.clearBlackWindow="ClearBlackWindow",e.getBlackCollectCount="GetBlackCollectCount",e.getCollectData="GetCollectData",e.getClearBlackRect="GetClearBlackRect",e.createPreViewSnapshot="CreatePreViewSnapshot",e.getPreViewSnapshot="GetPreViewSnapshot"}(t.SnapshotFunction||(t.SnapshotFunction={})),function(e){e.showSystemMenu="ShowSystemMenu"}(t.MainMenuFunction||(t.MainMenuFunction={})),function(e){e.createButton="CreateButton",e.updateButton="UpdateButton",e.createWebview="CreateWebview",e.setDefaultVipSpeedStatus="SetDefaultVipSpeedStatus",e.updateVipSpeedStatus="UpdateVipSpeedStatus",e.getWebviewInfo="GetWebviewInfo",e.createVipView="CreateVipview",e.showCurveChart="showCurveChart",e.applyBrowserView="ApplyBrowserView",e.getBrowserViewId="GetBrowserViewId",e.initBrowserViewConfig="initBrowserViewConfig",e.createVipMenu="CreateVipMenu",e.getMenuSlot="GetMenuSlot",e.openNewTab="OpenNewTab",e.videoPause="DoVideoPause",e.videoPlay="DoVideoPlay",e.videoPauseEx="DoVideoPauseEx",e.videoPlayEx="DoVideoPlayEx",e.setPlaySpeed="SetPlaySpeed",e.setProgressColor="SetProgressColor",e.getProgressColor="GetProgressColor",e.showBufferingEntry="ShowBufferingEntry",e.isBufferingEntryShow="IsBufferingEntryShow",e.showOpenVipEntry="ShowOpenVipEntry",e.registerFunctionCall="RegisterFunctionCall",e.executeFunctionCall="ExecuteFunctionCall",e.videoGetPlayState="VideoGetPlayState",e.setXmpFocus="SetXmpFocus",e.leaveFullScreen="LeaveFullScreen"}(t.UIFunction||(t.UIFunction={})),function(e){e.addItem="VideoTipLeftTopAddItem",e.addLinkItem="VideoTipLeftTopAddLinkItem",e.updateItemText="VideoTipLeftTopUpdateItemText",e.removeItem="VideoTipLeftTopRemoveItem",e.showTip="VideoTipLeftTopShowTip",e.closeTip="VideoTipLeftTopCloseTip",e.hideTip="HideTip"}(t.VideoTipFunction||(t.VideoTipFunction={})),function(e){e.unKnow="UnKnow",e.localFile="LocalFile",e.downloadAndPlay="DownloadAndPlay",e.yunBo="YunBo"}(t.XmpPlayType||(t.XmpPlayType={})),function(e){e.init="XmpPlayerInit",e.showAPlayerWindow="XmpShowAPlayerWindow",e.createXmpMedia="XmpPlayerCreateXmpMedia",e.open="XmpPlayerOpen",e.openFile="XmpPlayerOpenFile",e.addFile="XmpPlayerAddFile",e.openFolder="XmpPlayerOpenFolder",e.openBt="XmpPlayerOpenBt",e.openUrl="XmpPlayerOpenUrl",e.openMedia="XmpPlayerOpenMedia",e.close="XmpPlayerClose",e.stop="XmpPlayerStop",e.play="XmpPlayerPlay",e.pause="XmpPlayerPause",e.getVersion="XmpPlayerGetVersion",e.getState="XmpPlayerGetState",e.isPlaying="XmpPlayerIsPlaying",e.getDuration="XmpPlayerGetDuration",e.getPosition="XmpPlayerGetPosition",e.setPosition="XmpPlayerSetPosition",e.getVideoWidth="XmpPlayerGetVideoWidth",e.getVideoHeight="XmpPlayerGetVideoHeight",e.getVolume="XmpPlayerGetVolume",e.setVolume="XmpPlayerSetVolume",e.isSeeking="XmpPlayerIsSeeking",e.getBufferProgress="XmpPlayerGetBufferProgress",e.getConfig="XmpPlayerGetConfig",e.setConfig="XmpPlayerSetConfig",e.setCurrentMedia="XmpPlayerSetCurrentMedia",e.getCurrentMedia="XmpPlayerGetCurrentMedia",e.getMediaAttribute="XmpPlayerMediaAttribute",e.getCurrentMediaAttribute="XmpPlayerGetCurrentMediaAttribute",e.clearCurrentMedia="XmpPlayerClearCurrentMedia",e.openPreMedia="XmpPlayerOpenPreMedia",e.openNextMedia="XmpPlayerOpenNextMedia",e.isPlayOrderFirstMedia="XmpPlayerIsPlayOrderFirstMedia",e.isPlayOrderLastMedia="XmpPlayerIsPlayOrderLastMedia",e.isFirstMedia="XmpPlayerIsFirstMedia",e.isLastMedia="XmpPlayerIsLastMedia",e.isMediasLoadFinished="XmpPlayerIsMediasLoadFinished",e.getMediasInfo="XmpPlayerGetMediasInfo",e.removeMedia="XmpPlayerRemoveMedia",e.removeAllMedia="XmpPlayerRemoveAllMedia",e.setASpectRatioAtive="XmpPlayerSetASpectRatioAtive",e.setPlayForward="XmpPlayerSetPlayForward",e.postionChange="XmpPlayerPostionChange",e.getBufferRange="XmpPlayerGetBufferRange",e.fireKeyDown="XmpPlayerFireKeyDown",e.fireKeyUp="XmpPlayerFireKeyUp",e.setAudioTime="XmpPlayerSetAudioTime",e.setProportion="XmpPlayerSetProportion",e.setVlomue="XmpPlayerSetVlomue",e.getCurView="XmpPlayerGetCurView",e.recordStat="XmpPlayerRecordStat",e.getHostWnd="XmpPlayerGetHostWnd",e.startWindowZorderChecker="StartWindowZorderChecker",e.stopWindowZorderChecker="StopWindowZorderChecker",e.setZOrderCheckerWindowHandle="SetZOrderCheckerWindowHandle",e.removeZOrderCheckerWindowHandle="RemoveZOrderCheckerWindowHandle",e.getVideoDuration="GetVideoDuration",e.getDownloadState="GetDownloadState",e.getResConfig="GetResConfig",e.queryTaskState="QueryTaskState",e.shareMediaInfo="ShareMediaInfo",e.getThunderDirState="GetThunderDirState",e.setThunderDirState="SetThunderDirState",e.showSyncDig="ShowSyncDig",e.isXmpLite="IsXmpLite",e.handleVipPlaySpeed="handleVipPlaySpeed",e.getMediaInfo="GetMediaInfo",e.getCurrentMediaInfo="GetCurrentMediaInfo",e.setMediaAttribute="XmpPlayerSetMediaAttribute",e.updateDownloadEmbedRect="UpdateDownloadEmbedRect",e.updatePanEmbedRect="UpdatePanEmbedRect",e.createIndependentWindow="CreateIndependentWindow",e.thunderResize="ThunderResize",e.updateScrollShowOrHide="UpdateScrollShowOrHide",e.updateFloatWindow="IpdateFloatWindow",e.updateAplayerHwnd="UpdateAplayerHwnd",e.updatePlaySource="UpdatePlaySource",e.setXmpCurrentMode="SetXmpCurrentMode",e.getXmpCurrentMode="GetXmpCurrentMode",e.destroy="XmpDestroy",e.maximize="XmpMaximize",e.unmaximize="XmpUnmaximize",e.minmized="XmpMinmized",e.setPlaySpeed="SetPlaySpeed",e.getPlaySpeed="GetPlaySpeed",e.setWindowTopMode="SetWindowTopMode",e.calcelWindowTopMode="CalcelWindowTopMode",e.enterFullScreen="EnterFullScreen",e.leaveFullScreen="LeaveFullScreen",e.setFullcScreen="SetFullcScreen",e.getIsFullScreen="GetIsFullScreen",e.setPlayingTaskId="SetPlayingTaskId",e.setlayPingPanFileId="SetPlayingPanFileId",e.setSelectTaskId="SetSelectTaskId",e.setSelectPanel="SetSelectPanel",e.setSelectTab="SetSelectTab",e.setSelectPanFileId="SetSelectPanFileId",e.getPlayingTaskId="GetPlayingTaskId",e.getPlayingPanFileId="GetPlayingPanFileId",e.getSelectTaskId="GetSelectTaskId",e.getSelectPanel="GetSelectPanel",e.getSelectTab="GetSelectTab",e.getSelectPanFileId="GetSelectPanFileId",e.getXmpPlayType="GetXmpPlayType",e.getDownloadAndPlayTaskData="GetDownloadAndPlayTaskData",e.openDLNA="OpenDLNA",e.disConnectDLNA="DisConnectDLNA",e.addXmpVideoTipPos="AddXmpVideoTipPos",e.removeXmpVideoTipPos="RemoveXmpVideoTipPos",e.addXmpVideoTipPosMainRenderer="AddXmpVideoTipPosRenderer",e.removeXmpVideoTipPosMainRenderer="RemoveXmpVideoTipPosRenderer",e.switchSilent="XmpSwitchSilent",e.isSilent="XmpIsSilent",e.cancelDownloadCodecs="OnCancelDownloadCodecs",e.getCachedDownloadCodecInfo="OnGetCachedDownloadCodecInfo",e.onTaskStopped="OnTaskStopped",e.showOrHideXmpWindow="OnShowOrHideXmpWindow",e.getPlayingSoure="OnGetPlayingSoure",e.userLogout="OnUserLogout",e.isCurrentBuffingIsByDrag="IsCurrentBuffingIsByDrag",e.thunderQuit="ThunderQuit",e.getLastPlayError="GetLastPlayError",e.showAplayerAndFloatWindow="ShowAplayerAndFloatWindow",e.hideAplayerAndFloatWindow="HideAplayerAndFloatWindow",e.hideEmbedAplayerAndFloatWindow="HideEmbedAplayerAndFloatWindow",e.isPlayMusic="IsPlayMusic",e.getMediaById="GetMediaById",e.setPlayEndInfo="SetPlayEndInfo"}(t.XmpPlayerFunction||(t.XmpPlayerFunction={})),function(e){e.isSubtitleShow="XmpSubtitleIsSubtitleShow",e.isSubtitle2Show="XmpSubtitleIsSubtitle2Show",e.showSubtitle="XmpSubtitleShowSubtitle",e.showSubtitle2="XmpSubtitleShowSubtitle2",e.getCurrentSubtitle="XmpSubtitleGetCurrentSubtitle",e.getCurrentSubtitle2="XmpSubtitleGetCurrentSubtitle2",e.getSubtitleList="XmpSubtitleGetSubtitleList",e.loadSubtitleFile="XmpSubtitleLoadSubtitleFile",e.setCurrentSubtitle="XmpSubtitleSetCurrentSubtitle",e.setSubtitleLanguageIndex="XmpSubtitleSetSubtitleLanguageIndex",e.setSubtitlePosition="XmpSubtitleSetSubtitlePosition",e.getSubtitlePosition="XmpSubtitleGetSubtitlePosition",e.setSubtitleFontStyle="XmpSubtitleSetSubtitleFontStyle",e.getSubtitleSize="XmpSubtitleGetSubtitleSize",e.getSubtitleColor="XmpSubtitleGetSubtitleColor",e.getSubtitleFont="XmpSubtitleGetSubtitleFont",e.setSubtitleTimming="XmpSubtitleSetSubtitleTimming",e.getSubtitleTimming="XmpSubtitleGetSubtitleTimming",e.setSubtitle3DMode="XmpSubtitleSetSubtitle3DMode",e.setUseHardware="XmpSubtitleSetUseHardware",e.reportSubTitle="ReportSubTitle",e.uploadSubTitle="UploadubTitle",e.onSubtitleInit="XmpSubtitleInit",e.onSubtitleLoadSuc="XmpSubtitleLoadSuc",e.createSuppress="CreateSuppress",e.getSuppressState="GetSuppressState",e.getSuppressPlayUrl="GetSuppressPlayUrl",e.getSuppressProgress="GetSuppressProgress",e.getSuppressNeedTime="GetSuppressNeedTime",e.showSubtitleSuppressDialog="ShowSubtitleSuppressDialog",e.continueSuppress="ContinueSuppress",e.getFullState="GetFullState",e.isSettingDefaultSecondSubtitle="IsSettingDefaultSecondSubtitle",e.isSecondSubtitle="IsSecondSubtitle"}(t.XmpSubtitleFunction||(t.XmpSubtitleFunction={})),function(e){e.getTaskInfo="GetTaskInfo",e.shellOpen="ShellOpen",e.openFolderWithSelectFile="OpenFolderWithSelectFile",e.getFileMd5="GetFileMd5",e.getPeerID="GetPeerID",e.getDeviceID="GetDeviceID",e.getThunderVersion="GetThunderVersion",e.getXmpVersion="GetXmpVersion",e.trackEvent="TrackEvent",e.getCurInternetState="GetCurInternetState",e.getCurPlatform="GetCurPlatform",e.getXmpShowMode="GetXmpShowMode",e.isModuleEnable="IsModuleEnable",e.updateTabSelectState="UpdateTabSelectState",e.getMouseShow="getMouseShow",e.updateFullFill="UpdateFullFill",e.getWindowTopMode="GetWindowTopMode",e.isVideoEditMode="IsVideoEditMode",e.showCtrlView="ShowCtrlView",e.showTopView="ShowTopView",e.showMoreAbout="ShowMoreAbout",e.setMenuPopUp="SetMenuPopUp",e.setWindowPopUp="SetWindowPopUp",e.isListExpand="IsListExpand",e.isMenuPopUp="IsMenuPopUp",e.isWindowPopUp="IsWindowPopUp",e.isMouseInFloat="IsMouseInFloat",e.switchtoNormalMode="SwitchtoNormalMode",e.switchToTransparentMode="SwitchToTransparentMode",e.dropOpenFiles="DropOpenFiles",e.dropOpenUrl="DropOpenUrl",e.getShowCondition="GetShowCondition",e.utf8StringEncodeToBinary="Utf8StringEncodeToBinary",e.utf8StringDecodeFromBinary="Utf8StringDecodeFromBinary",e.getErrorCodeConfigMessage="GetErrorCodeConfigMessage",e.quitProcess="QuitProcess",e.associate="Associate",e.checkXmpUpdate="CheckXmpUpdate",e.changeVideoRatio="ChangeVideoRatio",e.getVideoScaleRate="GetVideoScaleRate",e.getHoverPos="GetHoverPos",e.setHoverPos="SetHoverPos",e.getCurrentDevice="GetCurrentDevice",e.activeDevice="ActiveDevice",e.setCurrentDevice="SetCurrentDevice",e.getDeviceList="GetDeviceList",e.searchDevice="SearchDevice",e.isDeviceSupport="IsDeviceSupport",e.getInitUserLoginParam="GetInitUserLoginParam",e.handleMouseTimeOut="HandleMouseTimeOut",e.getOpenFrom="GetOpenFrom",e.setHideAndPauseWindow="SetHideAndPauseWindow",e.setHideWindowNotPause="SetHideWindowNotPause",e.setFullWindowMouseEnter="SetFullWindowMouseHover",e.setDragMove="SetDragMove",e.isEmbedMode="IsEmbedMode",e.getBackUpValue="getBackUpValue"}(t.XmpPluginFunction||(t.XmpPluginFunction={})),function(e){e.getVideoStuckVipData="GetVideoStuckVipData",e.openPayVipUrl="OpenPayVipUrl",e.actionPreOpen="ActionPreOpen"}(t.VipBufferTipFunction||(t.VipBufferTipFunction={})),function(e){e.showTimeTips="ShowTimeTips",e.destroyTimeTips="DestroyTimeTips"}(t.TimeTipFunction||(t.TimeTipFunction={})),function(e){e.loadSubtitle="LoadSubtitle",e.onlineSubtitleMatch="OnlineSubtitleMatch",e.showOrHideSubtitle="ShowOrHideSubtitle",e.isEnableHideSubtitle="IsEnableHideSubtitle",e.isSubtitleHided="IsSubtitleHided",e.loadEmbedSubtitle="LoadEmbedSubtitle",e.loadOnlineSubtitle="LoadOnlineSubtitle",e.loadLocalSubtitle="LoadLocalSubtitle",e.getOnlineSubtitleList="GetOnlineSubtitleList",e.getEmbedSubtitleList="GetEmbedSubtitleList",e.getLocalSubtitleList="GetLocalSubtitleList",e.getManualSubtitleList="GetManualSubtitleList",e.getCurrentTitle="GetCurrentTitle",e.getCurrentTitle2="GetCurrentTitle2",e.manualLoadSubtitle="ManualLoadSubtitle"}(t.SubtitleFunction||(t.SubtitleFunction={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThunderDir=t.IVsrState=t.Subtitle3DMode=t.SubtitleSuppressType=t.TaskType=t.DcdnStatusCode=t.CreateError=t.ErrorFrom=t.XmpMediaType=t.OpenMode=t.XmpMediaState=t.XmpMediaAttr=t.XmpMediaCategory=t.XmpMediaDatabaseTable=void 0,function(e){e[e.UnkownList=0]="UnkownList",e[e.Playlist=1]="Playlist",e[e.BtFile=2]="BtFile",e[e.ThPlaylist=3]="ThPlaylist",e[e.ThBtFile=4]="ThBtFile",e[e.LoadPlaylist=5]="LoadPlaylist",e[e.LoadThPlaylist=6]="LoadThPlaylist"}(t.XmpMediaDatabaseTable||(t.XmpMediaDatabaseTable={})),function(e){e[e.Unkown=0]="Unkown",e[e.Download=1]="Download",e[e.Play=2]="Play",e[e.Collect=3]="Collect"}(t.XmpMediaCategory||(t.XmpMediaCategory={})),function(e){e[e.NumberStart=0]="NumberStart",e[e.MediaId=1]="MediaId",e[e.OwnerMediaId=2]="OwnerMediaId",e[e.CreateTime=3]="CreateTime",e[e.PlayTime=4]="PlayTime",e[e.LastPlayTime=5]="LastPlayTime",e[e.Duration=6]="Duration",e[e.Height=7]="Height",e[e.Width=8]="Width",e[e.PreState=9]="PreState",e[e.State=10]="State",e[e.Position=11]="Position",e[e.LastStartPos=12]="LastStartPos",e[e.PlaySpeed=13]="PlaySpeed",e[e.SubtitleShow=14]="SubtitleShow",e[e.SubtitleLanguage=15]="SubtitleLanguage",e[e.SubtitleType=16]="SubtitleType",e[e.SubtitlePosition=17]="SubtitlePosition",e[e.SubtitleTimming=18]="SubtitleTimming",e[e.Subtitle3D=19]="Subtitle3D",e[e.Subtitle2Show=20]="Subtitle2Show",e[e.Subtitle2Language=21]="Subtitle2Language",e[e.Subtitle2Type=22]="Subtitle2Type",e[e.Subtitle2Position=23]="Subtitle2Position",e[e.Subtitle2Timming=24]="Subtitle2Timming",e[e.Subtitle23D=25]="Subtitle23D",e[e.FileSize=26]="FileSize",e[e.Category=27]="Category",e[e.Type=28]="Type",e[e.MediaIndex=29]="MediaIndex",e[e.TaskId=30]="TaskId",e[e.TaskStop=31]="TaskStop",e[e.AudioTrack=32]="AudioTrack",e[e.ThunderTaskId=33]="ThunderTaskId",e[e.ThunderTaskSubId=34]="ThunderTaskSubId",e[e.PlayPercent=35]="PlayPercent",e[e.OpenFrom=36]="OpenFrom",e[e.DLNA=37]="DLNA",e[e.transcode=38]="transcode",e[e.NumberEnd=39]="NumberEnd",e[e.StringStart=4096]="StringStart",e[e.Name=4097]="Name",e[e.Url=4098]="Url",e[e.PlayUrl=4099]="PlayUrl",e[e.Cid=4100]="Cid",e[e.Gcid=4101]="Gcid",e[e.Subtitle=4102]="Subtitle",e[e.Subtitle2=4103]="Subtitle2",e[e.Ext=4104]="Ext",e[e.Played=4105]="Played",e[e.AudioChannel=4106]="AudioChannel",e[e.OutputMode=4107]="OutputMode",e[e.Brightness=4108]="Brightness",e[e.ContrastRatio=4109]="ContrastRatio",e[e.Saturation=4110]="Saturation",e[e.SubtitleSize=4111]="SubtitleSize",e[e.SubtitleColor=4112]="SubtitleColor",e[e.SubtitleFont=4113]="SubtitleFont",e[e.Subtitle2Size=4114]="Subtitle2Size",e[e.Subtitle2Color=4115]="Subtitle2Color",e[e.Subtitle2Font=4116]="Subtitle2Font",e[e.Proportion=4117]="Proportion",e[e.AudioTime=4118]="AudioTime",e[e.Rorate=4119]="Rorate",e[e.FlipH=4120]="FlipH",e[e.FlipV=4121]="FlipV",e[e.LocalAudioTrack=4122]="LocalAudioTrack",e[e.ImgSrc=4123]="ImgSrc",e[e.PanFileId=4124]="PanFileId",e[e.RationText=4125]="RationText",e[e.RationTextEx=4126]="RationTextEx",e[e.vipLevel=4127]="vipLevel",e[e.PlayFrom=4128]="PlayFrom",e[e.Resolution=4129]="Resolution",e[e.TransGcid=4130]="TransGcid",e[e.PlayType=4131]="PlayType",e[e.ShowBackIcon=4132]="ShowBackIcon",e[e.ResolutionMedias=4133]="ResolutionMedias",e[e.StringEnd=4134]="StringEnd"}(t.XmpMediaAttr||(t.XmpMediaAttr={})),function(e){e[e.Invalid=-100]="Invalid",e[e.PreOpen=-10]="PreOpen",e[e.QueryExt=-9]="QueryExt",e[e.DownloadTorrent=-3]="DownloadTorrent",e[e.ParserTorrent=-2]="ParserTorrent",e[e.GetPlayUrl=-1]="GetPlayUrl",e[e.Ready=0]="Ready",e[e.Opening=1]="Opening",e[e.Pausing=2]="Pausing",e[e.Paused=3]="Paused",e[e.Playing=4]="Playing",e[e.Play=5]="Play",e[e.Closeing=6]="Closeing",e[e.Completed=7]="Completed",e[e.Stopped=8]="Stopped",e[e.Error=9]="Error"}(t.XmpMediaState||(t.XmpMediaState={})),function(e){e[e.XMPDrag=0]="XMPDrag"}(t.OpenMode||(t.OpenMode={})),function(e){e[e.Unkown=0]="Unkown",e[e.Dc=1]="Dc",e[e.Bt=2]="Bt",e[e.BtFile=3]="BtFile",e[e.Gvod=4]="Gvod",e[e.Dir=5]="Dir",e[e.LocalUrl=6]="LocalUrl"}(t.XmpMediaType||(t.XmpMediaType={})),function(e){e.XMP="xmp",e.APlayer="aplayer",e.DownloadKernel="download_kernel",e.Thunder="thunder",e.Other="other",e.Exit="exit",e.Crash="crash",e.Restart="restart",e.CancelDownloadCodecs="cancel_download_codecs"}(t.ErrorFrom||(t.ErrorFrom={})),function(e){e[e.Unkown=0]="Unkown",e[e.MediaFileNotFound=1]="MediaFileNotFound",e[e.FilePathNotExist=2]="FilePathNotExist"}(t.CreateError||(t.CreateError={})),function(e){e[e.Unkown=-1]="Unkown",e[e.Success=0]="Success",e[e.QueryFailed=1]="QueryFailed",e[e.ServerError=2]="ServerError",e[e.ResourceNotFound=3]="ResourceNotFound",e[e.AuthorizingFailed=4]="AuthorizingFailed",e[e.ForbidByCopyright=5]="ForbidByCopyright",e[e.ForbidByPorNoGraphy=6]="ForbidByPorNoGraphy",e[e.ForbidByReactionary=7]="ForbidByReactionary",e[e.ForbidByOtherFilter=8]="ForbidByOtherFilter"}(t.DcdnStatusCode||(t.DcdnStatusCode={})),function(e){e[e.Unkown=0]="Unkown",e[e.P2sp=1]="P2sp",e[e.Bt=2]="Bt",e[e.Emule=3]="Emule",e[e.Group=4]="Group",e[e.Magnet=5]="Magnet"}(t.TaskType||(t.TaskType={})),function(e){e[e.Unkown=1]="Unkown",e[e.QuickSuppress=2]="QuickSuppress",e[e.FineSuppress=3]="FineSuppress"}(t.SubtitleSuppressType||(t.SubtitleSuppressType={})),function(e){e[e.normal=0]="normal",e[e.LR3D=1]="LR3D",e[e.UD3D=2]="UD3D"}(t.Subtitle3DMode||(t.Subtitle3DMode={})),function(e){e[e.Unkown=0]="Unkown",e[e.Vsring=1]="Vsring",e[e.VsrReady=2]="VsrReady",e[e.VsrSucc=3]="VsrSucc",e[e.VsrFailed=4]="VsrFailed",e[e.VsrNotExist=5]="VsrNotExist",e[e.VsrFullSize=6]="VsrFullSize"}(t.IVsrState||(t.IVsrState={})),function(e){e[e.MediaId=9999999999]="MediaId"}(t.ThunderDir||(t.ThunderDir={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModeChangeEvent=t.ClientProcessEvent=t.XmpEvent=void 0,function(e){e.onWindowMessage="OnWindowMessage",e.onStateChanged="OnStateChanged",e.onCreateMediaError="OnCreateMediaError",e.onOpenSucceeded="OnOpenSucceeded",e.onVideoSizeChanged="OnVideoSizeChanged",e.onAPlayerCreated="OnAPlayerCreated",e.onAllStoped="OnAllStoped",e.onSeekCompleted="OnSeekCompleted",e.onBuffer="OnBuffer",e.onDownloadCodec="OnDownloadCodec",e.onDownloadCodecProgress="OnDownloadCodecProgress",e.onDropFiles="OnDropFiles",e.onEvent="OnEvent",e.onGetPlayUrl="OnGetPlayUrl",e.onOpenFailed="OnOpenFailed",e.onPlayFailed="OnPlayFailed",e.onClearError="OnClearError",e.onError="OnError",e.onPlaying="OnPlaying",e.onPreOpen="OnPreOpen",e.onPaused="OnPaused",e.onPlayCompleted="OnPlayCompleted",e.onPreStop="OnPreStop",e.onStop="OnStop",e.onForceLoadingState="OnForceLoadingState",e.onVipStruckPlayState="OnVipStruckPlayState",e.onShowFloatWindow="OnShowFloatWindow",e.onTimeDesChange="OnTimeDesChange",e.onPositionChanged="OnPositionChanged",e.onSnapShotCreated="OnSnapShotCreated",e.onXmpPlayerEvent="OnXmpPlayerEvent",e.onXmpAplayerCrash="OnXmpAplayerCrash",e.onUpdateMediaCid="OnUpdateMediaCid",e.onUpdateMediaGcid="OnUpdateMediaGcid",e.onSpeedChange="OnSpeedChange",e.onFullScreenStateChange="OnFullScreenStateChange",e.onSetConfig="OnSetConfig",e.onVolumeChange="OnVolumeChange",e.onPlayStateChange="OnPlayStateChange",e.onCurViewChanged="OnCurViewChanged",e.onUserLogin="OnUserLogin",e.onDwmCompositionChanged="OnDwmCompositionChanged",e.onDpiChanged="OnDpiChanged",e.onGPUProcessCrashed="OnGPUProcessCrashed",e.onSetCurrentDevice="OnSetCurrentDevice",e.onXmpPlayerRemoveMedias="OnXmpPlayerRemoveMedias",e.onOpenMediaNotExist="OnOpenMediaNotExist",e.onSwitchModeError="OnSwitchModeError",e.onDlnaEvent="OnDlnaEvent",e.onSubtitleInit="OnSubtitleInit",e.onSubtitleUnInit="onSubtitleUnInit",e.onEmbedSubInitFinish="OnEmbedSubInitFinish",e.onEntertCurrentDevice="OnEntertCurrentDevice",e.onWindowZOrderChanged="OnWindowZOrderChanged",e.onAplayerSeekFrameChanged="OnAplayerSeekFrameChanged",e.onModeBarChange="OnModeBarChange",e.onThunderTaskRemove="OnThunderTaskRemove",e.onXmpClose="OnXmpClose",e.onXmpStartFailed="OnXmpStartFailed",e.onVipViewInitFinish="OnVipViewInitFinish",e.onModeEvent="OnModeEvent",e.onMaxmized="OnMaxmized",e.onUnMaxmized="OnUnMaxmized",e.onSetWindowTopMost="OnWindowTopMost",e.onCancelWindowTopMost="OnCancelWindowTopMost",e.onOpenOrCloseSettingCenter="OnOpenOrCloseSettingCenter",e.onUpdateBufferingUI="OnUpdateBufferingUI",e.onOpenSucceededCreateTask="OnOpenSucceededCreateTask"}(t.XmpEvent||(t.XmpEvent={})),function(e){e.onMainWindowSize="OnMainWindowSize",e.onTabSelectChange="OnTabSelectChange",e.onThunderQuit="OnThunderQuit"}(t.ClientProcessEvent||(t.ClientProcessEvent={})),function(e){e.onXmpModeChanging="OnXmpModeChanging",e.onXmpModeChanged="OnXmpModeChanged",e.onXmpEnterFullScreen="OnXmpEnterFullScreen",e.onXmpLeaveFullScreen="OnXmpLeaveFullScreen"}(t.ModeChangeEvent||(t.ModeChangeEvent={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(22),o=i(1);t.getDefaultPrex=function(){return o.basename(process.execPath,".exe")},t.getSockPath=function(e){const t=n.tmpdir();let i=e;e||(i=o.basename(process.execPath,".exe"));let r=o.join(t,`${i}-xunlei-node-net-ipc-{FD196984-2591-4588-AA6F-5C8AC1266290}.sock`);return"win32"===process.platform&&(r="\\\\.\\pipe\\"+(r=(r=r.replace(/^\//,"")).replace(/\//g,"-"))),r},t.serverContextName="xunlei-node-net-ipc-server-{46105371-DE78-4442-B59F-FDA1D6D7D430}",t.mainProcessContext="main-process",t.mainRendererContext="main-renderer",t.isObjectEmpty=function(e){let t=!0;do{if(!e)break;if(0===Object.keys(e).length)break;t=!1}while(0);return t}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.XmpMediaManagerNS=t.xmpPlayer=t.XmpMediaManager=void 0;const o=i(89),r=i(4),a=i(92),s=i(24),l=i(53),d=i(16),u=i(0),c=i(15),h=i(17),p=i(11),f=i(5),m=u.default.getLogger("MediaManager");class g{constructor(){this.inited=!1,this.eventContainer=null,this.medias=new Map,this.playListMedias=new Map,this.xmpPlayer=new a.XmpPlayerImpl,this.mediasLoadFinished=!1,this.eventContainer=new s.default}init(){return n(this,void 0,void 0,function*(){this.inited||(this.inited=!0,this.xmpPlayer.attachListener(f.XmpEvent.onStop,e=>{if(!c.ConfigNS.getValue(h.ConfigDefineNS.rememberProgress.section,h.ConfigDefineNS.rememberProgress.key,h.ConfigDefineNS.rememberProgress.value)){let t=this.medias.get(e);t&&(t.setXmpMediaAttribute(r.XmpMediaAttr.Position,0),this.eventContainer.fireEvent(l.NodeEventMesssageNS.eventUpdatePlayListProgress,[t]))}}))})}open(e,t,i){return n(this,void 0,void 0,function*(){let n=-1,o=null;do{if(!e){if(!(o=this.xmpPlayer.getCurrentMedia()))break;e=o.getXmpMediaAttribute(r.XmpMediaAttr.MediaId)}}while(0);if(t||(t=!1),e){yield this.xmpPlayer.createAPlayer();do{if(!o)break;if(!o.getXmpMediaAttribute(r.XmpMediaAttr.PanFileId))break;let e=null;e&&e.length>0?yield this.xmpPlayer.setConfig(p.APlayerConfigId.CONFIGID_NETWORK_BUFFERLEAVE,"30"):yield this.xmpPlayer.setConfig(p.APlayerConfigId.CONFIGID_NETWORK_BUFFERLEAVE,"100")}while(0);n=yield this.openMedia(e,t,i)}return n})}close(e,t=!0){return n(this,void 0,void 0,function*(){let i=-1;return this.isCurrentMedia(e)&&(i=yield this.xmpPlayer.close(0,r.ErrorFrom.XMP,t)),i})}play(e){return n(this,void 0,void 0,function*(){let t=-1;return this.isCurrentMedia(e)&&(t=yield this.xmpPlayer.play()),t})}pause(e){return n(this,void 0,void 0,function*(){let t=-1;return this.isCurrentMedia(e)&&(t=yield this.xmpPlayer.pause()),t})}getXmpPlayer(){return this.xmpPlayer}clearCurrentMedia(){this.xmpPlayer.setCurrentMedia(null)}setCurrentMedia(e){let t=this.medias.get(e);t&&this.xmpPlayer.setCurrentMedia(t)}getCurrentMedia(){let e=0,t=this.xmpPlayer.getCurrentMedia();return t&&(e=t.getXmpMediaAttribute(r.XmpMediaAttr.MediaId)),e}createXmpMedia(e,t){return n(this,void 0,void 0,function*(){let i=0,n=null,a=e.playUrl,s=e.fileName,l=e.taskId,u=e.openFrom,c=e.panFileId,h=e.gcid,p=e.dlnaPlay,f=e.playType,g=e.playFrom,S=void 0===e.showBackIcon||e.showBackIcon,y=void 0===e.fileIndex?-1:e.fileIndex,C=void 0===e.medias?[]:e.medias;do{if(!a)break;a=a.trim();try{a=decodeURI(a)}catch(e){m.warning(e)}if(!a)break;if(d.XmpUtilityNS.isLocalUrl(a))n=new o.XmpMedia(r.XmpMediaType.LocalUrl,a,0,s),s&&l&&n.setXmpMediaAttribute(r.XmpMediaAttr.TaskId,l),this.addMedia(n),i=n.getXmpMediaAttribute(r.XmpMediaAttr.MediaId);else if(d.XmpUtilityNS.isLocalPath(a)||d.XmpUtilityNS.isLanPath(a)||d.XmpUtilityNS.isNetworkPath(a)){if(d.XmpUtilityNS.isBlackExtFile(a))break;n=new o.XmpMedia(r.XmpMediaType.Dc,a,0,s),this.addMedia(n),i=n.getXmpMediaAttribute(r.XmpMediaAttr.MediaId)}p?n.setXmpMediaAttribute(r.XmpMediaAttr.DLNA,p):n.setXmpMediaAttribute(r.XmpMediaAttr.DLNA,0)}while(0);if(n&&i){n.setXmpMediaAttribute(r.XmpMediaAttr.PanFileId,c),n.setXmpMediaAttribute(r.XmpMediaAttr.OpenFrom,u);let e=1;"p2s"===f?e=3:"server_xlpan"===f?e=5:"local_xlpan"===f&&(e=6),n.setXmpMediaAttribute(r.XmpMediaAttr.PlayType,e),n.setXmpMediaAttribute(r.XmpMediaAttr.Gcid,h),n.setXmpMediaAttribute(r.XmpMediaAttr.PlayFrom,g),n.setXmpMediaAttribute(r.XmpMediaAttr.ShowBackIcon,S),n.setXmpMediaAttribute(r.XmpMediaAttr.ThunderTaskSubId,y),n.setXmpMediaAttribute(r.XmpMediaAttr.ResolutionMedias,C),yield this.open(i,t)}return i})}resetMediasPosition(){let e=[];for(let t of this.medias){let i=t[1],n=i.getXmpMediaAttribute(r.XmpMediaAttr.MediaId);this.isCurrentMedia(n)&&this.xmpPlayer.getState()!==r.XmpMediaState.Ready&&this.xmpPlayer.getState()!==r.XmpMediaState.Invalid||(i.setXmpMediaAttribute(r.XmpMediaAttr.Position,0),e.push(i))}this.eventContainer.fireEvent(l.NodeEventMesssageNS.eventUpdatePlayListProgress,e)}addMedia(e,t=!0){do{if(!e)break;let t=e.getXmpMediaAttribute(r.XmpMediaAttr.MediaId);if(!t)break;if(this.playListMedias.get(t))break;this.medias.set(t,e)}while(0)}getMedia(e){return this.medias.get(e)}attachListener(e,t){do{if(e===l.NodeEventMesssageNS.eventXmpPlayerMediasDataBaseLoadEnd){if(this.mediasLoadFinished){let e=[];for(let t of this.playListMedias)e.push(t[1].getXmpMediaInfo());t(this.mediasLoadFinished,e);break}this.attachOnceListener(e,t);break}this.eventContainer.attachListener(e,t)}while(0)}attachOnceListener(e,t){this.eventContainer.attachOnceListener(e,t)}detachListener(e,t){this.eventContainer.detachListener(e,t)}isCurrentMedia(e){let t=!1;do{let i=this.xmpPlayer.getCurrentMedia();if(!i)break;let n=i.getXmpMediaAttribute(r.XmpMediaAttr.MediaId);if(e&&e!==n)break;t=!0}while(0);return t}openMedia(e,t=!1,i=!1){return n(this,void 0,void 0,function*(){let n=0;do{if(!this.getMedia(e))break;let o=this.xmpPlayer.getState();if(o===r.XmpMediaState.Invalid){let t=this.medias.get(e);t&&(this.xmpPlayer.setCurrentMedia(t),n=yield this.xmpPlayer.open(!1))}else{let a=this.xmpPlayer.getCurrentMedia();if(a){let s=a.getXmpMediaAttribute(r.XmpMediaAttr.MediaId);this.eventContainer.fireEvent(l.NodeEventMesssageNS.eventUpdatePlayListProgress,[a]);let d=this.medias.get(e);e===s?t&&d?(n=yield this.xmpPlayer.stop(0,r.ErrorFrom.Restart),n=yield this.xmpPlayer.open(i)):o===r.XmpMediaState.Paused||o===r.XmpMediaState.Pausing?n=yield this.xmpPlayer.play():o===r.XmpMediaState.Play||r.XmpMediaState.Playing:(n=yield this.xmpPlayer.stop(),d&&(this.xmpPlayer.setCurrentMedia(d),n=yield this.xmpPlayer.open(!1)))}else{let t=this.medias.get(e);t&&(this.xmpPlayer.setCurrentMedia(t),n=yield this.xmpPlayer.open(!1))}}}while(0);return n})}}t.XmpMediaManager=g;const S=new g;t.xmpPlayer=S.getXmpPlayer(),function(e){e.getXmpMediaManager=function(){return S}}(t.XmpMediaManagerNS||(t.XmpMediaManagerNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){e.done?o(e.value):new i(function(t){t(e.value)}).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=i(12),r=i(100),a=i(6),s=i(35);function l(e){s.information("on object freeer"),global.__xdasIPCServerInstance.notifyFreer(e.client,e.callbackId)}let d=void 0;global.__xdasIPCServerInstance||(global.__xdasIPCServerInstance=new class extends o.EventEmitter{constructor(){super(),this.rid=0,this.apis={},this.eventMap={},this.clientAliasMap={},this.retCallbackMap={},this.contextCallbackMap={},this.singleton=!1}registerFunctions(e){do{if(!e)break;let t=void 0;for(let i in e)if(this.apis.hasOwnProperty(i)){t=i;break}if(t)throw new Error(`try to coverd function ${t}`);this.apis=Object.assign({},this.apis,e)}while(0)}start(e,t){if(this.singleton)throw new Error("try to start server duplicate");this.singleton=!0,this.server=new r.Server,global.__xdasIPCServer=this.server,this.server.listen(void 0,t),e&&this.registerFunctions(e),this.server.on("connect",e=>{this.emit("connect",e)}),this.server.on("message",(e,t)=>{do{if("attach_event"===e.action){this.attachEvent(e.name,t);break}if("detach_event"===e.action){this.detachEvent(e.name,t);break}if("broadcast"===e.action){if(e.__context&&e.__context.name===a.serverContextName)throw new Error("client context must difference from server");this.forwardEvent(e.name,e.__context,e.timestamp,...e.args);break}if("call_remote_client_api"===e.action){this.callClientFunction(e,t);break}if("call_remote_context_by_id"===e.action){if(e.dst&&this.clientAliasMap.hasOwnProperty(e.dst)){let t=this.clientAliasMap[e.dst];t&&this.callClientFunctionById(t,e.rid,...e.args)}break}if("call_client_by_id_callback"===e.action){this.fireRetCallback(e,t);break}if("check_client_function_callback"===e.action){this.fireRetCallback(e,t);break}if("remote_client_callback"===e.action){this.reply2Client(e,t);break}if("check_client_function_exist"===e.action){this.internalCheckClientFunction(e.dst,e.method).then(i=>{let n=this.getNow();this.sendAdapter(t,{success:!0,rid:e.rid,method:e.method,data:i,timestamp:e.timestamp?e.timestamp.concat(n):[].concat(n)})});break}let i=this.getNow(),n={success:!1,rid:e.rid,method:e.method,timestamp:e.timestamp?e.timestamp.concat(i):[].concat(i)},o=e.method;do{if("register"===e.action){this.registerAlias(e,t,n),this.sendAdapter(t,n);break}if("client_context_freer"===e.action){if(e.dst&&this.clientAliasMap.hasOwnProperty(e.dst)){let t=this.clientAliasMap[e.dst];this.notifyFreer(t,e.rid)}break}if("check_server_function_exist"===e.action){n.success=!0,n.data=!(!this.apis||!this.apis[o]),this.sendAdapter(t,n);break}if("check_client_exist"===e.action){n.success=!0,n.data=!1,e.dst&&this.clientAliasMap.hasOwnProperty(e.dst)&&(n.data=!0),this.sendAdapter(t,n);break}if(!o)break;if(!this.apis||!this.apis[o]){n.error=`${e.__context} try to call method '${o}' which is undefined`,this.sendAdapter(t,n);break}let i=void 0,r=this.decodeParameter(e.args,t);try{i=this.apis[o].apply(null,[t,e.__context].concat(r))}catch(e){n.error=e.message,this.sendAdapter(t,n);break}if(i&&i.then){i.then(e=>{n.data=e,n.success=!0,this.sendAdapter(t,n)}).catch(e=>{n.error=e instanceof Error?e.message:e,this.sendAdapter(t,n)});break}n.success=!0,n.data=i,this.sendAdapter(t,n)}while(0)}while(0)}),this.server.on("end",e=>{this.emit("end",e);for(let t in this.clientAliasMap)this.clientAliasMap[t]===e&&delete this.clientAliasMap[t];for(let t in this.eventMap)this.detachEvent(t,e);for(let t in this.retCallbackMap){let i=this.retCallbackMap[t];if(i.dstRemote===e){let e={rid:i.rid,method:i.method,error:"client has been ended by the other party",action:"remote_client_callback",success:!1};s.information("client has been ended by other party, but still has return callback",e),this.sendAdapter(i.remote,e),delete this.retCallbackMap[t]}}})}fireClientEvent(e,...t){this.forwardEvent(e,{name:a.serverContextName},void 0,...t)}callClientFunctionById(e,t,...i){this.sendAdapter(e,{action:"call_client_by_id",rid:t,args:i})}callClientFunctionByIdAw(e,t,...i){return new Promise((n,o)=>{{let o=this.generateId(),r=(e,t)=>{n(e?[null,e]:[t])},a={s_rid:o,action:"call_client_by_id",rid:t,args:i};this.retCallbackMap[o]=Object.assign({callback:r},a),this.sendAdapter(e,a)}})}checkClientFunction(e,t){return"string"==typeof e&&(e=this.getFullAlias(e)),this.internalCheckClientFunction(e,t)}callClientFunctionByName(e,t,...i){return new Promise((n,o)=>{do{if(!e){n([null,null]);break}let o=void 0;if("string"==typeof e){if(e=this.getFullAlias(e),!this.clientAliasMap.hasOwnProperty(e)){n([null,null]);break}o=this.clientAliasMap[e]}else o=e;if(!o){n([null,null]);break}let r=this.generateId(),s=(e,t,i)=>{n(e?[null,i,e]:[t,i])};if(i)for(let e=0;e<i.length;e++)i[e]=this.convertFunction2Id(i[e]);let l={s_rid:r,action:"call_client_api",args:i,src:a.serverContextName,method:t};this.retCallbackMap[r]=Object.assign({callback:s},l),this.sendAdapter(o,l)}while(0)})}isRemoteClientExist(e){let t=!1;return this.clientAliasMap.hasOwnProperty(this.getFullAlias(e))&&(t=!0),t}getRemoteClient(e,t){let i=null;do{if(!e)break;t||(t=this.server.getProductId());let n=`${t}-${e}`.toLowerCase();i=this.clientAliasMap[n]}while(0);return i}internalCheckClientFunction(e,t){return n(this,void 0,void 0,function*(){return new Promise((i,n)=>{do{if(!e){i(!1);break}let n=void 0;if("string"==typeof e){if(!this.clientAliasMap.hasOwnProperty(e)){i(!1);break}n=this.clientAliasMap[e]}else n=e;if(!n){i(!1);break}let o=this.generateId(),r=(e,t)=>{i(!e&&t)},a={s_rid:o,action:"check_client_function",method:t};this.retCallbackMap[o]=Object.assign({callback:r},a),this.sendAdapter(n,a)}while(0)})})}convertFunction2Id(e){let t=e;if("function"==typeof e){let i=this.generateId();this.contextCallbackMap[i]=e,t=i}else if(e&&"object"==typeof e)for(let t in e){let i=e[t];if("function"==typeof i){let n=this.generateId();this.contextCallbackMap[n]=i,e[t]=n}else i&&"object"==typeof i&&(e[t]=this.convertFunction2Id(i))}return t}registerAlias(e,t,i){do{if(!e)break;if(!e.alias){i.error="register alias can not be empty";break}if(this.clientAliasMap.hasOwnProperty(e.alias)){if(this.clientAliasMap[e.alias]===t){i.data=e.alias,i.success=!0;break}i.error="register failed cause alias is in use";break}{let n=void 0;for(let e in this.clientAliasMap)if(this.clientAliasMap[e]===t){n=e;break}if(n){i.data=n,i.error=`register failed cause already register by another alias ${n}`;break}this.clientAliasMap[e.alias]=t,i.data=e.alias,i.success=!0;break}}while(0)}callClientFunction(e,t){do{if(!e)break;let i=e.dst,n={rid:e.rid,method:e.method};if(!this.clientAliasMap.hasOwnProperty(i)){let o=`call remote function but dst client is not start or ended ${i}, method ${e.method}`;s.error(o),n.error=o,n.action="remote_client_callback",n.success=!1,this.sendAdapter(t,n);break}let o=this.generateId(),r=this.clientAliasMap[i];n=Object.assign({s_rid:o,action:"call_client_api",args:e.args,src:e.src},n),this.retCallbackMap[o]=Object.assign({remote:t,dstRemote:r},n),this.sendAdapter(r,n)}while(0)}fireRetCallback(e,t){do{let i=e.s_rid;if(void 0===i||null===i)break;let n=this.retCallbackMap[i];if(!n)break;const o=n.callback;if(!o)break;e.success?o(null,this.decodeParameter(e.data,t)):o(e.error,e.data),delete this.retCallbackMap[i],s.information("free fireRetCallback",i)}while(0)}decodeParameter(e,t){let i=e;do{if(!e)break;if("object"!=typeof e)break;let o=e["__nodeipc_callback_id__{A9C9D760-14E8-42CB-A3CB-9C0A0DDFD732}"];if(o){i=((...e)=>n(this,void 0,void 0,function*(){return this.callClientFunctionByIdAw(t,o,...e)})),global.__xdasObjectLiftMonitor&&global.__xdasObjectLiftMonitor.setObjectFreer(i,{client:t,callbackId:o},l);break}for(let i in e){let n=e[i];e[i]=this.decodeParameter(n,t)}}while(0);return i}notifyFreer(e,t){this.sendAdapter(e,{action:"client_context_freer",rid:t})}reply2Client(e,t){do{let i=e.s_rid;if(void 0===i||null===i)break;let n=this.retCallbackMap[i];if(!n)break;if(e.src===a.serverContextName){const i=n.callback;if(!i)break;e.success?i(null,this.decodeParameter(e.data,t),t):i(e.error,e.data,t)}else{let t=n.remote;if(!t)break;this.sendAdapter(t,e)}delete this.retCallbackMap[i]}while(0)}getNow(){return Date.now()}sendAdapter(e,t){let i=this.getNow();t.timestamp=t.timestamp?t.timestamp.concat(i):[].concat(i),e.isInprocess()?(s.information("send to client in process"),e.emit("message",t)):e.send(t)}forwardEvent(e,t,i,...n){do{if(!this.eventMap.hasOwnProperty(e))break;let o=this.eventMap[e];for(let r of o)this.sendAdapter(r,{action:"fire_event",name:e,args:n,__context:t,timestamp:i})}while(0)}attachEvent(e,t){{this.eventMap[e]||(this.eventMap[e]=[]);let i=this.eventMap[e],n=!1;for(let o of i)if(o===t){s.information("server attachEvent attached",e),n=!0;break}n||(this.eventMap[e].push(t),s.information("server attachEvent ",e))}}detachEvent(e,t){do{if(!this.eventMap.hasOwnProperty(e))break;let i=this.eventMap[e];for(let n=0;n<i.length;n++)if(i[n]===t){this.eventMap[e].splice(n,1),s.information("server detachEvent current eventMap",this.eventMap);break}}while(0)}generateId(){return this.rid++}getFullAlias(e){return`${this.server.getProductId()}-${e}`.toLowerCase()}}),d=global.__xdasIPCServerInstance,t.server=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return require(e)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayCardInfo=t.DetailIndex=t.PanelID=t.XmpPlaySoure=t.WindowParams=t.CombineRgnType=t.ZOrderChangedType=t.WindowTopMode=t.XmpMode=t.ShowWindowCmd=t.VirtualKeyCode=t.HitTestPositionCode=t.GWCmd=t.WindowMessage=t.SetWindowType=t.WindowStyleEx=t.WindowStyle=t.CmdShow=t.Uflag=t.OptionOfHWNDInAfter=void 0,function(e){e[e.HWND_NOTOPMOST=-2]="HWND_NOTOPMOST",e[e.HWND_TOPMOST=-1]="HWND_TOPMOST",e[e.HWND_TOP=0]="HWND_TOP",e[e.HWND_BOTTOM=1]="HWND_BOTTOM"}(t.OptionOfHWNDInAfter||(t.OptionOfHWNDInAfter={})),function(e){e[e.SWP_ASYNCWINDOWPOS=16384]="SWP_ASYNCWINDOWPOS",e[e.SWP_DEFERERASE=8192]="SWP_DEFERERASE",e[e.SWP_DRAWFRAME=32]="SWP_DRAWFRAME",e[e.SWP_FRAMECHANGED=32]="SWP_FRAMECHANGED",e[e.SWP_HIDEWINDOW=128]="SWP_HIDEWINDOW",e[e.SWP_NOACTIVATE=16]="SWP_NOACTIVATE",e[e.SWP_NOCOPYBITS=256]="SWP_NOCOPYBITS",e[e.SWP_NOMOVE=2]="SWP_NOMOVE",e[e.SWP_NOOWNERZORDER=512]="SWP_NOOWNERZORDER",e[e.SWP_NOREDRAW=8]="SWP_NOREDRAW",e[e.SWP_NOREPOSITION=512]="SWP_NOREPOSITION",e[e.SWP_NOSENDCHANGING=1024]="SWP_NOSENDCHANGING",e[e.SWP_NOSIZE=1]="SWP_NOSIZE",e[e.SWP_NOZORDER=4]="SWP_NOZORDER",e[e.SWP_SHOWWINDOW=64]="SWP_SHOWWINDOW"}(t.Uflag||(t.Uflag={})),function(e){e[e.SW_FORCEMINIMIZE=11]="SW_FORCEMINIMIZE",e[e.SW_HIDE=0]="SW_HIDE",e[e.SW_MAXIMIZE=3]="SW_MAXIMIZE",e[e.SW_MINIMIZE=6]="SW_MINIMIZE",e[e.SW_RESTORE=9]="SW_RESTORE",e[e.SW_SHOW=5]="SW_SHOW",e[e.SW_SHOWDEFAULT=10]="SW_SHOWDEFAULT",e[e.SW_SHOWMAXIMIZED=3]="SW_SHOWMAXIMIZED",e[e.SW_SHOWMINIMIZED=2]="SW_SHOWMINIMIZED",e[e.SW_SHOWMINNOACTIVE=7]="SW_SHOWMINNOACTIVE",e[e.SW_SHOWNA=8]="SW_SHOWNA",e[e.SW_SHOWNOACTIVATE=4]="SW_SHOWNOACTIVATE",e[e.SW_SHOWNORMAL=1]="SW_SHOWNORMAL"}(t.CmdShow||(t.CmdShow={})),function(e){e[e.WS_BORDER=8388608]="WS_BORDER",e[e.WS_CAPTION=12582912]="WS_CAPTION",e[e.WS_CHILD=1073741824]="WS_CHILD",e[e.WS_CHILDWINDOW=1073741824]="WS_CHILDWINDOW",e[e.WS_CLIPCHILDREN=33554432]="WS_CLIPCHILDREN",e[e.WS_CLIPSIBLINGS=67108864]="WS_CLIPSIBLINGS",e[e.WS_POPUP=2147483648]="WS_POPUP",e[e.WS_THICKFRAME=262144]="WS_THICKFRAME"}(t.WindowStyle||(t.WindowStyle={})),function(e){e[e.WS_EX_TOOLWINDOW=128]="WS_EX_TOOLWINDOW",e[e.WS_EX_APPWINDOW=262144]="WS_EX_APPWINDOW",e[e.WS_EX_TOPMOST=8]="WS_EX_TOPMOST",e[e.WS_EX_WINDOWEDGE=256]="WS_EX_WINDOWEDGE",e[e.WS_EX_NOACTIVATE=134217728]="WS_EX_NOACTIVATE"}(t.WindowStyleEx||(t.WindowStyleEx={})),function(e){e[e.GWL_EXSTYLE=-20]="GWL_EXSTYLE",e[e.GWL_HINSTANCE=-6]="GWL_HINSTANCE",e[e.GWL_ID=-12]="GWL_ID",e[e.GWL_STYLE=-16]="GWL_STYLE",e[e.GWL_USERDATA=-21]="GWL_USERDATA",e[e.GWL_WNDPROC=-4]="GWL_WNDPROC"}(t.SetWindowType||(t.SetWindowType={})),function(e){e[e.WM_CREATE=1]="WM_CREATE",e[e.WM_DESTROY=2]="WM_DESTROY",e[e.WM_MOVE=3]="WM_MOVE",e[e.WM_SIZE=5]="WM_SIZE",e[e.WM_ACTIVATE=6]="WM_ACTIVATE",e[e.WM_SETFOCUS=7]="WM_SETFOCUS",e[e.WM_KILLFOCUS=8]="WM_KILLFOCUS",e[e.WM_ENABLE=10]="WM_ENABLE",e[e.WM_KEYDOWN=256]="WM_KEYDOWN",e[e.WM_KEYUP=257]="WM_KEYUP",e[e.WM_SYSKEYDOWN=260]="WM_SYSKEYDOWN",e[e.WM_MOUSEMOVE=512]="WM_MOUSEMOVE",e[e.WM_SETCURSOR=32]="WM_SETCURSOR",e[e.WM_LBUTTONDOWN=513]="WM_LBUTTONDOWN",e[e.WM_LBUTTONUP=514]="WM_LBUTTONUP",e[e.WM_LBUTTONDBLCLK=515]="WM_LBUTTONDBLCLK",e[e.WM_RBUTTONUP=517]="WM_RBUTTONUP",e[e.WM_MOUSEWHEEL=522]="WM_MOUSEWHEEL",e[e.WM_MOUSELEAVE=675]="WM_MOUSELEAVE",e[e.WM_DPICHANGED=736]="WM_DPICHANGED",e[e.WM_GETMINMAXINFO=36]="WM_GETMINMAXINFO",e[e.WM_NCHITTEST=132]="WM_NCHITTEST",e[e.WM_NCMOUSEMOVE=160]="WM_NCMOUSEMOVE",e[e.WM_NCLBUTTONDOWN=161]="WM_NCLBUTTONDOWN",e[e.WM_NCLBUTTONUP=162]="WM_NCLBUTTONUP",e[e.WM_NCLBUTTONDBLCLK=163]="WM_NCLBUTTONDBLCLK",e[e.WM_NCRBUTTONDOWN=164]="WM_NCRBUTTONDOWN",e[e.WM_NCRBUTTONUP=165]="WM_NCRBUTTONUP",e[e.WM_NCRBUTTONDBLCLK=166]="WM_NCRBUTTONDBLCLK",e[e.WM_NCMBUTTONDOWN=167]="WM_NCMBUTTONDOWN",e[e.WM_NCMBUTTONUP=168]="WM_NCMBUTTONUP",e[e.WM_NCMBUTTONDBLCLK=169]="WM_NCMBUTTONDBLCLK",e[e.WM_WINDOWPOSCHANGED=71]="WM_WINDOWPOSCHANGED",e[e.WM_WINDOWPOSCHANGING=70]="WM_WINDOWPOSCHANGING",e[e.WM_ACTIVATEAPP=28]="WM_ACTIVATEAPP",e[e.WM_DWMCOMPOSITIONCHANGED=798]="WM_DWMCOMPOSITIONCHANGED"}(t.WindowMessage||(t.WindowMessage={})),function(e){e[e.GW_HWNDFIRST=0]="GW_HWNDFIRST",e[e.GW_HWNDLAST=1]="GW_HWNDLAST",e[e.GW_HWNDNEXT=2]="GW_HWNDNEXT",e[e.GW_HWNDPREV=3]="GW_HWNDPREV",e[e.GW_OWNER=4]="GW_OWNER",e[e.GW_CHILD=5]="GW_CHILD",e[e.GW_ENABLEDPOPUP=6]="GW_ENABLEDPOPUP"}(t.GWCmd||(t.GWCmd={})),function(e){e[e.HTERROR=-2]="HTERROR",e[e.HTTRANSPARENT=-1]="HTTRANSPARENT",e[e.HTNOWHERE=0]="HTNOWHERE",e[e.HTCLIENT=1]="HTCLIENT",e[e.HTCAPTION=2]="HTCAPTION",e[e.HTSYSMENU=3]="HTSYSMENU",e[e.HTGROWBOX=4]="HTGROWBOX",e[e.HTSIZE=4]="HTSIZE",e[e.HTMENU=5]="HTMENU",e[e.HTHSCROLL=6]="HTHSCROLL",e[e.HTVSCROLL=7]="HTVSCROLL",e[e.HTMINBUTTON=8]="HTMINBUTTON",e[e.HTMAXBUTTON=9]="HTMAXBUTTON",e[e.HTLEFT=10]="HTLEFT",e[e.HTRIGHT=11]="HTRIGHT",e[e.HTTOP=12]="HTTOP",e[e.HTTOPLEFT=13]="HTTOPLEFT",e[e.HTTOPRIGHT=14]="HTTOPRIGHT",e[e.HTBOTTOM=15]="HTBOTTOM",e[e.HTBOTTOMLEFT=16]="HTBOTTOMLEFT",e[e.HTBOTTOMRIGHT=17]="HTBOTTOMRIGHT",e[e.HTBORDER=18]="HTBORDER",e[e.HTREDUCE=8]="HTREDUCE",e[e.HTZOOM=9]="HTZOOM",e[e.HTSIZEFIRST=10]="HTSIZEFIRST",e[e.HTSIZELAST=17]="HTSIZELAST",e[e.HTOBJECT=19]="HTOBJECT",e[e.HTCLOSE=20]="HTCLOSE",e[e.HTHELP=21]="HTHELP"}(t.HitTestPositionCode||(t.HitTestPositionCode={})),function(e){e[e.VK_LBUTTON=1]="VK_LBUTTON",e[e.VK_RBUTTON=2]="VK_RBUTTON",e[e.VK_MBUTTON=4]="VK_MBUTTON",e[e.VK_BACK=8]="VK_BACK",e[e.VK_TAB=9]="VK_TAB",e[e.VK_RETURN=13]="VK_RETURN",e[e.VK_SHIFT=16]="VK_SHIFT",e[e.VK_CONTROL=17]="VK_CONTROL",e[e.VK_MENU=18]="VK_MENU",e[e.VK_ESCAPE=27]="VK_ESCAPE",e[e.VK_SPACE=32]="VK_SPACE",e[e.VK_PRIOR=33]="VK_PRIOR",e[e.VK_NEXT=34]="VK_NEXT",e[e.VK_END=35]="VK_END",e[e.VK_LEFT=37]="VK_LEFT",e[e.VK_UP=38]="VK_UP",e[e.VK_RIGHT=39]="VK_RIGHT",e[e.VK_DOWN=40]="VK_DOWN",e[e.VK_DELETE=46]="VK_DELETE",e[e.VK_F1=112]="VK_F1",e[e.VK_F2=113]="VK_F2",e[e.VK_F3=114]="VK_F3",e[e.VK_F4=115]="VK_F4",e[e.VK_F5=116]="VK_F5",e[e.VK_F6=117]="VK_F6",e[e.VK_F7=118]="VK_F7",e[e.VK_F8=119]="VK_F8",e[e.VK_F9=120]="VK_F9",e[e.VK_F10=121]="VK_F10",e[e.VK_F11=122]="VK_F11",e[e.VK_F12=123]="VK_F12",e[e.VK_OEM_1=186]="VK_OEM_1",e[e.VK_OEM_PLUS=187]="VK_OEM_PLUS",e[e.VK_OEM_COMMA=188]="VK_OEM_COMMA",e[e.VK_OEM_MINUS=189]="VK_OEM_MINUS",e[e.VK_OEM_PERIOD=190]="VK_OEM_PERIOD",e[e.VK_OEM_2=191]="VK_OEM_2",e[e.VK_OEM_3=192]="VK_OEM_3",e[e.VK_OEM_4=219]="VK_OEM_4",e[e.VK_OEM_5=220]="VK_OEM_5",e[e.VK_OEM_6=221]="VK_OEM_6",e[e.VK_OEM_7=222]="VK_OEM_7",e[e.VK_PROCESSKEY=229]="VK_PROCESSKEY"}(t.VirtualKeyCode||(t.VirtualKeyCode={})),function(e){e[e.SW_HIDE=0]="SW_HIDE",e[e.SW_SHOWMAXIMIZED=3]="SW_SHOWMAXIMIZED",e[e.SW_SHOW=5]="SW_SHOW"}(t.ShowWindowCmd||(t.ShowWindowCmd={})),function(e){e[e.UNKNOWN_MODE=-1]="UNKNOWN_MODE",e[e.INDEPENDENT_MODE=0]="INDEPENDENT_MODE",e[e.MAGNETIC_MODE=1]="MAGNETIC_MODE",e[e.EMBED_MODE=2]="EMBED_MODE"}(t.XmpMode||(t.XmpMode={})),function(e){e[e.NO_TOPMOST_MODE=0]="NO_TOPMOST_MODE",e[e.PLAYING_TOPMOST_MODE=1]="PLAYING_TOPMOST_MODE",e[e.ALWAYLS_TOPMOST_MODE=2]="ALWAYLS_TOPMOST_MODE"}(t.WindowTopMode||(t.WindowTopMode={})),function(e){e[e.ZORDER_CHANGED_TYPE_UNKNOW=-1]="ZORDER_CHANGED_TYPE_UNKNOW",e[e.ZORDER_CHANGED_TYPE_BEFORE=0]="ZORDER_CHANGED_TYPE_BEFORE",e[e.ZORDER_CHANGED_TYPE_AFTER=1]="ZORDER_CHANGED_TYPE_AFTER"}(t.ZOrderChangedType||(t.ZOrderChangedType={})),function(e){e[e.RGN_AND=1]="RGN_AND",e[e.RGN_OR=2]="RGN_OR",e[e.RGN_XOR=3]="RGN_XOR",e[e.RGN_DIFF=4]="RGN_DIFF",e[e.RGN_COPY=5]="RGN_COPY"}(t.CombineRgnType||(t.CombineRgnType={})),function(e){e[e.DEFAULT_WIDTH=850]="DEFAULT_WIDTH",e[e.DEFAULT_HEIGHT=550]="DEFAULT_HEIGHT",e[e.MIN_WINDOW_WIDTH=350]="MIN_WINDOW_WIDTH",e[e.MIN_WINDOW_HEIGHT=200]="MIN_WINDOW_HEIGHT",e[e.TOPCTRL_HEIGHT=42]="TOPCTRL_HEIGHT",e[e.PLAYCTRL_HEIGHT=62]="PLAYCTRL_HEIGHT"}(t.WindowParams||(t.WindowParams={})),function(e){e[e.PLAY_UNKNOWN=0]="PLAY_UNKNOWN",e[e.PLAY_BY_DOWNLOAD=1]="PLAY_BY_DOWNLOAD",e[e.PLAY_BY_PAN=2]="PLAY_BY_PAN"}(t.XmpPlaySoure||(t.XmpPlaySoure={})),function(e){e.Download="download-panel",e.Cloud="pan-plugin-view",e.Browser="find-page",e.Message="message-page"}(t.PanelID||(t.PanelID={})),function(e){e.Preview="Preview",e.Speed="TaskChart",e.Attribute="Attribute"}(t.DetailIndex||(t.DetailIndex={}));t.DisplayCardInfo=class{}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APlayerEventCode=t.APlayerConfigId=void 0,function(e){e[e.CONFIGID_APLAYERINFO=1]="CONFIGID_APLAYERINFO",e[e.CONFIGID_CODECSPATH=2]="CONFIGID_CODECSPATH",e[e.CONFIGID_CODECSDISABLELIST=3]="CONFIGID_CODECSDISABLELIST",e[e.CONFIGID_CURRENTURL=4]="CONFIGID_CURRENTURL",e[e.CONFIGID_FILESIZE=5]="CONFIGID_FILESIZE",e[e.CONFIGID_PLAYMODE=6]="CONFIGID_PLAYMODE",e[e.CONFIGID_PLAYRESULT=7]="CONFIGID_PLAYRESULT",e[e.CONFIGID_AUTOPLAY=8]="CONFIGID_AUTOPLAY",e[e.CONFIGID_USEOPENCHAIN=9]="CONFIGID_USEOPENCHAIN",e[e.CONFIGID_SOUNDDEVICELIST=10]="CONFIGID_SOUNDDEVICELIST",e[e.CONFIGID_SOUNDDEVICECURRENT=11]="CONFIGID_SOUNDDEVICECURRENT",e[e.CONFIGID_SOUNDSILENT=12]="CONFIGID_SOUNDSILENT",e[e.CONFIGID_SOUNDBALANCE=13]="CONFIGID_SOUNDBALANCE",e[e.CONFIGID_DISABLEVIDEO=14]="CONFIGID_DISABLEVIDEO",e[e.CONFIGID_DISABLEAUDIO=15]="CONFIGID_DISABLEAUDIO",e[e.CONFIGID_ENABLEVSFILTER=16]="CONFIGID_ENABLEVSFILTER",e[e.CONFIGID_ENABLEAUDIOSWITCHER=17]="CONFIGID_ENABLEAUDIOSWITCHER",e[e.CONFIGID_DOWNLOADCODECSYNC=18]="CONFIGID_DOWNLOADCODECSYNC",e[e.CONFIGID_DOWNLOADCODECCOMPLETED=19]="CONFIGID_DOWNLOADCODECCOMPLETED",e[e.CONFIGID_WINDOWHANDLE=20]="CONFIGID_WINDOWHANDLE",e[e.CONFIGID_WINDOWMOVED=21]="CONFIGID_WINDOWMOVED",e[e.CONFIGID_SETTINGEXPLAIN=22]="CONFIGID_SETTINGEXPLAIN",e[e.CONFIGID_SETTINGVALUES=23]="CONFIGID_SETTINGVALUES",e[e.CONFIGID_LOADPLUGIN=24]="CONFIGID_LOADPLUGIN",e[e.CONFIGID_FREEPLUGIN=25]="CONFIGID_FREEPLUGIN",e[e.CONFIGID_FLASHINTERACTION=26]="CONFIGID_FLASHINTERACTION",e[e.CONFIGID_INTELMEDIASDKDECODER=27]="CONFIGID_INTELMEDIASDKDECODER",e[e.CONFIGID_INTELMEDIASDKENCODER=28]="CONFIGID_INTELMEDIASDKENCODER",e[e.CONFIGID_READSIZE=29]="CONFIGID_READSIZE",e[e.CONFIGID_READOFFSET=30]="CONFIGID_READOFFSET",e[e.CONFIGID_READPOSITION=31]="CONFIGID_READPOSITION",e[e.CONFIGID_WRITEOFFSET=32]="CONFIGID_WRITEOFFSET",e[e.CONFIGID_ALLOWLOG=33]="CONFIGID_ALLOWLOG",e[e.CONFIGID_MEDIAINFO=34]="CONFIGID_MEDIAINFO",e[e.CONFIGID_PLUGINSTDCALL=35]="CONFIGID_PLUGINSTDCALL",e[e.CONFIGID_LOGOSETTINGS=36]="CONFIGID_LOGOSETTINGS",e[e.CONFIGID_LOGOFILE=37]="CONFIGID_LOGOFILE",e[e.CONFIGID_CUSTOMCURSOR=38]="CONFIGID_CUSTOMCURSOR",e[e.CONFIGID_APLAYERDNN=43]="CONFIGID_APLAYERDNN",e[e.CONFIGID_ENABLELOG=44]="CONFIGID_ENABLELOG",e[e.CONFIGID_FISRTFRAMETIME=45]="CONFIGID_FISRTFRAMETIME",e[e.CONFIGID_SEEK_FRAME_TIME=46]="CONFIGID_SEEK_FRAME_TIME",e[e.CONFIGID_SEEK_FRAME_TIME_AVERAGE=47]="CONFIGID_SEEK_FRAME_TIME_AVERAGE",e[e.CONFIGID_AUTOPLAY_AFTERBUFFER=48]="CONFIGID_AUTOPLAY_AFTERBUFFER",e[e.CONFIGID_STAT=50]="CONFIGID_STAT",e[e.CONFIGID_TIMEISFRAME=101]="CONFIGID_TIMEISFRAME",e[e.CONFIGID_STARTPOSITION=102]="CONFIGID_STARTPOSITION",e[e.CONFIGID_STOPPOSITION=103]="CONFIGID_STOPPOSITION",e[e.CONFIGID_PLAYSPEED=104]="CONFIGID_PLAYSPEED",e[e.CONFIGID_KEYFRAMESEEK=105]="CONFIGID_KEYFRAMESEEK",e[e.CONFIGID_KEYFRAMECOUNT=106]="CONFIGID_KEYFRAMECOUNT",e[e.CONFIGID_KEYFRAMELIST=107]="CONFIGID_KEYFRAMELIST",e[e.CONFIGID_KEYFRAMECURRENT=108]="CONFIGID_KEYFRAMECURRENT",e[e.CONFIGID_CANFRAMESTEPFORWARDONE=109]="CONFIGID_CANFRAMESTEPFORWARDONE",e[e.CONFIGID_CANFRAMESTEPFORWARDMULTI=110]="CONFIGID_CANFRAMESTEPFORWARDMULTI",e[e.CONFIGID_CANFRAMESTEPBACKWORDKONE=111]="CONFIGID_CANFRAMESTEPBACKWORDKONE",e[e.CONFIGID_CANFRAMESTEPBACKWORDMULTI=112]="CONFIGID_CANFRAMESTEPBACKWORDMULTI",e[e.CONFIGID_FRAMESTEP=113]="CONFIGID_FRAMESTEP",e[e.CONFIGID_ISFRAMESTEPPING=114]="CONFIGID_ISFRAMESTEPPING",e[e.CONFIGID_READINDEXWHENOPEN=115]="CONFIGID_READINDEXWHENOPEN",e[e.CONFIGID_TIMEPOSITIONLIST=116]="CONFIGID_TIMEPOSITIONLIST",e[e.CONFIGID_FRAMEINTERVAL=117]="CONFIGID_FRAMEINTERVAL",e[e.CONFIGID_FRAMESDRAWN=118]="CONFIGID_FRAMESDRAWN",e[e.CONFIGID_LOOPPLAY=119]="CONFIGID_LOOPPLAY",e[e.CONFIGID_NOCLOSEWHENCOMPLETE=120]="CONFIGID_NOCLOSEWHENCOMPLETE",e[e.CONFIGID_MOUSEFRAMESEEK=122]="CONFIGID_MOUSEFRAMESEEK",e[e.CONFIGID_RENDERMODECONFIG=201]="CONFIGID_RENDERMODECONFIG",e[e.CONFIGID_RENDERMODECURRENT=202]="CONFIGID_RENDERMODECURRENT",e[e.CONFIGID_ASPECTRATIONATIVE=203]="CONFIGID_ASPECTRATIONATIVE",e[e.CONFIGID_ASPECTRATIOCUSTOM=204]="CONFIGID_ASPECTRATIOCUSTOM",e[e.CONFIGID_VIDEOSOURCEPOSITION=205]="CONFIGID_VIDEOSOURCEPOSITION",e[e.CONFIGID_VIDEOTARGETPOSITION=206]="CONFIGID_VIDEOTARGETPOSITION",e[e.CONFIGID_CLIPBLACKBANDENABLE=207]="CONFIGID_CLIPBLACKBANDENABLE",e[e.CONFIGID_CLIPBLACKBANDSTILL=208]="CONFIGID_CLIPBLACKBANDSTILL",e[e.CONFIGID_SPEEDUPENABLE=209]="CONFIGID_SPEEDUPENABLE",e[e.CONFIGID_SPEEDUPCUDAFIRST=210]="CONFIGID_SPEEDUPCUDAFIRST",e[e.CONFIGID_SPEEDUPSTATUS=211]="CONFIGID_SPEEDUPSTATUS",e[e.CONFIGID_SPEEDUPQUERY=212]="CONFIGID_SPEEDUPQUERY",e[e.CONFIGID_VIDEOADJUSTUSABLE=213]="CONFIGID_VIDEOADJUSTUSABLE",e[e.CONFIGID_BRIGHTNESS=214]="CONFIGID_BRIGHTNESS",e[e.CONFIGID_CONTRAST=215]="CONFIGID_CONTRAST",e[e.CONFIGID_SATURATION=216]="CONFIGID_SATURATION",e[e.CONFIGID_HUE=217]="CONFIGID_HUE",e[e.CONFIGID_COREAVCOUTPUTLEVEL=218]="CONFIGID_COREAVCOUTPUTLEVEL",e[e.CONFIGID_UNUSED=219]="CONFIGID_UNUSED",e[e.CONFIGID_VIDEOCODEC=220]="CONFIGID_VIDEOCODEC",e[e.CONFIGID_VIDEOOUTPUTFORMAT=221]="CONFIGID_VIDEOOUTPUTFORMAT",e[e.CONFIGID_CURRENTBLACKBANDINFO=222]="CONFIGID_CURRENTBLACKBANDINFO",e[e.CONFIGID_IMAGEPROCESSUSABLE=301]="CONFIGID_IMAGEPROCESSUSABLE",e[e.CONFIGID_IMAGEFLIPH=302]="CONFIGID_IMAGEFLIPH",e[e.CONFIGID_IMAGEFLIPV=303]="CONFIGID_IMAGEFLIPV",e[e.CONFIGID_IMAGEROTATE=304]="CONFIGID_IMAGEROTATE",e[e.CONFIGID_IMAGENORMALIZEENABLE=305]="CONFIGID_IMAGENORMALIZEENABLE",e[e.CONFIGID_IMAGENORMALIZECOMPARE=306]="CONFIGID_IMAGENORMALIZECOMPARE",e[e.CONFIGID_IMAGESHARPEN=307]="CONFIGID_IMAGESHARPEN",e[e.CONFIGID_IMAGECOLOR3DENABLE=308]="CONFIGID_IMAGECOLOR3DENABLE",e[e.CONFIGID_IMAGECOLOR3DOKAY=309]="CONFIGID_IMAGECOLOR3DOKAY",e[e.CONFIGID_IMAGECOLOR3DSHOW=310]="CONFIGID_IMAGECOLOR3DSHOW",e[e.CONFIGID_IMAGECOLOR3DMODE=311]="CONFIGID_IMAGECOLOR3DMODE",e[e.CONFIGID_IMAGECOLOR3DCOLOR=312]="CONFIGID_IMAGECOLOR3DCOLOR",e[e.CONFIGID_IMAGEUSEOPENCL=313]="CONFIGID_IMAGEUSEOPENCL",e[e.CONFIGID_IMAGEUSEAVX2=314]="CONFIGID_IMAGEUSEAVX2",e[e.CONFIGID_IMAGEUSESSE2=315]="CONFIGID_IMAGEUSESSE2",e[e.CONFIGID_AUIDOPROCESSUSABLE=401]="CONFIGID_AUIDOPROCESSUSABLE",e[e.CONFIGID_AUDIOTRACKLIST=402]="CONFIGID_AUDIOTRACKLIST",e[e.CONFIGID_AUDIOTRACKCURRENT=403]="CONFIGID_AUDIOTRACKCURRENT",e[e.CONFIGID_AUDIOCHANNEL=404]="CONFIGID_AUDIOCHANNEL",e[e.CONFIGID_AUDIOTIMESHIFT=405]="CONFIGID_AUDIOTIMESHIFT",e[e.CONFIGID_AUDIONORMALIZE=406]="CONFIGID_AUDIONORMALIZE",e[e.CONFIGID_AUDIOVSSENABLE=407]="CONFIGID_AUDIOVSSENABLE",e[e.CONFIGID_AUDIOVSSDEEP=408]="CONFIGID_AUDIOVSSDEEP",e[e.CONFIGID_AUDIOLOADTRACK=409]="CONFIGID_AUDIOLOADTRACK",e[e.CONFIGID_AUDIOCODEC=410]="CONFIGID_AUDIOCODEC",e[e.CONFIGID_AUDIOINPUTCHANNELS=411]="CONFIGID_AUDIOINPUTCHANNELS",e[e.CONFIGID_AUDIOINPUTSAMPLERATE=412]="CONFIGID_AUDIOINPUTSAMPLERATE",e[e.CONFIGID_AUDIOINPUTSAMPLEBIT=413]="CONFIGID_AUDIOINPUTSAMPLEBIT",e[e.CONFIGID_AUDIOOUTPUTFORMAT=414]="CONFIGID_AUDIOOUTPUTFORMAT",e[e.CONFIGID_AUDIOOUTPUTCHANNELS=415]="CONFIGID_AUDIOOUTPUTCHANNELS",e[e.CONFIGID_AUDIOOUTPUTSAMPLERATE=416]="CONFIGID_AUDIOOUTPUTSAMPLERATE",e[e.CONFIGID_AUDIOOUTPUTSAMPLEBIT=417]="CONFIGID_AUDIOOUTPUTSAMPLEBIT",e[e.CONFIGID_SUBTITLEUSABLE=501]="CONFIGID_SUBTITLEUSABLE",e[e.CONFIGID_SUBTITLEEXTNAMELIST=502]="CONFIGID_SUBTITLEEXTNAMELIST",e[e.CONFIGID_SUBTITLEFILENAME=503]="CONFIGID_SUBTITLEFILENAME",e[e.CONFIGID_SUBTITLESHOW=504]="CONFIGID_SUBTITLESHOW",e[e.CONFIGID_SUBTITLELANGUAGELIST=505]="CONFIGID_SUBTITLELANGUAGELIST",e[e.CONFIGID_SUBTITLELANGUAGECURRENT=506]="CONFIGID_SUBTITLELANGUAGECURRENT",e[e.CONFIGID_SUBTITLEPLACEMENT=507]="CONFIGID_SUBTITLEPLACEMENT",e[e.CONFIGID_SUBTITLEFONT=508]="CONFIGID_SUBTITLEFONT",e[e.CONFIGID_SUBTITLETIMING=509]="CONFIGID_SUBTITLETIMING",e[e.CONFIGID_SUBTITLE3D=510]="CONFIGID_SUBTITLE3D",e[e.CONFIGID_SUBTITLECONTENT=511]="CONFIGID_SUBTITLECONTENT",e[e.CONFIGID_PICTUREUSABLE=601]="CONFIGID_PICTUREUSABLE",e[e.CONFIGID_PICTUREENABLE=602]="CONFIGID_PICTUREENABLE",e[e.CONFIGID_PICTUREBOUND=603]="CONFIGID_PICTUREBOUND",e[e.CONFIGID_PICTUREWIDTH=604]="CONFIGID_PICTUREWIDTH",e[e.CONFIGID_PICTUREHEIGHT=605]="CONFIGID_PICTUREHEIGHT",e[e.CONFIGID_PICTURELEFT=606]="CONFIGID_PICTURELEFT",e[e.CONFIGID_PICTURETOP=607]="CONFIGID_PICTURETOP",e[e.CONFIGID_PICTUREALPHA=608]="CONFIGID_PICTUREALPHA",e[e.CONFIGID_PICTURECOLORKEY=609]="CONFIGID_PICTURECOLORKEY",e[e.CONFIGID_PICTUREHITTEST=610]="CONFIGID_PICTUREHITTEST",e[e.CONFIGID_PICTUREHITALPHA=611]="CONFIGID_PICTUREHITALPHA",e[e.CONFIGID_PICTURETEXT=612]="CONFIGID_PICTURETEXT",e[e.CONFIGID_PICTUREFONT=613]="CONFIGID_PICTUREFONT",e[e.CONFIGID_PICTURERGBABUFFER=614]="CONFIGID_PICTURERGBABUFFER",e[e.CONFIGID_PICTUREBMPHANDLE=615]="CONFIGID_PICTUREBMPHANDLE",e[e.CONFIGID_PICTUREBMPFILENAME=616]="CONFIGID_PICTUREBMPFILENAME",e[e.CONFIGID_PICTUREPNGFILENAME=617]="CONFIGID_PICTUREPNGFILENAME",e[e.CONFIGID_PICTURESWFFILENAME=618]="CONFIGID_PICTURESWFFILENAME",e[e.CONFIGID_PICTURESWFSIZE=619]="CONFIGID_PICTURESWFSIZE",e[e.CONFIGID_PICTURESWFCONTROL=620]="CONFIGID_PICTURESWFCONTROL",e[e.CONFIGID_PICTUREEVRCPLINEAR=621]="CONFIGID_PICTUREEVRCPLINEAR",e[e.CONFIGID_PICTUREATTACHTOVR=622]="CONFIGID_PICTUREATTACHTOVR",e[e.CONFIGID_SNAPSHOTUSABLE=701]="CONFIGID_SNAPSHOTUSABLE",e[e.CONFIGID_SNAPSHOTIMAGE=702]="CONFIGID_SNAPSHOTIMAGE",e[e.CONFIGID_SNAPSHOTWIDTH=703]="CONFIGID_SNAPSHOTWIDTH",e[e.CONFIGID_SNAPSHOTHEIGHT=704]="CONFIGID_SNAPSHOTHEIGHT",e[e.CONFIGID_SNAPSHOTSOURCEPOSITION=705]="CONFIGID_SNAPSHOTSOURCEPOSITION",e[e.CONFIGID_SNAPSHOTKEEPASPECTRATIO=706]="CONFIGID_SNAPSHOTKEEPASPECTRATIO",e[e.CONFIGID_SNAPSHOTFORMAT=707]="CONFIGID_SNAPSHOTFORMAT",e[e.CONFIGID_SNAPSHOTJPEGQUALITY=708]="CONFIGID_SNAPSHOTJPEGQUALITY",e[e.CONFIGID_SNAPSHOTGIFPARAM=709]="CONFIGID_SNAPSHOTGIFPARAM",e[e.CONFIGID_SNAPSHOTABORT=710]="CONFIGID_SNAPSHOTABORT",e[e.CONFIGID_SNAPSHOTGIFWORKING=711]="CONFIGID_SNAPSHOTGIFWORKING",e[e.CONFIGID_SNAPSHOTGIFPROGRESS=712]="CONFIGID_SNAPSHOTGIFPROGRESS",e[e.CONFIGID_SNAPSHOTSUBTITLE=713]="CONFIGID_SNAPSHOTSUBTITLE",e[e.CONFIGID_CUTUSABLE=801]="CONFIGID_CUTUSABLE",e[e.CONFIGID_CUTFORMATLIST=802]="CONFIGID_CUTFORMATLIST",e[e.CONFIGID_CUTFORMATCURRENT=803]="CONFIGID_CUTFORMATCURRENT",e[e.CONFIGID_CUTFILENAME=804]="CONFIGID_CUTFILENAME",e[e.CONFIGID_TRANSCODEVIDEOWIDTH=901]="CONFIGID_TRANSCODEVIDEOWIDTH",e[e.CONFIGID_TRANSCODEVIDEOHEIGHT=902]="CONFIGID_TRANSCODEVIDEOHEIGHT",e[e.CONFIGID_TRANSCODEKEEPASPECTRATIO=903]="CONFIGID_TRANSCODEKEEPASPECTRATIO",e[e.CONFIGID_TRANSCODEROUNDSIZE=904]="CONFIGID_TRANSCODEROUNDSIZE",e[e.CONFIGID_TRANSCODEAUDIOTRACK=905]="CONFIGID_TRANSCODEAUDIOTRACK",e[e.CONFIGID_TRANSCODESUBTLTELANGUAGE=906]="CONFIGID_TRANSCODESUBTLTELANGUAGE",e[e.CONFIGID_TRANSCODECROPBORDER=907]="CONFIGID_TRANSCODECROPBORDER",e[e.CONFIGID_TRANSCODEVSFILTER=908]="CONFIGID_TRANSCODEVSFILTER",e[e.CONFIGID_NETWORK_BUFFERENTER=1001]="CONFIGID_NETWORK_BUFFERENTER",e[e.CONFIGID_NETWORK_BUFFERLEAVE=1002]="CONFIGID_NETWORK_BUFFERLEAVE",e[e.CONFIGID_NETWORK_NOBUFFERDRY=1003]="CONFIGID_NETWORK_NOBUFFERDRY",e[e.CONFIGID_NETWORK_SEEKBUFFERTIMEOUT=1004]="CONFIGID_NETWORK_SEEKBUFFERTIMEOUT",e[e.CONFIGID_NETWORK__ISSEEKBUFFER=1012]="CONFIGID_NETWORK__ISSEEKBUFFER",e[e.CONFIGID_NETWORK__FASTSEEK=1013]="CONFIGID_NETWORK__FASTSEEK",e[e.CONFIGID_NETWORK__STUFFURL=1014]="CONFIGID_NETWORK__STUFFURL",e[e.CONFIGID_NETWORK__TS_INDEX_STATUS=1018]="CONFIGID_NETWORK__TS_INDEX_STATUS",e[e.CONFIGID_NETWORK__STUFF_READ_SIZE=1019]="CONFIGID_NETWORK__STUFF_READ_SIZE",e[e.CONFIGID_HTTPENABLEVOD=1101]="CONFIGID_HTTPENABLEVOD",e[e.CONFIGID_HTTPFAILEDRECONNECTCOUNT=1102]="CONFIGID_HTTPFAILEDRECONNECTCOUNT",e[e.CONFIGID_HTTPFAILEDRECONNECTINTERVAL=1103]="CONFIGID_HTTPFAILEDRECONNECTINTERVAL",e[e.CONFIGID_HTTPLIVE=1104]="CONFIGID_HTTPLIVE",e[e.CONFIGID_HTTPCOOKIE=1105]="CONFIGID_HTTPCOOKIE",e[e.CONFIGID_HTTPREFERER=1106]="CONFIGID_HTTPREFERER",e[e.CONFIGID_HTTPCUSTOMHEADERS=1107]="CONFIGID_HTTPCUSTOMHEADERS",e[e.CONFIGID_HTTPUSERAGENT=1108]="CONFIGID_HTTPUSERAGENT",e[e.CONFIGID_MULTISOURCEUSABLE=1201]="CONFIGID_MULTISOURCEUSABLE",e[e.CONFIGID_MULTISOURCECHANGE=1202]="CONFIGID_MULTISOURCECHANGE",e[e.CONFIGID_MULTISOURCESEEK=1203]="CONFIGID_MULTISOURCESEEK",e[e.CONFIGID_MULTISOURCECURRENT=1204]="CONFIGID_MULTISOURCECURRENT",e[e.CONFIGID_LYRICUSABLE=1301]="CONFIGID_LYRICUSABLE",e[e.CONFIGID_LYRICSHOW=1302]="CONFIGID_LYRICSHOW",e[e.CONFIGID_LYRICUPDATETIME=1303]="CONFIGID_LYRICUPDATETIME",e[e.CONFIGID_LYRICFORMAT=1304]="CONFIGID_LYRICFORMAT",e[e.CONFIGID_LYRICFILE=1305]="CONFIGID_LYRICFILE",e[e.CONFIGID_LYRICCONTENT=1306]="CONFIGID_LYRICCONTENT",e[e.CONFIGID_LYRICBACKCOLOR=1307]="CONFIGID_LYRICBACKCOLOR",e[e.CONFIGID_LYRICPICTUREFILENAME=1308]="CONFIGID_LYRICPICTUREFILENAME",e[e.CONFIGID_LYRICPICTUREHANDLE=1309]="CONFIGID_LYRICPICTUREHANDLE",e[e.CONFIGID_LYRICPICTUREMODE=1310]="CONFIGID_LYRICPICTUREMODE",e[e.CONFIGID_LYRICFONT=1311]="CONFIGID_LYRICFONT",e[e.CONFIGID_LYRICFONTNORMALCOLOR=1312]="CONFIGID_LYRICFONTNORMALCOLOR",e[e.CONFIGID_LYRICFONTHIGHLIGHTCOLOR=1313]="CONFIGID_LYRICFONTHIGHLIGHTCOLOR",e[e.CONFIGID_LYRICFRAMEENABLE=1314]="CONFIGID_LYRICFRAMEENABLE",e[e.CONFIGID_LYRICFRAMECOLOR=1315]="CONFIGID_LYRICFRAMECOLOR",e[e.CONFIGID_LYRICSMOOTHMULITPLE=1316]="CONFIGID_LYRICSMOOTHMULITPLE",e[e.CONFIGID_LYRICSMOOTHONLYLYRIC=1317]="CONFIGID_LYRICSMOOTHONLYLYRIC",e[e.CONFIGID_LYRICALPHA=1318]="CONFIGID_LYRICALPHA",e[e.CONFIGID_LYRICANIMATION=1319]="CONFIGID_LYRICANIMATION",e[e.CONFIGID_LYRICTIMEOFFSET=1320]="CONFIGID_LYRICTIMEOFFSET",e[e.CONFIGID_LYRICDRAGENABLE=1321]="CONFIGID_LYRICDRAGENABLE",e[e.CONFIGID_LYRICDRAGLINECOLOR=1322]="CONFIGID_LYRICDRAGLINECOLOR",e[e.CONFIGID_LYRICDRAGTEXTCOLOR=1323]="CONFIGID_LYRICDRAGTEXTCOLOR",e[e.CONFIGID_LYRICDRAGTEXTLEFT=1324]="CONFIGID_LYRICDRAGTEXTLEFT",e[e.CONFIGID_LYRICDRAGTEXTRIGHTFRONT=1325]="CONFIGID_LYRICDRAGTEXTRIGHTFRONT",e[e.CONFIGID_LYRICDRAGTEXTRIGHTBACK=1326]="CONFIGID_LYRICDRAGTEXTRIGHTBACK",e[e.CONFIGID_LYRICDRAGTEXTRIGHTDIV=1327]="CONFIGID_LYRICDRAGTEXTRIGHTDIV",e[e.CONFIGID_LYRICALIGN=1328]="CONFIGID_LYRICALIGN",e[e.CONFIGID_DVDCHAPTERS=1401]="CONFIGID_DVDCHAPTERS",e[e.CONFIGID_DVDANGLECOUNT=1402]="CONFIGID_DVDANGLECOUNT",e[e.CONFIGID_DVDAUDIOS=1403]="CONFIGID_DVDAUDIOS",e[e.CONFIGID_DVDSUBPICTURES=1404]="CONFIGID_DVDSUBPICTURES",e[e.CONFIGID_DVDCURRENTCHAPTER=1405]="CONFIGID_DVDCURRENTCHAPTER",e[e.CONFIGID_DVDCURRENTANGLE=1406]="CONFIGID_DVDCURRENTANGLE",e[e.CONFIGID_DVDCURRENTAUDIO=1407]="CONFIGID_DVDCURRENTAUDIO",e[e.CONFIGID_DVDCURRENTSUBPICTURE=1408]="CONFIGID_DVDCURRENTSUBPICTURE",e[e.CONFIGID_DVDPARENTALLEVEL=1409]="CONFIGID_DVDPARENTALLEVEL",e[e.CONFIGID_DVDSHOWMENU=1410]="CONFIGID_DVDSHOWMENU",e[e.CONFIGID_DVDPRESSBUTTON=1411]="CONFIGID_DVDPRESSBUTTON",e[e.CONFIGID_DVDSKIPCHAPTER=1412]="CONFIGID_DVDSKIPCHAPTER",e[e.CONFIGID_DVDPLAYFORWARD=1413]="CONFIGID_DVDPLAYFORWARD",e[e.CONFIGID_DVDPLAYBACKWARD=1414]="CONFIGID_DVDPLAYBACKWARD",e[e.CONFIGID_DVDNEEDINTERACTION=1415]="CONFIGID_DVDNEEDINTERACTION",e[e.CONFIGID_AC3DTSUSABLE=1501]="CONFIGID_AC3DTSUSABLE",e[e.CONFIGID_AC3DTSOUTPUTMODE=1502]="CONFIGID_AC3DTSOUTPUTMODE",e[e.CONFIGID_AC3DTSVOICEVOLUME=1503]="CONFIGID_AC3DTSVOICEVOLUME",e[e.CONFIGID_SVCCURRENTLEVEL=1601]="CONFIGID_SVCCURRENTLEVEL",e[e.CONFIGID_SVCSTATISTICINTERVAL=1602]="CONFIGID_SVCSTATISTICINTERVAL",e[e.CONFIGID_SVCLEVELMIN=1603]="CONFIGID_SVCLEVELMIN",e[e.CONFIGID_SVCLEVELMAX=1604]="CONFIGID_SVCLEVELMAX",e[e.CONFIGID_SVCDOWNLOADSPEED=1605]="CONFIGID_SVCDOWNLOADSPEED",e[e.CONFIGID_SVCCONNECTTIMEOUT=1606]="CONFIGID_SVCCONNECTTIMEOUT",e[e.CONFIGID_DETECTSUBTITLEUSABLE=1701]="CONFIGID_DETECTSUBTITLEUSABLE",e[e.CONFIGID_DETECTSUBTITLEENABLE=1702]="CONFIGID_DETECTSUBTITLEENABLE",e[e.CONFIGID_DETECTSUBTITLEAREA=1703]="CONFIGID_DETECTSUBTITLEAREA",e[e.CONFIGID_DETECTSUBTITLESHOW=1704]="CONFIGID_DETECTSUBTITLESHOW",e[e.CONFIGID_DLNAENABLE=1801]="CONFIGID_DLNAENABLE",e[e.CONFIGID_DLNADEVICELIST=1802]="CONFIGID_DLNADEVICELIST",e[e.CONFIGID_DLNACURRENTDEVICE=1803]="CONFIGID_DLNACURRENTDEVICE",e[e.CONFIGID_DLNASEARCHDEVICE=1804]="CONFIGID_DLNASEARCHDEVICE",e[e.CONFIGID_VIDEO3DUSABLE=1901]="CONFIGID_VIDEO3DUSABLE",e[e.CONFIGID_VIDEO3DSHOW=1902]="CONFIGID_VIDEO3DSHOW",e[e.CONFIGID_VIDEO3DOBJECTLIST=1903]="CONFIGID_VIDEO3DOBJECTLIST",e[e.CONFIGID_VIDEO3DCURRENTOBJECT=1904]="CONFIGID_VIDEO3DCURRENTOBJECT",e[e.CONFIGID_VIDEO3DOBJECTINFO=1905]="CONFIGID_VIDEO3DOBJECTINFO",e[e.CONFIGID_VIDEO3DADDOBJECT=1906]="CONFIGID_VIDEO3DADDOBJECT",e[e.CONFIGID_VIDEO3DDELETEOBJECT=1907]="CONFIGID_VIDEO3DDELETEOBJECT",e[e.CONFIGID_VIDEO3DPOINTCOUNT=1908]="CONFIGID_VIDEO3DPOINTCOUNT",e[e.CONFIGID_VIDEO3DCURRENTPOINT=1909]="CONFIGID_VIDEO3DCURRENTPOINT",e[e.CONFIGID_VIDEO3DPOINTINFO=1910]="CONFIGID_VIDEO3DPOINTINFO",e[e.CONFIGID_VIDEO3DADDPOINT=1911]="CONFIGID_VIDEO3DADDPOINT",e[e.CONFIGID_VIDEO3DDELETEPOINT=1912]="CONFIGID_VIDEO3DDELETEPOINT",e[e.CONFIGID_VIDEO3DFRAMECOUNT=1913]="CONFIGID_VIDEO3DFRAMECOUNT",e[e.CONFIGID_VIDEO3DFRAMEINFO=1914]="CONFIGID_VIDEO3DFRAMEINFO",e[e.CONFIGID_VIDEO3DADDFRAME=1915]="CONFIGID_VIDEO3DADDFRAME",e[e.CONFIGID_VIDEO3DDELETEFRAME=1916]="CONFIGID_VIDEO3DDELETEFRAME",e[e.CONFIGID_VIDEO3DCLEARFRAMES=1917]="CONFIGID_VIDEO3DCLEARFRAMES",e[e.CONFIGID_VIDEO3DCOPYFRAME=1918]="CONFIGID_VIDEO3DCOPYFRAME",e[e.CONFIGID_VIDEO3DSAMEFRAMES=1919]="CONFIGID_VIDEO3DSAMEFRAMES",e[e.CONFIGID_VIDEO3DLINEARFRAMES=1920]="CONFIGID_VIDEO3DLINEARFRAMES",e[e.CONFIGID_VIDEO3DEDITMODE=1921]="CONFIGID_VIDEO3DEDITMODE",e[e.CONFIGID_VIDEO3DSELECTTOOL=1922]="CONFIGID_VIDEO3DSELECTTOOL",e[e.CONFIGID_VIDEO3DMAGICADMIT=1923]="CONFIGID_VIDEO3DMAGICADMIT",e[e.CONFIGID_VIDEO3DLOADFROMFILE=1924]="CONFIGID_VIDEO3DLOADFROMFILE",e[e.CONFIGID_VIDEO3DSAVETOFILE=1925]="CONFIGID_VIDEO3DSAVETOFILE",e[e.CONFIGID_WIDIENABLE=2001]="CONFIGID_WIDIENABLE",e[e.CONFIGID_WIDIADAPTERLIST=2002]="CONFIGID_WIDIADAPTERLIST",e[e.CONFIGID_WIDICONNECT=2003]="CONFIGID_WIDICONNECT",e[e.CONFIGID_WIDIDISCONNECT=2004]="CONFIGID_WIDIDISCONNECT",e[e.CONFIGID_WIDISETMODE=2005]="CONFIGID_WIDISETMODE",e[e.CONFIGID_WIDISEARCHDEVICE=2006]="CONFIGID_WIDISEARCHDEVICE",e[e.CONFIGID_SUBTITLE2USABLE=2101]="CONFIGID_SUBTITLE2USABLE",e[e.CONFIGID_SUBTITLE2EXTNAMELIST=2102]="CONFIGID_SUBTITLE2EXTNAMELIST",e[e.CONFIGID_SUBTITLE2FILENAME=2103]="CONFIGID_SUBTITLE2FILENAME",e[e.CONFIGID_SUBTITLE2SHOW=2104]="CONFIGID_SUBTITLE2SHOW",e[e.CONFIGID_SUBTITLE2LANGUAGELIST=2105]="CONFIGID_SUBTITLE2LANGUAGELIST",e[e.CONFIGID_SUBTITLE2LANGUAGECURRENT=2106]="CONFIGID_SUBTITLE2LANGUAGECURRENT",e[e.CONFIGID_SUBTITLE2PLACEMENT=2107]="CONFIGID_SUBTITLE2PLACEMENT",e[e.CONFIGID_SUBTITLE2FONT=2108]="CONFIGID_SUBTITLE2FONT",e[e.CONFIGID_SUBTITLE2TIMING=2109]="CONFIGID_SUBTITLE2TIMING",e[e.CONFIGID_SUBTITLE23D=2110]="CONFIGID_SUBTITLE23D",e[e.CONFIGID_SUBTITLE2CONTENT=2111]="CONFIGID_SUBTITLE2CONTENT",e[e.CONFIGID_CACHEFILENAME=2201]="CONFIGID_CACHEFILENAME",e[e.CONFIGID_CACHECLEAR=2202]="CONFIGID_CACHECLEAR",e[e.CONFIGID_CACHEDOWNLOADLIST=2203]="CONFIGID_CACHEDOWNLOADLIST",e[e.CONFIGID_CACHECOMPLETED=2204]="CONFIGID_CACHECOMPLETED",e[e.CONFIGID_CACHECONVERT=2205]="CONFIGID_CACHECONVERT",e[e.CONFIGID_CACHEIGNORECOMPAREURL=2206]="CONFIGID_CACHEIGNORECOMPAREURL",e[e.CONFIGID_CACHEGREED=2207]="CONFIGID_CACHEGREED",e[e.CONFIGID_SPRITEUSABLE=2301]="CONFIGID_SPRITEUSABLE",e[e.CONFIGID_SPRITELIST=2302]="CONFIGID_SPRITELIST",e[e.CONFIGID_SPRITEADD=2303]="CONFIGID_SPRITEADD",e[e.CONFIGID_SPRITEDELETE=2304]="CONFIGID_SPRITEDELETE",e[e.CONFIGID_SPRITECURRENT=2305]="CONFIGID_SPRITECURRENT",e[e.CONFIGID_SPRITEBOUND=2306]="CONFIGID_SPRITEBOUND",e[e.CONFIGID_SPRITEPOSITION=2307]="CONFIGID_SPRITEPOSITION",e[e.CONFIGID_SPRITEMOVETO=2308]="CONFIGID_SPRITEMOVETO",e[e.CONFIGID_SPRITESELECTVIDEO=2309]="CONFIGID_SPRITESELECTVIDEO",e[e.CONFIGID_SPRITESELECTRECT=2310]="CONFIGID_SPRITESELECTRECT",e[e.CONFIGID_SPRITESHOWSELECT=2311]="CONFIGID_SPRITESHOWSELECT",e[e.CONFIGID_SPRITEATTACHVIDEO=2312]="CONFIGID_SPRITEATTACHVIDEO",e[e.CONFIGID_SPRITEATTACHTOVR=2313]="CONFIGID_SPRITEATTACHTOVR",e[e.CONFIGID_VRENABLE=2401]="CONFIGID_VRENABLE",e[e.CONFIGID_VRMODE=2402]="CONFIGID_VRMODE",e[e.CONFIGID_VRPOSITION=2403]="CONFIGID_VRPOSITION",e[e.CONFIGID_VRDEVICE=2404]="CONFIGID_VRDEVICE",e[e.CONFIGID_VRDELAY=2405]="CONFIGID_VRDELAY",e[e.CONFIGID_VRCIRCULARPARAMETER=2406]="CONFIGID_VRCIRCULARPARAMETER",e[e.CONFIGID_VRMONITORPARAMETER=2407]="CONFIGID_VRMONITORPARAMETER",e[e.CONFIGID_VRFILLBAND=2408]="CONFIGID_VRFILLBAND",e[e.CONFIGID_VRFOCUSPOSITION=2409]="CONFIGID_VRFOCUSPOSITION",e[e.CONFIGID_VRQUALITY=2410]="CONFIGID_VRQUALITY",e[e.CONFIGID_DNNVSRMODEL=2802]="CONFIGID_DNNVSRMODEL",e[e.CONFIGID_DNNENABLEVSR=2803]="CONFIGID_DNNENABLEVSR",e[e.CONFIGID_DNNIMAGESR=2804]="CONFIGID_DNNIMAGESR"}(t.APlayerConfigId||(t.APlayerConfigId={})),function(e){e[e.EVENTCODE_BASE=1e4]="EVENTCODE_BASE",e[e.EVENTCODE_MULTISOURCE=10001]="EVENTCODE_MULTISOURCE",e[e.EVENTCODE_DVD=10002]="EVENTCODE_DVD",e[e.EVENTCODE_STEPCOMPLETED=10003]="EVENTCODE_STEPCOMPLETED",e[e.EVENTCODE_DLNA=10004]="EVENTCODE_DLNA",e[e.EVENTCODE_GIFCOMPLETED=10005]="EVENTCODE_GIFCOMPLETED",e[e.EVENTCODE_WIDI=10006]="EVENTCODE_WIDI",e[e.EVENTCODE_VIDEO3D=10007]="EVENTCODE_VIDEO3D",e[e.EVENTCODE_SPRITE=10008]="EVENTCODE_SPRITE",e[e.EVENTCODE_PLAYLIST=10009]="EVENTCODE_PLAYLIST",e[e.EVENTCODE_PLAYCOMPLETE=10010]="EVENTCODE_PLAYCOMPLETE",e[e.EVENTCODE_DNNIMAGESR=10013]="EVENTCODE_DNNIMAGESR"}(t.APlayerEventCode||(t.APlayerEventCode={}))},function(e,t){e.exports=require("events")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.FileSystemAWNS=void 0;const o=i(23),r=i(1),a=i(20),s=i(22),l=a.promisify,d=i(0).default.getLogger("Thunder.base.fs-utilities");!function(e){function t(e){return n(this,void 0,void 0,function*(){let t=null;if(void 0!==e){const i=l(o.open);try{t=yield i(e,"r")}catch(e){d.warning(e)}}return t})}function i(e){return n(this,void 0,void 0,function*(){let t=!1;if(void 0!==e){const i=l(o.access);try{yield i(e),t=!0}catch(e){d.information(e)}}return t})}function a(e){return n(this,void 0,void 0,function*(){let t=!1;if(void 0!==e){const i=l(o.mkdir);try{yield i(e),t=!0}catch(e){d.warning(e)}}return t})}function u(e){return n(this,void 0,void 0,function*(){let t=!1;if(void 0!==e){const i=l(o.rmdir);try{yield i(e),t=!0}catch(e){d.warning(e)}}return t})}function c(e){return n(this,void 0,void 0,function*(){let t=!1;if(void 0!==e){const i=l(o.unlink);try{yield i(e),t=!0}catch(e){d.warning(e)}}return t})}function h(e){return n(this,void 0,void 0,function*(){let t=null;if(void 0!==e){const i=l(o.readdir);try{t=yield i(e)}catch(e){d.warning(e)}}return t})}function p(e){return n(this,void 0,void 0,function*(){let t=null;if(void 0!==e){const i=l(o.lstat);try{t=yield i(e)}catch(e){d.warning(e)}}return t})}function f(e,t){return n(this,void 0,void 0,function*(){let i=!1;if(void 0!==e&&void 0!==t){let n=r.join(e,t),o=yield p(n);i=null!==o&&o.isDirectory()?yield m(n):yield c(n)}return i})}function m(e){return n(this,void 0,void 0,function*(){let t=!1;if(void 0!==e){if(yield i(e)){t=!0;let i=yield h(e);for(let n=0;n<i.length;n++)t=(yield f(e,i[n]))&&t;(t||0===i.length)&&(t=(yield u(e))&&t)}}return t})}function g(e){return n(this,void 0,void 0,function*(){let t=!1;return d.information("mkdirsAW",e),void 0!==e&&((yield i(e))?t=!0:r.dirname(e)===e?t=!1:(yield g(r.dirname(e)))&&(t=yield a(e))),t})}function S(e,t){return n(this,void 0,void 0,function*(){let n;if(e.toLowerCase()!==t.toLowerCase()&&(yield i(e))){let i=o.createReadStream(e),r=o.createWriteStream(t);n=new Promise(e=>{i.pipe(r).on("finish",()=>{e(!0)})})}else n=new Promise(e=>{e(!1)});return n})}e.readFileAW=function(e){return n(this,void 0,void 0,function*(){let t=null;if(void 0!==e){const i=l(o.readFile);try{t=yield i(e)}catch(e){d.warning(e)}}return t})},e.openFile=t,e.readFilePartAw=function(e,i,r,a=0){return n(this,void 0,void 0,function*(){let n={bytesRead:0,buffer:new Buffer(0)},s=yield t(e);if(!s)return n;const u=l(o.read);try{let e=new Buffer(r);n=yield u(s,e,i,r,a),e=void 0}catch(e){d.warning(e)}return yield l(o.close)(s),n})},e.writeFileAW=function(e,t){return n(this,void 0,void 0,function*(){let i=!1;if(void 0!==e&&null!==t){const n=l(o.writeFile);try{yield n(e,t),i=!0}catch(e){d.warning(e)}}return i})},e.existsAW=i,e.mkdirAW=a,e.rmdirAW=u,e.unlinkAW=c,e.readdirAW=h,e.readdirAllFiles=function e(t){return n(this,void 0,void 0,function*(){let n=!1,o=[],a=yield p(t),s=yield h(t);for(let l=0;l<s.length;l++){let d=r.join(t,s[l]);(n=yield i(d))&&((a=yield p(d)).isDirectory()?o.push(...yield e(d)):o.push(d))}return o})},e.lstatAW=p,e.rmdirsAW=m,e.mkdirsAW=g,e.renameAW=function(e,t){return n(this,void 0,void 0,function*(){if(void 0!==e&&void 0!==t){const i=l(o.rename);try{yield i(e,t)}catch(e){d.warning(e)}}})},e.copyFileAW=S,e.copyDirsAW=function e(t,o){return n(this,void 0,void 0,function*(){let n=!1,a=yield p(t);if(a.isDirectory()){n=yield g(o);let s=yield h(t);for(let l=0;l<s.length;l++){let d=r.join(t,s[l]),u=r.join(o,s[l]);(n=yield i(d))&&(n=(a=yield p(d)).isDirectory()?yield e(d,u):yield S(d,u))}}return n})},e.mkdtempAW=function(){return n(this,void 0,void 0,function*(){let e=!1;const t=l(o.mkdtemp),i=s.tmpdir();try{e=yield t(`${i}${r.sep}`)}catch(e){d.warning(e)}return e})},e.getFileSize=function e(t){return n(this,void 0,void 0,function*(){let n=0;do{if(!t)break;if(!(yield i(t)))break;let o=yield p(t);if(o)if(o.isDirectory()){let i=yield h(t);for(let o=0;o<i.length;o++)n+=(yield e(r.join(t,i[o])))}else n=o.size}while(0);return n})}}(t.FileSystemAWNS||(t.FileSystemAWNS={}))},function(e,t,i){"use strict";var n=i(67),o=i(112),r=Object.prototype.toString;function a(e){return"[object Array]"===r.call(e)}function s(e){return null!==e&&"object"==typeof e}function l(e){return"[object Function]"===r.call(e)}function d(e,t){if(null!==e&&void 0!==e)if("object"!=typeof e&&(e=[e]),a(e))for(var i=0,n=e.length;i<n;i++)t.call(null,e[i],i,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===r.call(e)},isBuffer:o,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===r.call(e)},isFile:function(e){return"[object File]"===r.call(e)},isBlob:function(e){return"[object Blob]"===r.call(e)},isFunction:l,isStream:function(e){return s(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:d,merge:function e(){var t={};function i(i,n){"object"==typeof t[n]&&"object"==typeof i?t[n]=e(t[n],i):t[n]=i}for(var n=0,o=arguments.length;n<o;n++)d(arguments[n],i);return t},extend:function(e,t,i){return d(t,function(t,o){e[o]=i&&"function"==typeof t?n(t,i):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigNS=t.Config=void 0;const o=i(23),r=i(0),a=i(24),s=i(13),l=i(53),d=r.default.getLogger("Config");class u{constructor(){this.isInit=!1,this.configData={},this.configPath=void 0,this.configBakPath=void 0,this.eventContainer=new a.default,this.changed=!1,this.timer=null,this.eventContainer.setMaxListeners(0)}init(e){return n(this,void 0,void 0,function*(){if(!this.isInit){this.configPath=e,this.configBakPath=e+".bak";let t=null,i=yield s.FileSystemAWNS.existsAW(e);if(i){let i=yield s.FileSystemAWNS.readFileAW(e);if(i&&i.length>0)try{t=JSON.parse(i.toString())}catch(e){d.warning(e)}}if(!t&&(i=yield s.FileSystemAWNS.existsAW(this.configBakPath))){let e=yield s.FileSystemAWNS.readFileAW(this.configBakPath);if(e&&e.length>0)try{t=JSON.parse(e.toString())}catch(e){d.warning(e)}}t&&this.mergeConfigData(t),this.isInit=!0,this.eventContainer.fireEvent(l.NodeEventMesssageNS.eventConfigInitFinished)}this.timer||(this.timer=setInterval(()=>{this.changed&&(this.changed=!1,this.save().catch())},5e3))})}initSync(e){if(!this.isInit){this.configPath=e,this.configBakPath=e+".bak";let t=null,i=o.existsSync(e);if(i){let i=o.readFileSync(e);if(i)try{t=JSON.parse(i.toString())}catch(e){d.warning(e)}}if(!t&&(i=o.existsSync(this.configBakPath))){let e=o.readFileSync(this.configBakPath);if(e)try{t=JSON.parse(e.toString())}catch(e){d.warning(e)}}t&&this.mergeConfigData(t),this.isInit=!0,this.eventContainer.fireEvent(l.NodeEventMesssageNS.eventConfigInitFinished)}this.timer||(this.timer=setInterval(()=>{this.changed&&(this.changed=!1,this.save().catch())},5e3))}getValue(e,t,i){let n=i;do{if(!e||""===e)break;if(!t||""===t)break;let i=this.configData[e];if(!i)break;t in i&&(n=i[t])}while(0);return n}setValue(e,t,i){do{if(!e||""===e)break;if(!t||""===t)break;let n=void 0,o=this.configData[e];if(o)n=o[t],o[t]=i;else{let n={};n[t]=i,this.configData[e]=n}n!==i&&(this.changed=!0,this.fireValueChangedEvent(e,t,n,i))}while(0)}removeValue(e,t){do{if(!e||""===e)break;if(!t||""===t)break;let i=void 0,n=this.configData[e];n&&(i=n[t],n[t]=void 0),void 0!==i&&this.fireValueChangedEvent(e,t,i,void 0)}while(0)}isInitConfigFinished(){return this.isInit}save(){return n(this,void 0,void 0,function*(){if(this.isInit){let e=JSON.stringify(this.configData,void 0,2);yield s.FileSystemAWNS.writeFileAW(this.configPath,e),yield s.FileSystemAWNS.writeFileAW(this.configBakPath,e)}})}saveSync(){if(this.isInit){let e=JSON.stringify(this.configData,void 0,2);o.writeFileSync(this.configPath,e),o.writeFileSync(this.configBakPath,e)}}attachListener(e,t){do{if(e===l.NodeEventMesssageNS.eventConfigInitFinished){if(this.isInit){t(this.isInit);break}this.eventContainer.attachOnceListener(e,t);break}this.eventContainer.attachListener(e,t)}while(0)}detachListener(e,t){this.eventContainer.detachListener(e,t)}prependListener(e,t){do{if(e===l.NodeEventMesssageNS.eventConfigInitFinished){if(this.isInit){t(this.isInit);break}this.eventContainer.prependOnceListener(e,t);break}this.eventContainer.prependListener(e,t)}while(0)}mergeConfigData(e){e&&(null===this.configData?this.configData=e:this.configData=Object.assign(e,this.configData))}fireValueChangedEvent(e,t,i,n){this.eventContainer.fireEvent(l.NodeEventMesssageNS.eventConfigValueChanged,e,t,i,n)}}t.Config=u;const c=new u;!function(e){e.init=function(e){return n(this,void 0,void 0,function*(){yield c.init(e)})},e.initSync=function(e){c.initSync(e)},e.isInitConfigFinished=function(){return c.isInitConfigFinished()},e.save=function(){return n(this,void 0,void 0,function*(){yield c.save()})},e.saveSync=function(){c.saveSync()},e.getValue=function(e,t,i){return c.getValue(e,t,i)},e.setValue=function(e,t,i){c.setValue(e,t,i)},e.attachListener=function(e,t){c.attachListener(e,t)},e.prependListener=function(e,t){c.prependListener(e,t)},e.detachListener=function(e,t){c.detachListener(e,t)}}(t.ConfigNS||(t.ConfigNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.XmpUtilityNS=void 0;const o=i(1),r=i(9),a=i(13),s=i(52),l=i(17),d=i(22),u=i(10),c=i(15);let h=null,p=null;!function(e){const t=[".3g2",".3gp",".3gp2",".3gpp",".aac",".ac3",".acc",".aiff",".amr",".amv",".ape",".asf",".avi",".au",".bik",".cda",".csf",".dts",".dat",".divx",".dvd",".evo",".flac",".flv",".f4v",".hlv",".m1a",".m2a",".m4a",".mka",".mod",".mp2",".mp3",".mpa",".mpc",".mid",".midi",".m1v",".m2p",".m2ts",".m2v",".m4b",".m4p",".m4r",".m4v",".mkv",".mov",".mp4",".mpe",".mpeg",".mpeg1",".mpeg2",".mpeg4",".mpg",".mpv2",".mts",".mp2v",".ogg",".oga",".ogm",".ogv",".ogx",".pss",".pva",".pmp",".qt",".ra",".ram",".rm",".rmvb",".rp",".rpm",".rt",".scm",".smil",".swf",".tta",".tp",".tpr",".ts",".vob",".vp6",".wav",".wma",".wm",".wmp",".wmv",".wv",".hflv",".f5v",".hmp4",".mp5",".hmkv",".mk5",".m3u8"],i=[".idx",".smi",".sub",".psb",".ssa",".ass",".usf",".ssf",".srt",".sup"],f=[".exe",".dll",".bat",".com",".sys",".ini",".inf",".cat",".msc"];function m(){return t}function g(e){let i=!1;do{if(null===e||void 0===e||""===e)break;let n=o.extname(e);".xltd"===n&&(e=o.basename(e,n),".bt"!==(n=o.extname(e))&&".emule"!==n||(e=o.basename(e,n),n=o.extname(e)));for(let e=0;e<t.length;++e)if(n.toLowerCase()===t[e]){i=!0;break}}while(0);return i}function S(){return h||(h=r.default(o.join(__dirname,"bin/XmpPlayer.node"))),h}function y(){return p||(p=r.default(o.join(__rootDir,"../bin/ThunderHelper.node"))),p}function C(t){let i=!1;do{if(!t)break;t=t.toLowerCase();for(let n=0;n<e.networkPrefixs.length;++n)if(0===t.indexOf(e.networkPrefixs[n])){i=!0;break}}while(0);return i}function I(e){let t=!1;do{if(!e)break;if(1===e.indexOf(":\\")||1===e.indexOf(":/")){t=!0;break}}while(0);return t}function v(e){let t=!1;do{if(!e)break;if(0===e.indexOf("\\\\")){t=!0;break}}while(0);return t}function T(e){let t=!1;do{if(!I(e))break;g(e)&&(t=!0)}while(0);return t}function E(e){let t=!1;do{if(!e)break;if(0===(e=e.toLowerCase()).indexOf("http://")){(".m3u8"===o.extname(e)||e.indexOf("m3u8?")>-1)&&(t=!0);break}}while(0);return t}e.getVideoFormatExt=m,e.getNoDotVideoExts=function(){let e=m().join(";");return(e=e.replace(/\./g,"")).split(";")},e.isBlackExtFile=function(e){let t=!1;do{if(null===e||void 0===e||""===e)break;let i=o.extname(e);if(!i)break;for(let e=0;e<f.length;++e)if(i.toLowerCase()===f[e]){t=!0;break}}while(0);return t},e.isVideoFile=g,e.isUnfinishedVideoFile=function(e){let i=!1;do{if(null===e||void 0===e||""===e)break;let n=o.extname(e);if(".xltd"!==n)break;n=o.extname(o.basename(e,n));for(let e=0;e<t.length;++e)if(n.toLowerCase()===t[e]){i=!0;break}}while(0);return i},e.getSubtitleFormatExt=function(){return i},e.isSubtitleFile=function(e){let t=!1;do{if(null===e||void 0===e||""===e)break;let n=o.extname(e);for(let e=0;e<i.length;++e)if(n.toLowerCase()===i[e]){t=!0;break}}while(0);return t},e.getXmpPlayer=S,e.getThunderHelper=y,e.networkPrefixs=["http://","https://","ftp://","mms://","thunder:","gvod://","ed2k://","magnet:?","srtsp://","rtsp://","rtmp://"],e.isNetworkPath=C,e.isLocalPath=I,e.isLanPath=v,e.isMagnetPath=function(e){let t=!1;do{if(!e)break;if(0===(e=e.toLowerCase()).indexOf("magnet:?")){t=!0;break}}while(0);return t},e.isTorrentPath=function(e){let t=!1;do{if(!e)break;if(C(e))break;e=e.toLowerCase(),".torrent"===o.extname(e)&&(t=!0)}while(0);return t},e.isLocalNetworkUrl=function(e){let t=!1;do{if(!e)break;if(E(e=e.toLowerCase()))break;t=y().isLocalNetworkUrl(e)}while(0);return t},e.isGvodPath=function(e){let t=!1;do{if(!e)break;if(E(e=e.toLowerCase()))break;if(y().isLocalNetworkUrl(e))break;0!==e.indexOf("ed2k://")&&0!==e.indexOf("http://")&&0!==e.indexOf("https://")&&0!==e.indexOf("ftp://")&&0!==e.indexOf("thunder:")||(t=!0)}while(0);return t},e.isLocalUrl=function(e){let t=!1;do{if(!e)break;if(0===(e=e.toLowerCase()).indexOf("http://127.0.0.1")){t=!0;break}}while(0);return t},e.isValidUrlOrPath=function(e){let t=!1;return(I(e)||v(e)||C(e))&&(t=!0),t},e.isLocalVideo=T,e.isDirectory=function(e){return n(this,void 0,void 0,function*(){let t=!1;do{if(!e)break;let i=yield a.FileSystemAWNS.lstatAW(e);if(!i)break;t=i.isDirectory()}while(0);return t})},e.createDefaultSnapshotDir=function(){return n(this,void 0,void 0,function*(){let e=o.join(__xmpProfilesDir,"截图");do{if(!e)break;(yield a.FileSystemAWNS.existsAW(e))||(yield a.FileSystemAWNS.mkdirAW(e))||(e=o.join(d.homedir(),"Desktop"))}while(0);return e})},e.isM3u8Url=E,e.generateMediaId=function(){let e=(new Date).getTime().toString();return e=e.substr(8,e.length-8),e=(1e5*Math.random()+1e4).toString().substr(0,5)+e,parseInt(e,10)},e.calculateFileCidAW=function(e){return n(this,void 0,void 0,function*(){do{if(!e)break;if(!(yield a.FileSystemAWNS.existsAW(e)))break;return new Promise(t=>{S().calculateFileCID(e,e=>{t(e)})})}while(0);return""})},e.getMediaInfo=function(e){return n(this,void 0,void 0,function*(){do{if(!e)break;if(!(yield a.FileSystemAWNS.existsAW(e)))break;return new Promise(t=>{S().getMediaInfo(e,e=>{t(e)})})}while(0);return""})},e.getXmpCachePath=function(){return n(this,void 0,void 0,function*(){let e=yield s.ConfigHelperNS.getValue(l.ConfigDefineNS.cacheFilePaths.section,l.ConfigDefineNS.cacheFilePaths.key,l.ConfigDefineNS.cacheFilePaths.value);if(!e||""===e){let t="HKEY_LOCAL_MACHINE",i="SOFTWARE\\Thunder Network\\Xmp",n="StorePath";e=y().readRegString(t,i,n)}return e&&""!==e||(e="C:/XmpCache"),e})},e.isEmbedMode=function(){return c.ConfigNS.getValue(l.ConfigDefineNS.showMode.section,l.ConfigDefineNS.showMode.key,l.ConfigDefineNS.showMode.value)===u.XmpMode.EMBED_MODE},e.isMagneticMode=function(){return c.ConfigNS.getValue(l.ConfigDefineNS.showMode.section,l.ConfigDefineNS.showMode.key,l.ConfigDefineNS.showMode.value)===u.XmpMode.MAGNETIC_MODE},e.setXmpCachePath=function(e){return n(this,void 0,void 0,function*(){do{if(!e)break;s.ConfigHelperNS.setValue(l.ConfigDefineNS.cacheFilePaths.section,l.ConfigDefineNS.cacheFilePaths.key,e).catch()}while(0)})},e.getXmpCodecsPath=function(){return n(this,void 0,void 0,function*(){return o.join(__rootDir,"../../codecs")})};let b=void 0;function P(){return b||(b="1.0.0"),b}e.getXmpVersion=P;let w=void 0;function D(e,t){let i=e.length,n=t.length,o=0,r=0,a=0,s=[],l=void 0,d=void 0;if(0===i)return n;if(0===n)return i;for(o=0;o<=i;o++)s[o]=[],s[o][0]=o;for(r=0;r<=n;r++)s[0][r]=r;for(o=1;o<=i;o++)for(l=e.charAt(o-1),r=1;r<=n;r++)a=l===(d=t.charAt(r-1))?0:1,s[o][r]=(u=s[o-1][r]+1,c=s[o][r-1]+1,h=s[o-1][r-1]+a,u<c?u<h?u:h:c<h?c:h);var u,c,h;return s[i][n]}e.getXmpBuildNum=function(){if(void 0===w){let e=P().split(".");e&&4===e.length&&(w=Number(e[3]).valueOf())}return w},e.stringSimilarityNumber=D,e.stringSimilarityPercent=function(e,t){e=o.basename(e,o.extname(e)).toLowerCase(),t=o.basename(t,o.extname(t)).toLowerCase();let i=e.length>t.length?e.length:t.length,n=1-D(e,t)/i;return n=100*Number(n.toFixed(4))},e.isPlayLoad=function(e){return n(this,void 0,void 0,function*(){let t=!1;if(e&&e.length>0){for(let i=0;i<e.length;++i)if(e[i]){if(e[i].indexOf("ThunderPanPlugin")>-1)return t=!0;if(e[i].indexOf("addtolist")>-1)return t}let i=0;if(e[0].toLowerCase().indexOf("xmp.exe")>-1&&(i=1),C(e[i]))t=!0;else if(T(e[i]))t=!0;else if("/play"===e[i])T(e[i+1])&&(t=!0);else if("/sopenfrom"===e[i]){let n=e[++i];n&&"wndexplr"===n.toLowerCase()&&"/sstartfrom"===e[++i]&&(n=e[++i])&&"localfile"===n.toLowerCase()&&(t=!0)}else if("/sstartfrom"===e[i]){let n=e[i+1];n&&"xl11"===n.toLowerCase()&&(t=!0)}}return t})},e.getThunderPath=function(){return y().readRegString("HKEY_LOCAL_MACHINE","SOFTWARE\\Thunder Network\\ThunderOem\\thunder_backwnd","Path")},e.getHotKeyStr=function(e){let t="";if(""===e)return t;-1!==e.indexOf("ctrl")&&(t+="Ctrl+"),-1!==e.indexOf("alt")&&(t+="Alt+"),-1!==e.indexOf("shift")&&(t+="Shift+");let i=e.lastIndexOf("+");return-1!==i&&(e=e.slice(i+1)),t+=e="arrowleft"===e?"←":"arrowright"===e?"→":"arrowup"===e?"↑":"arrowdown"===e?"↓":" "===e?"空格":"enter"===e?"回车":"pageup"===e?"PageUp":"pagedown"===e?"PageDown":e.toLocaleUpperCase()},e.getSnapshotTempTime=function(e){let t=0;return t=e<6e5?2:e<18e5?5:e<3e6?8:e<72e5?10:e<108e5?15:e<18e6?30:60},e.sortByFileName=function e(t,i){t=t.toLocaleLowerCase(),i=i.toLocaleLowerCase();let n=/[0-9]+/g,o=t.match(n),r=i.match(n);if(!o||!r)return t.localeCompare(i);let a=o[0],s=r[0],l=t.indexOf(a.toString()),d=i.indexOf(s.toString());return l!==d?t.localeCompare(i):t.substr(0,l)!==i.substr(0,d)?t.localeCompare(i):a!==s?a-s:e(t.substr(l+a.toString().length),i.substr(d+s.toString().length))}}(t.XmpUtilityNS||(t.XmpUtilityNS={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigDefineNS=void 0,function(e){let t,i,n,o,r,a,s,l,d,u,c,h,p,f,m,g,S;e.aplayerSection="APlayerConfig",e.hotKeySection="HotKeyConfig",e.xmpSetting="XmpSettingConfig",e.xmpShowMode="XmpShowMode",e.configNormalSection="ConfigNormalSection",e.configPlaySection="ConfigPlaySection",e.configOtherSection="ConfigOtherSection",e.configSubtitle="ConfigSubtitle",e.configSubtitle2="ConfigSubtitle2",e.configTestServer="ConfigTestServer",e.configClearBlack="ConfigClearBlack",e.configDefaultPlayer="ConfigDefaultPlayer",e.configAIFirstGuide="{8F8E9B59-D8CE-471D-9701-8677BF7BB210}",function(e){e.speedUpEnable="SpeedUpEnable",e.imageNormalSize="ImageNormalSize",e.playSpeed="PlaySpeed",e.lastPlayMediaId="LastPlayMediaId",e.mediaVolume="Volume",e.audioNormalize="AudioNormalize",e.frameProportion="FrameProportion",e.brightness="Brightness",e.contrastRatio="ContrastRatio",e.saturation="Saturation",e.fullScreenShow="FullScreenShow",e.noAssocExt="NoAssocExt",e.assocExt="AssocExt",e.alwaysAssociate="AlwaysAssociate",e.agreeVolume="AgreeVolume",e.playListMode="PlayListMode",e.soundBalance="soundBalance",e.soundDevice="SoundDevice",e.aiFirstGuide="aiFirstGuide"}(t=e.aplayerKey||(e.aplayerKey={})),function(e){e.closeOption="CloseOption",e.clearPlayRecord="ClearPlayRecord",e.rememberPlayPosition="RememberPlayPosition",e.rememberWindowSize="RememberWindowSize",e.autoRun="AutoRun",e.minizeStopPlay="MinizeStopPlay",e.playCtrlPrevNext="PlayCtrlPrevNext",e.playFullSceen="PlayFullSceen",e.cacheFilePaths="CacheFilePaths",e.snapShotFormat="SnapShotFormat",e.snapShotSaveDir="SnapShotSaveDir",e.autoAddFile="AutoAddFile",e.saveFileMode="SaveFileMode",e.picIncludeSub="PicIncludeSub",e.cacheSize="CacheSize",e.afterOpenBigSetTab="AfterOpenBigSetTab",e.afterOpenSmallSetTab="AfterOpenSmallSetTab",e.playFrameSeek="PlayFrameSeek",e.videoRatio="VideoRatio",e.render="Render",e.renderChanged="RenderChanged",e.lastRrender="LastRrender",e.speedOneText="SpeedOneText",e.speedTwoText="SpeedTwoText",e.speedThreeText="SpeedThreeText",e.playSettingAll="PlaySettingAll",e.playOrderMode="PlayOrderMode",e.audioChannel="AudioChannel",e.outputMode="OutputMode",e.rememberSpeed="RememberSpeed",e.rememberProgress="RememberProgress",e.speedMode="SpeedMode",e.downloadSpeed="DownloadSpeed",e.uploadSpeed="UploadSpeed",e.clearBlack="ClearBlack",e.showPreView="ShowPreView",e.windowPosMode="WindowPosMode",e.defaultPlayer="DefaultPlayer",e.showTime="ShowTime",e.startUpCount="StartUpCount",e.volumeAround="VolumeAround",e.noSign="noSign",e.kbSeekMode="kbseekMode",e.syncThunder="SyncThunder",e.noshowThDir="NoShowThDir",e.showSyncThDia="showSyncThDia"}(i=e.settingKey||(e.settingKey={})),function(e){e.play="Play",e.stop="Stop",e.fast="Fast",e.back="Back",e.fastMore="FastMore",e.backMore="BackMore",e.speedUp="SpeedUp",e.speedSlow="SpeedSlow",e.speedOne="SpeedOne",e.speedTwo="SpeedTwo",e.speedThree="SpeedThree",e.setAPoint="setAPoint",e.setBPoint="SetAPoint",e.cancelABPoint="CancelABPoint",e.addVolume="AddVolume",e.reduceVolume="ReduceVolume",e.silent="Silent",e.imageEnhance="ImageEnhance",e.onTopMost="OnTopMost",e.full="Full",e.clockWise="ClockWise",e.antiClockWise="AntiClockWise",e.openFile="OpenFile",e.openURL="OpenURL",e.preFile="PreFile",e.nextFile="NextFile",e.subtitleUp="SubtitleUp",e.subtitleDown="SubtitleDown",e.saveImage="SaveImage",e.systemSetting="SystemSetting",e.bossKey="BossKey",e.quit="Quit",e.preSecond="PreSecond",e.nextSecond="NextSecond",e.exactPreSecond="exactPreSecond",e.exactNextSecond="exactNextSecond"}(n=e.hotkey||(e.hotkey={})),function(e){e.size="Size",e.color="Color",e.font="Font",e.position="Position",e.useHardware="UseHardware"}(o=e.subtitle||(e.subtitle={})),function(e){e.size2="Size2",e.color2="Color2",e.font2="Font2",e.position2="Position2"}(r=e.subtitle2||(e.subtitle2={})),function(e){e.showMode="ShowMode",e.barAutoHide="BarAutoHide",e.transparent="Transparent",e.topMost="TopMost"}(a=e.showModeKey||(e.showModeKey={})),function(e){e.testServer="TestServer"}(s=e.otherKey||(e.otherKey={})),function(e){e[e.testServer=0]="testServer"}(l=e.otherValue||(e.otherValue={})),function(e){e[e.speedUpEnable=1]="speedUpEnable",e[e.imageNormalSize=0]="imageNormalSize",e[e.playSpeed=100]="playSpeed",e[e.lastPlayMediaId=0]="lastPlayMediaId",e[e.mediaVolume=50]="mediaVolume",e[e.audioNormalize=0]="audioNormalize",e.frameProportion="normal",e[e.brightness=50]="brightness",e[e.contrastRatio=50]="contrastRatio",e[e.saturation=50]="saturation",e.fullScreenShow="0;0;0;0",e.noAssocExt="",e.assocExt="",e[e.alwaysAssociate=1]="alwaysAssociate",e[e.agreeVolume=0]="agreeVolume",e[e.playListMode=0]="playListMode",e[e.soundBalance=50]="soundBalance",e.soundDevice="默认设置"}(d=e.aplayerValue||(e.aplayerValue={})),function(e){e[e.switch=0]="switch",e[e.fast=1]="fast"}(u=e.playCtrlPrevNextValue||(e.playCtrlPrevNextValue={})),function(e){e.JPG="JPG",e.BMP="BMP",e.PNG="PNG"}(c=e.snapShotFormatValue||(e.snapShotFormatValue={})),function(e){e[e.size=void 0]="size",e[e.color=void 0]="color",e[e.font=void 0]="font",e[e.position=95]="position",e[e.noUseHardware=0]="noUseHardware",e[e.useHardware=1]="useHardware"}(h=e.subtitleValue||(e.subtitleValue={})),function(e){e[e.size2=void 0]="size2",e[e.color2=void 0]="color2",e[e.font2=void 0]="font2",e[e.position2=95]="position2"}(p=e.subtitle2Value||(e.subtitle2Value={})),function(e){e.play=" ",e.stop="ctrl+s",e.fast="arrowright",e.back="arrowleft",e.fastMore="ctrl+arrowright",e.backMore="ctrl+arrowleft",e.speedUp="ctrl+arrowup",e.speedSlow="ctrl+arrowdown",e.speedOne="ctrl+1",e.speedTwo="ctrl+2",e.speedThree="ctrl+3",e.setAPoint="ctrl+4",e.setBPoint="ctrl+5",e.cancelABPoint="ctrl+6",e.addVolume="arrowup",e.reduceVolume="arrowdown",e.silent="ctrl+m",e.imageEnhance="f9",e.onTopMost="f11",e.full="ctrl+enter",e.clockWise="alt+arrowright",e.antiClockWise="alt+arrowleft",e.openFile="ctrl+o",e.openURL="ctrl+u",e.preFile="pageup",e.nextFile="pagedown",e.subtitleUp="]",e.subtitleDown="[",e.saveImage="f8",e.systemSetting="f2",e.bossKey="alt+d",e.quit="ctrl+w",e.videoratio1="alt+1",e.videoratio2="alt+2",e.videoratio3="alt+3",e.videoratio4="alt+4",e.videoratio5="alt+5",e[e.preSecond=5]="preSecond",e[e.nextSecond=5]="nextSecond",e[e.exactPreSecond=5]="exactPreSecond",e[e.exactNextSecond=5]="exactNextSecond"}(f=e.hotKeyValue||(e.hotKeyValue={})),function(e){e[e.Single=0]="Single",e[e.SingleLoop=1]="SingleLoop",e[e.List=2]="List",e[e.ListLoop=3]="ListLoop",e[e.Random=4]="Random"}(m=e.playOrderModeValue||(e.playOrderModeValue={})),function(e){e[e.closeOption=0]="closeOption",e[e.clearPlayRecord=0]="clearPlayRecord",e[e.rememberPlayPosition=0]="rememberPlayPosition",e[e.rememberWindowSize=0]="rememberWindowSize",e[e.autoRun=1]="autoRun",e[e.minizeStopPlay=0]="minizeStopPlay",e[e.playCtrlPrevNext=0]="playCtrlPrevNext",e[e.playFullSceen=0]="playFullSceen",e[e.cacheFilePaths=void 0]="cacheFilePaths",e.snapShotFormat="JPG",e[e.snapShotSaveDir=void 0]="snapShotSaveDir",e[e.autoAddFile=1]="autoAddFile",e[e.saveFileMode=0]="saveFileMode",e[e.picIncludeSub=1]="picIncludeSub",e[e.cacheSize=200]="cacheSize",e[e.afterOpenBigSetTab=0]="afterOpenBigSetTab",e[e.afterOpenSmallSetTab=0]="afterOpenSmallSetTab",e[e.playFrameSeek=1]="playFrameSeek",e[e.videoRatioValue=1]="videoRatioValue",e[e.render=4]="render",e[e.renderChanged=0]="renderChanged",e[e.lastRrender=-1]="lastRrender",e[e.speedOneText=1]="speedOneText",e[e.speedTwoText=2]="speedTwoText",e[e.speedThreeText=3]="speedThreeText",e[e.playSettingAll=1]="playSettingAll",e[e.playOrderMode=2]="playOrderMode",e[e.audioChannel=0]="audioChannel",e[e.outputMode=2]="outputMode",e[e.rememberSpeed=0]="rememberSpeed",e[e.rememberProgress=1]="rememberProgress",e[e.speedMode=1]="speedMode",e[e.downloadSpeed=2048]="downloadSpeed",e[e.uploadSpeed=1024]="uploadSpeed",e[e.noClearBlack=0]="noClearBlack",e[e.showPreView=1]="showPreView",e[e.windowPosMode=1]="windowPosMode",e[e.defaultPlayer=0]="defaultPlayer",e[e.showTime=0]="showTime",e[e.startUpCount=0]="startUpCount",e[e.volumeAround=0]="volumeAround",e[e.noSign=0]="noSign",e[e.kbSeekMode=1]="kbSeekMode",e[e.syncThunder=0]="syncThunder",e[e.noshowThDir=0]="noshowThDir",e[e.showSyncThDia=0]="showSyncThDia"}(g=e.settingValue||(e.settingValue={})),function(e){e[e.showMode=0]="showMode",e[e.barAutoHide=0]="barAutoHide",e[e.transparent=0]="transparent",e[e.topMost=0]="topMost"}(S=e.showModeValue||(e.showModeValue={})),e.minizeStopPlay={section:e.xmpSetting,key:i.minizeStopPlay,value:g.minizeStopPlay},e.rememberSpeed={section:e.xmpSetting,key:i.rememberSpeed,value:g.rememberSpeed},e.rememberProgress={section:e.xmpSetting,key:i.rememberProgress,value:g.rememberProgress},e.playFullSceen={section:e.xmpSetting,key:i.playFullSceen,value:g.playFullSceen},e.cacheFilePaths={section:e.xmpSetting,key:i.cacheFilePaths,value:g.cacheFilePaths},e.render={section:e.xmpSetting,key:i.render,value:g.render},e.renderChanged={section:e.xmpSetting,key:i.renderChanged,value:g.renderChanged},e.lastRrender={section:e.xmpSetting,key:i.lastRrender,value:g.lastRrender},e.fullScreenShow={section:e.aplayerSection,key:t.fullScreenShow,value:d.fullScreenShow},e.brightness={section:e.aplayerSection,key:t.brightness,value:d.brightness},e.contrastRatio={section:e.aplayerSection,key:t.contrastRatio,value:d.contrastRatio},e.saturation={section:e.aplayerSection,key:t.saturation,value:d.saturation},e.frameProportion={section:e.aplayerSection,key:t.frameProportion,value:d.frameProportion},e.speedUpEnable={section:e.aplayerSection,key:t.speedUpEnable,value:d.speedUpEnable},e.imageNormalSize={section:e.aplayerSection,key:t.imageNormalSize,value:d.imageNormalSize},e.playSpeed={section:e.aplayerSection,key:t.playSpeed,value:d.playSpeed},e.lastPlayMediaId={section:e.aplayerSection,key:t.lastPlayMediaId,value:d.lastPlayMediaId},e.playListMode={section:e.aplayerSection,key:t.playListMode,value:d.playListMode},e.audioNormalize={section:e.aplayerSection,key:t.audioNormalize,value:d.audioNormalize},e.soundBalance={section:e.aplayerSection,key:t.soundBalance,value:d.soundBalance},e.soundDevice={section:e.aplayerSection,key:t.soundDevice,value:d.soundDevice},e.agreeVolume={section:e.aplayerSection,key:t.agreeVolume,value:d.agreeVolume},e.mediaVolume={section:e.aplayerSection,key:t.mediaVolume,value:d.mediaVolume},e.autoAddFile={section:e.xmpSetting,key:i.autoAddFile,value:g.autoAddFile},e.saveFileMode={section:e.xmpSetting,key:i.saveFileMode,value:g.saveFileMode},e.picIncludeSub={section:e.xmpSetting,key:i.picIncludeSub,value:g.picIncludeSub},e.syncThunder={section:e.xmpSetting,key:i.syncThunder,value:g.syncThunder},e.showSyncThDia={section:e.xmpSetting,key:i.showSyncThDia,value:g.showSyncThDia},e.noshowThDir={section:e.xmpSetting,key:i.noshowThDir,value:g.noshowThDir},e.cacheSize={section:e.xmpSetting,key:i.cacheSize,value:g.cacheSize},e.speedMode={section:e.xmpSetting,key:i.speedMode,value:g.speedMode},e.downloadSpeed={section:e.xmpSetting,key:i.downloadSpeed,value:g.downloadSpeed},e.uploadSpeed={section:e.xmpSetting,key:i.uploadSpeed,value:g.uploadSpeed},e.closeOption={section:e.xmpSetting,key:i.closeOption,value:g.closeOption},e.clearPlayRecord={section:e.xmpSetting,key:i.clearPlayRecord,value:g.clearPlayRecord},e.noSign={section:e.xmpSetting,key:i.noSign,value:g.noSign},e.rememberWindowSize={section:e.xmpSetting,key:i.rememberWindowSize,value:g.rememberWindowSize},e.windowPosMode={section:e.xmpSetting,key:i.windowPosMode,value:g.windowPosMode},e.autoRun={section:e.xmpSetting,key:i.autoRun,value:g.autoRun},e.assocExt={section:e.xmpSetting,key:t.assocExt,value:d.assocExt},e.alwaysAssociate={section:e.xmpSetting,key:t.alwaysAssociate,value:d.alwaysAssociate},e.noAssocExt={section:e.xmpSetting,key:t.noAssocExt,value:d.noAssocExt},e.showMode={section:e.xmpShowMode,key:a.showMode,value:S.showMode},e.barAutoHide={section:e.xmpShowMode,key:a.barAutoHide,value:S.barAutoHide},e.transparent={section:e.xmpShowMode,key:a.transparent,value:S.transparent},e.topMost={section:e.xmpShowMode,key:a.topMost,value:S.topMost},e.afterOpenSmallSetTab={section:e.configPlaySection,key:i.afterOpenSmallSetTab,value:g.afterOpenSmallSetTab},e.afterOpenBigSetTab={section:e.configPlaySection,key:i.afterOpenBigSetTab,value:g.afterOpenBigSetTab},e.playCtrlPrevNext={section:e.configPlaySection,key:i.playCtrlPrevNext,value:g.playCtrlPrevNext},e.playFrameSeek={section:e.configPlaySection,key:i.playFrameSeek,value:g.playFrameSeek},e.speedOneText={section:e.configPlaySection,key:i.speedOneText,value:g.speedOneText},e.speedTwoText={section:e.configPlaySection,key:i.speedTwoText,value:g.speedTwoText},e.speedThreeText={section:e.configPlaySection,key:i.speedThreeText,value:g.speedThreeText},e.playSettingAll={section:e.configPlaySection,key:i.playSettingAll,value:g.playSettingAll},e.showPreView={section:e.configPlaySection,key:i.showPreView,value:g.showPreView},e.audioChannel={section:e.configPlaySection,key:i.audioChannel,value:g.audioChannel},e.outputMode={section:e.configPlaySection,key:i.outputMode,value:g.outputMode},e.volumeAround={section:e.configPlaySection,key:i.volumeAround,value:g.volumeAround},e.snapShotFormat={section:e.hotKeySection,key:i.snapShotFormat,value:g.snapShotFormat},e.snapShotSaveDir={section:e.configOtherSection,key:i.snapShotSaveDir,value:g.snapShotSaveDir},e.preSecond={section:e.hotKeySection,key:n.preSecond,value:f.preSecond},e.nextSecond={section:e.hotKeySection,key:n.nextSecond,value:f.nextSecond},e.keyboardSeekMode={section:e.configPlaySection,key:i.kbSeekMode,value:g.kbSeekMode},e.exactPreSecond={section:e.hotKeySection,key:n.exactPreSecond,value:f.exactPreSecond},e.exactNextSecond={section:e.hotKeySection,key:n.exactNextSecond,value:f.exactNextSecond},e.play={section:e.hotKeySection,key:n.play,value:f.play},e.videoRatio={section:e.xmpSetting,key:i.videoRatio,value:g.videoRatioValue},e.stop={section:e.hotKeySection,key:n.stop,value:f.stop},e.fast={section:e.hotKeySection,key:n.fast,value:f.fast},e.back={section:e.hotKeySection,key:n.back,value:f.back},e.fastMore={section:e.hotKeySection,key:n.fastMore,value:f.fastMore},e.backMore={section:e.hotKeySection,key:n.backMore,value:f.backMore},e.speedUp={section:e.hotKeySection,key:n.speedUp,value:f.speedUp},e.speedSlow={section:e.hotKeySection,key:n.speedSlow,value:f.speedSlow},e.speedOne={section:e.hotKeySection,key:n.speedOne,value:f.speedOne},e.speedTwo={section:e.hotKeySection,key:n.speedTwo,value:f.speedTwo},e.speedThree={section:e.hotKeySection,key:n.speedThree,value:f.speedThree},e.setAPoint={section:e.hotKeySection,key:n.setAPoint,value:f.setAPoint},e.setBPoint={section:e.hotKeySection,key:n.setBPoint,value:f.setBPoint},e.cancelABPoint={section:e.hotKeySection,key:n.cancelABPoint,value:f.cancelABPoint},e.addVolume={section:e.hotKeySection,key:n.addVolume,value:f.addVolume},e.reduceVolume={section:e.hotKeySection,key:n.reduceVolume,value:f.reduceVolume},e.silent={section:e.hotKeySection,key:n.silent,value:f.silent},e.imageEnhance={section:e.hotKeySection,key:n.imageEnhance,value:f.imageEnhance},e.onTopMost={section:e.hotKeySection,key:n.onTopMost,value:f.onTopMost},e.full={section:e.hotKeySection,key:n.full,value:f.full},e.clockWise={section:e.hotKeySection,key:n.clockWise,value:f.clockWise},e.antiClockWise={section:e.hotKeySection,key:n.antiClockWise,value:f.antiClockWise},e.openFile={section:e.hotKeySection,key:n.openFile,value:f.openFile},e.openURL={section:e.hotKeySection,key:n.openURL,value:f.openURL},e.preFile={section:e.hotKeySection,key:n.preFile,value:f.preFile},e.nextFile={section:e.hotKeySection,key:n.nextFile,value:f.nextFile},e.subtitleUp={section:e.hotKeySection,key:n.subtitleUp,value:f.subtitleUp},e.subtitleDown={section:e.hotKeySection,key:n.subtitleDown,value:f.subtitleDown},e.saveImage={section:e.hotKeySection,key:n.saveImage,value:f.saveImage},e.systemSetting={section:e.hotKeySection,key:n.systemSetting,value:f.systemSetting},e.bossKey={section:e.hotKeySection,key:n.bossKey,value:f.bossKey},e.quit={section:e.hotKeySection,key:n.quit,value:f.quit},e.playOrderMode={section:e.xmpSetting,key:i.playOrderMode,value:g.playOrderMode},e.size={section:e.configSubtitle,key:o.size,value:h.size},e.color={section:e.configSubtitle,key:o.color,value:h.color},e.font={section:e.configSubtitle,key:o.font,value:h.font},e.position={section:e.configSubtitle,key:o.position,value:h.position},e.size2={section:e.configSubtitle2,key:r.size2,value:p.size2},e.color2={section:e.configSubtitle2,key:r.color2,value:p.color2},e.font2={section:e.configSubtitle2,key:r.font2,value:p.font2},e.position2={section:e.configSubtitle2,key:r.position2,value:p.position2},e.useHardwareSubtitle={section:e.configSubtitle,key:o.useHardware,value:h.noUseHardware},e.clearBlackMode={section:e.configClearBlack,key:i.clearBlack,value:g.noClearBlack},e.defaultPlayer={section:e.configDefaultPlayer,key:i.defaultPlayer,value:g.defaultPlayer},e.showTipsTime={section:e.configDefaultPlayer,key:i.showTime,value:g.showTime},e.startUpCount={section:e.configDefaultPlayer,key:i.startUpCount,value:g.startUpCount}}(t.ConfigDefineNS||(t.ConfigDefineNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.ThunderHelper=void 0;const o=i(1),r=i(9),a=i(10),s=i(0).default.getLogger("XMP.ThunderHelper"),l=r.default(o.join(__rootDir,"../bin/ThunderHelper.node"));!function(e){function t(e){return n(this,void 0,void 0,function*(){if(!e||(yield e.isDestroyed()))return 0;let t=0,i=yield e.getNativeWindowHandle();return i&&(t=i.readUIntLE(0,4)),t})}function i(e,t,i,n,o,r,s,d){if(!l||!e)return;let u="";d&&d.length>3&&(u=d.substring(0,d.length-3)),s|=a.Uflag.SWP_ASYNCWINDOWPOS,l.setWindowPos(e,t,i,n,o,r,s)}function o(){return l.getDPIAwareSupport()}function r(e){return l.getMonitorDPIFactor(e)}function d(){return l.getSysDPIFactor()}e.getDriveInfo=function(e){return l.getDriveInfo(e)},e.getFreePartitionSpace=function(e){return l.getFreePartitionSpace(e)},e.getLogicalDriveStrings=function(){return l.getLogicalDriveStrings()},e.getPartitionSpace=function(e){return l.getPartitionSpace(e)},e.getSystemTempPath=function(){return l.getSystemTempPath()},e.getTaskTypeFromUrl=function(e){return l.getTaskTypeFromUrl(e)},e.dwmIsCompositionEnabled=function(){return l.dwmIsCompositionEnabled()},e.setWindowLong=function(e,t,i){return l.setWindowLong(e,t,i)},e.showCursor=function(e){l&&l.showCursor(e)},e.isWindowVisible=function(e){return!!l&&l.isWindowVisible(e)},e.isWindowEnable=function(e){return!!l&&l.isWindowEnable(e)},e.enableWindow=function(e,t){return!!l&&l.enableWindow(e,t)},e.shChangeNotify=function(){if(l)return l.refreshIcon()},e.getBrowserWindowHandle=t,e.setTopMostWindow=function(e){return n(this,void 0,void 0,function*(){l&&e&&i(yield t(e),a.OptionOfHWNDInAfter.HWND_TOPMOST,0,0,0,0,a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOMOVE)})},e.getGraphicsAdapterList=function(){return l?l.getGraphicsAdapterList():null},e.getFileVersion=function(e){return l&&e?l.getFileVersion(e):""},e.getCursorPos=function(){return l?l.getCursorPos():{x:0,y:0}},e.getPowerInfo=function(){return l?l.getPowerInfo():null},e.setWindowRectRgn=function(e,t,i,n,o){l&&l.setWindowRectRgn(e,t,i,n,o)},e.createRectRgn=function(e,t,i,n){return l?l.createRectRgn(e,t,i,n):0},e.combineRgn=function(e,t,i=a.CombineRgnType.RGN_OR){return l?l.combineRgn(e,t,i):-1},e.deleteObject=function(e){return!!l&&l.deleteObject(e)},e.setWindowRgn=function(e,t,i=!0){return l?l.setWindowRgn(e,t,i):-1},e.hitCaption=function(e){return!!l&&l.hitCaption(e)},e.isWindowForeGround=function(e){return n(this,void 0,void 0,function*(){if(!l)return!1;let t=l.getForegroundWindow();return e===t})},e.getForegroundWindow=function(){return l?l.getForegroundWindow():0},e.isWindowForceGroundEx=function(e){return!!l&&e===l.getForegroundWindow()},e.setListExpandMode=function(e){return l?l.setListExpandMode(e):0},e.setTopMostWindowEx=function(e){l&&e&&i(e,a.OptionOfHWNDInAfter.HWND_TOPMOST,0,0,0,0,a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOMOVE)},e.cancelTopMostWindow=function(e,o){return n(this,void 0,void 0,function*(){if(!l||!e)return;let n=yield t(e),r=a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOMOVE|a.Uflag.SWP_NOACTIVATE;o&&(r|=o),i(n,a.OptionOfHWNDInAfter.HWND_NOTOPMOST,0,0,0,0,r)})},e.cancelTopMostWindowEx=function(e,t){if(!l||!e)return;let n=a.Uflag.SWP_NOSIZE|a.Uflag.SWP_NOMOVE|a.Uflag.SWP_NOACTIVATE;t&&(n|=t),i(e,a.OptionOfHWNDInAfter.HWND_NOTOPMOST,0,0,0,0,n)},e.getTempPath=function(){return l?l.getSystemTempPath():""},e.switchToThisWindow=function(e,t=!1){l&&l.switchToThisWindow(e,t)},e.setScreenSaveActive=function(e){if(l)return l.setScreenSaveActive(e)},e.getDiskFreeSpace=function(e){return l?l.getFreePartitionSpace(e):0},e.getMemInfoByPointer=function(e,t){return l?l.getMemInfoByPointer(e,t):null},e.setMinTrackSize=function(e,t,i){return l?l.setMinTrackSize(e,t,i):null},e.setWindowPos=function(e,t,n,o,r,a,s,d){if(!l||!e||e.isDestroyed())return;i(e.getNativeWindowHandle().readUIntLE(0,4),t,n,o,r,a,s,d)},e.moveWindowGently=function(e,t,i,n,o,r,a){l&&t&&l.moveWindowGently(e,t,i,n,o,r,a)},e.moveWindow=function(e,t){l&&e&&l.moveWindow(e,t.x,t.y,t.width,t.height,!0)},e.setWindowFocus=function(e,t=!0){l&&e&&l.setWindowFocus(e,t)},e.getWindowRect=function(e){return l&&e?l.getWindowRect(e):{x:0,y:0,width:0,height:0}},e.getClientRect=function(e){return l&&e?l.getClientRect(e):{x:0,y:0,width:0,height:0}},e.getCurrentScreenRect=function(e){return l&&e?l.getCurrentScreenRect(e):{x:0,y:0,width:0,height:0}},e.getCurrentWorkRect=function(e){return l&&e?l.getCurrentScreenRect(e,!0):{x:0,y:0,width:0,height:0}},e.getChildWindow=function(e){return l&&e?l.getChildWindow(e):0},e.getParentWindow=function(e){return l&&e?l.getParentWindow(e):0},e.getKeyState=function(e){return l?l.getKeyState(e):0},e.setWindowPosEx=i,e.beginDeferWindowPos=function(e){return l&&e?l.beginDeferWindowPos(e):0},e.endDeferWindowPos=function(e){return l&&e?l.endDeferWindowPos(e):0},e.deferWindowPos=function(e,t,i,n,o,r,a,s){return l&&e?l.deferWindowPos(e,t,i,n,o,r,a,s):0},e.bindChildWindow=function(e,t,i){if(!l||!t||!e)return;let n=t.getNativeWindowHandle().readUIntLE(0,4),o=e.getNativeWindowHandle().readUIntLE(0,4);i?l.bindChildWindow(o,n,i.x,i.y,i.width,i.height):l.bindChildWindow(o,n)},e.bindChildWindowEx=function(e,t,i){l&&t&&e&&(i?l.bindChildWindow(e,t,i.x,i.y,i.width,i.height):l.bindChildWindow(e,t))},e.setDllDirectory=function(e){l&&e&&l.setDllDirectory(e)},e.bringWindowToTop=function(e){if(!e)return;let t=e.getNativeWindowHandle().readUIntLE(0,4);l.bringWindowToTop(t)},e.bringWindowToTopEx=function(e){e&&l.bringWindowToTop(e)},e.modifyStyleEx=function(e,t,i){e&&l.modifyStyle(e,t,i)},e.modifyStyle=function(e,t,i){if(!e)return;let n=e.getNativeWindowHandle().readUIntLE(0,4);l.modifyStyle(n,t,i)},e.registerSliderCreate=function(e){l.registerSliderCreate(e)},e.showSlider=function(e){l.showSlider(e)},e.initSideBar=function(e,t,i,n){l.initSideBar(e,t,i,n)},e.uninitSideBar=function(){return n(this,void 0,void 0,function*(){return new Promise(e=>{l.uninitSideBar(()=>{e()})})})},e.createSideBar=function(){l.createSideBar()},e.destroySideBar=function(){l.destroySideBar()},e.readRegValue=function(e,t,i){return l?l.readRegString(e,t,i):""},e.setForcegroundWindow=function(e){if(!e)return;let t=e.getNativeWindowHandle().readUIntLE(0,4);l.setForegroundWindow(t)},e.setActiveWindowEx=function(e){l&&e&&l.setActiveWindow(e)},e.setForcegroundWindowEx=function(e){e&&l.setForegroundWindow(e)},e.is64BitWindows=function(){return!!l&&l.is64bitSystem()},e.setSideBarExpandState=function(e){l.setExpandState(e)},e.unBindChildWindow=function(e,t){if(!l||!t||!e)return;s.information("unBindChildWindow");let i=t.getNativeWindowHandle().readUIntLE(0,4),n=e.getNativeWindowHandle().readUIntLE(0,4);l.unBindChildWindow(n,i)},e.unBindChildWindowEx=function(e,t){l&&t&&e&&(s.information("unBindChildWindowEx"),l.unBindChildWindow(e,t))},e.addBrowserWindowClipStyle=function(e){if(!l||!e)return!1;let t=e.getNativeWindowHandle().readUIntLE(0,4),i=l.findChildWindow(t,"Intermediate D3D Window");return i&&l.setWindowLong(i,a.SetWindowType.GWL_STYLE,a.WindowStyle.WS_CLIPSIBLINGS),l.setWindowLong(t,a.SetWindowType.GWL_STYLE,a.WindowStyle.WS_CLIPCHILDREN),!!i},e.addBrowserWindowClipStyleEx=function(e){if(!l)return!1;let t=l.findChildWindow(e,"Intermediate D3D Window");return t&&l.setWindowLong(t,a.SetWindowType.GWL_STYLE,a.WindowStyle.WS_CLIPSIBLINGS),l.setWindowLong(e,a.SetWindowType.GWL_STYLE,a.WindowStyle.WS_CLIPCHILDREN),!!t},e.getDoubleClickTime=function(){return l?l.getDoubleClickTime():50},e.invalidateRect=function(e,t,i){l&&l.invalidateRect(e,t,i)},e.isIconic=function(e){return!!l&&l.isIconic(e)},e.isZoomed=function(e){return!!l&&l.isZoomed(e)},e.showWindow=function(e){return!!l&&l.showWindow(e,a.ShowWindowCmd.SW_SHOW)},e.hideWindow=function(e){return!!l&&l.showWindow(e,a.ShowWindowCmd.SW_HIDE)},e.setZorderWindow=function(e,t,i){if(l)return l.setZorderWindow(e,t,i)},e.getWindowLong=function(e,t){return l?l.getWindowLong(e,t):0},e.getHelperObject=function(){return l},e.getPeerID=function(){return l.getPeerID()},e.getDPIAwareSupport=o,e.getMonitorDPIFactor=r,e.getSysDPIFactor=d,e.getDpi=function(e){let t=1;return t=o()?r(e):d()}}(t.ThunderHelper||(t.ThunderHelper={}))},function(e,t){e.exports=require("electron")},function(e,t){e.exports=require("util")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubInitStatus=t.SubtitleEvent=t.SubtitleType=void 0,function(e){e[e.None=0]="None",e[e.Embed=1]="Embed",e[e.Local=2]="Local",e[e.Online=3]="Online",e[e.Manual=4]="Manual"}(t.SubtitleType||(t.SubtitleType={})),function(e){e.Unknown="Unknown",e.InitSubtitle="OnInitSubtitle",e.LoadSucceed="OnLoadSucceed",e.QuerySucceed="OnQuerySucceed",e.QueryFailed="OnQueryFailed",e.SearchSucceed="OnSearchSucceed",e.SearchFailed="OnSearchFailed"}(t.SubtitleEvent||(t.SubtitleEvent={})),function(e){e[e.READY=0]="READY",e[e.INITING=1]="INITING",e[e.FINISH=2]="FINISH"}(t.SubInitStatus||(t.SubInitStatus={}))},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("fs")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(12);t.default=class{constructor(){this.emitter=null,this.emitter=new n.EventEmitter}attachOnceListener(e,t){this.emitter.once(e,t)}attachListener(e,t){this.emitter.addListener(e,t)}prependListener(e,t){this.emitter.prependListener(e,t)}prependOnceListener(e,t){this.emitter.prependOnceListener(e,t)}detachListener(e,t){this.emitter.removeListener(e,t)}fireEvent(e,...t){return this.emitter.emit(e,...t)}removeAllListeners(e){this.emitter.removeAllListeners(e)}removeListener(e,t){this.emitter.removeListener(e,t)}setMaxListeners(e){this.emitter.setMaxListeners(e)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=i(28),r=i(12),a=i(0).default.getLogger("mian-window");const s=new class{constructor(){this.mainWindow=null,this.handle=0,this.closed=!1,this.inited=!1,this.isIniting=!1,this.emitter=new r.EventEmitter,this.emitter.setMaxListeners(0)}init(){return n(this,void 0,void 0,function*(){this.mainWindow||this.closed||(this.isIniting?yield new Promise(e=>n(this,void 0,void 0,function*(){this.emitter.on("OnInit",()=>{e()})})):(this.isIniting=!0,this.mainWindow=yield o.global.mainRendererWindow.__resolve(),this.isIniting=!1,this.emitter.emit("OnInit"),this.emitter.removeAllListeners())),this.inited||(this.inited=!0,this.mainWindow.on("closed",()=>{this.closed=!0}))})}getWindow(){return n(this,void 0,void 0,function*(){return(yield this.isMainWindowValid())?this.mainWindow:null})}getId(){return n(this,void 0,void 0,function*(){return(yield this.isMainWindowValid())?this.mainWindow.id:0})}getChildWindows(){return n(this,void 0,void 0,function*(){return(yield this.isMainWindowValid())?this.mainWindow.getChildWindows():[]})}close(){return n(this,void 0,void 0,function*(){(yield this.isMainWindowValid())&&this.mainWindow.close()})}showInactive(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.showInactive()})}getBounds(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.getBounds()})}setBounds(e){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.setBounds(e)})}getWindowHandle(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid()){if(!this.handle){let e=yield this.mainWindow.getNativeWindowHandle();this.handle=e.readUInt32LE(0)}return this.handle}})}getWebContents(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.webContents})}isFullScreen(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.isFullScreen()})}setFullScreen(e){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.setFullScreen(e)})}setResizeable(e){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.setResizable(e)})}getMaximumSize(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.getMaximumSize()})}isResizable(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.isResizable()})}focus(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.focus()})}getMinimumSize(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.getMinimumSize()})}setMinimumSize(e,t){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.setMinimumSize(e,t)})}setMaximumSize(e,t){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.setMaximumSize(e,t)})}isMinimized(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.isMinimized()})}minimize(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.minimize()})}isMaximized(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.isMaximized()})}maximize(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.maximize()})}unmaximize(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.unmaximize()})}hide(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.hide()})}show(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return a.warning("cqm mainwindow show"),this.mainWindow.show()})}restore(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.restore()})}isVisible(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.isVisible()})}isDestroyed(){return n(this,void 0,void 0,function*(){return!(this.mainWindow&&!this.closed)||this.mainWindow.isDestroyed()})}on(e,t){return n(this,void 0,void 0,function*(){(yield this.isMainWindowValid())&&(yield this.mainWindow.on(e,t))})}removeListener(e,t){return n(this,void 0,void 0,function*(){(yield this.isMainWindowValid())&&this.mainWindow.removeListener(e,t)})}removeAllListener(){return n(this,void 0,void 0,function*(){(yield this.isMainWindowValid())&&this.mainWindow.removeAllListeners()})}once(e,t){return n(this,void 0,void 0,function*(){(yield this.isMainWindowValid())&&(yield this.mainWindow.once(e,t))})}send(e,...t){return n(this,void 0,void 0,function*(){(yield this.isMainWindowValid())&&(yield this.mainWindow.send(e,...t))})}hookWindowMessage(e,t){return n(this,void 0,void 0,function*(){(yield this.isMainWindowValid())&&this.mainWindow.hookWindowMessage(e,(e,i)=>{t(e,i)})})}unhookWindowMessage(e){return n(this,void 0,void 0,function*(){(yield this.isMainWindowValid())&&this.mainWindow.unhookWindowMessage(e)})}center(){return n(this,void 0,void 0,function*(){if(yield this.isMainWindowValid())return this.mainWindow.center()})}isMainWindowValid(){return n(this,void 0,void 0,function*(){if(!this.mainWindow){if(this.closed)return!1;yield this.init()}return this.mainWindow&&!this.closed})}};t.default=s},function(e,t,i){e.exports=i(111)},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.VipPluginHelper=void 0;const o=i(39),r=i(0),a=i(40),s=r.default.getLogger("xmp-vip-plugin-helper");class l{constructor(){this.mThunderVersionStr=void 0,this.mThunderVersionNumber=void 0,this.mPluginVersion=void 0}setPluginInfo(e,t,i){this.mThunderVersionStr=e,this.mThunderVersionNumber=t,this.mPluginVersion=i,localStorage.setItem("VipPluginHelper.ThunderVersionStr",this.mThunderVersionStr),localStorage.setItem("VipPluginHelper.ThunderVersionNumber",this.mThunderVersionNumber.toString()),localStorage.setItem("VipPluginHelper.PluginVersion",this.mPluginVersion),s.information("setPluginInfo",e,t,i)}get thunderVersionNumber(){return this.mThunderVersionNumber||Number(localStorage.getItem("VipPluginHelper.ThunderVersionNumber"))}get thunderVersionString(){return this.mThunderVersionStr||localStorage.getItem("VipPluginHelper.ThunderVersionStr")}get pluginVersion(){return this.mPluginVersion||localStorage.getItem("VipPluginHelper.PluginVersion")}get currentTime(){return Math.floor((new Date).getTime()/1e3)}getXmpMode(){return n(this,void 0,void 0,function*(){let e=yield a.CommonNS.getXmpCurrentMode();switch(s.information("XMPShowMode",e),e){case o.XmpMode.EMBED_MODE:return"pannel"}return"xmp"})}get clientName(){return"xl_xmp"}}t.VipPluginHelper=l,t.default=new l},function(e,t,i){"use strict";const n=i(29);if("renderer"===process.type){if(n.info("client running"),!global.__xdasAsyncRemoteExports){let e={};global.__xdasAsyncRemoteExports=e;let t=i(80);e.require=t.remoteRequire,e.getCurrentWebContents=t.getCurrentWebContents,e.getCurrentWindow=t.getCurrentWindow,e.Interest=t.Interest,e.global=new Proxy({},{get:(e,i,n)=>t.getGlobal(i)}),e.electron=new Proxy({},{get:(e,i,n)=>t.getBuiltin(i)}),Object.defineProperty(e,"currentWindow",{get:()=>t.getCurrentWindow()}),Object.defineProperty(e,"currentWebContents",{get:()=>t.getCurrentWebContents()}),Object.defineProperty(e,"process",{get:()=>t.getGlobal("process")}),Object.defineProperty(e,"webContents",{get:()=>t.getWebContents()})}}else if("browser"===process.type&&(n.info("server running"),!global.__xdasAsyncRemoteExports)){let e={};global.__xdasAsyncRemoteExports=e;const t=i(84);t.startServer(),e.getObjectRegistry=t.getObjectRegistry}e.exports=global.__xdasAsyncRemoteExports},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assert=t.log=t.error=t.warn=t.info=t.trace=t.timeEnd=t.time=t.traceback=void 0;const n=i(1);let o,r=console;function a(e=5){let t=/at\s+(.*)\s+\((.*):(\d*):(\d*)\)/i,i=/at\s+()(.*):(\d*):(\d*)/i,o=(new Error).stack.split("\n").slice(e+1);o.shift();let r=[];return o.forEach((e,o)=>{let a=t.exec(e)||i.exec(e),s={};a&&5===a.length&&(s.method=a[1],s.path=a[2],s.line=a[3],s.pos=a[4],s.file=n.basename(s.path),r.push(s))}),r}if(o="renderer"===process.type?"[Renderer] [async-remote]:":"browser"===process.type?"[Browser] [async-remote]:":`[${process.type}] [async-remote]`,t.traceback=function(e=5){return a(e).map(e=>e.method+"@("+e.file+")").join(" <= ")},t.time=function(...e){r.time(...e)},t.timeEnd=function(...e){r.timeEnd(...e)},t.trace=function(...e){let t=a(),i="";t[0]&&t[0].method&&(i=i),r.trace(o,...e)},t.info=function(...e){let t=a(),i="anonymous";t[0]&&t[0].method&&(i=i),r.info(o,"["+i+"]",e.join(","))},t.warn=function(...e){let t=a(),i="";t[0]&&t[0].method&&(i=i),r.warn("<WARN>"+o,"["+i+"]",e.join(","))},t.error=function(...e){let t=a(),i="";t[0]&&t[0].method&&(i=i),r.error("<ERROR>"+o,"["+i+"]",e.join(","))},t.log=function(...e){r.log(o,...e)},t.assert=function(e,t){if(!e)throw new Error(t)},!process.env.DEBUG_ASYNC_REMOTE){let e=function(){};t.traceback=e,t.time=e,t.timeEnd=e,t.trace=e,t.info=e,t.warn=e,t.error=e,t.log=e,t.assert=e}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.LeftTopVideoTipManagerNS=void 0;const o=i(44),r=i(57),a=i(10),s=i(8),l=i(3);!function(e){const t=o.VideoTipManagerNS.getVideoTipManager();class i{constructor(){this.isRegisted=!1,this.videoTipContainer=null,this.timer=new Map}registerPluginFunction(){if(!this.isRegisted){this.isRegisted=!0;let e={[l.VideoTipFunction.showTip]:this.showTip.bind(this),[l.VideoTipFunction.closeTip]:this.closeTip.bind(this)};s.server.registerFunctions(e)}}createVideoTip(){return n(this,void 0,void 0,function*(){null===this.videoTipContainer&&(yield t.createVideoTip(r.XmpVideoTipWndIdNS.videoTipWndIDLeftTop,{x:40,y:40,width:-80,height:100}),this.videoTipContainer=yield t.getVideoTipContainer(r.XmpVideoTipWndIdNS.videoTipWndIDLeftTop))})}clear(){return n(this,void 0,void 0,function*(){yield t.destroyVideoTip(r.XmpVideoTipWndIdNS.videoTipWndIDLeftTop),this.videoTipContainer=null})}getItem(e){return n(this,void 0,void 0,function*(){let t=null;do{if(!this.videoTipContainer)break;t=yield this.videoTipContainer.getItem(e)}while(0);return t})}addItem(e,i){return n(this,void 0,void 0,function*(){let n=!1;do{if(!this.videoTipContainer)break;if(yield this.videoTipContainer.getItem(e))n=yield this.updateItemText(e,i);else{if(!this.videoTipContainer)break;yield this.videoTipContainer.addItem(i,e),n=!0}n&&t.showVideoTip(r.XmpVideoTipWndIdNS.videoTipWndIDLeftTop,a.CmdShow.SW_SHOWNOACTIVATE).catch()}while(0);return n})}addLinkItem(e,i,o){return n(this,void 0,void 0,function*(){let n=!1;do{if(!this.videoTipContainer)break;yield this.videoTipContainer.removeItem(e);let s=yield this.videoTipContainer.addLinkItem(i,e);s&&(s.setClickHandler(o),t.showVideoTip(r.XmpVideoTipWndIdNS.videoTipWndIDLeftTop,a.CmdShow.SW_SHOWNOACTIVATE).catch(),n=!0)}while(0);return n})}updateItemText(e,t){return n(this,void 0,void 0,function*(){let i=!1;do{if(!this.videoTipContainer)break;let n=yield this.videoTipContainer.getItem(e);n&&(n.setText(t),i=!0)}while(0);return i})}removeItem(e){return n(this,void 0,void 0,function*(){let i=!1;do{if(!this.videoTipContainer)break;(yield this.videoTipContainer.getItem(e))&&(yield this.videoTipContainer.removeItem(e),i=!0);let n=yield this.videoTipContainer.getAllItems();if(n&&n.length>0)break;t.showVideoTip(r.XmpVideoTipWndIdNS.videoTipWndIDLeftTop,a.CmdShow.SW_HIDE).catch()}while(0);return i})}getTimer(e){return this.timer.get(e)}clearTimer(e){let t=this.getTimer(e);t&&(clearTimeout(t),this.timer.delete(e))}setTimeout(e,t){let i=setTimeout(()=>n(this,void 0,void 0,function*(){yield this.removeItem(e),this.clearTimer(e)}),t);this.timer.set(e,i)}hideTips(){return n(this,void 0,void 0,function*(){t.showVideoTip(r.XmpVideoTipWndIdNS.videoTipWndIDLeftTop,a.CmdShow.SW_HIDE).catch()})}showTip(e,t,...i){return n(this,void 0,void 0,function*(){!i||i.length<3||c(i[0],i[1],i[2]).catch()})}closeTip(e,t,...i){return n(this,void 0,void 0,function*(){!i||i.length<1||h(i[0]).catch()})}}e.LeftTopTipManager=i;let d=null;function u(){return d||(d=new i),d}function c(e,t,i){return n(this,void 0,void 0,function*(){do{if(!t||!e)break;let n=u();yield n.createVideoTip(),yield n.addItem(e,t),n.getTimer(e)&&n.clearTimer(e),i&&n.setTimeout(e,i)}while(0)})}function h(e){return n(this,void 0,void 0,function*(){let t=u();t.clearTimer(e),yield t.removeItem(e)})}e.getLeftTopVideoTipManager=u,e.showTip=c,e.closeTip=h}(t.LeftTopVideoTipManagerNS||(t.LeftTopVideoTipManagerNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.rpc=void 0;const o=i(28),r=i(19),a=i(12),s=i(20);t.rpc=new class{constructor(){this.mapObj=new Map,this.mapObjIniting=new Map,this.emitter=new a.EventEmitter}isXmpLiteEx(){return"renderer"!==process.type&&"xmplite"===r.app.getName()}getAppName(){return n(this,void 0,void 0,function*(){if(void 0===this.appName){let e=yield this.getApp();this.appName=yield e.getName()}return this.appName})}isXmpLite(){return n(this,void 0,void 0,function*(){return"xmplite"===(yield this.getAppName())})}getAppVersion(){return n(this,void 0,void 0,function*(){if(void 0===this.appVersion){let e=yield this.getApp();this.appVersion=yield e.getVersion()}return this.appVersion})}getProcess(){return n(this,void 0,void 0,function*(){return o.global.process.__resolve()})}getIpcMain(){return n(this,void 0,void 0,function*(){return this.getCurrentObject("ipcMain")})}getDialog(){return n(this,void 0,void 0,function*(){return this.getCurrentObject("dialog")})}getApp(){return n(this,void 0,void 0,function*(){return this.getCurrentObject("app")})}getShell(){return n(this,void 0,void 0,function*(){return this.getCurrentObject("shell")})}getMenu(){return n(this,void 0,void 0,function*(){return this.getCurrentObject("Menu")})}getScreen(){return n(this,void 0,void 0,function*(){return this.getCurrentObject("screen")})}getWebContents(){return n(this,void 0,void 0,function*(){return this.getCurrentObject("webContents")})}getBrowserWindow(){return n(this,void 0,void 0,function*(){return this.getCurrentObject("BrowserWindow")})}getGlobalShortcut(){return n(this,void 0,void 0,function*(){return this.getCurrentObject("globalShortcut")})}getCurrentWebContents(){return n(this,void 0,void 0,function*(){let e=this.mapObj.get("currentWebContents");return void 0===e&&(this.mapObjIniting.get("currentWebContents")?e=yield new Promise(e=>n(this,void 0,void 0,function*(){this.emitter.on("OnInitCurrentWebContents",t=>{e(t)})})):(this.mapObjIniting.set("currentWebContents",!0),e=yield o.getCurrentWebContents().__resolve(),this.mapObjIniting.set("currentWebContents",!1),this.emitter.emit("OnInitCurrentWebContents",e),this.emitter.listeners("OnInitCurrentWebContents").forEach(e=>{this.emitter.removeListener("OnInitCurrentWebContents",e)})),this.mapObj.set("currentWebContents",e)),e})}getCurrentWindow(){return n(this,void 0,void 0,function*(){let e=this.mapObj.get("currentWindow");return void 0===e&&(this.mapObjIniting.get("currentWindow")?e=yield new Promise(e=>n(this,void 0,void 0,function*(){this.emitter.on("OnInitCurrentWindow",t=>{e(t)})})):(this.mapObjIniting.set("currentWindow",!0),e=yield o.getCurrentWindow().__resolve(),this.mapObjIniting.set("currentWindow",!1),this.emitter.emit("OnInitCurrentWindow",e),this.emitter.listeners("OnInitCurrentWindow").forEach(e=>{this.emitter.removeListener("OnInitCurrentWindow",e)})),this.mapObj.set("currentWindow",e)),e})}getCurrentObject(e){return n(this,void 0,void 0,function*(){let t=this.mapObj.get(e);return s.isNullOrUndefined(t)&&(this.mapObjIniting.get(e)?t=yield new Promise(t=>n(this,void 0,void 0,function*(){this.emitter.on(e,e=>{t(e)})})):(this.mapObjIniting.set(e,!0),t=yield o.electron[e].__resolve(),this.mapObjIniting.set(e,!1),this.emitter.emit(e,t),this.emitter.listeners(e).forEach(t=>{this.emitter.removeListener(e,t)})),this.mapObj.set(e,t)),t})}}},function(e,t,i){"use strict";var n=i(14),o=i(115),r=i(117),a=i(118),s=i(119),l=i(68);e.exports=function(e){return new Promise(function(t,d){var u=e.data,c=e.headers;n.isFormData(u)&&delete c["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var p=e.auth.username||"",f=e.auth.password||"";c.Authorization="Basic "+btoa(p+":"+f)}if(h.open(e.method.toUpperCase(),r(e.url,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in h?a(h.getAllResponseHeaders()):null,n={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:i,config:e,request:h};o(t,d,n),h=null}},h.onerror=function(){d(l("Network Error",e,null,h)),h=null},h.ontimeout=function(){d(l("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",h)),h=null},n.isStandardBrowserEnv()){var m=i(120),g=(e.withCredentials||s(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;g&&(c[e.xsrfHeaderName]=g)}if("setRequestHeader"in h&&n.forEach(c,function(e,t){void 0===u&&"content-type"===t.toLowerCase()?delete c[t]:h.setRequestHeader(t,e)}),e.withCredentials&&(h.withCredentials=!0),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){h&&(h.abort(),d(e),h=null)}),void 0===u&&(u=null),h.send(u)})}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.UserHelper=t.UserEventNS=void 0;const o=i(12),r=i(2),a=i(0).default.getLogger("UserHelper");var s;!function(e){e.login="OnLogin",e.logout="OnLogout",e.authorityChanged="OnAuthorityChanged"}(s=t.UserEventNS||(t.UserEventNS={}));class l extends o.EventEmitter{constructor(){super(),this.mPeerId=void 0,this.mUserId="0",this.mSessionId=void 0,this.mIsLogin=!1,this.mIsVip=!1,this.mVipLevel=0,this.mVasType=0,this.mIsYear=!1,this.mPreUserIsVip=!1,this.init()}init(){this.setMaxListeners(0),this.attachUserEvents().catch()}getPeerId(){return n(this,void 0,void 0,function*(){if(this.mPeerId)return this.mPeerId;{let e=yield r.client.callServerFunction("GetPeerID");return e&&""!==e&&(this.mPeerId=e),this.mPeerId||""}})}getSessionId(){return n(this,void 0,void 0,function*(){if(this.mSessionId)return this.mSessionId;{let e=yield r.client.callServerFunction("GetSessionID");return e&&""!==e&&(this.mSessionId=e),this.mSessionId||"0"}})}getUserinfo(){return n(this,void 0,void 0,function*(){return yield r.client.callServerFunction("GetAllUserInfo")})}get jumpKey(){return""}get userId(){return this.mUserId}get isLogin(){return this.mIsLogin}get isVip(){return this.mIsVip}get isPreUserIsVip(){return this.mPreUserIsVip}get isYear(){return this.mIsYear}get isPlatinumVip(){return this.isVip&&this.vasType>2}get isSuperVip(){return this.isVip&&5===this.vasType}get vipLevel(){return this.mVipLevel}get vasType(){return this.mVasType}get userLevel(){return 1}get vipType(){let e=0;return this.isSuperVip?e=5:this.isPlatinumVip?e=3:this.isVip&&(e=2),e}get authority(){return this.isVip}get offlineAuthority(){return this.isLogin}authorityChanged(e,t){this.emit(s.authorityChanged,e,t)}attachUserEvents(){return n(this,void 0,void 0,function*(){let e=yield r.client.callServerFunction("IsLogined");if(null===e){let t=setInterval(()=>n(this,void 0,void 0,function*(){(e=yield r.client.callServerFunction("IsLogined"))&&this.onLogin().catch(),null!==e&&(clearInterval(t),r.client.attachServerEvent("onUserInfoChange",this.onUserInfoChange.bind(this)),r.client.attachServerEvent("onLoginStatusChange",this.onLoginStatusChange.bind(this)))}),50)}else e&&this.onLogin().catch(),r.client.attachServerEvent("onUserInfoChange",this.onUserInfoChange.bind(this)),r.client.attachServerEvent("onLoginStatusChange",this.onLoginStatusChange.bind(this))})}onLogin(){return n(this,void 0,void 0,function*(){a.information("--\x3eonLogin"),this.mPreUserIsVip=this.mIsVip,this.clear(),this.mIsLogin=!0,yield this.parseUserInfo(),this.emit(s.login),this.authorityChanged(this.authority),a.information("<--onLogin")})}onLogout(){a.information("--\x3eonLogout"),this.mPreUserIsVip=this.mIsVip,this.clear(),this.emit(s.logout),this.authorityChanged(!1),a.information("<--onLogout")}onUserInfoChange(e,t,i){return n(this,void 0,void 0,function*(){a.information("--\x3eonUserInfoChange"),"vipinfo"===t&&(a.information("data",i),yield this.parseUserInfo(),this.mIsVip&&this.authorityChanged(this.authority,!0)),a.information("<--onUserInfoChange")})}onLoginStatusChange(e,t,i){a.information("--\x3eonLoginStatusChange","newStatus",i),"unlogin"===i||"offline"===i?this.onLogout():"online"===i&&this.onLogin().catch(),a.information("<--onLoginStatusChange")}clear(){this.mUserId="0",this.mSessionId=void 0,this.mIsVip=!1,this.mIsLogin=!1,this.mVasType=0,this.mVipLevel=0}parseUserInfo(){return n(this,void 0,void 0,function*(){let e=yield this.getUserinfo();if(a.information("userinfo",e),e)if(this.mUserId=e.userID||"0",e.vipList&&e.vipList[0]){if(e.vipList[0].isVip){let t=Number(e.vipList[0].isVip).valueOf();this.mIsVip=t>0}else this.mIsVip=!1;if(e.vipList[0].vipLevel&&(this.mVipLevel=Number(e.vipList[0].vipLevel).valueOf()),e.vipList[0].vasType&&(this.mVasType=Number(e.vipList[0].vasType).valueOf()),e.vipList[0].isYear){let t=Number(e.vipList[0].isYear).valueOf();this.mIsYear=1===t}}else this.mIsVip=!1})}}t.UserHelper=l,t.default=new l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ThunderChannelList=void 0,function(e){e.channelBase="ChannelBase",e.channelRMNewTaskSetTaskData=e.channelBase+"1",e.channelRMPreNewTaskSetTaskData=e.channelBase+"2",e.channelRMNewTaskCreateNewTask=e.channelBase+"3",e.channelRMNewTaskSetBTInfo=e.channelBase+"4",e.channelRMNewTaskDownloadTorrent=e.channelBase+"5",e.channelRMNewTaskCreateBtTask=e.channelBase+"6",e.channelRMNewTaskCancleMagnet=e.channelBase+"7",e.channelRMImportTorrent=e.channelBase+"8",e.channelRMGetConfigValueResolve=e.channelBase+"9",e.channelRMGetConfigValueReject=e.channelBase+"10",e.channelMRTrayMenuClick=e.channelBase+"11",e.channelMRNewTaskMagnetTaskCreated=e.channelBase+"12",e.channelMRNewTaskDownloadTorrentResult=e.channelBase+"13",e.channelMRNewTaskCreateNewTaskResult=e.channelBase+"14",e.channelMRNewTaskCreateBtTaskResult=e.channelBase+"15",e.channelMRGetConfigValue=e.channelBase+"16",e.channelMRSetConfigValue=e.channelBase+"17",e.channelRMCommitPlanTask=e.channelBase+"18",e.channelRMPerformePlanTask=e.channelBase+"19",e.channelRMProcessSend=e.channelBase+"20",e.channelRMGetPrivateSpaceInfo=e.channelBase+"21",e.channelMRGetPrivateSpaceInfoResult=e.channelBase+"22",e.channelRMFileCopy=e.channelBase+"23",e.channelRMFileMove=e.channelBase+"24",e.channelMRFileCopyResult=e.channelBase+"25",e.channelMRFileMoveResult=e.channelBase+"26",e.channelRMGetSutitleByCid=e.channelBase+"27",e.channelMRGetSutitleByCidResult=e.channelBase+"28",e.channelRMGetSutitleByName=e.channelBase+"29",e.channelMRGetSutitleByNameResult=e.channelBase+"30",e.channelRMDownloadSutitle=e.channelBase+"31",e.channelMRDownloadSutitleSuc=e.channelBase+"32",e.channelMRDownloadSutitleFail=e.channelBase+"33",e.channelRMGetDisplayName=e.channelBase+"34",e.channelMRGetDisplayNameResult=e.channelBase+"35",e.channelMRBringWindowToTop=e.channelBase+"36",e.channelRMDownloadXmp=e.channelBase+"37",e.channelMRFixXmpSuc=e.channelBase+"38",e.channelMRFixXMPFail=e.channelBase+"39",e.channelMRAPlayerCreated=e.channelBase+"41",e.channelMRMainRendererNativeCallInited=e.channelBase+"42",e.channelMRShowWindow=e.channelBase+"43",e.channelMRCreateTopView=e.channelBase+"44",e.channelMRSendTopView=e.channelBase+"44.1",e.channelMRDestroyTopView=e.channelBase+"44.5",e.channelMRCreateTopViewReadyFinish=e.channelBase+"45",e.channelMRCreateTopViewFinish=e.channelBase+"45.5",e.channelMRCreateCtrlView=e.channelBase+"46",e.channelMRSendCtrlView=e.channelBase+"46.1",e.channelMRDestroyCtrlView=e.channelBase+"46.5",e.channelMRCreateCtrlViewReadyFinish=e.channelBase+"47",e.channelMRCreateCtrlViewFinish=e.channelBase+"47.5",e.channelMRCreateSideBar=e.channelBase+"48",e.channelMRCreateSideBarFinish=e.channelBase+"49",e.channelMRExpandListWindow=e.channelBase+"52",e.channelMRExpandListVue=e.channelBase+"53",e.channelMRSetChangeViewSize=e.channelBase+"54",e.channelMRSyncShowMode=e.channelBase+"55",e.channelMRAPWindowUpdate=e.channelBase+"56",e.channelMRUpdateAPlayerPos=e.channelBase+"57",e.channelMRXmpVideoTipCreated=e.channelBase+"58",e.channelMRXmpVideoTipDestroy=e.channelBase+"59",e.channelMRShowSettingCenterWindow=e.channelBase+"60",e.channelRMSetPosition=e.channelBase+"61",e.channelRMShowPlaySettingWindow=e.channelBase+"62",e.channelRMShowCursor=e.channelBase+"63",e.channelRMAPlayerState=e.channelBase+"64",e.channelRMAPlayerProgress=e.channelBase+"65",e.channelRMPlayAction=e.channelBase+"66",e.channelRMSetFoucs=e.channelBase+"67",e.channelMRSetZorder=e.channelBase+"68",e.channelRMGetBrowserStartType=e.channelBase+"69",e.channelMRGetBrowserStartTypeResult=e.channelBase+"70",e.channelMRWindowPopUp=e.channelBase+"71",e.channelMRUpdateTipWindowZorder=e.channelBase+"72",e.channelMRSetShadowWindowResize=e.channelBase+"73",e.channelMRBrowserWindowChange=e.channelBase+"74",e.channelMRChangeFullScreen=e.channelBase+"75",e.channelMRTabNumberChange=e.channelBase+"76",e.channelMRThumbTaskBarAction=e.channelBase+"77",e.channelMRThumbTaskBarButtonStatus=e.channelBase+"78",e.channelRMOpenFolder=e.channelBase+"79",e.channelRReCreateCtrlWindow=e.channelBase+"80",e.channelRReCreateTopWindow=e.channelBase+"81",e.channelRMSetEnvironmentVariable=e.channelBase+"82",e.channelRMServerStarted=e.channelBase+"83",e.channelRMOpenDevTools=e.channelBase+"84",e.channelEnterEditMode=e.channelBase+"85",e.channelUpdateEditRect=e.channelBase+"86",e.channelMessageBoxClose=e.channelBase+"87",e.channelPreventSleep=e.channelBase+"88",e.channelCancelPreventSleep=e.channelBase+"89",e.channelCloseEffectWindow=e.channelBase+"90",e.channelPopUpMenu=e.channelBase+"91",e.channelHideTray=e.channelBase+"92",e.channelEmbedMoveResize=e.channelBase+"94",e.channelTimeTipPos=e.channelBase+"95",e.channelUpdateVideoTip=e.channelBase+"96",e.channelGetBrowserView=e.channelBase+"97",e.channelGetBrowserViewResult=e.channelBase+"98",e.channelBrowserViewLoad=e.channelBase+"99",e.channelBrowserViewOpenDev=e.channelBase+"100",e.channelApplyBrowserView=e.channelBase+"101",e.channelCreateBrowserView=e.channelBase+"102",e.channelCreateBrowserViewResult=e.channelBase+"103",e.channelBrowserViewCall=e.channelBase+"104",e.channelBrowserViewCallRet=e.channelBase+"105",e.channelEmbedWindowRgn=e.channelBase+"106",e.channelRMUpdateLogEnviroment="RM_UPDATE_LOG_ENVIRONMENT",e.channelMRUpdateLogEnviroment="MR_UPDATE_LOG_ENVIRONMENT"}(t.ThunderChannelList||(t.ThunderChannelList={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.information=((...e)=>{}),t.error=((...e)=>{}),t.warning=((...e)=>{}),t.critical=((...e)=>{}),t.verbose=((...e)=>{})},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmpVideoTipItemAW=void 0;t.XmpVideoTipItemAW=class{constructor(e){this.xmpVideoTipItem=null,this.xmpVideoTipItem=e}getId(){return this.xmpVideoTipItem.getId()}getObject(){return this.xmpVideoTipItem}getType(){return this.xmpVideoTipItem.getType()}setText(e){this.xmpVideoTipItem.setText(e)}getText(){return new Promise(e=>{this.xmpVideoTipItem.getText(t=>{e(t)})})}setTextColor(e,t){this.xmpVideoTipItem.setTextColor(e,t)}getTextColor(){return new Promise(e=>{this.xmpVideoTipItem.getTextColor(t=>{e(t)})})}setTextFont(e,t){this.xmpVideoTipItem.setTextFont(e,t)}getTextFont(){return new Promise(e=>{this.xmpVideoTipItem.getTextFont(t=>{e(t)})})}setTextFontFaceName(e,t){this.xmpVideoTipItem.setTextFontFaceName(e,t)}getTextFontFaceName(){return new Promise(e=>{this.xmpVideoTipItem.getTextFontFaceName(t=>{e(t)})})}setTextFontHeight(e,t){this.xmpVideoTipItem.setTextFontHeight(e,t)}getTextFontHeight(){return new Promise(e=>{this.xmpVideoTipItem.getTextFontHeight(t=>{e(t)})})}setTextFontBold(e,t){this.xmpVideoTipItem.setTextFontBold(e,t)}getTextFontBold(){return new Promise(e=>{this.xmpVideoTipItem.getTextFontBold(t=>{e(t)})})}setTextFontItalic(e,t){this.setTextFontItalic(e,t)}getTextFontItalic(){return new Promise(e=>{this.xmpVideoTipItem.getTextFontBold(t=>{e(t)})})}setTextFontUnderline(e,t){this.xmpVideoTipItem.setTextFontUnderline(e,t)}getTextFontUnderline(){return new Promise(e=>{this.xmpVideoTipItem.getTextFontBold(t=>{e(t)})})}setTextFontStrikeout(e,t){this.xmpVideoTipItem.setTextFontStrikeout(e,t)}getTextFontStrikeout(){return new Promise(e=>{this.xmpVideoTipItem.getTextFontStrikeout(t=>{e(t)})})}getTextExtent(e){return new Promise(t=>{this.xmpVideoTipItem.getTextExtent(e,e=>{t(e)})})}setLightColor(e,t){this.xmpVideoTipItem.setLightColor(e,t)}setLightThickness(e,t){this.xmpVideoTipItem.setLightThickness(e,t)}setBorderColor(e,t){this.xmpVideoTipItem.setBorderColor(e,t)}setBorderThickness(e,t){this.xmpVideoTipItem.setBorderThickness(e,t)}setStringTrimming(e,t){this.xmpVideoTipItem.setStringTrimming(e,t)}getStringTrimming(){return new Promise(e=>{this.xmpVideoTipItem.getStringTrimming(t=>{e(t)})})}setEndReturn(e,t){this.xmpVideoTipItem.setEndReturn(e,t)}getEndReturn(){return new Promise(e=>{this.xmpVideoTipItem.getEndReturn(t=>{e(t)})})}setMaxWidth(e,t){this.xmpVideoTipItem.setMaxWidth(e,t)}getMaxWidth(){return new Promise(e=>{this.xmpVideoTipItem.getMaxWidth(t=>{e(t)})})}getOwnerContainer(){return this.xmpVideoTipItem.getOwnerContainer()}getObjPos(){return new Promise(e=>{this.xmpVideoTipItem.getObjPos(t=>{e(t)})})}invalidate(e){this.xmpVideoTipItem.invalidate(e)}setVSpacing(e){this.xmpVideoTipItem.setVSpacing(e)}setHSpacing(e){this.xmpVideoTipItem.setHSpacing(e)}getVSpacing(){return new Promise(e=>{this.xmpVideoTipItem.getVSpacing(t=>{e(t)})})}getHSpacing(){return new Promise(e=>{this.xmpVideoTipItem.getHSpacing(t=>{e(t)})})}setInsetHSpacing(e){this.xmpVideoTipItem.setInsetHSpacing(e)}getInsetHSpacing(){return new Promise(e=>{this.xmpVideoTipItem.getInsetHSpacing(t=>{e(t)})})}setObjPos(e,t,i,n){this.xmpVideoTipItem.setObjPos(e,t,i,n)}setLineAlignment(e,t){this.xmpVideoTipItem.setLineAlignment(e,t)}setAlignment(e,t){this.xmpVideoTipItem.setAlignment(e,t)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.playStat=void 0;const o=i(1),r=i(1),a=i(18),s=i(5),l=i(7),d=i(0),u=i(11),c=i(3),h=i(4),p=i(2),f=i(10),m=i(6),g=i(63),S=i(21),y=i(64),C=i(131),I=y.XmpSubtitleNS.getSubtitleManager(),v=l.XmpMediaManagerNS.getXmpMediaManager().getXmpPlayer(),T=d.default.getLogger("PlayStat");t.playStat=new class{constructor(){this.playIds=new Map,this.playSubType=0,this.playState="",this.cookieTimer=null,this.playingRealTime=0,this.playResult="success",this.tpBuffingCount=0,this.firstBuffTime=0,this.thenBuffNum=0,this.thenBuffTime=0,this.dragBuffNum=0,this.dragBuffTime=0,this.tpEnterBuffing=!1,this.tpBuffingBeing=0,this.tpBuffingEnd=0,this.tpPulseDrag=!1,this.tpPauseTime=0,this.aPlayerNormalBufferCount=0,this.aPlayerNormalBufferTime=0,this.aPlayerSeekCount=0,this.tpPauseTimer=null,this.timePlayTick=0,this.timePauseTick=0,this.endType="",this.tpEndType="",this.aplayerEndType="",this.clickStartTime=0,this.beforeOpenTime=0,this.yunDownloadId=0,this.mediaPlay={},this.statInfo=new Map,this.mediaMode=new Map}setYunDownloadId(e){T.information("cqm setYunDownloadId yunDownloadId",e),this.yunDownloadId=e}setBeforeOpenTime(e){T.information("cqm setBeforeOpenTime beforeOpenTime",e),this.beforeOpenTime=e}setclickStartTime(e){T.information("cqm setclickStartTime clickStartTime",e),this.clickStartTime=e}addAPlayerNormalBufferCount(){this.aPlayerNormalBufferCount++}addAPlayerSeekCount(){this.aPlayerSeekCount++}recEndType(e=""){T.information(this.timePauseTick,this.tpPauseTime,this.dragBuffNum),T.information("cqm",e),this.tpEndType=e}setAPlayerNormalBufferTime(e){this.aPlayerNormalBufferTime+=e}enterBuffering(){this.tpEnterBuffing||(this.tpEnterBuffing=!0,this.tpBuffingBeing=(new Date).getTime(),this.tpBuffingCount++)}leaveBuffering(){return n(this,void 0,void 0,function*(){let e=yield v.getConfig(u.APlayerConfigId.CONFIGID_NETWORK__ISSEEKBUFFER);if(this.tpEnterBuffing&&(this.tpBuffingEnd=(new Date).getTime(),1===this.tpBuffingCount?this.tpBuffingEnd>this.tpBuffingBeing&&(this.firstBuffTime=this.tpBuffingEnd-this.tpBuffingBeing,this.firstBuffTime=parseFloat(this.firstBuffTime.toFixed(2))):this.tpBuffingCount>1&&(this.thenBuffNum++,this.tpBuffingEnd>this.tpBuffingBeing&&(this.thenBuffTime=this.tpBuffingEnd-this.tpBuffingBeing,this.thenBuffTime=parseFloat(this.thenBuffTime.toFixed(2)))),this.tpPulseDrag&&(this.dragBuffNum++,this.tpBuffingEnd>this.tpBuffingBeing&&(this.dragBuffTime=this.tpBuffingEnd-this.tpBuffingBeing,this.dragBuffTime=parseFloat(this.dragBuffTime.toFixed(2))),this.tpPulseDrag=!1),this.tpEnterBuffing=!1,"0"===e)){this.addAPlayerNormalBufferCount();let e=this.tpBuffingEnd-this.tpBuffingBeing;this.setAPlayerNormalBufferTime(e)}})}beingPauseTimer(e){if(e){if(this.tpPauseTimer)return;this.tpPauseTimer=setInterval(()=>{this.tpPauseTime++},1e3)}else this.tpPauseTimer&&(clearInterval(this.tpPauseTimer),this.tpPauseTimer=null)}init(){v.attachListener(s.XmpEvent.onBuffer,e=>n(this,void 0,void 0,function*(){e>=0&&e<100?this.enterBuffering():yield this.leaveBuffering()})),v.attachListener(s.XmpEvent.onPreOpen,(e,t)=>n(this,void 0,void 0,function*(){let i=this.statInfo.get(e);t?(this.playState="change_resolution",i&&(i.playState="change_resolution")):(this.playState=" first",this.playIds.set(e,Math.floor((new Date).getTime()/1e3)),this.aPlayerNormalBufferCount=0,this.aPlayerNormalBufferTime=0,this.aPlayerSeekCount=0,i&&(i.playState="first"))})),v.attachListener(s.XmpEvent.onOpenSucceeded,()=>n(this,void 0,void 0,function*(){this.playResult="success",this.startRecTime(),this.recPlayTime(!0);let e=(new Date).getTime();T.information("cqm onOpenSucceeded time",e,e-this.beforeOpenTime)})),v.attachListener(s.XmpEvent.onPlaying,(e,t)=>n(this,void 0,void 0,function*(){if(yield this.leaveBuffering(),this.tpEnterBuffing=!1,this.beingPauseTimer(!1),void 0===this.mediaPlay[e]){this.mediaPlay[e]=!1;let t=(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getXmpCurrentMode))[0];yield this.sendPlayStart(e,t)}})),v.attachListener(s.XmpEvent.onPreStop,(e,t,i,o)=>n(this,void 0,void 0,function*(){this.mediaPlay[e]=void 0;let n=yield v.getConfig(u.APlayerConfigId.CONFIGID_PLAYRESULT);T.information("cqm playRes",n,"state",t,"errorCode",i,"errorFrom",o),0!==Number(n)&&1!==Number(n)?this.aplayerEndType="2":t===h.XmpMediaState.Completed?this.aplayerEndType="0":this.aplayerEndType="1",i&&0!==Number(i)?(this.playResult="fail",this.endType="error"):("0"!==n&&t!==h.XmpMediaState.Completed||(this.tpEndType="success"),""===this.tpEndType&&(this.tpEndType="other"),this.endType=this.tpEndType),yield this.sendPlayEnd(e,i,o),this.resetData()})),setInterval(()=>n(this,void 0,void 0,function*(){let e=v.getState();e>h.XmpMediaState.Opening&&(this.timePlayTick+=1e3),e===h.XmpMediaState.Paused&&(this.timePauseTick+=1e3)}),1e3)}setMediaMode(e,t){this.mediaMode.set(e,t)}startRecTime(){this.cookieTimer||(this.cookieTimer=setInterval(()=>{let e=v.getState();e!==h.XmpMediaState.Play&&e!==h.XmpMediaState.Playing||(this.playingRealTime+=1e3)},1e3))}stopRecTime(){this.cookieTimer&&(clearInterval(this.cookieTimer),this.cookieTimer=null,this.playingRealTime=0)}resetData(){this.playSubType=0,this.endType="",this.tpBuffingCount=0,this.thenBuffNum=0,this.firstBuffTime=0,this.thenBuffTime=0,this.timePlayTick=0,this.timePauseTick=0,this.tpEndType="",this.stopRecTime()}recPlayTime(e){}isDownAndPlayUrl(e){if(!e)return!1;let t=new RegExp("^http://127.0.0.1.*","g");return!!e.match(t)}getFileSubType(e,t){return n(this,void 0,void 0,function*(){switch(e){case h.XmpMediaType.Dc:if(!t){this.playSubType=68;break}if(yield g.FileSystemAWNS.existsAW(t)){this.playSubType=18;break}this.isDownAndPlayUrl(t)?this.playSubType=8:-1!==t.indexOf(".xunlei.com")?this.playSubType=18:-1!==t.indexOf("http://")?".m3u8"===o.extname(t)?this.playSubType=28:this.playSubType=38:-1!==t.indexOf("mms://")||-1!==t.indexOf("rtsp://")||-1!==t.indexOf("srtsp://")?this.playSubType=48:-1!==t.indexOf("rtmp://")?this.playSubType=58:this.playSubType=68;break;case h.XmpMediaType.LocalUrl:this.playSubType=8}})}sendPlayStart(e,t){return n(this,void 0,void 0,function*(){let i="",n=(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getMediaInfo,e))[0];if(!n)return;let r=n.playType,s=n.type,l=n.playUrl,d=n.url;yield this.getFileSubType(s,d);let h=this.playIds.get(e);i=(i=(i=(i=(i=(i=(i=i+"play_from="+n.playFrom)+",playid="+h)+",type="+r)+",subtype="+this.playSubType)+",gcid="+n.gcid)+",fileurl="+encodeURIComponent(d))+",url="+encodeURIComponent(l);let g=n.name;i=i+",filename="+encodeURIComponent(g);let S=n.panFileId;S=S||" ",i=i+",file_id="+encodeURIComponent(S);let y="";g&&(y=o.extname(g),i=i+",filetype="+encodeURIComponent(y)),i=(i=i+",filesize="+(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getConfig,u.APlayerConfigId.CONFIGID_FILESIZE))[0])+",filetime="+(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getDuration))[0],i+=",vip_type="+(yield this.getVipLevel());let C=yield(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getVideoWidth))[0],I=yield(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getVideoHeight))[0];i+=`,pixels=${C}*${I}`,S&&" "!==S?(i+=`,video_resolution=${n.resolution}`,i+=`,is_transcode=${Number(n.transcode)?"yes":"no"}`):i+=",is_transcode=no",t===f.XmpMode.EMBED_MODE?i+=",components_type=embed":t===f.XmpMode.INDEPENDENT_MODE&&(i+=",components_type=independent"),0===Number(C)||0===Number(I)?i+=",is_audio=yes":i+=",is_audio=no",i+=",play_state="+this.playState,i+=`,is_throwing_screen=${n.dlna?"yes":"no"}`,i+=",video_code="+(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getConfig,u.APlayerConfigId.CONFIGID_VIDEOCODEC))[0],i+=",audio_code="+(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getConfig,u.APlayerConfigId.CONFIGID_AUDIOCODEC))[0];let v=(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getConfig,u.APlayerConfigId.CONFIGID_AUDIOINPUTCHANNELS))[0];i+=",vocal_tract_num="+parseInt(v,10);let E=a.ThunderHelper.getGraphicsAdapterList(),b="null";if(E.list){b="";let e="";for(let t=0;t<E.list.length;t++)"string"==typeof(e=E.list[t])&&e.includes("Microsoft Basic Render Driver")||(b+="["+e+"]")}i+=",gpu="+b;let P=(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getConfig,u.APlayerConfigId.CONFIGID_FRAMESDRAWN))[0],w=parseInt(P,10);w||(w=0);let D=0;this.playingRealTime>0&&(D=w/this.playingRealTime),i+=",frame_rate="+D,i+=",picture_enhancement=0",i+=",hardware_speedup_succ="+(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getConfig,u.APlayerConfigId.CONFIGID_SPEEDUPENABLE))[0],i+=",is_virtual_surround=0",yield p.client.callServerFunction("TrackEvent","core_event","player_start","",0,0,0,0,i),T.warning("cqm xmp_player_start extData:",i)})}setInfo(e,t){this.statInfo.set(e,t),T.warning("cqm setInfo info",t)}sendPlayEnd(e,t=0,i){return n(this,void 0,void 0,function*(){let i="",n=(yield p.client.callRemoteClientFunction(m.mainRendererContext,c.XmpPlayerFunction.getMediaInfo,e))[0];if(T.warning("cqm media",n),!n)return;let s=this.statInfo.get(e);T.warning("cqm sendPlayEnd info",s),s.playState?(i+="play_state="+s.playState,i+=",play_start_type="+s.playState):(i+="play_state="+this.playState,i+=",play_start_type="+this.playState);let l=n.panFileId;(l=l||" ")&&" "!==l?(i+=`,video_resolution=${n.resolution}`,i+=`,is_transcode=${Number(n.transcode)?"yes":"no"}`):i+=",is_transcode=no";let d=I.getCurrentSubtitle();d&&(yield d.isShow())?d.getType()===S.SubtitleType.Embed?i+=",subtitle_type=inline_subtitle":d.getType()===S.SubtitleType.Online?i+=",subtitle_type=online_subtitle":d.getType()!==S.SubtitleType.Local&&d.getType()!==S.SubtitleType.Manual||(i+=",subtitle_type=local_subtitle"):i+=",subtitle_type=hide_subtitle",I.getLocalSubtitleList().length>0||I.getManualSubtitleList().length>0?i+=",is_local_subtitle=yes":i+=",is_local_subtitle=no",I.getOnlineSubtitleList().length>0?i+=",is_online_subtitle=yes":i+=",is_online_subtitle=no",I.getEmbedSubtitleList().length>0?i+=",is_inline_subtitle=yes":i+=",is_inline_subtitle=no",i=(i=(i=i+",play_from="+n.playFrom)+",playid="+this.playIds.get(e))+",gcid="+n.gcid;let u=n.playUrl,h=n.url;i=(i=i+",fileurl="+encodeURIComponent(h))+",url="+encodeURIComponent(u);let g=n.name;i=(i=i+",filename="+encodeURIComponent(g))+",filetime="+s.fileTime;let y=n.playType;i=(i=i+",type="+y)+",subtype="+this.playSubType,i+=",video_code="+s.videoCodec,i+=",audio_code="+s.audioCodec,i+=",vocal_tract_num="+parseInt(s.audioTracksStr,10);let C=parseInt(s.frameDrawStr,10);C||(C=0);let v=0;this.playingRealTime>0&&(v=1e3*C/this.playingRealTime),i+=",frame_rate="+v;let E="";g&&(E=o.extname(g),i=i+",filetype="+encodeURIComponent(E));let b=n.playSpeed.toString();"50"===b&&(b="0.5"),"75"===b&&(b="0.75"),"100"===b&&(b="1"),"125"===b&&(b="1.25"),"150"===b&&(b="1.5"),"175"===b&&(b="1.75"),"200"===b&&(b="2"),i+=",play_speed=play_speed_"+b,i+=",play_dur="+this.playingRealTime;let P=a.ThunderHelper.getGraphicsAdapterList(),w="null";if(P.list){w="";let e="";for(let t=0;t<P.list.length;t++)"string"==typeof(e=P.list[t])&&e.includes("Microsoft Basic Render Driver")||(w+="["+e+"]")}i+=",gpu="+w;let D=this.mediaMode.get(e);D===f.XmpMode.EMBED_MODE?i+=",components_type=embed":D===f.XmpMode.INDEPENDENT_MODE&&(i+=",components_type=independent"),0!==t||0!==Number(s.width)&&0!==Number(s.height)?i+=",is_audio=no":i+=",is_audio=yes";let O=0;this.tpBuffingCount>0&&(O=this.thenBuffNum+1),O<this.aPlayerNormalBufferCount&&(O=this.aPlayerNormalBufferCount),i+=",totalbuffernum="+O.toString(),i=(i=(i=(i+=",totalbuffertime="+(this.firstBuffTime+this.thenBuffTime).toString())+",filesize="+s.fileSize)+",endtype="+this.endType)+",playtime="+this.timePlayTick,i=(i=(i+=",hardware_speedup_succ="+s.isSucc)+",result="+this.playResult)+",errorcode="+t,i+=",is_vip="+((yield this.getIsVip())?1:0),i+=",vip_type="+(yield this.getVipLevel()),i+=",onStartOpen="+(this.beforeOpenTime-this.clickStartTime),T.information("cqm onStartOpen",this.beforeOpenTime-this.clickStartTime),i+=",APlayer_normalBufferCount="+this.aPlayerNormalBufferCount,i+=",APlayer_normalBufferTime="+this.aPlayerNormalBufferTime,i+=",APlayer_seekCount="+this.aPlayerSeekCount,i+=",APlayer_firstRenderTime="+s.firstTime;let N=r.join(__xmpRootDir,"bin/APlayer.dll");i+=",aplayer_version="+a.ThunderHelper.getFileVersion(N),i+=",APlayer_hasTsSeekIndex="+s.seekIndex,i+=",APlayer_openUrlReadByte="+s.readByte,i+=",APlayer_stuffUrlReadByte="+s.stuffReadByte;let _=yield p.client.callServerFunction("GetTaskInfoById",this.yunDownloadId);T.information("cqm taskInfo",_),5===Number(y)&&_&&_.channelInfo?(i+=",origin_receive_size="+_.channelInfo.originSize,i+=",p2s_receive_size="+_.channelInfo.p2sSize,i+=",dcdn_receive_size="+_.channelInfo.dcdnSize,i+=",p2p_receive_size="+_.channelInfo.p2pSize):(i+=",origin_receive_size=0",i+=",p2s_receive_size=0",i+=",dcdn_receive_size=0",i+=",p2p_receive_size=0"),i+=",APlayer_invalidSeekCount=0, APlayer_invalidseekTime=0",i+=",APlayer_seekTime="+Math.round(Number(s.seekTime)*this.aPlayerSeekCount),0===Number(s.frameDrawn)&&(Number(s.width)>0||Number(s.height)>0)?i+=",first_render_duration=-1":i+=",first_render_duration="+s.firstTime,i+=",peerid ="+a.ThunderHelper.getPeerID(),i+=`,is_throwing_screen=${""===s.deviceid?"no":"yes"}`,i+=`,trans_gcid=${n.transGcid}`,i+=",picture_enhancement=0",i+=",startPosition=0",i+=",end_type="+this.aplayerEndType;let F=(new Date).getTime();i+=",onRelease="+Math.abs(this.beforeOpenTime-F),i+=",APlayer_seekAverageDrawingTime="+s.drawingTime,i+=","+s.aplayerStats,yield p.client.callServerFunction("TrackEvent","core_event","player_end","",0,0,0,0,i),T.warning("cqm sendPlayEnd extData",i)})}getIsVip(){return n(this,void 0,void 0,function*(){let e=!1;try{let t=yield p.client.callServerFunction("GetUserInfo",2);if(!t)return e;let i=JSON.parse(t);i&&(e=Number(i.isVip)>0)}catch(e){}return e})}getVipLevel(){return n(this,void 0,void 0,function*(){T.information("getIsVip enter");let e=C.VipLevel.NonVip,t=yield p.client.callServerFunction("GetUserInfo",2);if(!t)return e;let i=JSON.parse(t);return i&&"1"===i.isVip&&(e=Number(i.vasType)>=5?C.VipLevel.SuperVip:Number(i.vasType)>2?C.VipLevel.BJVip:C.VipLevel.NormalVip),e})}sendBeforeQuit(){return n(this,void 0,void 0,function*(){this.recEndType("other"),this.endType="other";let e=yield p.client.callServerFunction(c.XmpPlayerFunction.getCurrentMedia);if(!e)return;let t=e[0];yield this.sendPlayEnd(t,0,""),this.resetData()})}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.LocalSubtitle=void 0;const o=i(4),r=i(7),a=i(11),s=i(21),l=i(108),d=i(0),u=i(65),c=d.default.getLogger("Subtitle.Local"),h=r.XmpMediaManagerNS.getXmpMediaManager().getXmpPlayer();class p extends l.Subtitle{constructor(e,t,i){super(e,i),this.path=t}getType(){return s.SubtitleType.Local}load(e){return n(this,void 0,void 0,function*(){c.information("load path:",this.path);let t=!1;do{this.realShowTime=0;let i="";if(this.isSecondSubtitle()||(yield this.subtitleManager.isSettingDefaultSecondSubtitle())?(yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLE2FILENAME,this.path),i=yield h.getConfig(a.APlayerConfigId.CONFIGID_SUBTITLE2FILENAME)):(yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLEFILENAME,this.path),i=yield h.getConfig(a.APlayerConfigId.CONFIGID_SUBTITLEFILENAME)),i!==this.path){c.error("load subtitle failed! path:",this.path);break}if(this.isSecondSubtitle()?(e.setXmpMediaAttribute(o.XmpMediaAttr.Subtitle2,this.path),e.setXmpMediaAttribute(o.XmpMediaAttr.Subtitle2Type,this.getType())):(e.setXmpMediaAttribute(o.XmpMediaAttr.Subtitle,this.path),e.setXmpMediaAttribute(o.XmpMediaAttr.SubtitleType,this.getType())),!this.languageList){let e;e=this.isSecondSubtitle()||(yield this.subtitleManager.isSettingDefaultSecondSubtitle())?yield h.getConfig(a.APlayerConfigId.CONFIGID_SUBTITLE2LANGUAGELIST):yield h.getConfig(a.APlayerConfigId.CONFIGID_SUBTITLELANGUAGELIST),yield this.initLanguageList(e)}if(void 0!==this.currentLanguageIndex)yield this.setLanguageIndex(this.currentLanguageIndex);else{let e="0";e=this.isSecondSubtitle()||(yield this.subtitleManager.isSettingDefaultSecondSubtitle())?yield h.getConfig(a.APlayerConfigId.CONFIGID_SUBTITLE2LANGUAGECURRENT):yield h.getConfig(a.APlayerConfigId.CONFIGID_SUBTITLELANGUAGECURRENT),yield this.setLanguageIndex(parseInt(e,10))}let n=yield this.getPosition();yield this.setPosition(n),t=!0,this.uploadSubtitle().catch()}while(0);return t&&(this.loadTimeStamp=(new Date).getTime()),t})}reportSubtitle(){return n(this,void 0,void 0,function*(){})}uploadSubtitle(){return n(this,void 0,void 0,function*(){let e=this.getType();e===s.SubtitleType.Local||e===s.SubtitleType.Manual?u.subReport.upload(this.path).catch():c.information("当前视频不是本地加载或者手动加载,无需上传")})}initLanguageList(e){return n(this,void 0,void 0,function*(){do{if(!e||e.length<=0)break;let t=[];if(e.indexOf(";")>=0){let i=(e+";").split(";");for(let e=0;e<i.length;++e){let n=i[e];if(0!==n.length){let e=!1;t.length>0&&(e=this.fixVsFilterEmbeddedSub(n)),e||t.push(n),c.information("sublancount N, path:",this.path," language : ",n)}}}else t.push("默认"),c.information("sublancount 1 path:",this.path,", language:默认");this.setLanguageList(t)}while(0)})}fixVsFilterEmbeddedSub(e){c.information("embedded subtitle fixVsFilterEmbeddedSub language:",e);let t=!1;do{let i=this.subtitleManager.getEmbedSubtitleList();if(!i||i.length<=0)break;for(let n=0;n<i.length;++n){let o=i[n].getLanguageList();for(let i=0;i<o.length;++i)if(o[i]===e){t=!0;break}if(t)break}}while(0);return t}clone(e){return new p(this.subtitleManager,this.path,e)}}t.LocalSubtitle=p},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigFunction=t.ModeChangeEvent=t.UIFunction=t.XmpMediaType=t.OpenMode=t.XmpMediaCategory=t.XmpErrorCodeNS=t.XmpMode=t.ErrorFrom=t.XmpEvent=t.XmpPlayerFunction=t.XmpPlayType=t.XmpMediaAttr=t.XmpMediaState=void 0,function(e){e[e.Invalid=-100]="Invalid",e[e.PreOpen=-10]="PreOpen",e[e.QueryExt=-9]="QueryExt",e[e.DownloadTorrent=-3]="DownloadTorrent",e[e.ParserTorrent=-2]="ParserTorrent",e[e.GetPlayUrl=-1]="GetPlayUrl",e[e.Ready=0]="Ready",e[e.Opening=1]="Opening",e[e.Pausing=2]="Pausing",e[e.Paused=3]="Paused",e[e.Playing=4]="Playing",e[e.Play=5]="Play",e[e.Closeing=6]="Closeing",e[e.Completed=7]="Completed",e[e.Stopped=8]="Stopped",e[e.Error=9]="Error"}(t.XmpMediaState||(t.XmpMediaState={})),function(e){e[e.NumberStart=0]="NumberStart",e[e.MediaId=1]="MediaId",e[e.OwnerMediaId=2]="OwnerMediaId",e[e.CreateTime=3]="CreateTime",e[e.PlayTime=4]="PlayTime",e[e.LastPlayTime=5]="LastPlayTime",e[e.Duration=6]="Duration",e[e.Height=7]="Height",e[e.Width=8]="Width",e[e.PreState=9]="PreState",e[e.State=10]="State",e[e.Position=11]="Position",e[e.LastStartPos=12]="LastStartPos",e[e.PlaySpeed=13]="PlaySpeed",e[e.SubtitleShow=14]="SubtitleShow",e[e.SubtitleLanguage=15]="SubtitleLanguage",e[e.SubtitleType=16]="SubtitleType",e[e.SubtitlePosition=17]="SubtitlePosition",e[e.SubtitleTimming=18]="SubtitleTimming",e[e.Subtitle3D=19]="Subtitle3D",e[e.Subtitle2Show=20]="Subtitle2Show",e[e.Subtitle2Language=21]="Subtitle2Language",e[e.Subtitle2Type=22]="Subtitle2Type",e[e.Subtitle2Position=23]="Subtitle2Position",e[e.Subtitle2Timming=24]="Subtitle2Timming",e[e.Subtitle23D=25]="Subtitle23D",e[e.FileSize=26]="FileSize",e[e.Category=27]="Category",e[e.Type=28]="Type",e[e.MediaIndex=29]="MediaIndex",e[e.TaskId=30]="TaskId",e[e.TaskStop=31]="TaskStop",e[e.AudioTrack=32]="AudioTrack",e[e.ThunderTaskId=33]="ThunderTaskId",e[e.ThunderTaskSubId=34]="ThunderTaskSubId",e[e.PlayPercent=35]="PlayPercent",e[e.OpenFrom=36]="OpenFrom",e[e.DLNA=37]="DLNA",e[e.transcode=38]="transcode",e[e.NumberEnd=39]="NumberEnd",e[e.StringStart=4096]="StringStart",e[e.Name=4097]="Name",e[e.Url=4098]="Url",e[e.PlayUrl=4099]="PlayUrl",e[e.Cid=4100]="Cid",e[e.Gcid=4101]="Gcid",e[e.Subtitle=4102]="Subtitle",e[e.Subtitle2=4103]="Subtitle2",e[e.Ext=4104]="Ext",e[e.Played=4105]="Played",e[e.AudioChannel=4106]="AudioChannel",e[e.OutputMode=4107]="OutputMode",e[e.Brightness=4108]="Brightness",e[e.ContrastRatio=4109]="ContrastRatio",e[e.Saturation=4110]="Saturation",e[e.SubtitleSize=4111]="SubtitleSize",e[e.SubtitleColor=4112]="SubtitleColor",e[e.SubtitleFont=4113]="SubtitleFont",e[e.Subtitle2Size=4114]="Subtitle2Size",e[e.Subtitle2Color=4115]="Subtitle2Color",e[e.Subtitle2Font=4116]="Subtitle2Font",e[e.Proportion=4117]="Proportion",e[e.AudioTime=4118]="AudioTime",e[e.Rorate=4119]="Rorate",e[e.FlipH=4120]="FlipH",e[e.FlipV=4121]="FlipV",e[e.LocalAudioTrack=4122]="LocalAudioTrack",e[e.ImgSrc=4123]="ImgSrc",e[e.PanFileId=4124]="PanFileId",e[e.RationText=4125]="RationText",e[e.RationTextEx=4126]="RationTextEx",e[e.vipLevel=4127]="vipLevel",e[e.PlayFrom=4128]="PlayFrom",e[e.resolution=4129]="resolution",e[e.trans_gcid=4130]="trans_gcid",e[e.PlayType=4131]="PlayType",e[e.StringEnd=4132]="StringEnd"}(t.XmpMediaAttr||(t.XmpMediaAttr={})),function(e){e.unKnow="UnKnow",e.localFile="LocalFile",e.downloadAndPlay="DownloadAndPlay",e.yunBo="YunBo"}(t.XmpPlayType||(t.XmpPlayType={})),function(e){e.init="XmpPlayerInit",e.showAPlayerWindow="XmpShowAPlayerWindow",e.createXmpMedia="XmpPlayerCreateXmpMedia",e.open="XmpPlayerOpen",e.openFile="XmpPlayerOpenFile",e.addFile="XmpPlayerAddFile",e.openFolder="XmpPlayerOpenFolder",e.openBt="XmpPlayerOpenBt",e.openUrl="XmpPlayerOpenUrl",e.openMedia="XmpPlayerOpenMedia",e.close="XmpPlayerClose",e.stop="XmpPlayerStop",e.play="XmpPlayerPlay",e.pause="XmpPlayerPause",e.getVersion="XmpPlayerGetVersion",e.getState="XmpPlayerGetState",e.isPlaying="XmpPlayerIsPlaying",e.getDuration="XmpPlayerGetDuration",e.getPosition="XmpPlayerGetPosition",e.setPosition="XmpPlayerSetPosition",e.getVideoWidth="XmpPlayerGetVideoWidth",e.getVideoHeight="XmpPlayerGetVideoHeight",e.getVolume="XmpPlayerGetVolume",e.setVolume="XmpPlayerSetVolume",e.isSeeking="XmpPlayerIsSeeking",e.getBufferProgress="XmpPlayerGetBufferProgress",e.getConfig="XmpPlayerGetConfig",e.setConfig="XmpPlayerSetConfig",e.setCurrentMedia="XmpPlayerSetCurrentMedia",e.getCurrentMedia="XmpPlayerGetCurrentMedia",e.getMediaAttribute="XmpPlayerMediaAttribute",e.getCurrentMediaAttribute="XmpPlayerGetCurrentMediaAttribute",e.clearCurrentMedia="XmpPlayerClearCurrentMedia",e.openPreMedia="XmpPlayerOpenPreMedia",e.openNextMedia="XmpPlayerOpenNextMedia",e.isPlayOrderFirstMedia="XmpPlayerIsPlayOrderFirstMedia",e.isPlayOrderLastMedia="XmpPlayerIsPlayOrderLastMedia",e.isFirstMedia="XmpPlayerIsFirstMedia",e.isLastMedia="XmpPlayerIsLastMedia",e.isMediasLoadFinished="XmpPlayerIsMediasLoadFinished",e.getMediasInfo="XmpPlayerGetMediasInfo",e.removeMedia="XmpPlayerRemoveMedia",e.removeAllMedia="XmpPlayerRemoveAllMedia",e.setASpectRatioAtive="XmpPlayerSetASpectRatioAtive",e.setPlayForward="XmpPlayerSetPlayForward",e.postionChange="XmpPlayerPostionChange",e.getBufferRange="XmpPlayerGetBufferRange",e.fireKeyDown="XmpPlayerFireKeyDown",e.fireKeyUp="XmpPlayerFireKeyUp",e.setAudioTime="XmpPlayerSetAudioTime",e.setProportion="XmpPlayerSetProportion",e.setVlomue="XmpPlayerSetVlomue",e.getCurView="XmpPlayerGetCurView",e.recordStat="XmpPlayerRecordStat",e.getHostWnd="XmpPlayerGetHostWnd",e.startWindowZorderChecker="StartWindowZorderChecker",e.stopWindowZorderChecker="StopWindowZorderChecker",e.setZOrderCheckerWindowHandle="SetZOrderCheckerWindowHandle",e.removeZOrderCheckerWindowHandle="RemoveZOrderCheckerWindowHandle",e.getVideoDuration="GetVideoDuration",e.getDownloadState="GetDownloadState",e.getResConfig="GetResConfig",e.queryTaskState="QueryTaskState",e.shareMediaInfo="ShareMediaInfo",e.getThunderDirState="GetThunderDirState",e.setThunderDirState="SetThunderDirState",e.showSyncDig="ShowSyncDig",e.isXmpLite="IsXmpLite",e.handleVipPlaySpeed="handleVipPlaySpeed",e.getMediaInfo="GetMediaInfo",e.getCurrentMediaInfo="GetCurrentMediaInfo",e.setMediaAttribute="XmpPlayerSetMediaAttribute",e.updateDownloadEmbedRect="UpdateDownloadEmbedRect",e.updatePanEmbedRect="UpdatePanEmbedRect",e.createIndependentWindow="CreateIndependentWindow",e.thunderResize="ThunderResize",e.updateFloatHwnd="UpdateFloatHwnd",e.updateAplayerHwnd="UpdateAplayerHwnd",e.updatePlaySource="UpdatePlaySource",e.setXmpCurrentMode="SetXmpCurrentMode",e.getXmpCurrentMode="GetXmpCurrentMode",e.destroy="XmpDestroy",e.maximize="XmpMaximize",e.unmaximize="XmpUnmaximize",e.minmized="XmpMinmized",e.setPlaySpeed="SetPlaySpeed",e.getPlaySpeed="GetPlaySpeed",e.setWindowTopMode="SetWindowTopMode",e.calcelWindowTopMode="CalcelWindowTopMode",e.enterFullScreen="EnterFullScreen",e.leaveFullScreen="LeaveFullScreen",e.getIsFullScreen="GetIsFullScreen",e.setPlayingTaskId="SetPlayingTaskId",e.setlayPingPanFileId="SetPlayingPanFileId",e.setSelectTaskId="SetSelectTaskId",e.setSelectPanel="SetSelectPanel",e.setSelectTab="SetSelectTab",e.setSelectPanFileId="SetSelectPanFileId",e.getPlayingTaskId="GetPlayingTaskId",e.getPlayingPanFileId="GetPlayingPanFileId",e.getSelectTaskId="GetSelectTaskId",e.getSelectPanel="GetSelectPanel",e.getSelectTab="GetSelectTab",e.getSelectPanFileId="GetSelectPanFileId",e.getXmpPlayType="GetXmpPlayType",e.getDownloadAndPlayTaskData="GetDownloadAndPlayTaskData",e.isCurrentBuffingIsByDrag="IsCurrentBuffingIsByDrag",e.getLastPlayError="GetLastPlayError"}(t.XmpPlayerFunction||(t.XmpPlayerFunction={})),function(e){e.onWindowMessage="OnWindowMessage",e.onStateChanged="OnStateChanged",e.onCreateMediaError="OnCreateMediaError",e.onOpenSucceeded="OnOpenSucceeded",e.onVideoSizeChanged="OnVideoSizeChanged",e.onAPlayerCreated="OnAPlayerCreated",e.onAllStoped="OnAllStoped",e.onSeekCompleted="OnSeekCompleted",e.onBuffer="OnBuffer",e.onDownloadCodec="OnDownloadCodec",e.onDownloadCodecProgress="OnDownloadCodecProgress",e.onDropFiles="OnDropFiles",e.onEvent="OnEvent",e.onGetPlayUrl="OnGetPlayUrl",e.onOpenFailed="OnOpenFailed",e.onPlayFailed="OnPlayFailed",e.onClearError="OnClearError",e.onError="OnError",e.onPlaying="OnPlaying",e.onPreOpen="OnPreOpen",e.onPaused="OnPaused",e.onPlayCompleted="OnPlayCompleted",e.onPreStop="OnPreStop",e.onStop="OnStop",e.onForceLoadingState="OnForceLoadingState",e.onVipStruckPlayState="OnVipStruckPlayState",e.onTimeDesChange="OnTimeDesChange",e.onPositionChanged="OnPositionChanged",e.onSnapShotCreated="OnSnapShotCreated",e.onXmpPlayerEvent="OnXmpPlayerEvent",e.onXmpAplayerCrash="OnXmpAplayerCrash",e.onUpdateMediaCid="OnUpdateMediaCid",e.onUpdateMediaGcid="OnUpdateMediaGcid",e.onSpeedChange="OnSpeedChange",e.onFullScreenStateChange="OnFullScreenStateChange",e.onSetConfig="OnSetConfig",e.onVolumeChange="OnVolumeChange",e.onPlayStateChange="OnPlayStateChange",e.onCurViewChanged="OnCurViewChanged",e.onUserLogin="OnUserLogin",e.onDwmCompositionChanged="OnDwmCompositionChanged",e.onDpiChanged="OnDpiChanged",e.onGPUProcessCrashed="OnGPUProcessCrashed",e.onSetCurrentDevice="OnSetCurrentDevice",e.onXmpPlayerRemoveMedias="OnXmpPlayerRemoveMedias",e.onOpenMediaNotExist="OnOpenMediaNotExist",e.onSwitchModeError="OnSwitchModeError",e.onDlnaEvent="OnDlnaEvent",e.onSubtitleInit="OnSubtitleInit",e.onSubtitleUnInit="onSubtitleUnInit",e.onEmbedSubInitFinish="OnEmbedSubInitFinish",e.onEntertCurrentDevice="OnEntertCurrentDevice",e.onWindowZOrderChanged="OnWindowZOrderChanged",e.onAplayerSeekFrameChanged="OnAplayerSeekFrameChanged",e.onModeBarChange="OnModeBarChange",e.onThunderTaskRemove="OnThunderTaskRemove",e.onXmpClose="OnXmpClose",e.onXmpStartFailed="OnXmpStartFailed",e.onVipViewInitFinish="OnVipViewInitFinish",e.onModeEvent="OnModeEvent",e.onMaxmized="OnMaxmized",e.onUnMaxmized="OnUnMaxmized",e.onSetWindowTopMost="OnWindowTopMost",e.onCancelWindowTopMost="OnCancelWindowTopMost",e.onOpenOrCloseSettingCenter="OnOpenOrCloseSettingCenter",e.onUpdateBufferingUI="OnUpdateBufferingUI"}(t.XmpEvent||(t.XmpEvent={})),function(e){e.XMP="xmp",e.APlayer="aplayer",e.DownloadKernel="download_kernel",e.Thunder="thunder",e.Other="other",e.Exit="exit",e.Crash="crash",e.Restart="restart",e.CancelDownloadCodecs="cancel_download_codecs"}(t.ErrorFrom||(t.ErrorFrom={})),function(e){e[e.UNKNOWN_MODE=-1]="UNKNOWN_MODE",e[e.INDEPENDENT_MODE=0]="INDEPENDENT_MODE",e[e.MAGNETIC_MODE=1]="MAGNETIC_MODE",e[e.EMBED_MODE=2]="EMBED_MODE"}(t.XmpMode||(t.XmpMode={})),function(e){let t=new Map([[2147746328,"无法解码该文件, 找不到所需的解码器或格式不支持，请尝试重新安装"],[2147680258,"找不到指定的资源"],[2147533648,"找不到指定的模块，请尝试重新安装"],[3222077446,"无法连接指定的服务器"],[3222080445,"无法播放受到版权保护的媒体文件"],[2147746351,"文件为空或无法访问"],[2147943792,"无效的播放参数，请确认输入了有效的播放文件地址"],[4294967263,"全网点播服务在维护中"],[1,"任务创建失败，无法继续下载"],[2,"任务参数错误，无法继续下载"],[3,"链接失效，无法继续下载"],[4,"任务配置文件错误，无法继续下载"],[5,"任务连接超时，无法继续下载"],[6,"文件校验失败，无法继续下载"],[7,"任务包含违规内容，无法继续下载"],[8,"下载引擎加速出错，无法继续下载"],[9,"文件路径超出系统限制，无法继续下载"],[201,"缓存文件创建失败，无法继续下载"],[202,"缓存文件写入失败，无法继续下载"],[203,"缓存文件读取失败，无法继续下载"],[204,"缓存文件文件重命名失败，无法继续下载"],[205,"缓存磁盘空间不足，无法继续下载，请清理再试"],[601,"BT任务已存在，无法继续下载"],[701,"任务包含违规内容，无法继续下载"],[702,"帐号存在异常，无法继续下载"],[703,"根据当地法律法规，文件无法下载"],[704,"应版权方要求，该文件无法下载"],[10001,"下载引擎未启动，无法继续下载"],[10002,"种子文件不存在，无法继续下载"],[44093,"播放进程崩溃了"],[44172,"边下边播任务异常,请尝试重启迅雷"],[44041,"本地BT媒体文件找不到,请稍后再试"],[44042,"种子内无有效的视频文件"],[44013,"媒体链接为网页地址,无法播放"],[44014,"媒体链接无法连接成功"],[44018,"不支持此媒体播放"],[44019,"媒体解码失败,无法播放"],[44091,"下载库崩溃,请重启迅雷播放组件再试"],[44111,"获取媒体格式失败"],[44112,"媒体文件下载失败"],[71200,"切换校验模式后，仍无法打开媒体文件"],[168965206,"播放失败，缺少必要的解码器"],[305419896,"播放出错, 可能暂不支持该格式解码, 建议尝试播放其他音视频文件"],[2326396930,"失效文件，可能已经被删除"]]);e.getErrorTextByErrorCode=function(e){let i=t.get(e);return i||(i="未知错误"),i}}(t.XmpErrorCodeNS||(t.XmpErrorCodeNS={})),function(e){e[e.Unkown=0]="Unkown",e[e.Download=1]="Download",e[e.Play=2]="Play",e[e.Collect=3]="Collect"}(t.XmpMediaCategory||(t.XmpMediaCategory={})),function(e){e[e.XMPDrag=0]="XMPDrag"}(t.OpenMode||(t.OpenMode={})),function(e){e[e.Unkown=0]="Unkown",e[e.Dc=1]="Dc",e[e.Vod=2]="Vod",e[e.P2s=3]="P2s",e[e.Gvod=4]="Gvod",e[e.ServerXlpan=5]="ServerXlpan",e[e.LocalXlpan=6]="LocalXlpan"}(t.XmpMediaType||(t.XmpMediaType={})),function(e){e.createButton="CreateButton",e.updateButton="UpdateButton",e.createWebview="CreateWebview",e.setDefaultVipSpeedStatus="SetDefaultVipSpeedStatus",e.updateVipSpeedStatus="UpdateVipSpeedStatus",e.getWebviewInfo="GetWebviewInfo",e.createVipView="CreateVipview",e.showCurveChart="showCurveChart",e.applyBrowserView="ApplyBrowserView",e.getBrowserViewId="GetBrowserViewId",e.initBrowserViewConfig="initBrowserViewConfig",e.createVipMenu="CreateVipMenu",e.getMenuSlot="GetMenuSlot",e.openNewTab="OpenNewTab",e.videoPause="DoVideoPause",e.videoPlay="DoVideoPlay",e.videoPauseEx="DoVideoPauseEx",e.videoPlayEx="DoVideoPlayEx",e.setPlaySpeed="SetPlaySpeed",e.setProgressColor="SetProgressColor",e.getProgressColor="GetProgressColor",e.showBufferingEntry="ShowBufferingEntry",e.isBufferingEntryShow="IsBufferingEntryShow",e.showOpenVipEntry="ShowOpenVipEntry",e.registerFunctionCall="RegisterFunctionCall",e.executeFunctionCall="ExecuteFunctionCall",e.videoGetPlayState="VideoGetPlayState",e.setXmpFocus="SetXmpFocus",e.leaveFullScreen="LeaveFullScreen"}(t.UIFunction||(t.UIFunction={})),function(e){e.onXmpModeChanging="OnXmpModeChanging",e.onXmpModeChanged="OnXmpModeChanged",e.onXmpEnterFullScreen="OnXmpEnterFullScreen",e.onXmpLeaveFullScreen="OnXmpLeaveFullScreen"}(t.ModeChangeEvent||(t.ModeChangeEvent={})),function(e){e.saveConfig="SaveConfig",e.getConfigValue="GetConfigValue",e.setConfigValue="SetConfigValue",e.isConfigInitFinish="IsConfigInitFinish",e.getConfigModules="GetConfigModules",e.setXmpAndThunderConfigValue="SetXmpAndThunderConfigValue"}(t.ConfigFunction||(t.ConfigFunction={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.CommonNS=void 0;const o=i(2),r=i(39),a=i(73),s="main-renderer";!function(e){function t(e,...t){return n(this,void 0,void 0,function*(){let i=yield o.client.callRemoteClientFunction(s,e,...t).catch();return i&&i.length>0?i[0]:{}})}function i(){return n(this,void 0,void 0,function*(){return yield t(r.XmpPlayerFunction.getXmpPlayType)})}function l(){return n(this,void 0,void 0,function*(){return(yield i())===r.XmpPlayType.yunBo})}function d(){return n(this,void 0,void 0,function*(){return Number(yield t(r.XmpPlayerFunction.getPlayingTaskId))})}e.openPayVipUrl=function(e){o.client.callRemoteClientFunction("vip-download-webview","OpenPayVipUrl",e).catch()},e.callXmp=t,e.getXmpPlayType=i,e.isYunBo=l,e.isPlayAndDownload=function(){return n(this,void 0,void 0,function*(){return(yield i())===r.XmpPlayType.downloadAndPlay})},e.isLocalPlay=function(){return n(this,void 0,void 0,function*(){return(yield i())===r.XmpPlayType.localFile})},e.getXmpCurrentMode=function(){return n(this,void 0,void 0,function*(){return t(r.XmpPlayerFunction.getXmpCurrentMode)})},e.getCurrentTaskGcid=function(){return n(this,void 0,void 0,function*(){return t(r.XmpPlayerFunction.getCurrentMediaAttribute,r.XmpMediaAttr.Gcid)})},e.getCurrentTaskId=d,e.getCurrentTaskIdOrPanId=function(){return n(this,void 0,void 0,function*(){return(yield l())?t(r.XmpPlayerFunction.getCurrentMediaAttribute,r.XmpMediaAttr.PanFileId):t(r.XmpPlayerFunction.getPlayingTaskId)})},e.getCurrentTaskStatus=function(){return n(this,void 0,void 0,function*(){let e=yield d();return a.default.getTaskStatus(e)})},e.getStatPlayType=function(){return n(this,void 0,void 0,function*(){return t(r.XmpPlayerFunction.getCurrentMediaAttribute,r.XmpMediaAttr.PlayType)})},e.getStatPlayfrom=function(){return n(this,void 0,void 0,function*(){return(yield t(r.XmpPlayerFunction.getCurrentMediaAttribute,r.XmpMediaAttr.PlayFrom))||""})},e.getStatOpenFrom=function(){return n(this,void 0,void 0,function*(){return(yield t(r.XmpPlayerFunction.getCurrentMediaAttribute,r.XmpMediaAttr.OpenFrom))||""})},e.trackShowEvnet=function(e,i,n){t("TrackShowEvent",(new Date).getTime(),e,i,function(e){let t="";return e.forEach((e,i)=>{""!==t&&(t+=","),t=t+i+"="+e}),t}(n)).catch()}}(t.CommonNS||(t.CommonNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.IpcModeControlNS=void 0;const o=i(0),r=i(2),a=i(3),s=i(7),l=i(25),d=i(10),u=i(18),c=i(4),h=i(6),p=i(59),f=i(8),m=i(5),g=i(56),S=i(60),y=i(105),C=i(46),I=i(61),v=i(11),T=i(37),E=s.XmpMediaManagerNS.getXmpMediaManager(),b=o.default.getLogger("IpcModeCtrl");let P=E.getXmpPlayer();r.client.start();!function(e){const t=new class{constructor(){this.playingStruct={},this.selectingStruct={},this.isRegister=!1,this.unmaxRect=null,this.aplayerWnd=0,this.mode=d.XmpMode.UNKNOWN_MODE,this.xmpPlayState=c.XmpMediaState.Invalid,this.isRecoXmpPlayState=!1,this.tipPosMap=[],this.showSettingCenter=!1,this.isErrorView=!1,this.mediaId=0,this.flag=!1,this.playingStruct={playingTaskId:"",playingPanFileId:"",playingSoure:d.XmpPlaySoure.PLAY_UNKNOWN},this.selectingStruct={selectTaskId:"",selectPanFileId:"",selectTab:d.DetailIndex.Preview,selectPanel:d.PanelID.Download}}registerPluginFunction(){return n(this,void 0,void 0,function*(){if(b.information("registerPluginFunction isRegister",this.isRegister),!this.isRegister){this.isRegister=!0;let e={[a.XmpPlayerFunction.open]:this.openMedia.bind(this),[a.XmpPlayerFunction.updateDownloadEmbedRect]:this.updateDownloadEmbedRect.bind(this),[a.XmpPlayerFunction.updatePanEmbedRect]:this.updatePanEmbedRect.bind(this),[a.XmpPlayerFunction.setXmpCurrentMode]:this.setXmpCurrentMode.bind(this),[a.XmpPlayerFunction.getXmpCurrentMode]:this.getXmpCurrentMode.bind(this),[a.XmpPlayerFunction.maximize]:this.xmpMaximize.bind(this),[a.XmpPlayerFunction.unmaximize]:this.xmpUnmaximize.bind(this),[a.XmpPlayerFunction.minmized]:this.xmpMinmized.bind(this),[a.XmpPlayerFunction.setWindowTopMode]:this.setWindowTopMode.bind(this),[a.XmpPlayerFunction.calcelWindowTopMode]:this.calcelWindowTopMode.bind(this),[a.XmpPlayerFunction.enterFullScreen]:this.enterFullScreen.bind(this),[a.XmpPlayerFunction.leaveFullScreen]:this.leaveFullScreen.bind(this),[a.XmpPlayerFunction.setFullcScreen]:this.setFullcScreen.bind(this),[a.XmpPlayerFunction.setPlayingTaskId]:this.setPlayingTaskId.bind(this),[a.XmpPlayerFunction.setlayPingPanFileId]:this.setPlayingPanFileId.bind(this),[a.XmpPlayerFunction.setSelectTaskId]:this.setSelectTaskId.bind(this),[a.XmpPlayerFunction.setSelectPanFileId]:this.setSelectPanFileId.bind(this),[a.XmpPlayerFunction.setSelectPanel]:this.setSelectPanel.bind(this),[a.XmpPlayerFunction.setSelectTab]:this.setSelectTab.bind(this),[a.XmpPlayerFunction.getPlayingTaskId]:this.getPlayingTaskId.bind(this),[a.XmpPlayerFunction.getPlayingPanFileId]:this.getPlayingPanFileId.bind(this),[a.XmpPlayerFunction.getPlayingSoure]:this.getPlayingSoure.bind(this),[a.XmpPlayerFunction.getSelectTaskId]:this.getSelectTaskId.bind(this),[a.XmpPlayerFunction.getSelectPanel]:this.getSelectPanel.bind(this),[a.XmpPlayerFunction.getSelectTab]:this.getSelectTab.bind(this),[a.XmpPlayerFunction.getSelectPanFileId]:this.getSelectPanFileId.bind(this),[a.XmpPlayerFunction.openDLNA]:this.openDLNA.bind(this),[a.XmpPlayerFunction.disConnectDLNA]:this.disConnectDLNA.bind(this),[a.XmpPlayerFunction.addXmpVideoTipPosMainRenderer]:this.addXmpVideoTipPos.bind(this),[a.XmpPlayerFunction.removeXmpVideoTipPosMainRenderer]:this.removeXmpVideoTipPos.bind(this),[a.XmpPlayerFunction.onTaskStopped]:this.onTaskStopped.bind(this),[a.XmpPlayerFunction.showOrHideXmpWindow]:this.showOrHideXmpWindow.bind(this),[a.XmpPlayerFunction.isCurrentBuffingIsByDrag]:this.isCurrentBuffingIsByDrag.bind(this),[a.XmpPlayerFunction.thunderQuit]:this.thunderQuit.bind(this),[a.XmpPlayerFunction.showAplayerAndFloatWindow]:this.showAplayerAndFloatWindow.bind(this),[a.XmpPlayerFunction.hideAplayerAndFloatWindow]:this.hideAplayerAndFloatWindow.bind(this),[a.XmpPlayerFunction.hideEmbedAplayerAndFloatWindow]:this.hideEmbedAplayerAndFloatWindow.bind(this),[a.XmpPlayerFunction.isPlayMusic]:this.isPlayMusic.bind(this)},t=yield r.client.callServerFunction("GetCurrentNav"),i=yield r.client.callServerFunction("GetThunderSelectTaskId"),n=yield r.client.callServerFunction("GetThunderSelectTab");yield this.setSelectPanel(null,t),yield this.setSelectTaskId(null,i),yield this.setSelectTab(null,n),r.client.registerFunctions(e)}p.XmpModeNS.attachListener(m.XmpEvent.onModeEvent,(e,...t)=>{f.server.fireClientEvent(e,...t)}),p.XmpModeNS.attachListener(m.ModeChangeEvent.onXmpModeChanging,(e,t)=>{b.information("onXmpModeChanging oldMode",e,"newMode",t)}),p.XmpModeNS.attachListener(m.ModeChangeEvent.onXmpModeChanged,(e,t,i)=>{this.mode=t,b.information("onXmpModeChanged oldMode",e,"newMode",t,i,"this.mode",this.mode)}),r.client.attachServerEvent(m.XmpEvent.onOpenOrCloseSettingCenter,(e,t)=>n(this,void 0,void 0,function*(){this.isErrorView&&(this.isErrorView=!1,yield this.setPlayingTaskId("","","")),t?(this.showSettingCenter=!0,yield this.showOrHideWindow()):this.showSettingCenter&&(this.showSettingCenter=!1,yield this.showOrHideWindow())})),r.client.attachServerEvent(m.XmpEvent.onXmpClose,()=>n(this,void 0,void 0,function*(){yield this.stopPlay("XmpEvent.onXmpClose"),yield P.close()})),r.client.attachServerEvent(m.XmpEvent.onPlayCompleted,()=>n(this,void 0,void 0,function*(){yield this.stopPlay("XmpEvent.onPlayCompleted")})),r.client.attachServerEvent(m.XmpEvent.onPreStop,()=>n(this,void 0,void 0,function*(){setTimeout(()=>{I.dlna.disConnectDevice().catch()},500)})),r.client.attachServerEvent(m.XmpEvent.onPreOpen,()=>n(this,void 0,void 0,function*(){this.isErrorView=!1,this.flag=!1})),r.client.attachServerEvent(m.XmpEvent.onError,()=>n(this,void 0,void 0,function*(){this.isErrorView=!0})),r.client.attachServerEvent(m.XmpEvent.onPlaying,()=>n(this,void 0,void 0,function*(){}))})}setAplayerPosition(){if(this.flag)return;let e=u.ThunderHelper.getWindowRect(this.aplayerWnd);e.x=0,e.y=0;let t=u.ThunderHelper.getChildWindow(this.aplayerWnd);e&&0!==e.width&&0!==e.height&&(b.information("setAplayerPosition aplayerChildHwnd ",t,"moveWindow rect",e),u.ThunderHelper.moveWindow(t,e),this.flag=!0)}stopPlay(e){return n(this,void 0,void 0,function*(){this.playingStruct.playingTaskId="",this.playingStruct.playingPanFileId="",this.playingStruct.playingSoure=d.XmpPlaySoure.PLAY_UNKNOWN,yield p.XmpModeNS.closeXmpPlugin(e),yield this.hideAplayerAndFloatWindow(),b.information("stopPlay playingStruct",this.playingStruct)})}openMedia(e,...t){return n(this,void 0,void 0,function*(){P.clearLastPlayError(),b.information("openMedia args",t);let e=t[0];this.aplayerWnd=P.getAPlayerHostWindow(),b.information("aplayerWnd",this.aplayerWnd);let i=yield l.default.getWindowHandle();u.ThunderHelper.setWindowPosEx(this.aplayerWnd,d.OptionOfHWNDInAfter.HWND_TOP,0,0,0,0,d.Uflag.SWP_NOACTIVATE|d.Uflag.SWP_NOSIZE|d.Uflag.SWP_NOMOVE,"setAPlayerPosition_"+__filename),r.client.callRemoteClientFunction(h.mainRendererContext,a.XmpPlayerFunction.recordStat,"recEndType","change_other_player").catch(),this.mediaId=yield E.createXmpMedia(e,!1),0===this.aplayerWnd&&(this.aplayerWnd=P.getAPlayerHostWindow());let n=p.XmpModeNS.getPlaySoure();p.XmpModeNS.setAplayerHwnd(this.aplayerWnd),p.XmpModeNS.setThunderHwnd(i),p.XmpModeNS.setPlaySoure(e.playSoure),yield f.server.callClientFunctionByName(h.mainProcessContext,a.XmpPlayerFunction.updateAplayerHwnd,this.aplayerWnd),yield f.server.callClientFunctionByName(h.mainProcessContext,a.XmpPlayerFunction.updatePlaySource,e.playSoure),e.isEmbed?(T.playStat.setMediaMode(this.mediaId,d.XmpMode.EMBED_MODE),yield p.XmpModeNS.setCurrentMode(d.XmpMode.EMBED_MODE,""),b.information("mode",this.mode,n,e.playSoure),this.mode===d.XmpMode.EMBED_MODE&&(yield f.server.callClientFunctionByName(h.mainProcessContext,a.XmpPlayerFunction.thunderResize))):(T.playStat.setMediaMode(this.mediaId,d.XmpMode.INDEPENDENT_MODE),yield p.XmpModeNS.setCurrentMode(d.XmpMode.INDEPENDENT_MODE,"")),yield P.play(),e.dlnaPlay&&this.openDLNA().catch(),b.information("mediaId",this.mediaId)})}updateDownloadEmbedRect(e,...t){b.warning("updateDownloadEmbedRect rect",t[0]),p.XmpModeNS.setDownloadEmbedRect(t[0])}updatePanEmbedRect(e,...t){b.warning("updatePanEmbedRect rect",t[0]),p.XmpModeNS.setPanEmbedRect(t[0])}setXmpCurrentMode(e,...t){return n(this,void 0,void 0,function*(){let e=t[0],i=t[1];yield p.XmpModeNS.setCurrentMode(e,i),T.playStat.setMediaMode(this.mediaId,e),e===d.XmpMode.EMBED_MODE&&"Float"===i&&(yield r.client.callServerFunction("BackUpEmbedAndSelectPlayingTask",this.playingStruct.playingTaskId,this.playingStruct.playingPanFileId,this.playingStruct.playingSoure))})}getXmpCurrentMode(e,...t){return p.XmpModeNS.getCurrentMode()}xmpMaximize(e,...t){return n(this,void 0,void 0,function*(){let e=S.IndependWindowHelperNS.getWindowObject();if(yield e.isMaximized())yield e.unmaximize(),null!==this.unmaxRect&&(yield e.setBounds(this.unmaxRect),this.unmaxRect=null),r.client.broadcastEvent(m.XmpEvent.onUnMaxmized);else{if(yield e.isFullScreen()){let e=yield g.windowDisplay.getWorkArea();e.height<=1&&(e.height=d.WindowParams.MIN_WINDOW_HEIGHT),e.width<=1&&(e.width=d.WindowParams.MIN_WINDOW_WIDTH),this.unmaxRect=e}yield e.maximize(),r.client.broadcastEvent(m.XmpEvent.onMaxmized)}})}xmpUnmaximize(e,...t){return n(this,void 0,void 0,function*(){this.xmpMaximize(e,...t).catch()})}xmpMinmized(e,...t){return n(this,void 0,void 0,function*(){let e=S.IndependWindowHelperNS.getWindowObject();e&&(yield e.minimize())})}setWindowTopMode(e,...t){return n(this,void 0,void 0,function*(){do{if(this.mode!==d.XmpMode.INDEPENDENT_MODE)break;let e=S.IndependWindowHelperNS.getWindowObject();if(!e)break;yield e.setAlwaysOnTop(!0),r.client.broadcastEvent(m.XmpEvent.onSetWindowTopMost)}while(0)})}calcelWindowTopMode(e,...t){return n(this,void 0,void 0,function*(){yield this.cancelMainWindowTopMost()})}cancelMainWindowTopMost(){return n(this,void 0,void 0,function*(){do{let e=S.IndependWindowHelperNS.getWindowObject();if(!e)break;let t=(yield e.getNativeWindowHandle()).readUIntLE(0,4);u.ThunderHelper.cancelTopMostWindowEx(t),u.ThunderHelper.setActiveWindowEx(t),r.client.broadcastEvent(m.XmpEvent.onCancelWindowTopMost)}while(0)})}setFullcScreen(e,...t){return n(this,void 0,void 0,function*(){let e=p.XmpModeNS.getIsFullScreen(),i=t[0],n="",o=p.XmpModeNS.getCurrentMode();o===d.XmpMode.EMBED_MODE&&(n=",components_type=embed"),o===d.XmpMode.INDEPENDENT_MODE&&(n=",components_type=independent"),b.warning("setFullcScreen isFullScreen",e),e?(n+=",button=shortcut_exit_full_screen",yield r.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,n),yield p.XmpModeNS.leaveFullScreen()):"esc"!==i&&(n+=",button=shortcut_full_screen",yield r.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,n),yield p.XmpModeNS.enterFullScreen())})}enterFullScreen(e,...t){return n(this,void 0,void 0,function*(){let e=P.getState(),t=yield P.getVideoWidth(),i=yield P.getVideoHeight();e<c.XmpMediaState.Pausing||e>c.XmpMediaState.Play?b.information("onLButtonDbClick state:",e):(t<=0||i<=0)&&this.mode===d.XmpMode.EMBED_MODE?b.information("onLButtonDbClick state:",e):yield p.XmpModeNS.enterFullScreen()})}leaveFullScreen(e,...t){return n(this,void 0,void 0,function*(){yield p.XmpModeNS.leaveFullScreen()})}setPlayingTaskId(e,...t){return n(this,void 0,void 0,function*(){this.playingStruct.playingTaskId=t[0],this.playingStruct.playingSoure=t[1],this.playingStruct.playingPanFileId="",P.setPlayingTaskId(t[0]),b.information("setPlayingTaskId playingTaskId",t[0],"playingSoure",t[1])})}setPlayingPanFileId(e,...t){return n(this,void 0,void 0,function*(){this.playingStruct.playingPanFileId=t[0],this.playingStruct.playingSoure=t[1],this.playingStruct.playingTaskId="",P.setPlayingPanFileId(t[0]),b.information("setPlayingPanFileId playingPanFileId",t[0],"playingSoure",t[1])})}setSelectTaskId(e,...t){return n(this,void 0,void 0,function*(){let e=this.selectingStruct.selectTaskId;this.selectingStruct.selectTaskId=t[0],b.information("setSelectTaskId selectTaskId",t[0]),this.isErrorView&&(this.isErrorView=!1,yield this.setPlayingTaskId("","","")),yield this.selectChange(e,t[0])})}setSelectPanFileId(e,...t){return n(this,void 0,void 0,function*(){let e=this.selectingStruct.selectPanFileId;this.selectingStruct.selectPanFileId=t[0],b.information("setSelectPanFileId oldValue",e,"selectPanFileId",t[0]),this.isErrorView&&(this.isErrorView=!1,yield this.setPlayingTaskId("","","")),yield this.selectChange(e,t[0])})}setSelectPanel(e,...t){return n(this,void 0,void 0,function*(){let e=this.selectingStruct.selectPanel;this.selectingStruct.selectPanel=t[0],b.information("setSelectPanel selectPanel",t[0]),this.isErrorView&&(this.isErrorView=!1,yield this.setPlayingTaskId("","","")),yield this.selectChange(e,t[0])})}setSelectTab(e,...t){return n(this,void 0,void 0,function*(){let e=this.selectingStruct.selectTab;this.selectingStruct.selectTab=t[0],b.information("setSelectTab selectTab",t[0]),this.isErrorView&&(this.isErrorView=!1,yield this.setPlayingTaskId("","","")),yield this.selectChange(e,t[0])})}getPlayingTaskId(e,...t){return this.playingStruct.playingTaskId}getPlayingPanFileId(e,...t){return this.playingStruct.playingPanFileId}getPlayingSoure(e,...t){return this.playingStruct.playingSoure}getSelectTaskId(e,...t){return this.selectingStruct.selectTaskId}getSelectPanel(e,...t){return this.selectingStruct.selectPanel}getSelectTab(e,...t){return this.selectingStruct.selectTab}getSelectPanFileId(e,...t){return this.selectingStruct.selectPanFileId}selectChange(e,t){return n(this,void 0,void 0,function*(){do{if(e===t)break;if(this.mode===d.XmpMode.INDEPENDENT_MODE)break;yield this.showOrHideWindow()}while(0)})}showOrHideWindow(){return n(this,void 0,void 0,function*(){if(this.mode!==d.XmpMode.EMBED_MODE)return;let e=yield this.calcWindowShowState();b.information("showOrHideWindow isShow",e),e?(yield this.showAplayerAndFloatWindow(),this.xmpPlayState!==c.XmpMediaState.Play&&this.xmpPlayState!==c.XmpMediaState.Playing||(yield P.play()),this.isRecoXmpPlayState=!1):(yield this.hideAplayerAndFloatWindow(),this.isRecoXmpPlayState||(this.xmpPlayState=P.getState(),this.isRecoXmpPlayState=!0),yield P.pause(),P.clearLastPlayError())})}calcWindowShowState(){return n(this,void 0,void 0,function*(){b.information("calcWindowShowState mode",this.mode,"playingStruct",this.playingStruct,"selectingStruct",this.selectingStruct);let e=!1;do{let t=P.getState();if(b.information("calcWindowShowState playState",t,"isErrorView",this.isErrorView,"showSettingCenter",this.showSettingCenter),(t<c.XmpMediaState.Pausing||t>c.XmpMediaState.Play)&&!this.isErrorView){let e=P.getCachedDownloadCodecInfo();if(!e||!e.downloading)break}if(this.mode===d.XmpMode.INDEPENDENT_MODE)e=!0;else if(this.mode!==d.XmpMode.EMBED_MODE)break;if(this.showSettingCenter)break;let i=yield l.default.isVisible(),n=yield l.default.isMinimized();if(!i||n)break;if(this.playingStruct.playingSoure===d.XmpPlaySoure.PLAY_BY_DOWNLOAD){if(this.selectingStruct.selectPanel!==d.PanelID.Download)break;if(this.selectingStruct.selectTab!==d.DetailIndex.Preview)break;if(this.playingStruct.playingTaskId!==this.selectingStruct.selectTaskId)break}else{if(this.playingStruct.playingSoure!==d.XmpPlaySoure.PLAY_BY_PAN)break;if(this.selectingStruct.selectPanel!==d.PanelID.Cloud)break;if(this.playingStruct.playingPanFileId!==this.selectingStruct.selectPanFileId)break}e=!0}while(0);return b.information("calcWindowShowState isShow",e),e})}showAplayerAndFloatWindow(){return n(this,void 0,void 0,function*(){b.information("showAplayerAndFloatWindow"),this.tipPosMap.forEach((e,t)=>{u.ThunderHelper.showWindow(e)});let e=yield P.getVideoWidth(),t=yield P.getVideoHeight(),i=e<=0||t<=0;i||p.XmpModeNS.setShowOrHideState(!0),yield C.default.showFloatWindow(null),P.fireXmpPlayerEvent(m.XmpEvent.onShowFloatWindow);let n=P.getState();n>=c.XmpMediaState.Pausing&&n<=c.XmpMediaState.Play&&!i&&P.showAPlayerWindow(!0)})}hideEmbedAplayerAndFloatWindow(){return n(this,void 0,void 0,function*(){this.mode===d.XmpMode.EMBED_MODE&&this.hideAplayerAndFloatWindow().catch()})}hideAplayerAndFloatWindow(){return n(this,void 0,void 0,function*(){b.information("hideAplayerAndFloatWindow"),this.tipPosMap.forEach((e,t)=>{u.ThunderHelper.hideWindow(e)}),p.XmpModeNS.setShowOrHideState(!1),yield C.default.hideFloatWindow("hideAplayerAndFloatWindow"),P.showAPlayerWindow(!1)})}openDLNA(){return n(this,void 0,void 0,function*(){setTimeout(()=>{y.MessageBox.custom("DLNAView",{size:"large"},{width:450,height:310}).catch()},1e3)})}disConnectDLNA(){I.dlna.disConnectDevice().catch()}addXmpVideoTipPos(e,t){-1===this.tipPosMap.indexOf(t)&&(b.information("addXmpVideoTipPos hwnd",t),this.tipPosMap.push(t))}removeXmpVideoTipPos(e,t){let i=this.tipPosMap.indexOf(t);this.tipPosMap.splice(i,1)}onTaskStopped(e,t){return n(this,void 0,void 0,function*(){b.information("onTaskStopped taskId",t,"playingStruct",this.playingStruct.playingTaskId),this.playingStruct.playingTaskId===t.toString()&&(r.client.callRemoteClientFunction(h.mainRendererContext,a.XmpPlayerFunction.recordStat,"recEndType","other").catch(),yield this.stopPlay("onTaskStopped"),yield P.close())})}showOrHideXmpWindow(e,...t){return n(this,void 0,void 0,function*(){b.information("cqm showOrHideXmpWindow"),yield this.showOrHideWindow()})}isCurrentBuffingIsByDrag(e,...t){return n(this,void 0,void 0,function*(){let e=yield P.getConfig(v.APlayerConfigId.CONFIGID_NETWORK__ISSEEKBUFFER);return 1===Number(e)})}thunderQuit(e,...t){return n(this,void 0,void 0,function*(){this.mode===d.XmpMode.INDEPENDENT_MODE&&(yield p.XmpModeNS.closeXmpPlugin("thunderQuit"))})}isPlayMusic(e,...t){return n(this,void 0,void 0,function*(){return P.isPlayMusic()})}};e.registerPluginFunction=function(){return n(this,void 0,void 0,function*(){yield t.registerPluginFunction()})},e.calcWindowShowState=function(){return n(this,void 0,void 0,function*(){return t.calcWindowShowState()})},e.showAplayerAndFloatWindow=function(){return n(this,void 0,void 0,function*(){return t.showAplayerAndFloatWindow()})},e.hideAplayerAndFloatWindow=function(){return n(this,void 0,void 0,function*(){return t.hideAplayerAndFloatWindow()})},e.getCurrentMode=function(){return t.getXmpCurrentMode(null)},e.setAplayerPosition=function(){return t.setAplayerPosition()}}(t.IpcModeControlNS||(t.IpcModeControlNS={}))},function(e,t){e.exports=require("net")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadKernel=void 0,function(e){let t,i,n,o,r,a,s,l,d,u,c,h,p,f,m,g,S,y,C;!function(e){e[e.Unkown=0]="Unkown",e[e.Create=1]="Create",e[e.InvaldParam=2]="InvaldParam",e[e.InvaldLink=3]="InvaldLink",e[e.InvaldConfig=4]="InvaldConfig",e[e.Timeout=5]="Timeout",e[e.VerifyData=6]="VerifyData",e[e.Forbidden=7]="Forbidden",e[e.RangeDispatch=8]="RangeDispatch",e[e.FilePathOverRanging=9]="FilePathOverRanging",e[e.FileCreate=201]="FileCreate",e[e.FileWrite=202]="FileWrite",e[e.FileRead=203]="FileRead",e[e.FileRename=204]="FileRename",e[e.FileFull=205]="FileFull",e[e.BtUploadExist=601]="BtUploadExist",e[e.ForbinddenResource=701]="ForbinddenResource",e[e.ForbinddenAccount=702]="ForbinddenAccount",e[e.ForbinddenArea=703]="ForbinddenArea",e[e.ForbinddenCopyright=704]="ForbinddenCopyright",e[e.ForbinddenReaction=705]="ForbinddenReaction",e[e.ForbinddenPorn=706]="ForbinddenPorn",e[e.DownloadSDKCrash=10001]="DownloadSDKCrash",e[e.torrentFileNotExist=10002]="torrentFileNotExist"}(t=e.TaskError||(e.TaskError={})),function(e){e[e.Unkown=-1]="Unkown",e[e.Success=0]="Success",e[e.QueryFailed=1]="QueryFailed",e[e.ServerError=2]="ServerError",e[e.ResourceNotFound=3]="ResourceNotFound",e[e.AuthorizingFailed=4]="AuthorizingFailed",e[e.ForbidByCopyright=5]="ForbidByCopyright",e[e.ForbidByPorNoGraphy=6]="ForbidByPorNoGraphy",e[e.ForbidByReactionary=7]="ForbidByReactionary",e[e.ForbidByOtherFilter=8]="ForbidByOtherFilter"}(i=e.DcdnStatusCode||(e.DcdnStatusCode={})),function(e){e[e.Begin=-1]="Begin",e[e.Unkown=0]="Unkown",e[e.StandBy=1]="StandBy",e[e.PreDownloading=2]="PreDownloading",e[e.StartWaiting=3]="StartWaiting",e[e.StartPending=4]="StartPending",e[e.Started=5]="Started",e[e.StopPending=6]="StopPending",e[e.Stopped=7]="Stopped",e[e.Succeeded=8]="Succeeded",e[e.Failed=9]="Failed",e[e.Seeding=10]="Seeding",e[e.DestroyPending=11]="DestroyPending",e[e.End=12]="End"}(n=e.TaskStatus||(e.TaskStatus={})),function(e){e[e.Begin=-1]="Begin",e[e.StandBy=0]="StandBy",e[e.Stopped=1]="Stopped",e[e.Started=2]="Started",e[e.Complete=3]="Complete",e[e.Forbidden=4]="Forbidden",e[e.Error=5]="Error",e[e.End=6]="End"}(o=e.BtFileStatus||(e.BtFileStatus={})),function(e){e[e.DispatchStrategyNone=0]="DispatchStrategyNone",e[e.DispatchStrategyOrigin=1]="DispatchStrategyOrigin",e[e.DispatchStrategyP2s=2]="DispatchStrategyP2s",e[e.DispatchStrategyP2p=4]="DispatchStrategyP2p",e[e.DispatchStrategyAll=-1]="DispatchStrategyAll"}(r=e.DispatchStrategy||(e.DispatchStrategy={})),function(e){e[e.Unkown=0]="Unkown",e[e.P2sp=1]="P2sp",e[e.Bt=2]="Bt",e[e.Emule=3]="Emule",e[e.Group=4]="Group",e[e.Magnet=5]="Magnet"}(a=e.TaskType||(e.TaskType={})),function(e){e.Unkown="Unkown",e.Downloading="Downloading",e.Completed="Completed",e.Recycle="Recycle"}(s=e.CategroyViewID||(e.CategroyViewID={})),function(e){e[e.Unknow=0]="Unknow",e[e.TaskCreated=1]="TaskCreated",e[e.InsertToCategoryView=2]="InsertToCategoryView",e[e.RemoveFromCategoryView=3]="RemoveFromCategoryView",e[e.StatusChanged=4]="StatusChanged",e[e.DetailChanged=5]="DetailChanged",e[e.ChannelInfoChanged=6]="ChannelInfoChanged",e[e.DcdnStatusChanged=7]="DcdnStatusChanged",e[e.TaskDescriptionChanged=8]="TaskDescriptionChanged",e[e.TaskUserRead=9]="TaskUserRead",e[e.TaskRenamed=10]="TaskRenamed",e[e.TaskMovedEnd=11]="TaskMovedEnd",e[e.TaskMovingStateChange=12]="TaskMovingStateChange",e[e.BtSubFileDetailChanged=13]="BtSubFileDetailChanged",e[e.BtSubFileLoaded=14]="BtSubFileLoaded",e[e.BtSubFileForbidden=15]="BtSubFileForbidden",e[e.BtSubFileDcdnStatusChanged=16]="BtSubFileDcdnStatusChanged",e[e.TaskCategoryMovedEnd=17]="TaskCategoryMovedEnd",e[e.GroupTaskSubFileDetailChanged=18]="GroupTaskSubFileDetailChanged",e[e.TaskDestroying=19]="TaskDestroying",e[e.TaskDestroyed=20]="TaskDestroyed",e[e.UpdateTaskCid=21]="UpdateTaskCid",e[e.UpdateTaskGcid=22]="UpdateTaskGcid"}(l=e.TaskEventType||(e.TaskEventType={})),function(e){e[e.NumberStrart=0]="NumberStrart",e[e.TaskId=1]="TaskId",e[e.VirtualId=2]="VirtualId",e[e.SrcTotal=3]="SrcTotal",e[e.SrcUsing=4]="SrcUsing",e[e.FileSize=5]="FileSize",e[e.ReceivedSize=6]="ReceivedSize",e[e.DownloadSize=7]="DownloadSize",e[e.TotalDownloadSize=8]="TotalDownloadSize",e[e.CreateTime=9]="CreateTime",e[e.CompletionTime=10]="CompletionTime",e[e.DownloadingPeriod=11]="DownloadingPeriod",e[e.Progress=12]="Progress",e[e.RecycleTime=13]="RecycleTime",e[e.FileCreated=14]="FileCreated",e[e.Forbidden=15]="Forbidden",e[e.CategoryId=16]="CategoryId",e[e.UserRead=17]="UserRead",e[e.OpenOnComplete=18]="OpenOnComplete",e[e.GroupTaskId=19]="GroupTaskId",e[e.DownloadSubTask=20]="DownloadSubTask",e[e.NameType=21]="NameType",e[e.OwnerProduct=22]="OwnerProduct",e[e.FileIndex=23]="FileIndex",e[e.NameFixed=24]="NameFixed",e[e.ValidDownloadSize=25]="ValidDownloadSize",e[e.RealDownloadSize=26]="RealDownloadSize",e[e.ResourceLegal=27]="ResourceLegal",e[e.TaskType=28]="TaskType",e[e.ErrorCode=29]="ErrorCode",e[e.NumberEnd=30]="NumberEnd",e[e.BooleanStart=4096]="BooleanStart",e[e.Destroyed=4097]="Destroyed",e[e.Background=4098]="Background",e[e.Moving=4099]="Moving",e[e.BooleanEnd=4100]="BooleanEnd",e[e.StringStart=8192]="StringStart",e[e.TaskName=8193]="TaskName",e[e.SavePath=8194]="SavePath",e[e.RelativePath=8195]="RelativePath",e[e.TaskUrl=8196]="TaskUrl",e[e.RefUrl=8197]="RefUrl",e[e.Cid=8198]="Cid",e[e.Gcid=8199]="Gcid",e[e.Cookie=8200]="Cookie",e[e.ProductInfo=8201]="ProductInfo",e[e.Origin=8202]="Origin",e[e.Description=8203]="Description",e[e.UserData=8204]="UserData",e[e.OriginName=8205]="OriginName",e[e.HTTPContentType=8206]="HTTPContentType",e[e.CategoryViewId=8207]="CategoryViewId",e[e.StringEnd=8208]="StringEnd",e[e.ObjectStart=12288]="ObjectStart",e[e.ObjectEnd=12289]="ObjectEnd"}(d=e.TaskAttribute||(e.TaskAttribute={})),function(e){e[e.UnKnown=0]="UnKnown",e[e.SrcTotal=1]="SrcTotal",e[e.SrcUsing=2]="SrcUsing",e[e.FileSize=4]="FileSize",e[e.ReceivedSize=8]="ReceivedSize",e[e.DownloadSize=16]="DownloadSize",e[e.CompletionTime=32]="CompletionTime",e[e.DownloadingPeriod=64]="DownloadingPeriod",e[e.Progress=128]="Progress",e[e.RecycleTime=256]="RecycleTime",e[e.FileCreated=512]="FileCreated",e[e.Forbidden=1024]="Forbidden",e[e.UserRead=2048]="UserRead",e[e.OpenOnComplete=4096]="OpenOnComplete",e[e.DownloadSubTask=8192]="DownloadSubTask",e[e.TaskName=16384]="TaskName",e[e.SavePath=32768]="SavePath",e[e.Cid=65536]="Cid",e[e.Gcid=131072]="Gcid",e[e.UserData=262144]="UserData",e[e.CategoryViewId=524288]="CategoryViewId",e[e.ErrorCode=1048576]="ErrorCode",e[e.TaskSpeed=2097152]="TaskSpeed",e[e.ChannelInfo=4194304]="ChannelInfo",e[e.ValidDownloadSize=8388608]="ValidDownloadSize"}(u=e.TaskDetailChangedFlags||(e.TaskDetailChangedFlags={})),function(e){e[e.UnKnown=0]="UnKnown"}(c=e.BtSubFileDetailChangedFlags||(e.BtSubFileDetailChangedFlags={})),function(e){e[e.UnKnown=0]="UnKnown"}(h=e.GroupTaskSubFileDetailChangedFlags||(e.GroupTaskSubFileDetailChangedFlags={})),function(e){e[e.NumberStrart=0]="NumberStrart",e[e.TaskId=1]="TaskId",e[e.FileStatus=2]="FileStatus",e[e.DownloadSize=3]="DownloadSize",e[e.FileSize=4]="FileSize",e[e.EnableDcdn=5]="EnableDcdn",e[e.ErrorCode=6]="ErrorCode",e[e.DcdnStatus=7]="DcdnStatus",e[e.RealIndex=8]="RealIndex",e[e.FileOffset=9]="FileOffset",e[e.Visible=10]="Visible",e[e.Download=11]="Download",e[e.NumberEnd=12]="NumberEnd",e[e.StringStart=13]="StringStart",e[e.FinalName=14]="FinalName",e[e.RelativePath=15]="RelativePath",e[e.FileName=16]="FileName",e[e.FilePath=17]="FilePath",e[e.Cid=18]="Cid",e[e.Gcid=19]="Gcid",e[e.StringEnd=20]="StringEnd"}(p=e.BtFileAttribute||(e.BtFileAttribute={})),function(e){e[e.P2spUrl=0]="P2spUrl",e[e.BtInfoId=1]="BtInfoId",e[e.EmuleFileHash=2]="EmuleFileHash",e[e.MagnetUrl=3]="MagnetUrl",e[e.GroupTaskName=4]="GroupTaskName"}(f=e.KeyType||(e.KeyType={})),function(e){e[e.NameInclude=1]="NameInclude",e[e.BtDisplayNameInclude=2]="BtDisplayNameInclude"}(m=e.SearchKeyType||(e.SearchKeyType={})),function(e){e[e.ExtEqual=1]="ExtEqual",e[e.NameLikeAndExtEqual=2]="NameLikeAndExtEqual",e[e.TaskTypeEqual=4]="TaskTypeEqual"}(g=e.FilterKeyType||(e.FilterKeyType={})),function(e){e[e.All=0]="All",e[e.CommonForeground=1]="CommonForeground",e[e.CommonBackground=2]="CommonBackground",e[e.Temporary=3]="Temporary",e[e.PreDownload=4]="PreDownload",e[e.PrivateForeground=5]="PrivateForeground"}(S=e.KeyFilter||(e.KeyFilter={})),function(e){e[e.Unknown=-1]="Unknown",e[e.LoadTaskBasic=0]="LoadTaskBasic",e[e.Create=1]="Create",e[e.Recycle=2]="Recycle",e[e.Recover=3]="Recover",e[e.ReDownload=4]="ReDownload",e[e.MoveThoughCategory=5]="MoveThoughCategory"}(y=e.TaskInsertReason||(e.TaskInsertReason={})),function(e){e[e.Unknown=-1]="Unknown",e[e.ContextMenu=0]="ContextMenu",e[e.Button=1]="Button",e[e.TaskDetail=2]="TaskDetail",e[e.DownloadMagnet=3]="DownloadMagnet",e[e.ToolbarButton=4]="ToolbarButton",e[e.SelectDownloadLists=5]="SelectDownloadLists",e[e.DeleteTask=6]="DeleteTask"}(C=e.TaskStopReason||(e.TaskStopReason={}))}(t.DownloadKernel||(t.DownloadKernel={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.VideoTipManagerNS=void 0;const o=i(19),r=i(1),a=i(54),s=i(16),l=i(94),d=i(34),u=i(10),c=i(56),h=i(9),p=i(0),f=i(12),m=i(2),g=i(5),S=i(8),y=i(3),C=i(25),I=i(6),v=h.default(r.join(__rootDir,"../bin/ThunderHelper.node")),T=p.default.getLogger("video-tip-manager");!function(e){e.defaultVideoTipWndId="XmpVideoTipWnd",e.defaultVideoTipContainerId="XmpVideoTipContainer";class t extends f.EventEmitter{constructor(){super(),this.factory=null,this.aplayerWnd=0,this.isinit=!1,this.setMaxListeners(0)}init(e){return n(this,void 0,void 0,function*(){do{if(this.factory)break;this.factory=new l.XmpVideoTipFactoryAW(s.XmpUtilityNS.getXmpPlayer().videoTipFactory),yield this.factory.init(),this.aplayerWnd=e,C.default.hookWindowMessage(u.WindowMessage.WM_DPICHANGED,(e,t)=>n(this,void 0,void 0,function*(){S.server.fireClientEvent(g.XmpEvent.onDpiChanged);do{if(!this.factory)break;let t=Math.floor(100*e[0]/96);T.information("WM_DPICHANGED dpiFactor:",t),this.factory.getAllVideoTipWnd().forEach(e=>n(this,void 0,void 0,function*(){e.setDpiFactor(t);let i=yield e.getWindowRect();e.moveWindow(i.x,i.y,i.width,i.height,!1)}))}while(0)})).catch(),m.client.attachServerEvent(g.XmpEvent.onDwmCompositionChanged,e=>{this.clearAndHideAllVideoTip().catch()}),this.isinit=!0,this.emit("OnInitFinish")}while(0)})}uninit(){return n(this,void 0,void 0,function*(){do{if(!this.factory)break;yield this.initAW(),yield this.factory.destroyAllVideoTipContainer(),yield this.factory.destroyAllVideoTipWnd(),yield this.factory.uninit(),this.factory=null}while(0)})}clearAndHideAllVideoTip(){return n(this,void 0,void 0,function*(){this.factory.getAllVideoTipContainer().forEach(e=>n(this,void 0,void 0,function*(){e.clear();let t=yield e.getBindWnd();t&&t.showWindow(u.CmdShow.SW_HIDE)}))})}initAW(){return n(this,void 0,void 0,function*(){if(!this.isinit)return new Promise(e=>{this.once("OnInitFinish",()=>{e()})})})}createVideoTip(e,t,i=a.XmpVideoTipWndRenderType.Layered){return n(this,void 0,void 0,function*(){do{if(yield this.initAW(),!this.factory)break;let n=yield this.getVideoTipWnd(e,!0),o=yield this.getVideoTipContainer(e,!0);if(!n||!o)break;n.setRenderType(i),n.bindContainer(o);let r=yield this.getTipParentHwnd();yield n.create(r);let a=yield c.windowDisplay.getDpi(),s=v.getWindowRect(r),l=Math.floor(s.x/a)+t.x,d=Math.floor(s.y/a)+t.y,h=t.width>0?t.width:s.width+t.width,p=t.height;T.information("cqm x",l,"y",d,"width",h,"height",p),n.moveWindow(l,d,h,p,!1);let f=yield n.getWndHandle();yield m.client.callRemoteClientFunction(I.mainProcessContext,y.XmpPlayerFunction.addXmpVideoTipPos,f,{x:t.x,y:t.y,width:t.width,height:t.height}),yield m.client.callRemoteClientFunction(I.mainRendererContext,y.XmpPlayerFunction.addXmpVideoTipPosMainRenderer,f),yield m.client.callServerFunction(y.XmpPlayerFunction.setZOrderCheckerWindowHandle,u.ZOrderChangedType.ZORDER_CHANGED_TYPE_BEFORE,f,"video-tip-window")}while(0)})}getTipParentHwnd(){return n(this,void 0,void 0,function*(){let e=this.aplayerWnd;return e||(e=yield C.default.getWindowHandle()),e})}destroyVideoTip(e){return n(this,void 0,void 0,function*(){do{if(yield this.initAW(),!this.factory)break;this.factory.destroyVideoTipContainer(e);let t=yield this.factory.getVideoTipWnd(e,!1);if(t){let i=yield t.getWndHandle();o.ipcRenderer.send(d.ThunderChannelList.channelMRXmpVideoTipDestroy,i),yield m.client.callRemoteClientFunction(I.mainProcessContext,y.XmpPlayerFunction.removeXmpVideoTipPos,i),this.factory.destroyVideoTipWnd(e),yield m.client.callServerFunction(y.XmpPlayerFunction.removeZOrderCheckerWindowHandle,i)}}while(0)})}showVideoTip(e,t){return n(this,void 0,void 0,function*(){let i=!1;do{if((yield C.default.isDestroyed())||(yield C.default.isMinimized())||!(yield C.default.isVisible()))break;if(yield this.initAW(),!this.factory)break;let n=yield this.factory.getVideoTipWnd(e,!1);if(!n)break;n.showWindow(t),i=!0}while(0);return i})}getVideoTipWnd(e,t=!0){return n(this,void 0,void 0,function*(){let i=null;do{if(yield this.initAW(),!this.factory)break;if(!(i=yield this.factory.getVideoTipWnd(e,t)))break;let n=yield c.windowDisplay.getDpi();i.setDpiFactor(100*n)}while(0);return i})}getVideoTipContainer(e,t=!0){return n(this,void 0,void 0,function*(){let i=null;do{if(yield this.initAW(),!this.factory)break;i=yield this.factory.getVideoTipContainer(e,t)}while(0);return i})}}e.VideoTipManager=t;let i=null;e.getVideoTipManager=function(){return i||(i=new t),i}}(t.VideoTipManagerNS||(t.VideoTipManagerNS={}))},function(e,t){e.exports=require("url")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.FloatWindowHelper=void 0;const o=i(18),r=i(2),a=i(31),s=i(0),l=i(10),d=i(5),u=s.default.getLogger("FloatWindowHelper");class c{constructor(){this.floatWindow=null,this.floatWindowHandle=0,this.parent=null,this.isEmbed=void 0,this.isRegister=!1,this.isdwmEnabled=!0,this.combineRects=[],this.combineFull=!1}registerPluginFunction(){if(!this.isRegister){this.isRegister=!0;let e={hideFloatWindow:this.hideFloatWindow.bind(this),showFloatWindow:this.showFloatWindow.bind(this),setCombineFloatWindowRgn:this.setCombineFloatWindowRgn.bind(this),addCombineFloatWindowRgn:this.addCombineFloatWindowRgn.bind(this),delCombineFloatWindowRgn:this.delCombineFloatWindowRgn.bind(this),clearCombineFloatWindowRgn:this.clearCombineFloatWindowRgn.bind(this),fullCombineFloatWindowRgn:this.fullCombineFloatWindowRgn.bind(this),getFloatWindowId:this.getFloatWindowId.bind(this)};r.client.registerFunctions(e),this.attachPlayeEvent().catch()}}updateFloatWindowRect(e,t){return n(this,void 0,void 0,function*(){let i={x:Math.floor(e.x*t),y:Math.floor(e.y*t),width:Math.floor(e.width*t),height:Math.floor(e.height*t)};u.warning("cqm updateFloatWindowRect rectDpi",i),o.ThunderHelper.moveWindow(this.floatWindowHandle,i)})}createFloatWindow(e,t){return n(this,void 0,void 0,function*(){let i=!e.parent;if(this.combineRects=[],this.combineFull=!1,u.information("option",e,this.parent,e===this.parent),this.floatWindow&&e.parent===this.parent)return yield this.updateFloatWindowRect({x:e.x,y:e.y,width:e.width,height:e.height},t),this.floatWindow.show().catch(),this.floatWindow.id;let n=yield this.destoryFloatWindow();this.isdwmEnabled=o.ThunderHelper.dwmIsCompositionEnabled();let r=`file:///${__dirname}/float-window-renderer/index.html`;r+=`?restart=${n?1:0}&show=${e.parent?"alone":"embed"}&dwmEnabled=${this.isdwmEnabled?"true":"false"}`;let s=yield a.rpc.getBrowserWindow();return this.parent=e.parent,this.isEmbed=i,this.floatWindow=yield new s({x:Math.floor(e.x),y:Math.floor(e.y),width:Math.floor(e.width),height:Math.floor(e.height),parent:e.parent?e.parent:yield a.rpc.getCurrentWindow(),frame:!1,resizable:!0,focusable:!0,show:!0,title:"float-window",maximizable:!1,minimizable:!1,closable:!1,movable:!1,backgroundColor:this.isdwmEnabled?"#0000":"#000",transparent:!!this.isdwmEnabled,webPreferences:{nodeIntegration:!0,devTools:!1}}),this.registerPluginFunction(),this.floatWindow.loadURL(r).catch(),this.floatWindowHandle=yield o.ThunderHelper.getBrowserWindowHandle(this.floatWindow),this.floatWindow.setResizable(!1),yield this.updateFloatWindowRect({x:e.x,y:e.y,width:e.width,height:e.height},t),yield this.updateFloatWindowRgn(),this.floatWindow.id})}hideFloatWindow(e,...t){return n(this,void 0,void 0,function*(){u.information("HideFloatWindow",e),this.floatWindow&&(this.combineRects=[],this.updateFloatWindowRgn().catch(),yield this.floatWindow.hide())})}showFloatWindow(e,...t){return n(this,void 0,void 0,function*(){u.information("ShowFloatWindow",e),this.floatWindow&&(this.combineRects=[],this.updateFloatWindowRgn().catch(),yield this.floatWindow.show())})}fullscreen(e,...t){return n(this,void 0,void 0,function*(){!t||t.length<0?this.floatWindow&&this.floatWindow.setFullScreen(!0):this.floatWindow&&this.floatWindow.setFullScreen(t[0])})}updateFloatWindowRgn(e){return n(this,void 0,void 0,function*(){if(this.isdwmEnabled)return;let t=yield o.ThunderHelper.getBrowserWindowHandle(this.floatWindow);if(0===e)return void o.ThunderHelper.setWindowRgn(t,0,!0);if(this.combineFull){let e=o.ThunderHelper.getWindowRect(t),i=o.ThunderHelper.createRectRgn(0,0,e.width,e.height);return o.ThunderHelper.setWindowRgn(t,i,!0),void o.ThunderHelper.deleteObject(i)}let i=o.ThunderHelper.getWindowRect(t),n=o.ThunderHelper.createRectRgn(0,0,i.width,40),r=o.ThunderHelper.createRectRgn(0,i.height-65,i.width,i.height);o.ThunderHelper.combineRgn(n,r,l.CombineRgnType.RGN_OR);for(let e=0;e<this.combineRects.length;++e){let t=this.combineRects[e];if(t&&t.width){let e=t.y+t.height,i=o.ThunderHelper.createRectRgn(t.x,t.y,t.x+t.width,e);o.ThunderHelper.combineRgn(n,i,l.CombineRgnType.RGN_OR)}}o.ThunderHelper.setWindowRgn(t,n,!0),o.ThunderHelper.deleteObject(n),o.ThunderHelper.deleteObject(r),u.information("updateFloatWindowRgn",i.x,i.y,i.width,i.height)})}setCombineFloatWindowRgn(e,...t){return n(this,void 0,void 0,function*(){u.information("SetCombineFloatWindowRgn",...t),this.isdwmEnabled||!t||t.length<1||(this.combineRects=t[0],yield this.updateFloatWindowRgn())})}addCombineFloatWindowRgn(e,...t){return n(this,void 0,void 0,function*(){if(u.information("AddCombineFloatWindowRgn",...t),this.isdwmEnabled)return;if(!t||t.length<1)return;let e=t[0];e.x=Math.floor(e.x),e.y=Math.floor(e.y),e.width=Math.floor(e.width),e.height=Math.floor(e.height);for(let t=0;t<this.combineRects.length;++t){let i=this.combineRects[t];if(i&&i.x===e.x&&i.y===e.y&&i.width===e.width&&i.height===e.height)return}this.combineRects.push(e),yield this.updateFloatWindowRgn()})}delCombineFloatWindowRgn(e,...t){return n(this,void 0,void 0,function*(){if(u.information("DelCombineFloatWindowRgn",...t),this.isdwmEnabled)return;let e=t[0];e.x=Math.floor(e.x),e.y=Math.floor(e.y),e.width=Math.floor(e.width),e.height=Math.floor(e.height);let i=[];for(let t=0;t<this.combineRects.length;++t){let n=this.combineRects[t];n&&n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height||i.push(n)}this.combineRects=i,yield this.updateFloatWindowRgn()})}clearCombineFloatWindowRgn(e,...t){return n(this,void 0,void 0,function*(){u.information("ClearCombineFloatWindowRgn",...t),this.isdwmEnabled||(this.combineRects=[],yield this.updateFloatWindowRgn())})}fullCombineFloatWindowRgn(e,...t){return n(this,void 0,void 0,function*(){u.information("fullCombineFloatWindowRgn",...t),this.isdwmEnabled||(t||t.length>1?this.combineFull=t[0]:this.combineFull=!0,yield this.updateFloatWindowRgn())})}getFloatWindowId(e,...t){return n(this,void 0,void 0,function*(){return this.floatWindow&&!(yield this.floatWindow.isDestroyed())?this.floatWindow.id:0})}getFloatWindow(){return this.floatWindow}getFloatWindowHandle(){return this.floatWindowHandle}destoryFloatWindow(){return n(this,void 0,void 0,function*(){return!!this.floatWindow&&(yield this.floatWindow.setClosable(!0),this.floatWindow.close(),this.floatWindow=null,this.floatWindowHandle=0,!0)})}isPointerFloatPanelArea(){let e=!1,t=o.ThunderHelper.getCursorPos();if(0!==this.floatWindowHandle){let i=o.ThunderHelper.getWindowRect(this.floatWindowHandle),n=o.ThunderHelper.getDpi(this.floatWindowHandle);t.x>=i.x&&t.x<=i.x+i.width&&t.y>=i.y&&t.y<=i.y+l.WindowParams.TOPCTRL_HEIGHT*n?e=!0:t.x>=i.x&&t.x<=i.x+i.width&&t.y<=i.y+i.height&&t.y>=i.y+i.height-l.WindowParams.PLAYCTRL_HEIGHT*n&&(e=!0)}return e}attachPlayeEvent(){return n(this,void 0,void 0,function*(){let e=100,t=0;[d.XmpEvent.onForceLoadingState,d.XmpEvent.onBuffer].forEach(i=>{r.client.attachServerEvent(i,(o,...r)=>n(this,void 0,void 0,function*(){switch(i){case d.XmpEvent.onBuffer:e=r[0];break;case d.XmpEvent.onForceLoadingState:t=r[0]}2===t||e<100?this.fullCombineFloatWindowRgn(i,!0):this.fullCombineFloatWindowRgn(i,!1)}))})})}}t.FloatWindowHelper=c,t.default=new c},function(e,t,i){"use strict";var n=i(14),o=i(114),r={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s,l={adapter:("undefined"!=typeof XMLHttpRequest?s=i(32):"undefined"!=typeof process&&(s=i(32)),s),transformRequest:[function(e,t){return o(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};l.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],function(e){l.headers[e]={}}),n.forEach(["post","put","patch"],function(e){l.headers[e]=n.merge(r)}),e.exports=l},function(e,t){e.exports=require("buffer")},function(e,t,i){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){let t,i;!function(e){e.require="AR_BROWSER_REQUIRE",e.builtIn="AR_BROWSER_GET_BUILTIN",e.global="AR_BROWSER_GET_GLOBAL",e.functionCall="AR_BROWSER_FUNCTION_CALL",e.construct="AR_BROWSER_CONSTRUCTOR",e.memberConstruct="AR_BROWSER_MEMBER_CONSTRUCTOR",e.memberCall="AR_BROWSER_MEMBER_CALL",e.memberSet="AR_BROWSER_MEMBER_SET",e.memberGet="AR_BROWSER_MEMBER_GET",e.currentWindow="AR_BROWSER_CURRENT_WINDOW",e.currentWebContents="AR_BROWSER_CURRENT_WEB_CONTENTS",e.clientWebContents="AR_BROWSER_CLIENT_WEB_CONTENTS",e.webContents="AR_BROWSER_WEB_CONTENTS",e.sync="AR_BROWSER_SYNC",e.contextRelease="AR_BROWSER_CONTEXT_RELEASE"}(t=e.browser||(e.browser={})),function(e){e.requireReturn="AR_RENDERER_REQUIRE_RETURN",e.getBuiltInReturn="AR_RENDERER_BUILTIN_RETURN",e.getGlobalReturn="AR_RENDERER_GLOBAL_RETURN",e.functionCallReturn="AR_RENDERER_FUNCTION_CALL_RETURN",e.memberConstructReturn="AR_RENDERER_MEMBER_CONSTRUCTOR_RETURN",e.constructReturn="AR_RENDERER_CONSTRUCTOR_RETURN",e.memberCallReturn="AR_RENDERER_MEMBER_CALL_RETURN",e.memberSetReturn="AR_RENDERER_MEMBER_SET_RETURN",e.memberGetReturn="AR_RENDERER_MEMBER_GET_RETURN",e.currentWindowReturn="AR_BROWSER_CURRENT_WINDOW_RETURN",e.currentWebContentsReturn="AR_RENDERER_CURRENT_WEB_CONTENTS_RETURN",e.clientWebContentsReturn="AR_RENDERER_CLIENT_WEB_CONTENTS_RETURN",e.webContentsReturn="AR_RENDERER_WEB_CONTENTS_RETURN",e.syncReturn="AR_RENDERER_SYNC_RETURN",e.callback="AR_RENDERER_CALLBACK"}(i=e.renderer||(e.renderer={}))}(n||(n={})),t.default=n},function(e,t,i){"use strict";var n;!function(e){e.getRemoteObjectName=function(e){let t=typeof e;if("function"===t)t=e.name;else if("object"===t){let t=e.name;if("string"!=typeof t){let i=e.constructor;t=i?i.name:Object.toString.call(e)}}return t},e.isPromise=function(e){return e&&e.then&&e.then instanceof Function&&e.constructor&&e.constructor.reject&&e.constructor.reject instanceof Function&&e.constructor.resolve&&e.constructor.resolve instanceof Function}}(n||(n={})),e.exports=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(88),o=i(12);t.Parser=class extends o.EventEmitter{constructor(){super(),this.decoder=new n.StringDecoder("utf8"),this.jsonBuffer=""}encode(e){return JSON.stringify(e)+"\n"}feed(e){let t=this.jsonBuffer,i=0,n=(t+=this.decoder.write(e)).indexOf("\n",i);for(;n>=0;){const e=t.slice(i,n),o=JSON.parse(e);this.emit("message",o),i=n+1,n=t.indexOf("\n",i)}this.jsonBuffer=t.slice(i)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigHelperNS=void 0;const o=i(2),r=i(3);!function(e){e.getValue=function(e,t,i){return n(this,void 0,void 0,function*(){return o.client.callServerFunction(r.ConfigFunction.getConfigValue,e,t,i)})},e.setValue=function(e,t,i){return n(this,void 0,void 0,function*(){yield o.client.callServerFunction(r.ConfigFunction.setConfigValue,e,t,i)})}}(t.ConfigHelperNS||(t.ConfigHelperNS={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeEventMesssageNS=void 0,function(e){e.eventPluginLoderPluginReady="event_plugin_loader_plugin_ready",e.eventDownloadItemActive="event_download_item_active",e.eventDetailSwitch2Index="event_detail_switch_to_index",e.eventDownloadSwitchCategory="event_download_switch_category",e.eventBringMainWindowToTop="event_bring_main_window_to_top",e.eventDownloadContextMenuClick="event_download_context_menu_click",e.eventOnCommand="event_on_command",e.eventDownloadKernelInitEnd="event_dk_init_end",e.eventDownloadSDKRecover="event_sdk_crash_recover",e.eventTaskDataBaseLoadEnd="event_dk_task_data_base_load_end",e.eventGlobalDownloadSpeedChanged="event_dk_global_download_speed_changed",e.eventGlobalUploadSpeedChanged="event_dk_global_upload_speed_changed",e.eventConfigInitFinished="event_config_init_finished",e.eventConfigValueChanged="event_config_value_changed",e.eventBHOConfigInitFinished="event_bho_config_init_finished",e.eventBHOConfigValueChanged="event_bho_config_value_changed",e.eventShowHomePage="event_show_home_page",e.eventShowSearchTaskPage="event_show_searchtask_page",e.eventConfigBrowserInitFinished="event_config_browser_init_finished",e.eventDownloadContextMenuPopup="event_download_context_menu_popup",e.eventDownloadContextMenuEnd="event_download_context_menu_end",e.eventXmpPlayerMediasDataBaseLoadEnd="event_xmp_player_medias_data_base_load_end",e.eventXmpPlayerAddNewMedias="event_xmp_player_add_new_medias",e.eventXmpPlayerRemoveMedias="event_xmp_player_remove_medias",e.eventXmpPlayerUpdateMedias="event_xmp_player_update_medias",e.eventLoginWndCreate="event_login_wnd_create",e.eventLoginWndShow="event_login_wnd_show",e.eventLoginWndShowResult="event_login_wnd_show_result",e.eventLoginWndClose="event_login_wnd_close",e.eventRetryLoginWndCreate="event_retry_login_wnd_create",e.eventModifierUserinfoWndCreate="event_modifier-userinfo-wnd-create",e.eventUpdatePlayListProgress="event_update_playlist_progress",e.eventBrowserNumberChange="event_browser_number_change"}(t.NodeEventMesssageNS||(t.NodeEventMesssageNS={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringAlignment=t.StringTrimming=t.XmpVideoTipWndRenderType=t.XmpVideoTipItemType=void 0,function(e){e[e.Unknown=-1]="Unknown",e[e.Normal=0]="Normal",e[e.Link=1]="Link",e[e.Button=2]="Button"}(t.XmpVideoTipItemType||(t.XmpVideoTipItemType={})),function(e){e[e.KeyColor=0]="KeyColor",e[e.Layered=1]="Layered"}(t.XmpVideoTipWndRenderType||(t.XmpVideoTipWndRenderType={})),function(e){e[e.None=0]="None",e[e.Character=1]="Character",e[e.Word=2]="Word",e[e.EllipsisCharacter=3]="EllipsisCharacter",e[e.EllipsisWord=4]="EllipsisWord",e[e.EllipsisPath=5]="EllipsisPath"}(t.StringTrimming||(t.StringTrimming={})),function(e){e[e.StringAlignmentNear=0]="StringAlignmentNear",e[e.StringAlignmentCenter=1]="StringAlignmentCenter",e[e.StringAlignmentFar=2]="StringAlignmentFar"}(t.StringAlignment||(t.StringAlignment={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmpVideoTipWndAW=void 0;t.XmpVideoTipWndAW=class{constructor(e){this.xmpVideoTipWnd=null,this.xmpVideoTipWnd=e}getId(){return this.xmpVideoTipWnd.getId()}getObject(){return this.xmpVideoTipWnd}create(e){return new Promise(t=>{this.xmpVideoTipWnd.create(e,e=>{t(e)})})}bindContainer(e){e&&this.xmpVideoTipWnd.bindContainer(e.getObject())}unbindContainer(){this.xmpVideoTipWnd.unbindContainer()}getBindContainer(){return this.xmpVideoTipWnd.getBindContainer()}invalidate(e){this.xmpVideoTipWnd.invalidate(e)}invalidateRect(e,t,i,n,o){this.xmpVideoTipWnd.invalidateRect(e,t,i,n,o)}showWindow(e){this.xmpVideoTipWnd.showWindow(e)}getVisible(){return new Promise(e=>{this.xmpVideoTipWnd.getVisible(t=>{e(t)})})}updateWindow(){this.xmpVideoTipWnd.updateWindow()}getWindowRect(){return new Promise(e=>{this.xmpVideoTipWnd.getWindowRect(t=>{e(t)})})}getClientRect(){return new Promise(e=>{this.xmpVideoTipWnd.getClientRect(t=>{e(t)})})}moveWindow(e,t,i,n,o){this.xmpVideoTipWnd.moveWindow(e,t,i,n,o)}getWndHandle(){return new Promise(e=>{this.xmpVideoTipWnd.getWndHandle(t=>{e(t)})})}getDpiFactor(){return new Promise(e=>{this.xmpVideoTipWnd.getDpiFactor(t=>{e(t)})})}setDpiFactor(e){this.xmpVideoTipWnd.setDpiFactor(e)}setRenderType(e){this.xmpVideoTipWnd.setRenderType(e)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.windowDisplay=void 0;const o=i(25),r=i(99);class a{static getInstance(){return null==a.mins&&(a.mins=new a),a.mins}getDpi(){return n(this,void 0,void 0,function*(){let e=yield this.getMainWindowRect();return(yield r.default.getDisplayMatching(e)).scaleFactor})}getWorkArea(){return n(this,void 0,void 0,function*(){let e=yield this.getMainWindowRect();return(yield r.default.getDisplayMatching(e)).workArea})}getScreenArea(){return n(this,void 0,void 0,function*(){let e=yield this.getMainWindowRect();return(yield r.default.getDisplayMatching(e)).bounds})}getMainWindowRect(){return n(this,void 0,void 0,function*(){let e;return e=(yield o.default.getWindow())?yield o.default.getBounds():{x:0,y:0,width:1,height:1}})}}a.mins=null,t.windowDisplay=a.getInstance()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmpVideoTipItemIdNS=t.XmpVideoTipWndIdNS=void 0,function(e){e.videoTipWndIDLeftTop="VIDEO_TIP__WND_ID_LEFT_TOP",e.videoTipWndIDVip="VIDEO_TIP__WND_ID_VIP",e.videoTipWndIDNormal="VIDEO_TIP__WND_ID_NORMAL",e.videoTipWndIDPan="VIDEO_TIP__WND_ID_Pan"}(t.XmpVideoTipWndIdNS||(t.XmpVideoTipWndIdNS={})),function(e){e.videoTipItemConfigChanged="VIDEO_TIP__ITEM_ID_CONFIG_CHANGED",e.videoTipItemBufferProgress="VIDEO_TIP__ITEM_ID_BUFFER_PROGRESS",e.videoTipItembufferSpeed="VIDEO_TIP__ITEM_ID_BUFFER_SPEED",e.videoTipItemTaskStoped="VIDEO_TIP__ITEM_ID_TASK_STOPED",e.videoTipItemCreateMediaError="VIDEO_TIP__ITEM_ID_CREATE_MEDIA_ERROR",e.videoTipItemConfigInfo="VIDEO_TIP__ITEM_ID_CONFIG_INFO"}(t.XmpVideoTipItemIdNS||(t.XmpVideoTipItemIdNS={}))},function(e,t){e.exports=require("http")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.XmpModeNS=void 0;const o=i(10),r=i(25),a=i(18),s=i(0),l=i(7),d=i(6),u=i(3),c=i(8),h=i(104),p=i(5),f=i(46),m=i(60),g=i(4),S=i(30),y=s.default.getLogger("mode-manager");!function(e){let t,i,s=0,C=0,I=0,v=null,T=null,E=new h.ModeEvent,b=o.XmpPlaySoure.PLAY_UNKNOWN,P=!1,w=!0;E.setMaxListeners(20);class D{}function O(e,...t){E.fireModeEvent(e,...t)}e.XmpModeStrategy=D;class N extends D{setCurrentMode(e,t){return n(this,void 0,void 0,function*(){})}}class _ extends D{createFloat(e,r){return n(this,void 0,void 0,function*(){let e=t;b===o.XmpPlaySoure.PLAY_BY_PAN&&(e=i);let n=a.ThunderHelper.getWindowRect(C),s=a.ThunderHelper.getClientRect(C);y.warning("playSoure",b,"rect",e,"mainRect",n,"mainWindowRect",s);let l={x:e.x+Math.floor(s.x/r),y:e.y+Math.floor(s.y/r),width:e.width,height:e.height};y.warning("options",l,"aplayer rect",e,"downloadEmbedRect",t,"panEmbedRect",i);let h=yield f.default.createFloatWindow(l,r);yield c.server.callClientFunctionByName(d.mainProcessContext,u.XmpPlayerFunction.updateFloatWindow,h)})}updateAPlayerPosition(e){return n(this,void 0,void 0,function*(){let n=t;b===o.XmpPlaySoure.PLAY_BY_PAN&&(n=i),n={x:Math.floor(n.x*e),y:Math.floor(n.y*e),width:Math.floor(n.width*e),height:Math.floor(n.height*e)},y.warning("EmbedModeStrategy updateAPlayerPosition playSoure",b,"rect",n,"aplayerHwnd",I),a.ThunderHelper.setWindowPosEx(I,o.OptionOfHWNDInAfter.HWND_TOP,n.x,n.y,n.width,n.height,o.Uflag.SWP_NOZORDER|o.Uflag.SWP_NOACTIVATE)})}setCurrentMode(e,t){return n(this,void 0,void 0,function*(){let e=a.ThunderHelper.getDpi(C);if(l.xmpPlayer.showAPlayerWindow(!1),T&&(yield T.hide()),s&&a.ThunderHelper.unBindChildWindowEx(s,I),T&&(yield T.destroy(),T=null),a.ThunderHelper.bindChildWindowEx(C,I),yield this.updateAPlayerPosition(e),w){y.warning("cqm embed showAPlayerWindow");let e=l.xmpPlayer.getState();e>=g.XmpMediaState.Pausing&&e<=g.XmpMediaState.Play&&l.xmpPlayer.showAPlayerWindow(!0)}yield this.createFloat(I,e),s=C,v=yield r.default.getWindow()})}}class F extends D{createFloat(e,t){return n(this,void 0,void 0,function*(){let i=a.ThunderHelper.getWindowRect(e),n=a.ThunderHelper.getDpi(I),o={x:Math.floor(i.x/n),y:Math.floor(i.y/n),width:Math.floor(i.width/n),height:Math.floor(i.height/n),parent:t},r=yield f.default.createFloatWindow(o,n);y.warning("createFloat aplayer rect",i,"floatWindowId",r,"options",o),yield c.server.callClientFunctionByName(d.mainProcessContext,u.XmpPlayerFunction.updateFloatWindow,r)})}updateAPlayerPosition(){return n(this,void 0,void 0,function*(){let e=a.ThunderHelper.getDpi(I);y.warning("IndependentModeStrategy updateAPlayerPosition playSoure",b,"aplayerHwnd",I),a.ThunderHelper.setWindowPosEx(I,o.OptionOfHWNDInAfter.HWND_TOP,0,0,Math.floor(o.WindowParams.DEFAULT_WIDTH*e),Math.floor(o.WindowParams.DEFAULT_HEIGHT*e),o.Uflag.SWP_NOZORDER|o.Uflag.SWP_NOACTIVATE)})}setCurrentMode(e,t){return n(this,void 0,void 0,function*(){l.xmpPlayer.showAPlayerWindow(!1);let e=(yield(T=yield m.IndependWindowHelperNS.createBrowserWindow(I)).getNativeWindowHandle()).readUIntLE(0,4);if(y.information("independWindowHwnd",e,"aplayerHwnd",I,"parentHwnd",s),a.ThunderHelper.unBindChildWindowEx(s,I),a.ThunderHelper.bindChildWindowEx(e,I),yield this.updateAPlayerPosition(),w){y.warning("cqm independ showAPlayerWindow");let e=l.xmpPlayer.getState();e>=g.XmpMediaState.Pausing&&e<=g.XmpMediaState.Play&&l.xmpPlayer.showAPlayerWindow(!0)}yield this.createFloat(e,T),s=e,v=T,S.LeftTopVideoTipManagerNS.getLeftTopVideoTipManager().clear().catch()})}}const M=new class{constructor(){this.xmpModeStrategys=[],this.mode=o.XmpMode.UNKNOWN_MODE,this.switchingMode=!1,this.pendingSwitchingMode=o.XmpMode.UNKNOWN_MODE,this.xmpModeStrategys[o.XmpMode.EMBED_MODE]=new _,this.xmpModeStrategys[o.XmpMode.MAGNETIC_MODE]=new N,this.xmpModeStrategys[o.XmpMode.INDEPENDENT_MODE]=new F}getStrategy(e){return this.xmpModeStrategys[e]}getCurrentStrategy(){return this.getStrategy(this.mode)}setCurrentMode(e,t){return n(this,void 0,void 0,function*(){if(this.switchingMode)return this.pendingSwitchingMode=e,void y.warning("setCurrentMode, is in switching, abort! pendingSwitchingMode",this.pendingSwitchingMode);this.pendingSwitchingMode=o.XmpMode.UNKNOWN_MODE,this.switchingMode=!0,y.warning("switching start! mode",e,"from",t);let i=this.getStrategy(e),n=this.mode;O(p.ModeChangeEvent.onXmpModeChanging,n,e),P&&(yield this.leaveFullScreen());let r=yield l.xmpPlayer.getVideoWidth(),a=yield l.xmpPlayer.getVideoHeight(),s=r<=0||a<=0;s&&k(!s),yield i.setCurrentMode(e,t),this.mode=e,this.switchingMode=!1;let d=-1;e===o.XmpMode.INDEPENDENT_MODE&&(d=T.id),y.information("onXmpModeChanged preMode",n,"mode",e,"independWindowId",d),O(p.ModeChangeEvent.onXmpModeChanged,n,e,d),y.warning("switching finish!")})}getCurrentMode(){return this.mode}enterFullScreen(){return n(this,void 0,void 0,function*(){if(yield v.setFullScreen(!0),P=!0,this.mode===o.XmpMode.EMBED_MODE){let e=a.ThunderHelper.getWindowRect(s),t=a.ThunderHelper.getDpi(s),i={x:0,y:0,width:e.width,height:e.height};y.information("enterFullScreen srcRect",e,"aplayerRect",i,"dpi",t),yield f.default.updateFloatWindowRect({x:-99999,y:-99999,width:e.width,height:e.height},1),a.ThunderHelper.moveWindow(I,i),setTimeout(()=>{f.default.updateFloatWindowRect(e,1).catch()},100)}a.ThunderHelper.setWindowPosEx(I,0,0,0,0,0,o.Uflag.SWP_NOSIZE|o.Uflag.SWP_NOMOVE|o.Uflag.SWP_ASYNCWINDOWPOS),O(p.ModeChangeEvent.onXmpEnterFullScreen)})}leaveFullScreen(){return n(this,void 0,void 0,function*(){P&&(yield v.setFullScreen(!1),P=!1,a.ThunderHelper.setWindowPosEx(I,0,0,0,0,0,o.Uflag.SWP_NOSIZE|o.Uflag.SWP_NOMOVE|o.Uflag.SWP_ASYNCWINDOWPOS),O(p.ModeChangeEvent.onXmpLeaveFullScreen))})}getIsFullScreen(){return P}setThunderHwnd(e){C=e}setAplayerHwnd(e){y.information("setAplayerHwnd aplayerHwnd",e),I=e}setDownloadEmbedRect(e){e&&(t=e,y.information("downloadEmbedRect",t))}setPanEmbedRect(e){e&&(i=e,y.information("panEmbedRect",i))}closeXmpPlugin(e){return n(this,void 0,void 0,function*(){y.warning("closeXmpPlugin from",e);let t=this.mode;if(O(p.ModeChangeEvent.onXmpModeChanging,t,o.XmpMode.UNKNOWN_MODE),P&&(yield this.leaveFullScreen()),yield f.default.hideFloatWindow(`closeXmpPlugin_${e}`),T&&!(yield T.isDestroyed())){l.xmpPlayer.showAPlayerWindow(!1),yield T.hide(),a.ThunderHelper.unBindChildWindowEx(s,I);let e=T;setTimeout(()=>{e.destroy().catch()},1e3)}T=null,s=0,v=null,P=!1,b=o.XmpPlaySoure.PLAY_UNKNOWN,w=!0,this.mode=o.XmpMode.UNKNOWN_MODE,this.switchingMode=!1,this.pendingSwitchingMode=o.XmpMode.UNKNOWN_MODE,O(p.ModeChangeEvent.onXmpModeChanged,t,o.XmpMode.UNKNOWN_MODE)})}setPlaySoure(e){b=e}getPlaySoure(){return b}setShowOrHideState(e){w=e,y.information("setShowOrHideState currentShowState",w)}};function A(){return M.getCurrentMode()}function k(e){return M.setShowOrHideState(e)}e.setCurrentMode=function(e,t){return n(this,void 0,void 0,function*(){A()!==e&&(yield M.setCurrentMode(e,t))})},e.getCurrentMode=A,e.enterFullScreen=function(){return n(this,void 0,void 0,function*(){yield M.enterFullScreen()})},e.leaveFullScreen=function(){return n(this,void 0,void 0,function*(){yield M.leaveFullScreen()})},e.getIsFullScreen=function(){return M.getIsFullScreen()},e.setAplayerHwnd=function(e){M.setAplayerHwnd(e)},e.setThunderHwnd=function(e){M.setThunderHwnd(e)},e.setDownloadEmbedRect=function(e){M.setDownloadEmbedRect(e)},e.setPanEmbedRect=function(e){M.setPanEmbedRect(e)},e.closeXmpPlugin=function(e){return n(this,void 0,void 0,function*(){yield M.closeXmpPlugin(e)})},e.setPlaySoure=function(e){M.setPlaySoure(e)},e.getPlaySoure=function(){return M.getPlaySoure()},e.setShowOrHideState=k,e.getParentWindow=function(){return v},e.getParentWndHandle=function(){return s},e.attachListener=function(e,t){E&&E.attachListener(e,t)},e.attachOnceListener=function(e,t){E&&E.attachOnceListener(e,t)},e.detachListener=function(e,t){E&&E.detachListener(e,t)}}(t.XmpModeNS||(t.XmpModeNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.IndependWindowHelperNS=void 0;const o=i(18),r=i(10),a=i(31),s=i(0),l=i(2),d=i(6),u=i(3),c=s.default.getLogger("main-window");!function(e){const t=new class{constructor(){this.windowObject=null,this.mainWnd=0}getWindowObject(){return this.windowObject}createBrowserWindow(e,t){return n(this,void 0,void 0,function*(){let i=`file:///${__dirname}/main-window-renderer/index.html`,s=yield a.rpc.getBrowserWindow(),h={width:r.WindowParams.DEFAULT_WIDTH,height:r.WindowParams.DEFAULT_HEIGHT,resizable:!0,frame:!1,center:!0,show:!0,modal:!0,alwaysOnTop:!1,minimizable:!0,maximizable:!0,skipTaskbar:!1,backgroundColor:"#000",icon:`${__xmpRootDir}/static/xmp.ico`,webPreferences:{spellcheck:!1,nodeIntegration:!0,webSecurity:"development"!==process.env.RUN_ENV,preload:`file:///${__rootDir}/out/plugin-boot.js`}};Object.assign(h,e),this.windowObject=yield new s(h);let p=yield(yield this.windowObject.getNativeWindowHandle()).readUIntLE(0,4);return o.ThunderHelper.addBrowserWindowClipStyleEx(p),this.windowObject.once("ready-to-show",()=>n(this,void 0,void 0,function*(){yield this.windowObject.show()})),this.windowObject.once("close",e=>n(this,void 0,void 0,function*(){c.information("close main window",this.mainWnd,t),l.client.callRemoteClientFunction(d.mainRendererContext,u.XmpPlayerFunction.showAPlayerWindow,!1),o.ThunderHelper.unBindChildWindowEx(this.mainWnd,t),l.client.callRemoteClientFunction(d.mainRendererContext,u.XmpPlayerFunction.close),l.client.callRemoteClientFunction(d.mainRendererContext,"hideFloatWindow")})),this.windowObject.loadURL(i).catch(),this.mainWnd=yield o.ThunderHelper.getBrowserWindowHandle(this.windowObject),this.windowObject})}};e.createBrowserWindow=function(e){return n(this,void 0,void 0,function*(){return t.createBrowserWindow(null,e)})},e.getWindowObject=function(){return t.getWindowObject()},e.getWindowObjectId=function(){return t.getWindowObject().id}}(t.IndependWindowHelperNS||(t.IndependWindowHelperNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.dlna=void 0;const o=i(7),r=i(0),a=i(11),s=i(8),l=i(4),d=i(62),u=i(106),c=i(5),h=i(2),p=o.XmpMediaManagerNS.getXmpMediaManager().getXmpPlayer(),f=r.default.getLogger("dlna-device");t.dlna=new class extends d.Device{constructor(){super(...arguments),this.deviceList=[],this.registFunc=[],this.timeCookie=null}init(){return n(this,void 0,void 0,function*(){if(yield this.isEnable()){let e=yield p.getConfig(a.APlayerConfigId.CONFIGID_DLNADEVICELIST);this.generateDeviceList(e)}h.client.attachServerEvent(c.XmpEvent.onEvent,(e,t)=>{f.information("[DLNA] OnEvent:",e," Param:",e),e===a.APlayerEventCode.EVENTCODE_DLNA&&this.onDLNAEvent(t)}),h.client.attachServerEvent(c.XmpEvent.onOpenSucceeded,()=>n(this,void 0,void 0,function*(){let e=yield this.getCurrentDevice(),t=yield p.getConfig(a.APlayerConfigId.CONFIGID_STARTPOSITION);if(e&&""!==e&&t&&"0"!==t){let e=yield p.getPosition();this.setPostionOnce(e)}}))})}unInit(){this.registFunc=[],this.disConnectDevice().catch()}isDeviceSupport(e){return n(this,void 0,void 0,function*(){let t=p.getCurrentMedia(),i="";t&&(i=t.getXmpMediaInfo().ext,f.information(" 当前视频格式:",i));let n=!0;return e&&e.length>0&&-1===e.search(i)&&(n=!1),n})}connectDevice(...e){return n(this,void 0,void 0,function*(){let t=e[0],i=e[1],n=e[2];f.information("[DLNA] 选中设备,deviceId:",t," 设备支持格式:",i);let o=p.getState();if(o>l.XmpMediaState.Opening){let e=yield p.getPosition();this.setPostionOnce(e)}let r="";r=r+"type=dlna,device_name="+n,""!==t?(o<=l.XmpMediaState.Opening?p.attachOnceListener(c.XmpEvent.onPlaying,e=>{this.doConnect(t,n,e).catch()}):this.doConnect(t,n).catch(),o===l.XmpMediaState.Paused&&p.play().catch(),r+=",result=success"):r+=",result=fail",u.XLStatNS.trackEvent("xmp_player","xmp_player_throwing_screen_connect","",0,0,0,0,r)})}disConnectDevice(...e){return n(this,void 0,void 0,function*(){let t=e[0];t||(t=""),f.information("DLNA 断开设备:",t),p.setConfig(a.APlayerConfigId.CONFIGID_DLNACURRENTDEVICE,t).catch(),s.server.fireClientEvent(c.XmpEvent.onSetCurrentDevice,"")})}registNotify(e){this.registFunc.push(e)}getCurrentDevice(){return n(this,void 0,void 0,function*(){return yield p.getConfig(a.APlayerConfigId.CONFIGID_DLNACURRENTDEVICE)})}activeDevice(e){return n(this,void 0,void 0,function*(){let t=-1;t=e?yield p.setConfig(a.APlayerConfigId.CONFIGID_DLNAENABLE,"1"):yield p.setConfig(a.APlayerConfigId.CONFIGID_DLNAENABLE,"0"),f.information("[DLNA] 开启DLNA active:",e," ret:",t)})}isEnable(){return n(this,void 0,void 0,function*(){let e=yield p.getConfig(a.APlayerConfigId.CONFIGID_DLNAENABLE);return f.information("[DLNA] isEnable:",e),"1"===e})}getDeviceList(){return n(this,void 0,void 0,function*(){f.information("[DLNA] 获取设备列表...");let e=yield p.getConfig(a.APlayerConfigId.CONFIGID_DLNADEVICELIST);return f.information("[DLNA] 获取设备列表,deviceList:",e),this.generateDeviceList(e),this.deviceList})}searchDevice(){return n(this,void 0,void 0,function*(){f.information("[DLNA] 搜索设备中..."),p.setConfig(a.APlayerConfigId.CONFIGID_DLNASEARCHDEVICE,"1").catch()})}onDLNAEvent(e){let t=e>>16,i=65535&e;f.information("[DLNA] event: hiword:",t," loword:",i),this.registFunc.forEach(e=>{"function"==typeof e&&e(t,i)}),s.server.fireClientEvent(c.XmpEvent.onDlnaEvent,t,i)}generateDeviceList(e){if(this.deviceList=[],!e)return void f.information("无设备列表");let t=e.split("\r\n");t&&0!==t.length?t.forEach(e=>{this.generateDeviceItem(e)}):f.error("无法获取到设备列表信息")}generateDeviceItem(e){if(!e)return;let t=e.split(";");t&&3===t.length?this.deviceList.push({name:t[0].trim(),id:t[1].trim(),supportExts:t[2],deviceType:"DLNA"}):f.error("获取设备信息错误")}doConnect(e,t,i){return n(this,void 0,void 0,function*(){yield this.activeDevice(!0),p.setConfig(a.APlayerConfigId.CONFIGID_DLNACURRENTDEVICE,e).catch(),s.server.fireClientEvent(c.XmpEvent.onSetCurrentDevice,e,t,i)})}setPostionOnce(e){this.timeCookie&&(clearTimeout(this.timeCookie),this.timeCookie=null),this.timeCookie=setTimeout(()=>{p.setPosition(e).catch(),this.timeCookie=null},1e3)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Device=void 0;t.Device=class{}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.FileSystemAWNS=void 0;const o=i(23),r=i(1),a=i(20).promisify,s=i(0).default.getLogger("xmp-vip-fs-utilities");!function(e){function t(e){return n(this,void 0,void 0,function*(){let t=!1;if(void 0!==e){const i=a(o.access);try{yield i(e),t=!0}catch(e){s.information(e)}}return t})}function l(e){return n(this,void 0,void 0,function*(){let t=!1;if(void 0!==e){const i=a(o.mkdir);try{yield i(e),t=!0}catch(e){s.warning(e)}}return t})}function d(e){return n(this,void 0,void 0,function*(){let t=!1;if(void 0!==e){const i=a(o.rmdir);try{yield i(e),t=!0}catch(e){s.warning(e)}}return t})}function u(e){return n(this,void 0,void 0,function*(){let t=!1;if(void 0!==e){const i=a(o.unlink);try{yield i(e),t=!0}catch(e){s.warning(e)}}return t})}function c(e){return n(this,void 0,void 0,function*(){let t=null;if(void 0!==e){const i=a(o.readdir);try{t=yield i(e)}catch(e){s.warning(e)}}return t})}function h(e){return n(this,void 0,void 0,function*(){let t=null;if(void 0!==e){const i=a(o.lstat);try{t=yield i(e)}catch(e){s.warning(e)}}return t})}function p(e,t){return n(this,void 0,void 0,function*(){let i=!1;if(void 0!==e&&void 0!==t){let n=r.join(e,t),o=yield h(n);i=null!==o&&o.isDirectory()?yield f(n):yield u(n)}return i})}function f(e){return n(this,void 0,void 0,function*(){let i=!1;if(void 0!==e){if(yield t(e)){i=!0;let t=yield c(e);for(let n=0;n<t.length;n++)i=(yield p(e,t[n]))&&i;(i||0===t.length)&&(i=(yield d(e))&&i)}}return i})}function m(e){return n(this,void 0,void 0,function*(){let i=!1;return s.information("mkdirsAW",e),void 0!==e&&((yield t(e))?i=!0:r.dirname(e)===e?i=!1:(yield m(r.dirname(e)))&&(i=yield l(e))),i})}function g(e,i){return n(this,void 0,void 0,function*(){let n;if(e.toLowerCase()!==i.toLowerCase()&&(yield t(e))){let t=o.createReadStream(e),r=o.createWriteStream(i);n=new Promise(e=>{t.pipe(r).on("finish",()=>{e(!0)})})}else n=new Promise(e=>{e(!1)});return n})}e.readFileAW=function(e){return n(this,void 0,void 0,function*(){let t=null;if(void 0!==e){const i=a(o.readFile);try{t=yield i(e)}catch(e){s.warning(e)}}return t})},e.writeFileAW=function(e,t){return n(this,void 0,void 0,function*(){let i=!1;if(void 0!==e&&null!==t){const n=a(o.writeFile);try{yield n(e,t),i=!0}catch(e){s.warning(e)}}return i})},e.existsAW=t,e.mkdirAW=l,e.rmdirAW=d,e.unlinkAW=u,e.readdirAW=c,e.lstatAW=h,e.rmdirsAW=f,e.mkdirsAW=m,e.renameAW=function(e,t){return n(this,void 0,void 0,function*(){if(void 0!==e&&void 0!==t){const i=a(o.rename);try{yield i(e,t)}catch(e){s.warning(e)}}})},e.copyFileAW=g,e.copyDirsAW=function e(i,o){return n(this,void 0,void 0,function*(){let n=!1,a=yield h(i);if(a.isDirectory()){n=yield m(o);let s=yield c(i);for(let l=0;l<s.length;l++){let d=r.join(i,s[l]),u=r.join(o,s[l]);(n=yield t(d))&&(n=(a=yield h(d)).isDirectory()?yield e(d,u):yield g(d,u))}}return n})},e.mkdtempAW=function(){return n(this,void 0,void 0,function*(){let e=!1;const t=a(o.mkdtemp),n=(yield Promise.resolve().then(()=>i(22))).tmpdir();try{e=yield t(`${n}${r.sep}`)}catch(e){s.warning(e)}return e})}}(t.FileSystemAWNS||(t.FileSystemAWNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.XmpSubtitleNS=void 0;const o=i(7),r=i(0),a=i(21),s=i(107),l=i(128),d=i(38),u=i(129),c=i(4),h=i(11),p=i(15),f=i(1),m=i(13),g=i(16),S=i(30),y=i(24),C=i(5),I=i(17),v=i(65),T=i(8),E=i(2),b=o.XmpMediaManagerNS.getXmpMediaManager(),P=b.getXmpPlayer(),w=r.default.getLogger("SubtitleManager"),D=S.LeftTopVideoTipManagerNS.getLeftTopVideoTipManager();!function(e){class t{constructor(){this.embedSubtitleList=[],this.localSubtitleList=[],this.onlineSubtitleList=[],this.manualSubtitleList=[],this.currentSubtitle=null,this.currentSubtitle2=null,this.videoTipTimer=null,this.eventContainer=new y.default,this.isInited=!1,this.embedSubInitStatus=a.SubInitStatus.READY}init(){this.isInited||(E.client.attachServerEvent(C.XmpEvent.onOpenSucceeded,this.onOpenSucceeded.bind(this)),E.client.attachServerEvent(C.XmpEvent.onStop,e=>{setTimeout(()=>{this.onStop(e).catch()},500)}),this.isInited=!0)}getEmbedInitStatus(){return this.embedSubInitStatus}loadSubtitleFile(e,t,i=a.SubtitleType.Local,o,r){return n(this,void 0,void 0,function*(){let e=!1,n=!0;do{let s=null;if(i===a.SubtitleType.Embed)for(let e=0;e<this.embedSubtitleList.length;++e){if(this.embedSubtitleList[e].getPath().toLocaleLowerCase()===t.toLocaleLowerCase()){s=this.embedSubtitleList[e];break}}else{if(!t||!(yield m.FileSystemAWNS.existsAW(t)))break;if(i===a.SubtitleType.Local){for(let e=0;e<this.localSubtitleList.length;++e){let i=this.localSubtitleList[e];i.getPath().toLocaleLowerCase()===t.toLocaleLowerCase()&&(s=i);break}s||(s=new d.LocalSubtitle(this,t,!1),n=!1)}else if(i===a.SubtitleType.Online){for(let e=0;e<this.onlineSubtitleList.length;++e){let i=this.onlineSubtitleList[e];i.getPath().toLocaleLowerCase()===t.toLocaleLowerCase()&&(s=i);break}s||(s=new u.OnlineSubtitle(this,t,!1),n=!1)}else if(i===a.SubtitleType.Manual){for(let e=0;e<this.manualSubtitleList.length;++e){let i=this.manualSubtitleList[e];i.getPath().toLocaleLowerCase()===t.toLocaleLowerCase()&&(s=i);break}s||(s=new l.ManualSubtitle(this,t,!1),n=!1)}}if(!s)break;o&&(s=s.clone(o)),(e=yield this.loadSubtitle(s))&&(void 0!==r&&(yield s.setLanguageIndex(r)),n||(i===a.SubtitleType.Local?this.localSubtitleList.push(s):i===a.SubtitleType.Manual?this.manualSubtitleList.push(s):i===a.SubtitleType.Online&&this.onlineSubtitleList.push(s)))}while(0);return e})}loadSubtitle(e){return n(this,void 0,void 0,function*(){let t=!1;do{let i=P.getCurrentMedia();if(!i)break;let n=e.getPath();if(this.currentSubtitle&&this.currentSubtitle.getType()!==a.SubtitleType.Embed){this.currentSubtitle.getPath()!==n&&(yield this.reportSubtitle(i.getXmpMediaAttribute(c.XmpMediaAttr.MediaId),this.currentSubtitle,2))}(t=yield e.load(i))&&(e.isSecondSubtitle()?this.currentSubtitle2=e:this.currentSubtitle=e,yield this.initSubtitleConfig(e),this.fireEvent(a.SubtitleEvent.LoadSucceed,e),T.server.fireClientEvent(a.SubtitleEvent.LoadSucceed))}while(0);return t})}getLocalSubtitleList(){return this.localSubtitleList}getEmbedSubtitleList(){return this.embedSubtitleList}getOnlineSubtitleList(){return this.onlineSubtitleList}getManualSubtitleList(){return this.manualSubtitleList}isHasSubtitle(){let e=!1;do{if(this.localSubtitleList&&this.localSubtitleList.length>0){e=!0;break}if(this.embedSubtitleList&&this.embedSubtitleList.length>0){e=!0;break}if(this.onlineSubtitleList&&this.onlineSubtitleList.length>0){e=!0;break}if(this.manualSubtitleList&&this.manualSubtitleList.length>0){e=!0;break}}while(0);return e}getCurrentSubtitle(){return this.currentSubtitle}getCurrentSubtitle2(){return this.currentSubtitle2}showSubtitle(){return n(this,void 0,void 0,function*(){do{let e=P.getCurrentMedia();if(!e)break;(yield this.isSettingDefaultSecondSubtitle())?yield P.setConfig(h.APlayerConfigId.CONFIGID_SUBTITLE2SHOW,"1"):yield P.setConfig(h.APlayerConfigId.CONFIGID_SUBTITLESHOW,"1"),e.setXmpMediaAttribute(c.XmpMediaAttr.SubtitleShow,1)}while(0)})}showSubtitle2(){return n(this,void 0,void 0,function*(){do{let e=P.getCurrentMedia();if(!e)break;yield P.setConfig(h.APlayerConfigId.CONFIGID_SUBTITLE2SHOW,"1"),e.setXmpMediaAttribute(c.XmpMediaAttr.Subtitle2Show,1)}while(0)})}hideSubtitle(){return n(this,void 0,void 0,function*(){do{let e=P.getCurrentMedia();if(!e)break;let t=this.getCurrentSubtitle();t&&(yield t.isShow())&&this.reportSubtitle(e.getXmpMediaAttribute(c.XmpMediaAttr.MediaId),t,1).catch(),(yield this.isSettingDefaultSecondSubtitle())?yield P.setConfig(h.APlayerConfigId.CONFIGID_SUBTITLE2SHOW,"0"):yield P.setConfig(h.APlayerConfigId.CONFIGID_SUBTITLESHOW,"0"),e.setXmpMediaAttribute(c.XmpMediaAttr.SubtitleShow,0)}while(0)})}hideSubtitle2(){return n(this,void 0,void 0,function*(){do{let e=P.getCurrentMedia();if(!e)break;let t=this.getCurrentSubtitle2();t&&(yield t.isShow())&&this.reportSubtitle(e.getXmpMediaAttribute(c.XmpMediaAttr.MediaId),t,1).catch(),yield P.setConfig(h.APlayerConfigId.CONFIGID_SUBTITLE2SHOW,"0"),e.setXmpMediaAttribute(c.XmpMediaAttr.Subtitle2Show,0)}while(0)})}isSubtitleShow(){return n(this,void 0,void 0,function*(){let e=!1;do{if(!this.currentSubtitle)break;e=yield this.currentSubtitle.isShow()}while(0);return e})}isSubtitle2Show(){return n(this,void 0,void 0,function*(){let e=!1;do{if(!this.currentSubtitle2)break;e=yield this.currentSubtitle2.isShow()}while(0);return e})}setUseHardwareSubtitle(e){return n(this,void 0,void 0,function*(){if(p.ConfigNS.setValue(I.ConfigDefineNS.useHardwareSubtitle.section,I.ConfigDefineNS.useHardwareSubtitle.key,e?I.ConfigDefineNS.subtitleValue.useHardware:I.ConfigDefineNS.subtitleValue.noUseHardware),"1"===(yield P.getConfig(h.APlayerConfigId.CONFIGID_SUBTITLE2USABLE))){let e=P.getState();if(e>=c.XmpMediaState.Pausing&&e<=c.XmpMediaState.Play){let e=b.getCurrentMedia();yield b.close(0,!1),yield b.open(e)}}})}isSettingDefaultSecondSubtitle(){return n(this,void 0,void 0,function*(){let e=!1;do{if(!(p.ConfigNS.getValue(I.ConfigDefineNS.useHardwareSubtitle.section,I.ConfigDefineNS.useHardwareSubtitle.key,I.ConfigDefineNS.useHardwareSubtitle.value)===I.ConfigDefineNS.subtitleValue.useHardware))break;if("4"!==(yield P.getConfig(h.APlayerConfigId.CONFIGID_RENDERMODECURRENT)))break;if("1"!==(yield P.getConfig(h.APlayerConfigId.CONFIGID_SUBTITLE2USABLE)))break;e=!0}while(0);return e})}queryOnlineSubtitle(e=!0){return n(this,void 0,void 0,function*(){let e;do{let t=P.getCurrentMedia();if(!t)break;let i=b.getCurrentMedia(),n=t.getXmpMediaAttribute(c.XmpMediaAttr.Cid);if(w.information("### current query online subtitle media cid: ",n),e=n&&40===n.length?yield u.OnlineSubtitle.query(this,t):yield u.OnlineSubtitle.search(this,t),i!==b.getCurrentMedia()||!this.isInPlay()){w.information("Subtitle query current media has changed, break.");break}if(w.information("Subtitle query found ",e.length," matched subtitles"),e.length>0){for(let t=0;t<this.onlineSubtitleList.length;++t){let i=this.onlineSubtitleList[t];for(let t=0;t<e.length;++t){let n=e[t];if(n.getPath()===i.getPath()){i.setAttribute(n.getAttribute()),i.setLanguageList(n.getLanguageList()),e[t]=i;break}}}this.onlineSubtitleList=e}}while(0);return e})}onOpenSucceeded(){return n(this,void 0,void 0,function*(){do{if("1"!==(yield P.getConfig(h.APlayerConfigId.CONFIGID_SUBTITLEUSABLE))){w.information("onOpenSucceeded, this video doesn't support subtitle");break}let e=yield P.getVideoHeight(),t=yield P.getVideoWidth();if(0===e||0===t){w.information("videoHeight:",e,", videoWidth:",t);break}let i=P.getCurrentMedia();yield this.initEmbedSubtitleList();let n=yield this.loadLastSubtitle(i);n?(yield this.setSubtitleLastShow(i),yield this.loadLocalSubtitle(!1),yield this.loadOnlineSubtitle(!1,!1)):((n=yield this.loadEmbedSubtitle())?(yield this.showTips("自动加载内嵌字幕"),yield this.loadLocalSubtitle(!1),yield this.loadOnlineSubtitle(!1,!1)):(n=yield this.loadLocalSubtitle(!0))?(yield this.showTips("自动加载匹配的本地字幕"),yield this.loadOnlineSubtitle(!1,!1)):(n=yield this.loadOnlineSubtitle(!1,!0))&&(yield this.showTips("自动加载匹配的在线字幕")),n&&(this.currentSubtitle&&this.showSubtitle().catch(),this.currentSubtitle2&&this.showSubtitle2().catch()))}while(0);this.fireEvent(a.SubtitleEvent.InitSubtitle),setTimeout(()=>{T.server.fireClientEvent(C.XmpEvent.onSubtitleInit)},1e3)})}onStop(e){return n(this,void 0,void 0,function*(){T.server.fireClientEvent(C.XmpEvent.onSubtitleUnInit),yield this.reportSubtitle(e,this.currentSubtitle,0),this.currentSubtitle=null,this.currentSubtitle2=null,this.embedSubInitStatus=a.SubInitStatus.READY,this.embedSubtitleList=[],this.localSubtitleList=[],this.onlineSubtitleList=[],this.manualSubtitleList=[],this.videoTipTimer&&(clearTimeout(this.videoTipTimer),this.videoTipTimer=null,yield D.removeItem("subtitleTipItem"))})}isInPlay(){let e=!1,t=P.getState();return t!==c.XmpMediaState.Playing&&t!==c.XmpMediaState.Play&&t!==c.XmpMediaState.Pausing&&t!==c.XmpMediaState.Paused||(e=!0),e}initEmbedSubtitleList(){return n(this,void 0,void 0,function*(){this.embedSubInitStatus=a.SubInitStatus.INITING,this.embedSubtitleList=[];let e=yield P.getConfig(h.APlayerConfigId.CONFIGID_SUBTITLELANGUAGELIST);if(e&&e.length>0){w.information("initEmbeddedSubtitle Embedded subtitle exists, language is ",e);let t=new s.EmbedSubtitle(this,e);this.embedSubtitleList.push(t)}T.server.fireClientEvent(C.XmpEvent.onEmbedSubInitFinish),this.embedSubInitStatus=a.SubInitStatus.FINISH})}initLocalSubtitleList(){return n(this,void 0,void 0,function*(){do{let e=P.getCurrentMedia();if(!e)break;let t=e.getXmpMediaAttribute(c.XmpMediaAttr.Url);w.information("initLocalSubtitle url:",t);let i=f.parse(t),n=i.dir,o=i.name;if(w.information("initLocalSubtitle dir:",n,", mediaFileName:",o),!n||!o||!(yield m.FileSystemAWNS.existsAW(n)))break;let r=[],a=yield m.FileSystemAWNS.readdirAW(n);if(!a)break;for(let e=0;e<a.length;++e){let t=f.parse(a[e]).name;if(g.XmpUtilityNS.isSubtitleFile(a[e])&&t.toLocaleLowerCase().includes(o.toLocaleLowerCase())){let t=f.join(n,a[e]),i=null;for(let e=0;e<this.localSubtitleList.length;++e){let n=this.localSubtitleList[e];if(n.getPath().toLocaleLowerCase()===t.toLocaleLowerCase()){i=n;break}}i||r.push(t)}}if(r.length<=0)break;for(let e=0;e<r.length;++e){let t=new d.LocalSubtitle(this,r[e]);this.localSubtitleList.push(t)}}while(0)})}initSubtitleConfig(e){return n(this,void 0,void 0,function*(){do{if(!e)break;if(e.getType()===a.SubtitleType.Embed){this.showTips("当前视频字幕为内嵌字幕,全局设置不生效").catch();break}e.setTimming().catch();let t=yield e.getPosition();e.setPosition(t).catch(),e.set3DMode().catch();let i=yield e.getSize(),n=yield e.getColor(),o=yield e.getFont();e.setFontStyle(i,n,o).catch()}while(0)})}setSubtitleLastShow(e){return n(this,void 0,void 0,function*(){{let t=!1,i=!1;if(this.currentSubtitle){let i=e.getXmpMediaAttribute(c.XmpMediaAttr.SubtitleShow),n=h.APlayerConfigId.CONFIGID_SUBTITLESHOW;(yield this.isSettingDefaultSecondSubtitle())&&(n=h.APlayerConfigId.CONFIGID_SUBTITLE2SHOW),1===i?(yield P.setConfig(n,"1"),t=!0):yield P.setConfig(n,"0")}if(this.currentSubtitle2){1===e.getXmpMediaAttribute(c.XmpMediaAttr.Subtitle2Show)?(yield P.setConfig(h.APlayerConfigId.CONFIGID_SUBTITLE2SHOW,"1"),i=!0):yield P.setConfig(h.APlayerConfigId.CONFIGID_SUBTITLE2SHOW,"0")}if(t&&this.currentSubtitle){let e=this.currentSubtitle.getType();e===a.SubtitleType.Embed?yield this.showTips("按上次设置自动加载内嵌字幕"):e===a.SubtitleType.Manual?yield this.showTips("自动加载选中的本地字幕"):e===a.SubtitleType.Local?yield this.showTips("自动加载匹配的本地字幕"):e===a.SubtitleType.Online&&(yield this.showTips("按上次设置自动加载匹配字幕"))}else if(i&&this.currentSubtitle2){let e=this.currentSubtitle2.getType();e===a.SubtitleType.Embed?yield this.showTips("按上次设置自动加载内嵌次字幕"):e===a.SubtitleType.Manual?yield this.showTips("自动加载选中的本地次字幕"):e===a.SubtitleType.Local?yield this.showTips("自动加载匹配的本地次字幕"):e===a.SubtitleType.Online&&(yield this.showTips("按上次设置自动加载匹配次字幕"))}else this.currentSubtitle?yield this.showTips("按上次设置不显示字幕"):this.currentSubtitle2&&(yield this.showTips("按上次设置不显示次字幕"))}})}loadLastSubtitle(e){return n(this,void 0,void 0,function*(){let t=!1;do{if(!e)break;let i=e.getXmpMediaAttribute(c.XmpMediaAttr.SubtitleType),n=e.getXmpMediaAttribute(c.XmpMediaAttr.Subtitle2Type),o=!!p.ConfigNS.getValue("Subtitle","LocalSubtitleMatch",1),r=!!p.ConfigNS.getValue("Subtitle","OnlineSubtitleMatch",1);if(i!==a.SubtitleType.None)do{if(i===a.SubtitleType.Local&&!o||i===a.SubtitleType.Online&&!r)break;let n=e.getXmpMediaAttribute(c.XmpMediaAttr.Subtitle),s=e.getXmpMediaAttribute(c.XmpMediaAttr.SubtitleLanguage);t=yield this.loadSubtitleFile(e,n,i,!1,s),w.information("Load last subtitle ret:",t,", type:",i,", path:",n,", languageIndex:",s)}while(0);if(n!==a.SubtitleType.None)do{if(i===a.SubtitleType.Local&&!o||i===a.SubtitleType.Online&&!r)break;let s=e.getXmpMediaAttribute(c.XmpMediaAttr.Subtitle2),l=e.getXmpMediaAttribute(c.XmpMediaAttr.Subtitle2Language),d=yield this.loadSubtitleFile(e,s,n,!0,l);w.information("Load last subtitle2 ret:",t,", type:",n,", path:",s,", languageIndex:",l),t||(t=d)}while(0)}while(0);return t})}loadEmbedSubtitle(){return n(this,void 0,void 0,function*(){w.information("embed subtitle count:",this.embedSubtitleList.length);let e=!1;do{if(0===this.embedSubtitleList.length)break;let t=this.embedSubtitleList[0];e=yield this.loadSubtitle(t)}while(0);return e})}loadLocalSubtitle(e){return n(this,void 0,void 0,function*(){let t=!1;do{if(!p.ConfigNS.getValue("Subtitle","LocalSubtitleMatch",!0))break;if(yield this.initLocalSubtitleList(),e&&this.localSubtitleList.length>0){w.information("localSubtitleList.count:",this.localSubtitleList.length);let e=this.localSubtitleList[0];t=yield this.loadSubtitle(e)}}while(0);return t})}loadOnlineSubtitle(e,t){return n(this,void 0,void 0,function*(){let i=!1;do{if(!p.ConfigNS.getValue("Subtitle","OnlineSubtitleMatch",!0))break;let n=yield P.getDuration();if(!n||n<12e4){w.information("This video's duration less than 2 * 60 * 1000 ms, return, duration:",n);break}let o=yield this.queryOnlineSubtitle(t);if(e&&o&&o.length>0){let e=o[0];e.isAutoLoad()&&(i=yield this.loadSubtitle(e))}}while(0);return i})}reportSubtitle(e,t,i){return n(this,void 0,void 0,function*(){if(!t)return void w.error("上报切换投票时,当前字幕是没有的");let n=t.getType();if(n===a.SubtitleType.Embed||n===a.SubtitleType.None)return;let o=t.isSecondSubtitle(),r=t.getRealShowTime();if(o){if(!this.currentSubtitle2)return;yield v.subReport.report(e,t.getPath(),r,i,o)}else{if(!this.currentSubtitle)return;yield v.subReport.report(e,t.getPath(),r,i,o)}})}showTips(e){return n(this,void 0,void 0,function*(){w.information("showTips tipsText:",e),yield D.createVideoTip(),yield D.addItem("subtitleTipItem",e),this.videoTipTimer&&clearTimeout(this.videoTipTimer),this.videoTipTimer=setTimeout(()=>n(this,void 0,void 0,function*(){this.videoTipTimer=null,yield D.removeItem("subtitleTipItem")}),5e3)})}attachOnceListener(e,t){this.eventContainer.attachOnceListener(e,t)}attachListener(e,t){this.eventContainer.attachListener(e,t)}detachListener(e,t){this.eventContainer.detachListener(e,t)}fireEvent(e,...t){return this.eventContainer.fireEvent(e,...t)}}e.SubtitleManager=t;let i=null;e.getSubtitleManager=function(){return i||(i=new t).init(),i}}(t.XmpSubtitleNS||(t.XmpSubtitleNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.subReport=void 0;const o=i(7),r=i(4),a=i(0),s=i(11),l=i(109),d=i(16),u=i(13),c=i(1),h=i(9),p=i(20),f=h.default(c.join(__rootDir,"../bin/ThunderHelper.node")),m=a.default.getLogger("subtitle-report");t.subReport=new class{report(e,t,i,a,h){return n(this,void 0,void 0,function*(){m.information("[字幕投票中]...subpath=",t," reason=",a);let n=o.XmpMediaManagerNS.getXmpMediaManager().getMedia(e);if(!n)return void m.warning("当前媒体对象不存在");let p,f,g=n.getXmpMediaAttribute(r.XmpMediaAttr.Cid);if(!g)return void m.warning("CID不存在");if(h?(p=s.APlayerConfigId.CONFIGID_SUBTITLE2LANGUAGELIST,f=s.APlayerConfigId.CONFIGID_SUBTITLE2TIMING):!1===h&&(p=s.APlayerConfigId.CONFIGID_SUBTITLELANGUAGELIST,f=s.APlayerConfigId.CONFIGID_SUBTITLETIMING),!p&&!f)return void m.error("GetConfig ID错误");let S=yield o.xmpPlayer.getConfig(p);if(!S)return void m.warning("语言列表不存在");let y=S.split(";");if(y&&0===y.length)return void m.warning("语言列表格式错误");if(!(yield u.FileSystemAWNS.existsAW(t)))return void m.warning("投票的字幕文件不存在");let C=yield d.XmpUtilityNS.calculateFileCidAW(t);if(!C)return void m.warning("计算投票字幕文件出错了,subpath=",t);let I=n.getXmpMediaAttribute(r.XmpMediaAttr.Name),v=n.getXmpMediaAttribute(r.XmpMediaAttr.Duration),T={sprotocol_version:"1",icmdid:1001};T.smcid=g,T.sscid=C,T.encode="utf-8",T.ilanguagenum=y.length>1?y.length-1:y.length,T.i64stimereal=i,T.i64mtime=v,T.videolength=v,T.ssname=encodeURIComponent(c.basename(t)),T.closereason=a,T.smname=encodeURIComponent(I),T.xmpver=d.XmpUtilityNS.getXmpVersion();let E=yield o.xmpPlayer.getConfig(f),b=0;if(E){let e=E.split(";");b=e&&e.length>0?parseInt(e[0],10):0}T.i64stimeoffset=b;for(let e=y.length>1?1:0;e<y.length;e++)T["sslanguage"+(e>1?(e-1).toString():"")]=encodeURIComponent(y[e]);this.checkData(T)?(m.information("[字幕投票]...,内容",T),(yield this.isDebugEnv())||(m.information("[字幕投票]发送中..."),l.fetchRequest({url:"http://subtitle.kankan.xunlei.com:8000",data:T,method:"get"}).catch())):m.error("数据错误,取消上报...")})}upload(e){return n(this,void 0,void 0,function*(){do{if(m.information("[字幕上传]中...subPath=",e),!d.XmpUtilityNS.isSubtitleFile(e))return;let t=yield d.XmpUtilityNS.calculateFileCidAW(e);if(!t)return void m.warning("当前字幕无CID,稍后再试");let n="http://subtitle.kankan.xunlei.com:8000/subup/"+t.substr(0,2)+"/"+t.substr(t.length-2)+"/"+t+".json?xmpver="+d.XmpUtilityNS.getXmpBuildNum(),r=null;try{const e=yield i(26);e.defaults.adapter=i(32),r=yield e.get(n)}catch(e){m.information("网络请求错误")}if(null===r||200!==r.status||!r.data||""===r.data){m.information("request failed! response:",r);break}if(1!==r.data.iaccept){m.information("不被接受 not accept, data:",r.data);break}let a=0,l=1,c=yield u.FileSystemAWNS.getFileSize(e),h="ssfilename="+encodeURIComponent(e)+"; i64sfilesize="+c,p=e.substr(0,e.length-4)+".idx",g=0,S="";if((yield u.FileSystemAWNS.existsAW(p))&&(l=2,a=1,g=yield u.FileSystemAWNS.getFileSize(p),S="ssfilename2="+encodeURIComponent(p)+"; i64sfilesize2="+g),c+g>10485760)return;let y,C=0,I="sscid="+t+"; istype="+a+"; isfilenum="+l,v=yield o.xmpPlayer.getConfig(s.APlayerConfigId.CONFIGID_SUBTITLE2LANGUAGELIST);v&&(C=(y=v.split(";"))?y.length:0);let T="ilanguagenum="+C;for(let e=0;e<C;++e)T=0===e?T+"; sslanguage="+y[e]:T+"; sslanguage"+e+"="+y[e];let E="";f&&(E=f.getPeerID());let b={"Content-Type":"text/html","xmpsubtitle-common":" sprotocol_version=1; icmdid=1002; resp_format=1; encode=utf-8; speerid="+E,"xmpsubtitle-upload":I,"xmpsubtitle-language":T,"xmpsubtitle-file1":h};2===l&&(b["xmpsubtitle-file2"]=S),n="http://subtitle.kankan.xunlei.com:8000/?xmpver="+d.XmpUtilityNS.getXmpBuildNum();let P=new ArrayBuffer(c+g),w=yield u.FileSystemAWNS.readFileAW(e),D=new Uint8Array(P);for(let e=0;e<w.length;++e)D[e]=w[e];if(2===l){let e=yield u.FileSystemAWNS.readFileAW(p);for(let t=c;t<c+e.length;++t)D[t]=e[t]}try{let e=JSON.stringify(b);m.information("开始上传字幕中,headDesc=",e),(yield i(26)).post(n,P,{headers:b}).then(e=>{m.information("上传结果,res=",e)})}catch(e){m.information("上传字幕错误")}}while(0)})}checkData(e){let t=0;for(const i in e)e.hasOwnProperty(i)&&(p.isNullOrUndefined(e[i])?t++:""===e[i]&&t++);return 0===t}isDebugEnv(){return n(this,void 0,void 0,function*(){return yield u.FileSystemAWNS.existsAW("C:\\debug-xmp.txt")})}}},function(e,t){e.exports=require("crypto")},function(e,t,i){"use strict";e.exports=function(e,t){return function(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];return e.apply(t,i)}}},function(e,t,i){"use strict";var n=i(116);e.exports=function(e,t,i,o,r){var a=new Error(e);return n(a,t,i,o,r)}},function(e,t,i){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,i){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.XmpHotKeyManagerNS=t.XmpHotKeyManager=void 0;const o=i(4),r=i(8),a=i(15),s=i(17),l=i(0),d=i(5),u=i(7),c=i(3),h=i(6),p=i(2),f=i(10),m=i(41),g=l.default.getLogger("HotKeyHelper"),S=u.XmpMediaManagerNS.getXmpMediaManager(),y=S.getXmpPlayer();class C{constructor(){this.nextSecond=5e3,this.preSecond=-5e3,this.hotKeys={}}getCurrentMode(){let e="",t=m.IpcModeControlNS.getCurrentMode();return t===f.XmpMode.EMBED_MODE&&(e=",components_type=embed"),t===f.XmpMode.INDEPENDENT_MODE&&(e=",components_type=independent"),e}setVolume(e){return n(this,void 0,void 0,function*(){let t=y.getState();if(t>=o.XmpMediaState.Pausing&&t<=o.XmpMediaState.Play){let t=yield y.getVolume();(t+=e)>1e3&&(t=1e3),t<=0&&(t=0);let i=this.getCurrentMode();5===e?(i+=",button=voice_add_5",yield p.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,i)):(i+=",button=voice_reduce_5",yield p.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,i)),yield y.setVolume(t),r.server.fireClientEvent(d.XmpEvent.onVolumeChange,t)}})}getValue(e,t,i){let n=a.ConfigNS.getValue(e,t,void 0);return void 0===n&&(n=i,a.ConfigNS.setValue(e,t,i)),g.information("getValue hotkey",e,t,"value",n),n}registerHotKey(){return n(this,void 0,void 0,function*(){{let e=" ";e=this.getValue(s.ConfigDefineNS.play.section,s.ConfigDefineNS.play.key,s.ConfigDefineNS.play.value),this.hotKeys[s.ConfigDefineNS.play.key]={hotValue:e,hotFunc:()=>n(this,void 0,void 0,function*(){let e=y.getState();do{let t=this.getCurrentMode();if(e===o.XmpMediaState.Playing||e===o.XmpMediaState.Play)t+=",button=space_pause",yield p.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,t),yield y.pause();else{if(e!==o.XmpMediaState.Paused&&e!==o.XmpMediaState.Pausing)break;t+=",button=space_play",yield p.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,t),yield y.play()}let i=y.getState();r.server.fireClientEvent(d.XmpEvent.onPlayStateChange,e,i)}while(0)})},e=this.getValue(s.ConfigDefineNS.full.section,s.ConfigDefineNS.full.key,s.ConfigDefineNS.full.value),this.hotKeys[s.ConfigDefineNS.full.key]={hotValue:e,hotFunc:()=>n(this,void 0,void 0,function*(){p.client.callRemoteClientFunction(h.mainRendererContext,c.XmpPlayerFunction.setFullcScreen).catch()})},e=this.getValue(s.ConfigDefineNS.stop.section,s.ConfigDefineNS.stop.key,s.ConfigDefineNS.stop.value),this.hotKeys[s.ConfigDefineNS.stop.key]={hotValue:e,hotFunc:()=>n(this,void 0,void 0,function*(){let e=y.getState();if(e>=o.XmpMediaState.Pausing&&e<=o.XmpMediaState.Play){let e=S.getCurrentMedia();yield S.close(e)}})},e=this.getValue(s.ConfigDefineNS.quit.section,s.ConfigDefineNS.quit.key,s.ConfigDefineNS.quit.value),this.hotKeys[s.ConfigDefineNS.quit.key]={hotValue:e,hotFunc:()=>{}},e=this.getValue(s.ConfigDefineNS.back.section,s.ConfigDefineNS.back.key,s.ConfigDefineNS.back.value),this.hotKeys[s.ConfigDefineNS.back.key]={hotValue:e,hotFunc:()=>n(this,void 0,void 0,function*(){let e=a.ConfigNS.getValue(s.ConfigDefineNS.playFrameSeek.section,s.ConfigDefineNS.playFrameSeek.key,s.ConfigDefineNS.playFrameSeek.value),t=this.getCurrentMode();t+=",button=back_5",yield p.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,t),yield y.positionChanged(this.preSecond,e.toString(),0,!0)})},e=this.getValue(s.ConfigDefineNS.fast.section,s.ConfigDefineNS.fast.key,s.ConfigDefineNS.fast.value),this.hotKeys[s.ConfigDefineNS.fast.key]={hotValue:e,hotFunc:()=>n(this,void 0,void 0,function*(){let e=this.getCurrentMode();e+=",button=forward_5",yield p.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,e),yield y.positionChanged(this.nextSecond,"1",0,!0)})},e=this.getValue(s.ConfigDefineNS.addVolume.section,s.ConfigDefineNS.addVolume.key,s.ConfigDefineNS.addVolume.value),this.hotKeys[s.ConfigDefineNS.addVolume.key]={hotValue:e,hotFunc:()=>n(this,void 0,void 0,function*(){yield this.setVolume(5)})},e=this.getValue(s.ConfigDefineNS.reduceVolume.section,s.ConfigDefineNS.reduceVolume.key,s.ConfigDefineNS.reduceVolume.value),this.hotKeys[s.ConfigDefineNS.reduceVolume.key]={hotValue:e,hotFunc:()=>n(this,void 0,void 0,function*(){yield this.setVolume(-5)})},this.hotKeys.quitFullScreen={hotValue:"esc",hotFunc:()=>n(this,void 0,void 0,function*(){p.client.callRemoteClientFunction(h.mainRendererContext,c.XmpPlayerFunction.setFullcScreen,"esc").catch()})},this.hotKeys.quitProcess={hotValue:"alt+f4",hotFunc:()=>n(this,void 0,void 0,function*(){p.client.callRemoteClientFunction(h.mainRendererContext,c.XmpPlayerFunction.close).catch()})}}})}fireWindowEvent(e,t="keydown"){return n(this,void 0,void 0,function*(){do{if("keydown"!==t)break;let i=Object.values(this.hotKeys),n=void 0;for(let t of i)if(t.hotValue===e){n=t.hotFunc;break}n&&(yield n(e))}while(0)})}}t.XmpHotKeyManager=C;const I=new C;!function(e){e.getXmpHotKeyManager=function(){return I.registerHotKey().catch(),I}}(t.XmpHotKeyManagerNS||(t.XmpHotKeyManagerNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.deviceHelper=void 0;const o=i(61),r=i(135);t.deviceHelper=new class{init(){o.dlna.init().catch(),r.widi.init()}activeDevice(e){return n(this,void 0,void 0,function*(){yield o.dlna.activeDevice(e),yield r.widi.activeDevice(e)})}getDeviceList(){return n(this,void 0,void 0,function*(){let e=yield o.dlna.getDeviceList(),t=yield r.widi.getDeviceList(),i=e;for(let e=0;e<t.length;e++)i.push(t[e]);return i})}searchDevice(){return n(this,void 0,void 0,function*(){o.dlna.searchDevice().catch(),r.widi.searchDevice()})}registDeviceNofiy(e){o.dlna.registNotify(e)}getCurrentDevice(e){return n(this,void 0,void 0,function*(){return"WIDI"===e?r.widi.getCurrentDevice():"DLNA"===e?o.dlna.getCurrentDevice():""})}isDeviceSupport(e,t){return n(this,void 0,void 0,function*(){return"WIDI"===e?r.widi.isDeviceSupport(t):"DLNA"===e&&o.dlna.isDeviceSupport(t)})}connectDevice(e,t,i,a){return n(this,void 0,void 0,function*(){return"WIDI"===e?r.widi.connectDevice(t,i,a):"DLNA"===e?o.dlna.connectDevice(t,i,a):void 0})}disConnectDevice(e,t){return n(this,void 0,void 0,function*(){return"WIDI"===e?r.widi.disConnectDevice(t):"DLNA"===e?o.dlna.disConnectDevice(t):void 0})}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.DkHelper=t.DkEventNS=void 0;const o=i(139),r=i(12),a=i(2),s=i(0).default.getLogger("xmp-vip-download-kernel-helper");var l;!function(e){e.taskInserted="OnTaskInserted",e.taskCompleted="OnTaskCompleted",e.taskRemoved="OnTaskRemoved",e.taskStatusChanged="OnTaskStatusChanged",e.taskDetailChanged="OnTaskDetailChanged",e.taskDcdnStatusChanged="OnTaskDcdnStatusChanged",e.btSubFileDcdnStatusChanged="OnBtSubFileDcdnStatusChanged",e.btSubFileDetailChanged="OnBtSubFileDetailChanged"}(l=t.DkEventNS||(t.DkEventNS={}));class d extends r.EventEmitter{constructor(){super(),this.mPeerId=void 0,this.init()}init(){this.setMaxListeners(0)}getTpPeerId(){return n(this,void 0,void 0,function*(){if(this.mPeerId)return this.mPeerId;{let e=yield a.client.callServerFunction("GetTpPeerId");return e&&""!==e&&(this.mPeerId=e),this.mPeerId||""}})}getCurrentCategoryId(){return n(this,void 0,void 0,function*(){return yield a.client.callServerFunction("GetCurrentCategoryId")})}getTaskBaseInfo(e){return n(this,void 0,void 0,function*(){let t=null,i=yield a.client.callServerFunction("GetTaskBaseInfo",e);if(i)try{t=JSON.parse(i)}catch(e){s.warning(e)}return t})}getTaskGcid(e){return n(this,void 0,void 0,function*(){let t=yield this.getTaskBaseInfo(e),i="";return t&&t.gcid&&(i=t.gcid),i})}getTaskStatus(e){return n(this,void 0,void 0,function*(){return yield a.client.callServerFunction("GetTaskStatus",e)})}IsTaskExist(e){return n(this,void 0,void 0,function*(){return yield a.client.callServerFunction("IsTaskExist",e)})}getTaskDetail(e){return n(this,void 0,void 0,function*(){let t=null,i=yield a.client.callServerFunction("GetTaskInfo",e,void 0,"taskDetail");s.information("getTaskDetail",i);do{if(!i)break;let e=null;try{e=JSON.parse(i)}catch(e){s.warning(e)}if(!e||!e.fileList)break;let n=e.infoId,r=e.type;t={infoId:n,files:new Map};for(let i of e.fileList){let e=-1,a=i.url;r===o.DownloadKernel.TaskType.Bt?(e=i.index,a=this.createBtFileUrl(i.index,n)):r===o.DownloadKernel.TaskType.Group&&(e=i.taskId);let s={subId:e,taskStatus:i.status,filePath:i.filePath,fileName:i.fileName,gcid:i.gcid,cid:i.cid,url:a,refUrl:i.refUrl||"",fileSize:i.fileSize,downloadSize:i.downloadSize,errCode:i.errCode,isNeedDownload:i.isNeedDownload,dcdnStatus:i.dcdnStatus};t.files.set(e,s)}}while(0);return t})}createBtTaskUrl(e){return"bt://"+e}createBtFileUrl(e,t){let i=this.createBtTaskUrl(t);return i=i+"/"+e}startTask(e){this.operateTask(e,"continue")}stopTask(e){this.operateTask(e,"pause")}enableDcdnWithVipCert(e,t){return n(this,void 0,void 0,function*(){s.information("enableDcdnWithVipCert","taskId",e,"vipCert",t),yield a.client.callServerFunction("EnableDcdnWithVipCert",e,t)})}updateDcdnWithVipCert(e,t){return n(this,void 0,void 0,function*(){s.information("updateDcdnWithVipCert","taskId",e,"vipCert",t),yield a.client.callServerFunction("UpdateDcdnWithVipCert",e,t)})}disableDcdnWithVipCert(e){return n(this,void 0,void 0,function*(){s.information("disableDcdnWithVipCert","taskId",e),yield a.client.callServerFunction("DisableDcdnWithVipCert",e)})}getDownloadingActiveTaskId(){return n(this,void 0,void 0,function*(){return yield a.client.callServerFunction("GetDownloadingActiveTaskId")})}attachDkEvents(){a.client.attachServerEvent("OnTaskInserted",this.onTaskInserted.bind(this)),a.client.attachServerEvent("OnTaskRemoved",this.onTaskRemoved.bind(this)),a.client.attachServerEvent("OnTaskStatusChanged",(e,t)=>{{let e=null;try{e=JSON.parse(t)}catch(e){s.warning(e)}if(null!==e)for(let t in e){let i=e[t];this.onTaskStatusChanged(Number(t),i)}}}),a.client.attachServerEvent("OnTaskDetailChanged",(e,t,i)=>{t.forEach(e=>n(this,void 0,void 0,function*(){this.onTaskDetailChanged(Number(e),yield this.getTaskBaseInfo(e))}))}),a.client.attachServerEvent("OnTaskDcdnStatusChanged",(e,t)=>{if(null!==t)for(let e in t){let i=t[e];this.onTaskDcdnStatusChanged(Number(e),i)}}),a.client.attachServerEvent("OnBtSubFileDcdnStatusChanged",this.onBtSubFileDcdnStatusChanged.bind(this)),a.client.attachServerEvent("OnBtSubFileDetailChanged",(e,t,i)=>{{let e=null;try{e=JSON.parse(i)}catch(e){s.warning(e)}null!==e&&this.onBtSubFileDetailChanged(t,e)}})}operateTask(e,t,i){a.client.callServerFunction("OperateTask",e,t,i).catch()}onTaskInserted(e,t,i,n){if(s.information("onTaskInserted categoryId:",t,", categoryViewId:",i),null!==n)switch(i){case o.DownloadKernel.CategroyViewID.Downloading:n.forEach(e=>{this.emit(l.taskInserted,e)});break;case o.DownloadKernel.CategroyViewID.Completed:n.forEach(e=>{this.emit(l.taskCompleted,e)})}}onTaskRemoved(e,t,i,n){if(s.information("onTaskRemoved categoryId:",t,", categoryViewId:",i),n)switch(i){case o.DownloadKernel.CategroyViewID.Downloading:case o.DownloadKernel.CategroyViewID.Completed:n.forEach(e=>{this.emit(l.taskRemoved,e)})}}onTaskStatusChanged(e,t){this.emit(l.taskStatusChanged,e,t)}onTaskDetailChanged(e,t){this.emit(l.taskDetailChanged,e,t)}onTaskDcdnStatusChanged(e,t){this.emit(l.taskDcdnStatusChanged,e,t)}onBtSubFileDcdnStatusChanged(e,t,i,n){this.emit(l.btSubFileDcdnStatusChanged,t,i,n)}onBtSubFileDetailChanged(e,t){this.emit(l.btSubFileDetailChanged,e,t)}}t.DkHelper=d,t.default=new d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpJsonCryptoNS=void 0;const n=i(48),o=i(140),r=i(33),a=i(27),s=i(0).default.getLogger("xmp-vip-json-crypto");!function(e){e.getAuthorization=function(e,t,i,n){let o=e+":"+t;return i&&(o=o+":"+i),n&&(o=o+":"+n),o},e.getAccept=function(){return"application/json; version=1.0"},e.getUriParam=function(e,t,i){let n="client_name="+a.default.clientName+"&client_version="+a.default.thunderVersionNumber+"&client_sequence="+e+"&r="+t+"&isvip="+Number(r.default.isVip);return void 0!==i&&(n=n+"&verify_type="+i),n},e.getKey=function(e,t){let i=a.default.clientName+a.default.thunderVersionNumber+e+t;return(i=o.ToolsUtilitiesAWNS.genarateMd5(i)).substr(0,16).toUpperCase()},e.encryptHttpBuffer=function(e,t){s.information("key",t);let i=JSON.stringify(e);s.information("jsonStr",i);let r=n.Buffer.from(i);return o.ToolsUtilitiesAWNS.encryptBuffer(r,t)},e.decryptHttpBuffer=function(e,t){s.information("key",t);let i=null;if(e=o.ToolsUtilitiesAWNS.decryptBuffer(e,t)){let t=e.toString();s.information("jsonStr",t);try{i=JSON.parse(t)}catch(e){s.warning(e)}}return i}}(t.HttpJsonCryptoNS||(t.HttpJsonCryptoNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.VipStatNS=void 0;const o=i(76),r=i(33),a=i(27),s=i(0),l=i(40),d=s.default.getLogger("track-stat-xmp-vip");!function(e){function t(){let e=0;return r.default.isSuperVip?e=5:r.default.isPlatinumVip?e=3:r.default.isVip&&(e=2),e}function i(){return n(this,void 0,void 0,function*(){let e=new Map,i=function(){let e=0;return r.default.isLogin&&(e=1),e}(),n=function(){let e=0;return r.default.isVip&&(e=1),e}(),o=t();return e.set("is_login",i),e.set("is_vip",n),e.set("vip_type",o),e.set("plugin_version",a.default.pluginVersion),e.set("client_version",a.default.thunderVersionString),e.set("player_type",yield a.default.getXmpMode()),e})}e.firstBufferShow=function(e,t){return n(this,void 0,void 0,function*(){let n=yield i();n.set("gcid",e),n.set("is_delay",t);let o={attribute1:"bxbb_buffer_qp_show",extData:n};l.CommonNS.trackShowEvnet("xlx_vip_event",o.attribute1,o.extData)})},e.firstBufferClick=function(e,t){return n(this,void 0,void 0,function*(){let n=yield i();n.set("gcid",e),n.set("is_delay",t);let r={attribute1:"bxbb_buffer_qp_click",extData:n};o.StatUtilitiesNS.trackEvent("xlx_vip_event",r)})},e.bxbbStuckShow=function(e,t){return n(this,void 0,void 0,function*(){let n=yield i();n.set("is_nature",e),n.set("is_delay",t);let o={attribute1:"bxbb_buffer_open_show",extData:n};l.CommonNS.trackShowEvnet("xlx_vip_event",o.attribute1,o.extData)})},e.bxbbStuckClick=function(e,t){return n(this,void 0,void 0,function*(){let n=yield i();n.set("is_nature",e),n.set("is_delay",t);let r={attribute1:"bxbb_buffer_open_click",extData:n};o.StatUtilitiesNS.trackEvent("xlx_vip_event",r)})},e.vipButtonShow=function(e){return n(this,void 0,void 0,function*(){d.information("vipButtonShow");let t=yield i();t.set("gcid",e);let n={attribute1:"bxbb_vipspeedup_btn_show",extData:t};l.CommonNS.trackShowEvnet("xlx_vip_event",n.attribute1,n.extData)})},e.vipButtonClick=function(e){return n(this,void 0,void 0,function*(){d.information("vipButtonClick");let t=yield i();t.set("gcid",e);let n={attribute1:"bxbb_vipspeedup_btn_click",extData:t};o.StatUtilitiesNS.trackEvent("xlx_vip_event",n)})},e.playSpeedShow=function(){return n(this,void 0,void 0,function*(){d.information("playSpeedShow");let e={attribute1:"xmp_play_speed_option_show",extData:yield i()};l.CommonNS.trackShowEvnet("xlx_vip_event",e.attribute1,e.extData)})},e.playSpeedClick=function(e){return n(this,void 0,void 0,function*(){d.information("playSpeedClick");let t=yield i();t.set("clickid",`speed${e}`);let n={attribute1:"xmp_play_speed_option_click",extData:t};o.StatUtilitiesNS.trackEvent("xlx_vip_event",n)})},e.xmpPlayStart=function(e,t){return n(this,void 0,void 0,function*(){if(!e)return;d.information("xmpPlayStart");let n=yield i();n.set("player_type",e),n.set("play_type",t);let r={attribute1:"xmp_play_start",extData:n};o.StatUtilitiesNS.trackEvent("xlx_vip_event",r)})},e.xmpVideoLoadOpenYunboBtnShow=function(e,i,o){return n(this,void 0,void 0,function*(){d.information("xmpVideoLoadOpenYunboBtnShow");let n=new Map;n.set("components_type",e),n.set("play_from",i),n.set("vip_type",t()),n.set("btn_position",o);let r={attribute1:"xmp_video_load_open_yunbo_btn_show",extData:n};l.CommonNS.trackShowEvnet("xlx_vip_event",r.attribute1,r.extData)})},e.xmpVideoLoadOpenYunboBtnClick=function(e,i,r){return n(this,void 0,void 0,function*(){d.information("xmpVideoLoadOpenYunboBtnClick");let n=new Map;n.set("components_type",e),n.set("play_from",i),n.set("vip_type",t()),n.set("btn_position",r);let a={attribute1:"xmp_video_load_open_yunbo_btn_click",extData:n};o.StatUtilitiesNS.trackEvent("xlx_vip_event",a)})}}(t.VipStatNS||(t.VipStatNS={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatUtilitiesNS=void 0;const n=i(27),o=i(2),r=i(0).default.getLogger("vip-stat-utilities");!function(e){e.trackEvent=function(e,t){let i=(t=t||{}).attribute1||"",a=t.attribute2||"",s=t.extData||new Map;s.set("plugin_version",n.default.pluginVersion),s.set("client_version",n.default.thunderVersionString);let l=function(e){let t="";return e.forEach((e,i)=>{""!==t&&(t+=","),t=t+i+"="+e}),t}(s);r.information("key",e),r.information("attribute1",i),r.information("attribute2",a),r.information("extData",l),o.client.callServerFunction("TrackEvent",e,i,a,0,0,0,0,l).catch()},e.initUtilities=function(){let e={TrackShowEvent:i};o.client.registerFunctions(e)};let t=new Map;function i(e,...i){let n=i[0],a=i[1],s=i[2],l=i[3];r.information("trackShowEvent",...i);do{if(t.has(s)&&n-t.get(s)<2e3){r.information("break trackShowEvent",n,s),t.get(s);break}r.information("key",a),r.information("attribute1",s),r.information("extData",l),o.client.callServerFunction("TrackEvent",a,s,"",0,0,0,0,l).catch()}while(0);t.set(s,n)}}(t.StatUtilitiesNS||(t.StatUtilitiesNS={}))},function(e,t,i){i(78),e.exports=i(79)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),o=i(20),r=i(1),a=i(9).default(r.join(__rootDir,"../bin/ThunderHelper.node")),s=i(34),l=i(19);function d(){"console"===process.env.TL_OUTPUT?n.default.outputLogger=n.outputLoggerConsole:n.default.outputLogger=function(){function e(e){return function(...t){a.printEtwLog(e,function(...e){return e.map(e=>o.inspect(e)).join(" ").replace(/%/g,"%%")}(...t))}}return{[n.LogLevel.Critical]:e(n.LogLevel.Critical),[n.LogLevel.Error]:e(n.LogLevel.Error),[n.LogLevel.Warning]:e(n.LogLevel.Warning),[n.LogLevel.Information]:e(n.LogLevel.Information),[n.LogLevel.Verbose]:e(n.LogLevel.Verbose)}}()}function u(){n.default.enableLogger="1"===process.env.TL_ENABLE,d()}d(),"browser"===process.type?l.ipcMain.on(s.ThunderChannelList.channelRMUpdateLogEnviroment,()=>{u()}):"renderer"===process.type&&l.ipcRenderer.on(s.ThunderChannelList.channelMRUpdateLogEnviroment,()=>{u()})},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=i(0),r=i(1),a=i(28),s=i(41),l=i(8),d=i(132),u=i(7),c=i(133),h=i(134),p=i(137),f=i(146),m=i(147),g=i(15),S=i(149),y=i(37),C=i(30),I=i(150),v=i(76),T=i(151),E=o.default.getLogger("XMP.MainRenderer");let b=!1;const P=i(155);s.IpcModeControlNS.registerPluginFunction().catch(),d.IpcPlayControlNS.registerPluginFunction(),T.IAplayerWindowMessageHelperNS.init().catch(),S.IpcUIFunctionControlNS.registerPluginFunction(),m.QuitHandlerNS.addQuitHandler(),p.default.init(P.version).catch(),I.VipMenuNS.monitorVipMenu(),v.StatUtilitiesNS.initUtilities(),g.ConfigNS.init(`${__profilesDir}/XMP/config.json`).catch(),f.IpcConfigControlNS.registerPluginFunction(),C.LeftTopVideoTipManagerNS.getLeftTopVideoTipManager().registerPluginFunction(),function(){return n(this,void 0,void 0,function*(){E.information("main-renderer enter, __dirname: ",__dirname,", __profilesDir:",__profilesDir),global.__xmpRootDir=__dirname,window.__xmpRootDir=__dirname,global.__xmpProfilesDir=`${__profilesDir}/XMP`,window.__xmpProfilesDir=`${__profilesDir}/XMP`,yield u.xmpPlayer.createAPlayer(),y.playStat.init(),function(){return n(this,void 0,void 0,function*(){})}().catch(),function(){if(E.information("registerPluginFunction isRegister",b),!b){b=!0;let e={};l.server.registerFunctions(e)}c.PluginFunctionSubtitleNS.registerPluginFunction(),h.PluginFunctionNS.registerPluginFunction()}(),a.require(r.join(__dirname,"main.js")).__resolve().catch()})}().catch()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWebContents=t.getCurrentWebContents=t.getCurrentWindow=t.getGlobal=t.getBuiltin=t.remoteRequire=t.Interest=void 0;const n=i(19),o=i(48),r=i(81),a=i(82),s=i(49),l=i(83),d=i(29),u=i(50),c=n.ipcRenderer,h=process.electronBinding("v8_util"),p=new r.default,f=h.createIDWeakMap(),m=h.getHiddenValue(global,"contextId");class g{constructor(e){if("object"==typeof e?(this.on="object"==typeof e.on?e.on:{},this.once="object"==typeof e.once?e.once:{}):(this.on={},this.once={}),!this.check())throw new Error("unexpected param")}check(){let e=!0;do{let t=Object.getOwnPropertyNames(this.on);if(t.forEach(t=>{"function"!=typeof this.on[t]&&(e=!1)}),!e)break;(t=Object.getOwnPropertyNames(this.once)).forEach(t=>{"function"!=typeof this.once[t]&&(e=!1)})}while(0);return e}}function S(e,t=new Set){const i=e=>{if(t.has(e))return{type:"value",value:null};let n=e;if(Array.isArray(e)){t.add(e);let i={type:"array",value:S(e,t)};return t.delete(e),i}if(ArrayBuffer.isView(n))return{type:"buffer",value:o.Buffer.from(e)};if(e instanceof Date)return{type:"date",value:e.getTime()};if(null!=e&&"object"==typeof e){if(u.isPromise(e))return{type:"promise",then:i(function(t,i){e.then(t,i)})};if(h.getHiddenValue(e,"__remote_id__"))return{type:"remote-object",id:h.getHiddenValue(e,"__remote_id__")};let n={type:e instanceof g?"interest":"object",name:e.constructor?e.constructor.name:"",members:[]};t.add(e);for(let t in e)n.members.push({name:t,value:i(e[t])});return t.delete(e),n}if("function"==typeof e){return{type:"function",id:p.add(e),location:h.getHiddenValue(e,"__remote_call_location__"),length:e.length}}return{type:"value",value:e}};return e.map(i)}function y(e,t,i){u.isPromise(e)?e.then(e=>{t(e)},e=>{i(e)}):t(e)}function C(e,t,i,n=!1){const o=t=>{if(e.hasOwnProperty(t.name)&&!n)return;let i,o={enumerable:t.enumerable,configurable:!0};if("method"===t.type){if(t.value.refId){if(f.has(t.value.refId)&&(i=f.get(t.value.refId)),null==i)throw new Error("member refId pointer to null"+t.value.refId+"name: "+t.name)}else i=E(t.value,e,t.name);o.get=(()=>i),o.set=(e=>i=e)}else"get"===t.type&&(o.get=(()=>i),t.writable&&(o.set=(e=>{i=e})),i=E(t.value));Object.defineProperty(e,t.name,o)};if(Array.isArray(i)){let e=i.length;for(let t=0;t<e;t++)o(i[t])}}function I(e,t,i){if(i){let t=E(i);Object.setPrototypeOf(e,t)}}function v(e,t){h.setHiddenValue(e,"__remote_id__",t)}function T(e){return h.getHiddenValue(e,"__remote_id__")}function E(e,t,i){const n={value:()=>e.value,array:()=>e.members.map(e=>E(e)),buffer:()=>o.Buffer.from(e.value),promise:()=>Promise.resolve({then:E(e.then)}),error:()=>(function(e){const t=(()=>"error"===e.type?new Error:{})();for(let i=0;i<e.members.length;i++){let{name:n,value:o}=e.members[i];t[n]=o}return t})(e),date:()=>new Date(e.value),exception:()=>{throw new Error(`${e.message}\n${e.stack}`)}};let r;return e.type in n?r=n[e.type]():e.refId?f.has(e.refId)?(h.addRemoteObjectRef(m,e.refId),r=f.get(e.refId)):(d.warn("[metaToValue] refId point to null"+e.refId),r="function"===e.type?()=>{}:{}):e.id?f.has(e.id)?(h.addRemoteObjectRef(m,e.id),C(r=f.get(e.id),e.id,e.members,!0),I(r,e.id,e.proto)):(r="function"===e.type?t?function(e,t,i){if(f.has(i.id))return f.get(i.id);let n=T(e),o=function(...e){throw Error("never should come to a proxied function")};Object.defineProperty(o,"name",{value:t,writable:!1,enumerable:!0});let r=new Proxy(o,{apply:(e,i,o)=>new Promise((e,r)=>{let d=T(i);if(d||(d=T(i.__remoteObj_)),!d)throw Error("is this function was a bound function?");let u=s.default.browser.memberCall,h=l.default(u),p=S(o);c.send(u,m,h,d,n,t,p),a.default.add(h,t=>{try{y(E(t),e,r)}catch(e){r(e)}})}),construct:(e,i,o)=>new Promise((e,o)=>{let r=s.default.browser.memberConstruct,d=l.default(r);c.send(r,m,d,n,t,S(i)),a.default.add(d,t=>{try{let i=E(t);e(i)}catch(e){o(e)}})})});return h.setHiddenValue(o,"__remote_id__",i.id),r}(t,i,e):function(e){let t=e.id;const i=function(...e){throw new Error("Should Never com to a remoteFunction PlaceHolder")};return v(i,t),new Proxy(i,{apply:(e,i,n)=>new Promise((e,o)=>{let r=s.default.browser.functionCall,d=l.default(r),u=T(i);c.send(r,m,d,u,t,S(n)),a.default.add(d,t=>{try{y(E(t),e,o)}catch(e){o(e)}})}),construct:(e,i,n)=>new Promise((e,n)=>{let o=s.default.browser.construct,r=l.default(o);c.send(o,m,r,t,S(i)),a.default.add(r,t=>{try{let i=E(t);e(i)}catch(e){n(e)}})})})}(e):{},h.setRemoteObjectFreer(r,m,e.id),f.set(e.id,r),h.setHiddenValue(r,"__remote_id__",e.id),h.addRemoteObjectRef(m,e.id),function(e){let t=T(e);Object.defineProperties(e,{__set:{enumerable:!1,writable:!1,value:function(i,n){if("function"==typeof n)throw new Error("set a function to a remote member is dangerous");return new Promise((o,r)=>{let d=s.default.browser.memberSet,u=l.default(d),h=S([n]);c.send(d,m,u,t,i,h),a.default.add(u,t=>{try{let a=E(t);e[i]=n,o(a)}catch(e){r(e)}})})}},__get:{enumerable:!1,writable:!1,value:function(i){return new Promise((n,o)=>{let r=s.default.browser.memberGet,d=l.default(r);c.send(r,m,d,t,i),a.default.add(d,t=>{try{const r=E(t);e[i]=r,n(r)}catch(e){o(e)}})})}},__sync:{enumerable:!1,writable:!1,value:function(){return new Promise((e,i)=>{let n=s.default.browser.sync,o=l.default(n);c.send(n,m,o,t),a.default.add(o,n=>{try{if(n.id!==t)throw Error("SYNC_RETURN: remote id not match");let o=E(n);e(o)}catch(e){i(e)}})})}}})}(r),C(r,e.id,e.members),I(r,e.id,e.proto),Object.defineProperty(r.constructor,"name",{value:e.name}),e.extendedMemberNames&&e.extendedMemberNames.forEach((e,t)=>{let i=r[e],n=r.__proto__;for(;n;){if(Object.prototype.hasOwnProperty.call(n,e)){delete n[e];break}n=n.__proto__}Object.defineProperty(r,e,{value:i,enumerable:!1,writable:!1,configurable:!0})})):d.error("no id of meta:",e),r}t.Interest=g;class b{constructor(...e){if(this.__resolved_=!1,this.__promise_=null,this.__remoteObj_=null,this.__what_="",this.__name_="","string"===typeof arguments[0]){let e=arguments[0],t=arguments[1];this.__what_=e,this.__name_=t||e,this.__resolved_=!1,this.__remoteObj_=null,this.__promise_=new Promise((i,n)=>{let o=this.getChannel(e),r=l.default(o);c.send(o,m,r,t),a.default.add(r,e=>{try{let t=E(e);this.__remoteObj_=t,this.__resolved_=!0,i(t)}catch(e){n(e)}})})}else this.__remoteObj_=arguments[0],this.__resolved_=!0,this.__promise_=null}getChannel(e){let t="";switch(e){case"module":t=s.default.browser.require;break;case"builtin":t=s.default.browser.builtIn;break;case"global":t=s.default.browser.global;break;case"current_window":t=s.default.browser.currentWindow;break;case"current_web_contents":t=s.default.browser.currentWebContents;break;case"client_web_contents":t=s.default.browser.clientWebContents;break;case"web_contents":t=s.default.browser.webContents}return t}__resolve(){let e=this.__promise_;if(null!==e);else{if(!this.__resolved_)throw Error("missing the promise for ayncnomously get remote object");e=new Promise((e,t)=>{e(this.__remoteObj_)}),this.__promise_=e}return e}__isResolved(){return this.__resolved_}}function P(e,t,i){try{a.default.invoke(t,i).remove(t)}finally{a.default.remove(t)}}c.on(s.default.renderer.requireReturn,P),c.on(s.default.renderer.getBuiltInReturn,P),c.on(s.default.renderer.getGlobalReturn,P),c.on(s.default.renderer.currentWindowReturn,P),c.on(s.default.renderer.currentWebContentsReturn,P),c.on(s.default.renderer.functionCallReturn,P),c.on(s.default.renderer.constructReturn,P),c.on(s.default.renderer.memberCallReturn,P),c.on(s.default.renderer.memberSetReturn,P),c.on(s.default.renderer.memberGetReturn,P),c.on(s.default.renderer.memberConstructReturn,P),c.on(s.default.renderer.callback,(e,t,i)=>{p.apply(t,E(i))}),c.on(s.default.renderer.syncReturn,P),c.on("ELECTRON_RENDERER_RELEASE_CALLBACK",(e,t)=>{d.info("[RELEASE_CALLBACK]: callbackId:",t),p.remove(t)}),process.on("exit",()=>{c.send(s.default.browser.contextRelease)});const w=["__resolve","__isResolved"],D=["__promise_","__resolved_","__remoteObj_","__name_","__what_"],O=e=>{if(!e.__isResolved())throw Error("Can not access the property of a remote module which has not Resolved yet.")};function N(e){const t=function(){};Object.defineProperty(t,"name",{value:e.__name_}),Object.defineProperty(t,"what",{enumerable:!1,value:e.__what_});let i=new Proxy(t,{getPrototypeOf:t=>(O(e),Reflect.getPrototypeOf(e.__remoteObj_)),setPrototypeOf:(e,t)=>{throw new Error("changing prototype of remote object is forbidden")},isExtensible:t=>(O(e),Reflect.isExtensible(e.__remoteObj_)),preventExtensions:t=>(O(e),Reflect.preventExtensions(e)),getOwnPropertyDescriptor:(t,i)=>(O(e),Reflect.getOwnPropertyDescriptor(e.__remoteObj_,i)),has:(t,i)=>(O(e),Reflect.has(e.__remoteObj_,i)),deleteProperty:(t,i)=>(O(t),Reflect.deleteProperty(e.__remoteObj_,i)),defineProperty:(t,i,n)=>(O(e),Reflect.defineProperty(e.__remoteObj_,i,n)),get:(t,i,n)=>{if("string"==typeof i){if(String.prototype.includes.call(D,i)){return e[i]}if(String.prototype.includes.call(w,i)){return e[i]}}return O(e),Reflect.get(e.__remoteObj_,i)},set:(t,i,n,o)=>(O(e),Reflect.set(e.__remoteObj_,i,n,o)),ownKeys:t=>(O(e),Reflect.ownKeys(e.__remoteObj_)),apply:(t,i,n)=>{O(e),Reflect.apply(e.__remoteObj_,i,n)},construct:(t,i,n)=>{if(O(e),"function"!=typeof e.__remoteObj_)throw Error("operator new ONLY used for function");return new Promise((t,n)=>{let o=s.default.browser.construct,r=l.default(o),d=h.getHiddenValue(e.__remoteObj_,"__remote_id__");c.send(o,m,r,d,S(i)),a.default.add(r,e=>{try{t(E(e))}catch(e){n(e)}})})}});return e.__promise_.then(e=>{let t=typeof e;if("function"===t||"object"===t){let t=T(e);t&&v(i,t)}}),i}t.remoteRequire=function(e){return N(new b("module",e))},t.getBuiltin=function(e){return N(new b("builtin",e))},t.getGlobal=function(e){return N(new b("global",e))},t.getCurrentWindow=function(){return N(new b("current_window"))},t.getCurrentWebContents=function(){return N(new b("current_web_contents"))},t.getWebContents=function(){return N(new b("web_contents"))}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=process.electronBinding("v8_util");t.default=class{constructor(){this.nextId=0,this.callbacks={}}add(e){let t=n.getHiddenValue(e,"__remote_callback_id__");if(null!=t)return t;t=this.nextId-=1;const i=/at (.*)/gi,o=(new Error).stack;let r,a=i.exec(o);for(;null!==a;){const e=a[1];if(!e.includes("native")&&!e.includes("electron.asar")){r=/([^/^)]*)\)?$/gi.exec(e)[1];break}a=i.exec(o)}return this.callbacks[t]=e,n.setHiddenValue(e,"__remote_callback_id__",t),n.setHiddenValue(e,"__remote_call_location__",r),t}get(e){return this.callbacks[e]||function(){}}apply(e,...t){return this.get(e).apply(global,...t)}remove(e){const t=this.callbacks[e];t&&(n.deleteHiddenValue(t,"__remote_callback_id__"),delete this.callbacks[e])}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(29);var o;!function(e){let t={};e.add=function(e,i,n){t[e]={func:i,thisArg:n}},e.invoke=function(i,...o){let r=t[i];return r?r.thisArg?r.func.apply(r.thisArg,...o):r.func(...o):n.error(`Cannot invoke function by unrecognize id. ${i}`),e},e.remove=function(e){delete t[e]}}(o||(o={})),t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=0;t.default=function(e){return e?e.concat(".").concat(String(++n)):String(++n)}},function(e,t,i){"use strict";const n=i(19),o=i(85),r=i(49),a=i(86),s=i(29),l=i(50),d=n.ipcMain,u=process.electronBinding("v8_util");let c=u.createDoubleIDWeakMap();const h=new o.default;function p(e,t,i,n,o,r){let a,l=!1,d=null,u=!1;do{try{a=t[n]}catch(e){l=!0}if(l)try{a=i.value[n],l=!1,i.meta.extendedMemberNames.push(n),u=!0}catch(e){s.error(`property ${n} untouchable, even try root[name]`)}if(l)break;let o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){s.warn(`descriptor of property ${n} is undefined`);break}d={name:n,enumerable:o.enumerable,writable:!1,type:"get"},void 0===o.get&&"function"==typeof a?d.type="method":((o.set||o.writable)&&(d.writable=!0),d.type="get"),u?(d.configurable=!0,d.value=g(e,a,r,!1,null)):d.value=g(e,a,r,!1,i)}while(0);return d}function f(e,t,i,n=null){let o=Object.getOwnPropertyNames(t);"function"==typeof t&&(o=o.filter(function(e){return!String.prototype.includes.call(a.propertiesOfFunction,e)}));let r=[];do{if(0===o.length)break;let a=o.length;for(let s=0;s<a;s++){let a=p(e,t,i,o[s],0,n);a&&r.push(a)}}while(0);return r}function m(e,t,i,n=null){let o=null,r=Object.getPrototypeOf(t);return o=null===r||r===Object.prototype||r===Function.prototype?null:g(e,r,n,!1,i)}function g(e,t,i=null,n=!1,o=null){i=null===i?{}:i;const r={type:typeof t};"object"===r.type&&(r.type=function(e,t){let i=typeof e;if("object"!==i)throw new Error("incorrect arg at index 0. non-object");return null===e?i="value":ArrayBuffer.isView(e)?i="buffer":Array.isArray(e)?i="array":e instanceof Error?i="error":e instanceof Date?i="date":l.isPromise(e)?i="promise":Object.prototype.hasOwnProperty.call(e,"callee")&&null!=e.length?i="array":t&&u.getHiddenValue(e,"simple")&&(i="value"),i}(t,n));do{if("object"===r.type||"function"===r.type){let n=h.getIdOfObject(t);if(n&&i[n]){r.refId=n,h.add(e,t);break}}"array"===r.type?r.members=t.map(t=>g(e,t,i)):"object"===r.type||"function"===r.type?(null==o&&(r.extendedMemberNames=[],o={value:t,meta:r}),r.name=t.constructor?t.constructor.name:"",r.id=h.add(e,t),i[r.id]=!0,r.members=f(e,t,o,i),r.proto=m(e,t,o,i)):"buffer"===r.type?r.value=Buffer.from(t):"promise"===r.type?(t.then(function(){},function(){}),r.then=g(e,function(e,i){t.then(e,i)})):"error"===r.type?(r.members=S(t),r.members.push({name:"name",value:t.name})):"date"===r.type?r.value=t.getTime():(r.type="value",r.value=t)}while(0);return r}function S(e){return Object.getOwnPropertyNames(e).map(t=>({name:t,value:e[t]}))}function y(e,t,i,o){const a=function(o){let l,d,p=0,f=0;switch(o.type){case"value":return o.value;case"remote-object":return h.get(o.id);case"array":return y(e,t,i,o.value);case"buffer":return Buffer.from(o.value);case"date":return new Date(o.value);case"promise":return Promise.resolve({then:a(o.then)});case"object":case"interest":{let e={};for(Object.defineProperty(e.constructor,"name",{value:o.name}),p=0,f=(d=o.members).length;p<f;p++)e[(l=d[p]).name]=a(l.value);return e}case"function":{const a=e.id,l=[i,o.id];if(s.info("renderer function id:"+l),c.has(l))return c.get(l);let d=function(...t){s.info("[CALLBACK] args",t);let i=[...t];e.isDestroyed()||a!==e.id?function(e,t,i){let o="Attempting to call a function in a renderer window that has been closed or released."+`\nFunction provided here: ${e.location}`;if(t.length>0&&t[0].sender&&t[0].sender instanceof n.webContents.constructor){const{sender:e}=t[0],n=e.eventNames().filter(t=>{let n=e.listeners(t),o=!1;return n.forEach(e=>{e===i&&(o=!0)}),o});n.length>0&&(o+=`\nRemote event names: ${n.join(", ")}`,n.forEach(t=>{Object.getPrototypeOf(e).removeListener.call(e,t,i)}))}s.warn(o)}(o,i,d):e.send(r.default.renderer.callback,o.id,g(e,i))};return Object.defineProperty(d,"length",{value:o.length}),u.setRemoteCallbackFreer(d,t,i,o.id,e),c.set(l,d),d}default:throw new TypeError(`Unknown type: ${o.type}`)}};return o.map(a)}function C(e,t,i,n){let o,r;try{return t.apply(i,n)}catch(e){return r=t.name,new Error(`Could not call remote function '${o=null!=r?r:"anonymous"}'. Check that the function signature is correct. Underlying error: ${e.message}`)}}function I(e){return{type:"exception",message:e.message,stack:e.stack||e}}function v(e){const t=new Error(e);throw Object.defineProperty(t,"code",{value:"EBADRPC"}),Object.defineProperty(t,"errno",{value:-72}),t}var T;!function(e){const t=(e,t,...i)=>{const n=e.sender;n.isDestroyed()?s.warn("webcontext is destroyed."):n.send(t,...i)};e.startServer=function(){d.on(r.default.browser.require,(e,i,n,o)=>{s.info(`[REQUIRE] module=${o} `);let a=process.mainModule.require(o),l=g(e.sender,a);t(e,r.default.renderer.requireReturn,n,l)}),d.on(r.default.browser.builtIn,(e,i,o,a)=>{s.info(`[BUILTIN]: property=${a} contextId=${i}`);let l=n[a],d=g(e.sender,l);s.info(`[BUILTIN]: returns remoteId:${d.id}, type: ${typeof l}`),t(e,r.default.renderer.getBuiltInReturn,o,d)}),d.on(r.default.browser.global,(e,i,n,o)=>{s.info(`[GLOBAL]: proerty:${o} contextId=${i}`);let a,l=global[o];a=g(e.sender,l),s.info(`[GLOBAL]: returns remoteid=${a.id}, obj=`+typeof l),t(e,r.default.renderer.getGlobalReturn,n,a)}),d.on(r.default.browser.currentWindow,(e,i,n,o)=>{s.info(`[CURRENT_WINDOW]: property=${o} contextId=${i}`);let a=e.sender.getOwnerBrowserWindow.call(e.sender),l=g(e.sender,a);s.info(`[CURRENT_WINDOW]: returns remoteid=${l.id}, obj=`+a),t(e,r.default.renderer.currentWindowReturn,n,l)}),d.on(r.default.browser.currentWebContents,(e,i,n,o)=>{t(e,r.default.renderer.currentWebContentsReturn,n,g(e.sender,e.sender))}),d.on(r.default.browser.webContents,(e,i,o,a)=>{s.info(`[WebContents]: proerty:${a} contextId=${i}`);let l,d=n.webContents;l=g(e.sender,d),s.info(`[WebContents]: returns remoteid=${l.id}, obj=`+typeof d),t(e,r.default.renderer.webContentsReturn,o,l)});const e=(e,t)=>{const i=(t,i)=>{t&&Object.getOwnPropertyNames(t).forEach(n=>{i?e.once(n,t[n]):e.on(n,t[n])})};t.on&&i(t.on,!1),t.once&&i(t.once,!0)};d.on(r.default.browser.construct,(i,n,o,a,l)=>{let d,u=null;try{s.info(`[CONSTRUCTOR]: remoteId=${a} `);let c=l.length>0?l[l.length-1]:null;l=y(i.sender,i.frameId,n,l);let p=h.get(a);null==p&&v(`Cannot call constructor on missing remote object ${a}`),c&&"interest"===c.type&&(u=l.pop());let f=new(Function.prototype.bind.apply(p,[null,...l]));f&&u&&e(f,u),d=g(i.sender,f,null,!1),s.info(`[CONSTRUCTOR]: returns remoteId =${d.id} name=${p.name} `)}catch(e){d=I(e)}finally{t(i,r.default.renderer.constructReturn,o,d)}}),d.on(r.default.browser.functionCall,function(e,i,n,o,a,l){let d;try{s.info(`[FUNCTION_CALL]: remoteId=${a}`),l=y(e.sender,e.frameId,i,l);let u=h.get(a);if(null==u)s.error(`Cannot call function on missing remote object ${a}`),d=g(e.sender,void 0);else{let t=o?h.get(o):global;if(t){let i=C(0,u,t,l);d=g(e.sender,i)}else s.error(`Cannot call function(${a}) on missing context(${o})`),d=g(e.sender,void 0)}s.info(`[FUNCTION_CALL]: name=${u.name}`)}catch(e){d=I(e)}finally{t(e,r.default.renderer.functionCallReturn,n,d)}}),d.on(r.default.browser.memberCall,function(e,i,n,o,a,l,d){let u;s.info(`[MEMBER_CALL]: thisArg=${o}, remoteId=${a}, method=${l}, args count=${d.length}`);try{d=y(e.sender,e.frameId,i,d);let c=h.get(a);null==c&&v(`Cannot call function '${l}' on missing remote object ${a}`);let p=o?h.get(o):c;if(p){let t=C(0,c[l],p,d);u=g(e.sender,t),s.info("[MEMBER_CALL]: return="+t)}else u=g(e.sender,void 0)}catch(e){u=I(e)}finally{t(e,r.default.renderer.memberCallReturn,n,u)}}),d.on(r.default.browser.memberGet,function(e,i,n,o,a){let l;try{s.info(`[MEMBER_GET]: remoteId=${o}, property=`,a);let i=h.get(o);null==i&&v(`Cannot get property '${Object.toString.call(a)}' on missing remote object ${o}`);let d=i[a];l=g(e.sender,d)}catch(e){l=I(e)}finally{t(e,r.default.renderer.memberGetReturn,n,l)}}),d.on(r.default.browser.memberSet,function(e,i,n,o,a,l){try{s.info(`[MEMBER_SET]: remoteId=${o}, property=`+a),l=y(e.sender,e.frameId,i,l);let d=h.get(o);null==d&&v(`Cannot set property '${Object.toString.call(a)}' on missing remote object ${o}`),d[a]=l[0],t(e,r.default.renderer.memberSetReturn,n,{type:"value",value:!0})}catch(i){t(e,r.default.renderer.memberSetReturn,n,I(i))}}),d.on(r.default.browser.memberConstruct,function(i,n,o,a,l,d){let u,c=null;try{s.info(`[MEMBER_CONSTRUCTOR]: regId=${a}, method=${l}`);let p=d.length>0?d[d.length-1]:null;d=y(i.sender,i.frameId,n,d);let f=h.get(a);null==f&&v(`Cannot call constructor '${l}' on missing remote object ${a}`),p&&"interest"===p.type&&(c=d.pop());let m=f[l],S=new(Function.prototype.bind.apply(m,[null,...d]));S&&c&&e(S,c),u=g(i.sender,S)}catch(e){u=I(e)}finally{t(i,r.default.renderer.memberConstructReturn,o,u)}}),d.on(r.default.browser.sync,function(e,i,n,o){let a=h.get(o);t(e,r.default.renderer.syncReturn,n,g(e.sender,a))}),d.on("ELECTRON_BROWSER_DEREFERENCE",function(e,t){let i=h.get(t);if(n.ipcMain.emit("log_to_renderer","ELECTRON_BROWSER_DEREFERENCE",t,typeof i),i){let n=i.name;n||(n=i.constructor?i.constructor.name:""),h.remove(e.sender.id,t)}else t<0&&s.warn("remote id reference to nothing:",t)}),d.on(r.default.browser.contextRelease,e=>{h.clear(e.sender.id)})},e.getObjectRegistry=function(){return h}}(T||(T={})),e.exports=T},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(29),o=-1*Math.pow(2,31),r=process.electronBinding("v8_util");t.default=class{constructor(){this.nextId=0,this.storage=new Map,this.owners=new Map}add(e,t){const i=this.saveToStorage(t),n=e.id;let o=this.owners.get(n);return o||(o=new Set,this.owners.set(n,o),this.registerDeleteListener(e,n)),o.has(i)||(o.add(i),this.storage.get(i).count++),i}getIdOfObject(e){return r.getHiddenValue(e,"__remote_id__")}get(e){const t=this.storage.get(e);if(void 0!==t)return t.object}remove(e,t){this.dereference(t);let i=this.owners.get(e);i&&i.delete(t)}clear(e){let t=this.owners.get(e);if(t){for(let e of t)this.dereference(e);this.owners.delete(e)}}getStorageSize(){return this.storage.size}saveToStorage(e){let t=r.getHiddenValue(e,"__remote_id__");if(!t){if((t=--this.nextId)<=o)throw new Error("object registry id overflow");this.storage.set(t,{object:e,count:0}),r.setHiddenValue(e,"__remote_id__",t)}return t}dereference(e){let t=this.storage.get(e);null!=t&&(t.count-=1,0===t.count&&(r.deleteHiddenValue(t.object,"__remote_id__"),this.storage.delete(e)))}registerDeleteListener(e,t){const i=e.getProcessId(),o=(r,a)=>{a===i&&(n.info("render-view-deleted: processid="+i),(()=>{n.info("before clear. objectsRegistry capacity="+this.storage.size,"owners size:"+this.owners.size)})(),e.removeListener("render-view-deleted",o),this.clear(t))};e.on("render-view-deleted",o)}}},function(e,t,i){"use strict";var n;!function(e){e.propertiesOfFunction=["length","name","arguments","caller","prototype","apply","bind","call","toString"]}(n||(n={})),e.exports=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(42),o=i(12),r=i(35),a=i(51),s=i(6);t.Client=class extends o.EventEmitter{constructor(e){if(e=e||{},super(),this.inprocess=!1,this.context=void 0,e.context&&(this.context=Object.assign({},e.context),this.context.productId=e.socketPrex),e.socket)this.socket=e.socket,this.bind();else if(global.__xdasIPCServer&&global.__xdasIPCServer.getProductId().toLowerCase()===e.socketPrex.toLowerCase())this.inprocess=!0;else{let t=s.getSockPath(e.socketPrex);this.socket=n.connect(t),this.bind()}}isInprocess(){return this.inprocess}getContext(){return this.context}bind(){const e=new a.Parser,t=this.socket;t.on("data",t=>{e.feed(t)}),t.on("connect",()=>{this.emit("connect")}),t.on("end",()=>{r.information("socket is ended"),this.socket=null,this.emit("end")}),t.on("error",e=>{this.socket=null,this.emit("error",e)}),e.on("message",e=>{this.emit("message",e)}),this.parser=e}send(e){if(this.socket)try{this.socket.write(this.parser.encode(e))}catch(e){r.error(e.message)}else r.information("This socket has been ended by the other party",this.context&&this.context.name)}}},function(e,t){e.exports=require("string_decoder")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmpMedia=void 0;const n=i(1),o=i(16),r=i(90),a=i(4),s=i(15),l=i(17);t.XmpMedia=class{constructor(e,t,i,s,l,d){this.taskType=-1,this.videobtindex=-1,this.attribute=new Map,this.taskData=null;for(let e=a.XmpMediaAttr.NumberStart;e<a.XmpMediaAttr.NumberEnd;++e)this.attribute.set(e,0);for(let e=a.XmpMediaAttr.StringStart;e<a.XmpMediaAttr.StringEnd;++e)this.attribute.set(e,"");let u=r.ParseUrlFileNameNS.getNameFromUrl(t);"index.html"===u&&(u=n.basename(t)),this.attribute.set(a.XmpMediaAttr.Url,t),this.attribute.set(a.XmpMediaAttr.PlayUrl,d||t),this.attribute.set(a.XmpMediaAttr.Type,e),this.attribute.set(a.XmpMediaAttr.Category,a.XmpMediaCategory.Play),this.attribute.set(a.XmpMediaAttr.CreateTime,(new Date).getTime()),this.attribute.set(a.XmpMediaAttr.Ext,n.extname(u)),this.attribute.set(a.XmpMediaAttr.Name,s||u),this.attribute.set(a.XmpMediaAttr.MediaId,i||o.XmpUtilityNS.generateMediaId()),this.attribute.set(a.XmpMediaAttr.Position,l||0),this.attribute.set(a.XmpMediaAttr.SubtitleShow,1),this.attribute.set(a.XmpMediaAttr.Subtitle2Show,1),this.attribute.set(a.XmpMediaAttr.SubtitlePosition,95),this.attribute.set(a.XmpMediaAttr.Subtitle2Position,20),this.attribute.set(a.XmpMediaAttr.Brightness,50),this.attribute.set(a.XmpMediaAttr.ContrastRatio,50),this.attribute.set(a.XmpMediaAttr.Saturation,50),this.attribute.set(a.XmpMediaAttr.AudioChannel,0),this.attribute.set(a.XmpMediaAttr.PlaySpeed,100),this.attribute.set(a.XmpMediaAttr.ThunderTaskId,0),this.attribute.set(a.XmpMediaAttr.ThunderTaskSubId,-1),this.attribute.set(a.XmpMediaAttr.PlayPercent,-1),this.attribute.set(a.XmpMediaAttr.OpenFrom,"")}getXmpMediaInfo(){let e={};return e.mediaId=this.attribute.get(a.XmpMediaAttr.MediaId),e.name=this.attribute.get(a.XmpMediaAttr.Name),e.url=this.attribute.get(a.XmpMediaAttr.Url),e.playUrl=this.attribute.get(a.XmpMediaAttr.PlayUrl),e.createTime=this.attribute.get(a.XmpMediaAttr.CreateTime),e.category=this.attribute.get(a.XmpMediaAttr.Category),e.ext=this.attribute.get(a.XmpMediaAttr.Ext),e.fileSize=this.attribute.get(a.XmpMediaAttr.FileSize),e.cid=this.attribute.get(a.XmpMediaAttr.Cid),e.type=this.attribute.get(a.XmpMediaAttr.Type),e.position=this.attribute.get(a.XmpMediaAttr.Position),e.duration=this.attribute.get(a.XmpMediaAttr.Duration),e.width=this.attribute.get(a.XmpMediaAttr.Width),e.height=this.attribute.get(a.XmpMediaAttr.Height),e.mediaIndex=this.attribute.get(a.XmpMediaAttr.MediaIndex),e.ownerMediaId=this.attribute.get(a.XmpMediaAttr.OwnerMediaId),e.preState=this.attribute.get(a.XmpMediaAttr.PreState),e.state=this.attribute.get(a.XmpMediaAttr.State),e.playSpeed=this.attribute.get(a.XmpMediaAttr.PlaySpeed),e.subtitle=this.attribute.get(a.XmpMediaAttr.Subtitle),e.subtitleShow=this.attribute.get(a.XmpMediaAttr.SubtitleShow),e.subtitleLanguage=this.attribute.get(a.XmpMediaAttr.SubtitleLanguage),e.subtitleType=this.attribute.get(a.XmpMediaAttr.SubtitleType),e.subtitlePosition=this.attribute.get(a.XmpMediaAttr.SubtitlePosition),e.subtitleTimming=this.attribute.get(a.XmpMediaAttr.SubtitleTimming),e.subtitle3D=this.attribute.get(a.XmpMediaAttr.Subtitle3D),e.subtitle2=this.attribute.get(a.XmpMediaAttr.Subtitle2),e.subtitle2Show=this.attribute.get(a.XmpMediaAttr.Subtitle2Show),e.subtitle2Language=this.attribute.get(a.XmpMediaAttr.Subtitle2Language),e.subtitle2Type=this.attribute.get(a.XmpMediaAttr.Subtitle2Type),e.subtitle2Position=this.attribute.get(a.XmpMediaAttr.Subtitle2Position),e.subtitle2Timming=this.attribute.get(a.XmpMediaAttr.Subtitle2Timming),e.subtitle23D=this.attribute.get(a.XmpMediaAttr.Subtitle23D),e.rorate=this.attribute.get(a.XmpMediaAttr.Rorate),e.audioTime=this.attribute.get(a.XmpMediaAttr.AudioTime),e.proportion=this.attribute.get(a.XmpMediaAttr.Proportion),e.flipH=this.attribute.get(a.XmpMediaAttr.FlipH),e.flipV=this.attribute.get(a.XmpMediaAttr.FlipV),e.audioTrack=this.attribute.get(a.XmpMediaAttr.AudioTrack),e.localAudioTrack=this.attribute.get(a.XmpMediaAttr.LocalAudioTrack),e.imgSrc=this.attribute.get(a.XmpMediaAttr.ImgSrc),e.openFrom=this.attribute.get(a.XmpMediaAttr.OpenFrom),e.thunderTaskId=this.attribute.get(a.XmpMediaAttr.ThunderTaskId),e.thunderTaskSubId=this.attribute.get(a.XmpMediaAttr.ThunderTaskSubId),e.panFileId=this.attribute.get(a.XmpMediaAttr.PanFileId),e.gcid=this.attribute.get(a.XmpMediaAttr.Gcid),e.playFrom=this.attribute.get(a.XmpMediaAttr.PlayFrom),e.panFileId=this.attribute.get(a.XmpMediaAttr.PanFileId),e.playType=this.attribute.get(a.XmpMediaAttr.PlayType),e.resolution=this.attribute.get(a.XmpMediaAttr.Resolution),e.transcode=this.attribute.get(a.XmpMediaAttr.transcode),e.dlna=this.attribute.get(a.XmpMediaAttr.DLNA),e.transGcid=this.attribute.get(a.XmpMediaAttr.TransGcid),e.resolutionMedias=this.attribute.get(a.XmpMediaAttr.ResolutionMedias),e}getXmpMediaAttribute(e){return this.attribute.get(e)}setXmpMediaState(e){this.attribute.set(a.XmpMediaAttr.PreState,this.attribute.get(a.XmpMediaAttr.State)),this.attribute.set(a.XmpMediaAttr.State,e)}setXmpMediaAttribute(e,t){this.attribute.set(e,t)}setXmpMediaExtra(e,t){this.mediaExtra=e,s.ConfigNS.getValue(l.ConfigDefineNS.noSign.section,l.ConfigDefineNS.noSign.key,l.ConfigDefineNS.noSign.value)}getXmpMediaExtra(){return this.mediaExtra}setDownloadAndPlayTaskData(e){this.taskData=e}getDownloadAndPlayTaskData(){return this.taskData}setTaskType(e){this.taskType=Number(e)}setVideobtindex(e){this.videobtindex=Number(e)}getTaskType(){return this.taskType}getVideobtindex(){return this.videobtindex}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParseUrlFileNameNS=void 0;const n=i(1),o=i(0),r=i(43),a=i(91),s=i(18),l=i(9),d=o.default.getLogger("ThunderNewTask"),u=l.default(n.join(__rootDir,"../bin/ThunderHelper.node")),c=".asf;.avi;.exe;.iso;.mp3;.mpeg;.mpg;.mpga;.ra;.rar;.rm;.rmvb;.tar;.wma;.wmp;.wmv;\n  .mov;.zip;.3gp;.chm;.mdf;.torrent;.jar;.msi;.arj;.bin;.dll;.psd;.hqx;.sit;.lzh;.gz;.tgz;.xlsx;.xls;.doc;.docx;.ppt;\n  .pptx;.flv;.swf;.mkv;.tp;.ts;.flac;.ape;.wav;.aac;.txt;.dat;.7z;.ttf;.bat;.xv;.xvx;.pdf;.mp4;.apk;.ipa;.epub;.mobi;\n  .deb;.sisx;.cab;.pxl;",h=".a;.a3m;.a3w;.a4m;.a4p;.a4w;.a5w;.aam;.aas;.abf;.abk;.abs;.ace;.acm;.acp;.act;.ad;\n  .ada;.adb;.adf;.adi;.adm;.adp;.adr;.ads;.af2;.af3;.afm;.ai;.aif;.aifc;.aiff;.aim;.ais;.akw;.alb;.all;.ams;.anc;.ani;\n  .ans;.ant;.api;.aps;.ari;.arj;.art;.asa;.asc;.asd;.ase;.asf;.asm;.aso;.asp;.asv;.asx;.atw;.au;.avb;.avi;.avr;.avs;\n  .awd;.awr;.axx;.bak;.bas;.bat;.bdf;.bgl;.bi;.bif;.biff;.bin;.bk;.bk$;.bks;.bmk;.bmp;.book;.brx;.bsp;.btm;.bud;.bun;\n  .bw;.bwv;.c;.cab;.cad;.cal;.cap;.cas;.cb;.cc;.ccb;.cch;.cco;.cct;.cda;.cdf;.cdi;.cdm;.cdr;.cdt;.cdx;.cfg;.cgi;.cgm;\n  .chk;.chm;.chr;.cif;.cil;.class;.cll;.clp;.cls;.cmf;.cmv;.cmx;.cnf;.cnm;.cnt;.cod;.com;.cpl;.cpo;.cpp;.cpr;.cpt;.cpx;\n  .crd;.crp;.crt;.csc;.csp;.cst;.csv;.ctl;.cur;.cv;.cxx;.dat;.db;.dbc;.dbf;.dbx;.dcm;.dcs;.dct;.dcu;.dcx;.dem;.der;.dewf;\n  .dib;.dic;.dif;.dig;.dir;.diz;.dlg;.dll;.dls;.dmd;.dmf;.doc;.dot;.draw;.drv;.drw;.dsf;.dsg;.dsm;.dsp;.dsq;.dsw;.dtd;\n  .dun;.dv;.dxf;.dxr;.eda;.edd;.emd;.emf;.eml;.ephtml;.eps;.exe;.fav;.fax;.fcd;.fdf;.ffa;.ffk;.ffl;.ffo;.fif;.fla;.flc;\n  .fm;.fml;.fng;.fnk;.fon;.fot;.frt;.frx;.ftg;.fts;.gal;.gdb;.gdm;.gem;.gen;.getright;.gfi;.gfx;.gho;.gif;.gim;.gix;.gkh;\n  .gks;.gl;.gna;.gnt;.gnx;.gra;.grf;.grp;.hcom;.hgl;.hlp;.hpj;.hpp;.hst;.ht;.htm;.html;.htt;.htx;.icb;.icc;.icl;.icm;.ico;\n  .idd;.idf;.idq;.idx;.iff;.iges;.igf;.ilbm;.ima;.inf;.ini;.inrs;.ins;.int;.iqy;.iso;.ist;.isu;.iwc;.j62;.jar;.java;.jbf;\n  .jff;.jfif;.jif;.jmp;.jpe;.jpeg;.jpg;.js;.jsp;.jtf;.k25;.kar;.kdc;.key;.kfx;.kiz;.kkw;.kmp;.kqp;.lab;.lbm;.lbt;.lbx;.ldb;\n  .ldl;.leg;.lft;.lgo;.lha;.lib;.lin;.lis;.llx;.lnk;.log;.lst;.lu;.lyr;.lzh;.lzs;.m1v;.m3u;.mad;.maf;.mam;.map;.maq;.mar;.mat;\n  .mb1;.mbx;.mcr;.mdb;.mde;.mdl;.mdn;.mdw;.mdz;.mic;.mid;.mim;.mime;.mli;.mme;.mng;.mnu;.mod;.mov;.mp2;.mp3;.mpa;.mpe;.mpeg;\n  .mpg;.mpp;.mpr;.msg;.msi;.msn;.msp;.mst;.mtm;.nan;.nap;.ncb;.ncd;.ncf;.nff;.nft;.nil;.nist;.nls;.nlu;.ntx;.nwc;.nws;.obj;\n  .ocx;.ods;.ofn;.oft;.olb;.ole;.oogl;.opo;.p65;.pab;.part;.pas;.pbd;.pbl;.pbm;.pbr;.pcd;.pcl;.pcm;.pdd;.pdf;.pfm;.pgl;.pgm;\n  .ph;.php;.php3;.phtml;.pic;.pjt;.pjx;.pkg;.pli;.png;.pot;.ppa;.ppf;.ppm;.pps;.ppt;.prf;.prg;.prj;.prn;.prt;.psd;.psp;.pst;\n  .pwz;.qic;.qif;.qlb;.qry;.qtp;.qtx;.qw;.ra;.ram;.rar;.rdf;.reg;.rep;.res;.rft;.rgb;.rm;.rmd;.rpt;.rtf;.rul;.rvp;.s;.sav;.sbl;\n  .scc;.scf;.scp;.scr;.sct;.scx;.sdt;.sdv;.sdx;.sep;.sfd;.sfi;.sfr;.sfx;.sgi;.sgml;.shg;.shtml;.shw;.sig;.ska;.skl;.sl;.spl;\n  .sqc;.sqr;.str;.swa;.swf;.sys;.syw;.taz;.tga;.theme;.thn;.tif;.tiff;.tig;.tlb;.tmp;.tol;.tpl;.trm;.trn;.ttf;.txt;.txw;.udf;\n  .ult;.url;.use;.uwf;.vbp;.vbp;.vbw;.vbw;.vbx;.vbx;.vct;.vcx;.vda;.vda;.vir;.vir;.viv;.vqf;.vsd;.vsd;.vsl;.vsl;.vss;.vss;.vst;\n  .vst;.vsw;.vsw;.vxd;.vxd;.w3l;.wab;.wad;.wav;.wbk;.wcm;.wdb;.wfm;.wfn;.wil;.wiz;.wll;.wmf;.wow;.wp;.wpd;.wpf;.wpg;.wps;.wpt;.wr1;\n  .wrk;.wrl;.wrz;.x;.x16;.x32;.xar;.xbm;.xi;.xla;.xlb;.xlc;.xld;.xlk;.xll;.xlm;.xls;.xlt;.xlv;.xlw;.xnk;.xpm;.xwd;.xwf;.yal;.z;.zap;.zip;";!function(e){function t(e){let t=!1;do{if(void 0===e||null===e)break;if(""===e||"."===e)break;if(c.indexOf(e)>-1){t=!0;break}}while(0);return t}function i(e){let t=!1;do{if(void 0===e||null===e)break;if(""===e)break;if(e.match(/[\/\\"<>\?\*|]/))break;t=!0}while(0);return t}function o(e){let i=!1;do{if(void 0===e||null===e)break;if(""===e||"."===e)break;let n=a.TaskUtilHelper.getTaskFileType(void 0,e);if(n===a.TaskUtilHelper.FileExtType.Video||n===a.TaskUtilHelper.FileExtType.Music||n===a.TaskUtilHelper.FileExtType.Pic){i=!0;break}i=t(e)}while(0);return i}function l(e){let t=!1,r=n.parse(e);return t=i(r.name)&&o(r.ext)}function p(e){let t={};do{if(void 0===e||null===e)break;d.information("parseDynamicUrlArgs");let i=/([^&=?]+)=([^&]*)/g;for(;i.exec(e);)t[RegExp.$1]=RegExp.$2;d.information("parseDynamicUrlArgs ret ",t)}while(0);return t}function f(e){let t={pageFileName:void 0,args:void 0};do{if(void 0===e||null===e)break;d.information("parseDynamicUrlPath"),e.match(/[\/]?([^?]*)\?([^\s]*)/)&&(t.pageFileName=RegExp.$1,t.args=RegExp.$2),d.information("parseDynamicUrlPath ret",t)}while(0);return t}function m(e){let t="";do{if(void 0===e||null===e)break;let i=f(e);if(void 0!==i.args){let e=p(i.args);for(let i in e){let n=e[i];if(l(n)){t=n;break}}}void 0!==i.pageFileName&&l(i.pageFileName)&&(t=i.pageFileName)}while(0);return t}function g(e){let t=[];do{if(void 0===e||null===e)break;let i=m(e);if(""!==i&&!t.includes(i)){let e=S(i);t.push(e)}let n=S(e);t.includes(n)||t.push(n)}while(0);return t}function S(e){return u.parseFileNameFromP2spUrlPath(e)}function y(e){return u.isThunderPrivateUrl(e)}function C(e){return u.parseEd2kUrl(e)}function I(e){return u.parseUrl(e)}e.isDownloadFileExtName=t,e.isIllegalFileName=i,e.isGoodFileExtName=o,e.isUsualFileExtName=function(e){let t=!1;do{if(void 0===e||null===e)break;if(""===e||"."===e)break;if(o(e)){t=!0;break}if(h.indexOf(e)>-1){t=!0;break}}while(0);return t},e.isGoodFileName=l,e.parseDynamicUrlArgs=p,e.parseDynamicUrlPath=f,e.parseFileNameFromDynamicUrlPath=m,e.getFileNameListFromUrlPath=g,e.getNameFromUrl=function(e){let t="index.html",i=s.ThunderHelper.getTaskTypeFromUrl(e);if(i===r.DownloadKernel.TaskType.P2sp){let i=g(I(e).fullPath);i.length>0&&(t=i[0])}else i===r.DownloadKernel.TaskType.Emule&&(t=C(e).fileName);return t.replace(/[*?/\\:|<>\"]/g,"_")},e.parseFileNameFromP2spUrlPath=S,e.isThunderPrivateUrl=y,e.parseThunderPrivateUrl=function(e){let t={url:e,codePage:-1};return y(e)&&(t=u.parseThunderPrivateUrl(e)),t},e.parseEd2kUrl=C,e.parseUrl=I,e.parseMagnetUrl=function(e){return u.parseMagnetUrl(e)},e.makeUrl=function(e){return u.makeUrl(e)}}(t.ParseUrlFileNameNS||(t.ParseUrlFileNameNS={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TaskUtilHelper=void 0;const n=i(1),o=i(43);let r=["apk","avi","chm","doc","exe","flv","ipa","ipsw","iso","mkv","mov","mp4"];r.push(...["mpg","pdf","ppt","rar","rm","rmvb","txt","wmv","xls"]);const a=".xv;.xlmv;.3gp;.3gp2;.3gpp;.3gpp2;.3mm;.3p2;.60d;.787;.aaf;.aep;.aepx;.aet;.aetx;.ajp;.ale;.amv;.amx;.arf;\n  .asf;.ass;.asx;.avb;.avd;.avi;.avp;.avs;.avs;.axm;.bdm;.bdmv;.bik;.bix;.bmk;.bnp;.box;.bs4;.bsf;.byu;.camproj;.camrec;.clpi;.cmmp;\n  .cmmtpl;.cmproj; .cmrec;.cpi;.cst;.cvc;.d2v;.d3v;.dat;.dav;.dce;.dck;.ddat;.dif;.dir;.divx;.dlx; .dmb;.dmsm;.dmsm3d;.dmss;.dnc;.dpg;\n  .dream;.dsy;.dv;.dv-avi;.dv4;.dvdmedia; .dvr-ms;.dvx;.dxr;.dzm;.dzp;.dzt;.edl;.evo;.eye;.f4p;.f4v;.fbr;.fbr;.fbz;.fcp; .flc;.flh;\n  .fli;.flv;.flx;.gfp;.gl;.grasp;.gts;.gvi;.gvp;.hdmov;.hkm;.ifo; .imovieproj;.imovieproject;.iva;.ivf;.ivr;.ivs;.izz;.izzy;.jts;.jtv;\n  .k3g;.lrec; .lsf;.lsx;.m15;.m1pg;.m1v;.m21;.m21;.m2a;.m2p;.m2t;.m2ts;.m2v;.m4e;.m4u;.m4v; .m75;.meta;.mgv;.mj2;.mjp;.mjpg;.mkv;.mmv;\n  .mnv;.mod;.modd;.moff;.moi;.moov;.mov; .movie;.mp21;.mp21;.mp2v;.mp4;.mp4v;.mpe;.mpeg;.mpeg4;.mpf;.mpg;.mpg2;.mpgindex; .mpl;.mpls;\n  .mpsub;.mpv;.mpv2;.mqv;.msdvd;.msh;.mswmm;.mts;.mtv;.mvb;.mvc;.mvd; .mve;.mvp;.mvy;.mxf;.mys;.ncor;.nsv;.nuv;.nvc;.ogm;.ogv;.ogx;.osp;\n  .par;.pds;.pgi; .piv;.pjs;.playlist;.pmf;.pns;.ppj;.prel;.pro;.prproj;.prtl;.psb;.psh;.pssd;.pva;.pvr;.pxv; .qt;.qtch;.qtl;.qtm;.qtz;\n  .r3d;.rcproject;.rdb;.rec;.rm;.rmd;.rmp;.rms;.rmvb;.roq; .rp;.rts;.rts;.rum;.rv;.sbk;.sbt;.scc;.scm;.scn;.screenflow;.sec;.seq;.sfd;\n  .sfvidcap;.smi;.smil;.smk;.sml;.smv;.spl;.srt;.ssa;.ssm;.stl;.str;.stx;.sub;.svi;.swf;.swi; .swt;.tda3mt;.tivo;.tix;.tod;.tp;.tp0;.tpd;\n  .tpr;.trp;.ts;.tts;.tvs;.vc1;.vcpf;.vcr; .vcv;.vdo;.vdr;.veg;.vem;.vf;.vfw;.vfz;.vgz;.vid;.viewlet;.viv;.vivo;.vlab;.vob; .vp3;.vp6;.vp7;\n  .vpj;.vro;.vs4;.vse;.vsp;.w32;.wcp;.webm;.wlmp;.wm;.wmd;.wmmp; .wmv;.wmx;.wp3;.wpl;.wtv;.wvx;.xfl;.xvid;.yuv;.zm1;.zm2;.zm3;.zmv;",s=".exe;.com;.bat;.msi;.apk;.ipa;.iso;.mds;.bin;.img;.ipsw;",l=".txt;.html;.htm;.shtml;.xhtml;.chm;.hlp;.inf;.rtf;.tex;.ltx;.doc;.docx;.wps;.ppt;.pptx;.odf;.pdf;.xls;.xlsx;.docm;.\n  dot;.dotm;.dotx;.email;.rp;.pps;.et;.ett;.xlt;.dbf;.prn;.csv;.mht;.mhtml;.xml;.wpt;.dps;.dpt;.pot;.ppsx;.epub;.mobi;.lit;.wdl;.ceb;.abm;\n  .pdg;.umb;.ibooks;",d=".aiff;.cue;.m3u;.au;.cdda;.raw;.wav;.flac;.tak;.mp3;.aac;.wma;.m4a;.mid;.mka;.mp2;.mpa;.mpc;.ape;.ofr;\n  .ogg;.ra;.wv;.tta;.ac3;.dts;.nsf;.mod;.s3m;.xm;.it;.vst;",u=".psd;.tga;.gif;.jpeg;.jpg;.jp2;.bmp;.ico;.pcx;.png;.pbm;.pgm;.ppm;.pnm;.pgf;.arw;.cr2;.crw;.dcr;.dng;.erf;.kdc;.mef;\n  .mos;.mrw;.nef;.nrw;.orf;.pef;.ptx;.r3d;.raf;.raw;.rw2;.srf;.srw;.x3f;.ras;.tiff;.tif;.wbmp;.ilbm;.lbm;.iff;.ico;",c=".zip;.zipx;.rar;.7z;.isz;.cab;.arj;.ace;.alz;.uue;.tar;.gz; .gzip;.tgz;.tpz;.bzip2;.bz2;.bz;.tbz;.tbz2;.xz;.txz;\n  .lzh;.lha;.zt;.az; .xpi;.jar;.wim;.swm;.rpm;.xar;.deb;.dmg;.hfs;.cpio;.lzma;.lzma86;.split;",h=".torrent;",p=".3gp;.asf;.avi;.divx;.f4v;.flv;.mkv;.mov;.movie;.mp4;.mpeg;.mpeg4;.mpg;.mpg2;.rm;.rmvb;.rp;.swf;.tp;.tp0;.ts;.wmv",f=".exe;.com;.bat;.msi",m=".wav;.flac;.MP3;.AAC;.WMA;.M4A;.MID;.APE;.OGG;.RA;.mod",g=".psd;.tga;.gif;.jpeg;.jpg;.jp2;.bmp;.ico;.pcx;.pdf;.png;.pbm;.pgm;.ppm;.pnm;.pgf;.arw;.cr2;.crw;.dcr;.dng;.erf;.kdc;\n  .mef;.mos;.mrw;.nef;.nrw;.orf;.pef;.ptx;.r3d;.raf;.raw;.rw2;.srf;.srw;.x3f;.ras;.tiff;.tif;.wbmp;.ilbm;.lbm;.iff;.ico",S=".txt;.html;.htm;.shtml;.xhtml;.chm;.hlp;.inf;.rtf;.tex;.ltx;.doc;.docx;.wps;.ppt;.pptx;.odf;.pdf;.xls;.xlsx;.docm;.dot;.dotm;.dotx;.email;.rp;.pps",y=".rar;.tar;.zip;.gzip;.cab;.uue;.arj;.bz2;.lzh;.jar;.ace;.iso;.7-zip;.7z";!function(e){let t;function i(e){let i=t.Unkown,o=n.extname(e);return void 0===o||""===o||o.length<2?i=t.Unkown:p.indexOf(o)>-1?i=t.Video:f.indexOf(o)>-1?i=t.Software:S.indexOf(o)>-1?i=t.Doc:m.indexOf(o)>-1?i=t.Music:g.indexOf(o)>-1?i=t.Pic:y.indexOf(o)>-1&&(i=t.Zip),o.length>1&&".z"===o.slice(0,2)&&/[0-9]+/.test(o.substring(2))&&(i=t.Zip),i}e.getTaskIcon=function(e,t){let i="";do{if(t===o.DownloadKernel.TaskType.Bt){i="xlx-icon-type-bt-file";break}if(t===o.DownloadKernel.TaskType.Group){i="xlx-icon-type-group";break}i="xlx-icon-type-unknown";let p=n.extname(e);if(""===p||p.length<2)break;let f=(p=p.toLowerCase()).substring(1);if(r.indexOf(f)>-1){i="doc"===p?"xlx-icon-type-word":"xlx-icon-type-"+f;break}if(a.indexOf(p)>-1){i="xlx-icon-type-video";break}if(s.indexOf(p)>-1){i="xlx-icon-type-install",[".mds",".bin",".img"].indexOf(p)>-1&&(i="xlx-icon-type-iso");break}if(l.indexOf(p)>-1){if(i="xlx-icon-type-doc",[".htm",".html",".mht"].indexOf(p)>-1){i="xlx-icon-type-link";break}if("docx"===p){i="xlx-icon-type-word";break}if("xlsx"===p){i="xlx-icon-type-xls";break}if("pptx"===p){i="xlx-icon-type-ppt";break}break}if(d.indexOf(p)>-1){i="xlx-icon-type-music";break}if(u.indexOf(p)>-1){i="xlx-icon-type-pic";break}if(c.indexOf(p)>-1){i="xlx-icon-type-rar";break}if(h.indexOf(p)>-1){i="xlx-icon-type-bt-link";break}}while(0);return i},function(e){e[e.Unkown=0]="Unkown",e[e.Video=1]="Video",e[e.Software=2]="Software",e[e.Doc=3]="Doc",e[e.Music=4]="Music",e[e.Pic=5]="Pic",e[e.Zip=6]="Zip",e[e.Bt=7]="Bt"}(t=e.FileExtType||(e.FileExtType={})),e.getTaskFileType=function(e,i){let o=t.Unkown;return void 0===i&&void 0!==e&&(i=n.extname(e)),void 0===i||""===i||i.length<2?o=t.Unkown:a.indexOf(i)>-1?o=t.Video:s.indexOf(i)>-1?o=t.Software:l.indexOf(i)>-1?o=t.Doc:d.indexOf(i)>-1?o=t.Music:u.indexOf(i)>-1?o=t.Pic:c.indexOf(i)>-1?o=t.Zip:h.indexOf(i)>-1&&(o=t.Bt),i.length>1&&".z"===i.slice(0,2)&&/[0-9]+/.test(i.substring(2))&&(o=t.Zip),o},e.getGroupFileType=i,e.getDefaultGroupPrefix=function(e){let n="任务组";do{if(void 0===e||null===e||0===e.length)break;let o=[];for(let e=0;e<7;e++)o[e]=0;for(let t of e){let e=i(t);o[e]=o[e]+1}let r=t.Unkown;for(let e=1;e<o.length;e++)o[e]>o[r]&&(r=e);r===t.Video?n="视频任务组":r===t.Software?n="程序任务组":r===t.Music?n="音乐任务组":r===t.Pic?n="图片任务组":r===t.Doc?n="文档任务组":r===t.Zip&&(n="压缩包任务组")}while(0);return n},e.compareVersion=function(e,t){let i=-2;do{if(null===e||void 0===e||""===e||null===t||void 0===t||""===t)break;let n=0,o=0,r=0,a=0,s=0,l=0,d=0,u=0,c=e.split(/\./);if(null===c||void 0===c||c.length<3)break;if(n=Number(c[0]),o=Number(c[1]),r=Number(c[2]),null!==c[3]&&void 0!==c[3]&&""!==c[3]&&(a=Number(c[3])),null===(c=t.split(/\./))||void 0===c||c.length<3)break;if(s=Number(c[0]),l=Number(c[1]),d=Number(c[2]),null!==c[3]&&void 0!==c[3]&&""!==c[3]&&(u=Number(c[3])),s>n){i=1;break}if(s<n){i=-1;break}if(l>o){i=1;break}if(l<o){i=-1;break}if(d>r){i=1;break}if(d<r){i=-1;break}if(0!==a){if(u>a){i=1;break}if(u<a){i=-1;break}}i=0}while(0);return i}}(t.TaskUtilHelper||(t.TaskUtilHelper={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.XmpPlayerImpl=void 0;const o=i(1),r=i(19),a=i(34),s=i(93),l=i(11),d=i(4),u=i(16),c=i(18),h=i(10),p=i(15),f=i(13),m=i(44),g=i(30),S=i(17),y=i(57),C=i(9),I=i(5),v=i(102),T=i(0),E=i(2),b=i(3),P=i(45),w=i(58),D=i(6),O=T.default.getLogger("XmpPlayerImpl");let N=C.default(o.join(__rootDir,"../bin/ThunderHelper.node"));var _;!function(e){e.Satrt="start",e.Stop="stop",e.Finished="finished"}(_||(_={}));t.XmpPlayerImpl=class{constructor(){this.aplayer=null,this.event=null,this.media=null,this.state=d.XmpMediaState.Invalid,this.firstPlay=!0,this.hostWnd=0,this.timer=null,this.positionTimer=null,this.queryTimer=null,this.checkThunderPauseTimer=null,this.checkThunderPauseBufferTimeStamp=0,this.crashTime=0,this.aPosition=-1,this.bPosition=-1,this.duration=0,this.preloading=!1,this.lastErrorTaskId="",this.lastErrorCode=0,this.taskOrPanId="",this.taskTimer=null,this.event=new s.APlayerEvent,this.event.setMaxListeners(20),this.aplayer=new v.XmpPlayerIPC(v.XmpPlayerIPCId.xmpPlayer,this.event),this.attachAPlayerEvent()}preloadAPlayer(){return n(this,void 0,void 0,function*(){do{if(this.preloading)break;if(this.preloading=!0,!(yield this.aplayer.createAPlayer())){this.preloading=!1,this.fireXmpPlayerEvent(I.XmpEvent.onAPlayerCreated);break}this.hostWnd=this.aplayer.getAPlayerWnd(),O.warning("preloadAPlayer hostWnd",this.hostWnd),N.setDragAcceptFiles(this.hostWnd,!0);let e=p.ConfigNS.getValue(S.ConfigDefineNS.speedUpEnable.section,S.ConfigDefineNS.speedUpEnable.key,S.ConfigDefineNS.speedUpEnable.value);this.setConfig(l.APlayerConfigId.CONFIGID_SPEEDUPENABLE,e.toString()).catch();let t=p.ConfigNS.getValue(S.ConfigDefineNS.mediaVolume.section,S.ConfigDefineNS.mediaVolume.key,S.ConfigDefineNS.mediaVolume.value);this.aplayer.setVolume(t).catch(),this.showAPlayerWindow(!1),this.preloading=!1,r.ipcRenderer.send(a.ThunderChannelList.channelMRAPlayerCreated,this.hostWnd),this.fireXmpPlayerEvent(I.XmpEvent.onAPlayerCreated),m.VideoTipManagerNS.getVideoTipManager().init(this.hostWnd).catch()}while(0)})}createAPlayer(){return n(this,void 0,void 0,function*(){return!this.preloading&&this.hostWnd?this.aplayer:this.preloading?new Promise(e=>n(this,void 0,void 0,function*(){this.attachOnceListener(I.XmpEvent.onAPlayerCreated,()=>{e(this.aplayer)})})):(yield this.preloadAPlayer(),this.aplayer)})}destroyAPlayer(){return n(this,void 0,void 0,function*(){this.aplayer.destroyAPlayer(),this.hostWnd=0})}attachListener(e,t){this.event&&this.event.attachListener(e,t)}attachOnceListener(e,t){this.event&&this.event.attachOnceListener(e,t)}detachListener(e,t){this.event&&this.event.detachListener(e,t)}getAplayer(){return this.aplayer}setCurrentMedia(e){this.media=e}getCurrentMedia(){return this.media}open(e=!1,t){return n(this,void 0,void 0,function*(){let i=-1;do{if(t&&(this.media&&this.media.setDownloadAndPlayTaskData(null),this.media=t),!this.media)break;this.state=d.XmpMediaState.PreOpen,yield this.createAPlayer(),yield this.setConfig(l.APlayerConfigId.CONFIGID_NETWORK_SEEKBUFFERTIMEOUT,"100"),yield this.setConfig(l.APlayerConfigId.CONFIGID_NOCLOSEWHENCOMPLETE,"1");let n=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId),o=this.media.getXmpMediaAttribute(d.XmpMediaAttr.Type),r=this.media.getXmpMediaAttribute(d.XmpMediaAttr.PanFileId),a=this.media.getXmpMediaAttribute(d.XmpMediaAttr.TaskId),s=this.media.getXmpMediaAttribute(d.XmpMediaAttr.ShowBackIcon);if(this.fireXmpPlayerEvent(I.XmpEvent.onPreOpen,n,e,a,r,s),p.ConfigNS.setValue(S.ConfigDefineNS.lastPlayMediaId.section,S.ConfigDefineNS.lastPlayMediaId.key,n),this.attachTaskStatusChanged(),this.state!==d.XmpMediaState.PreOpen){O.information("state:",this.state);break}if(1===p.ConfigNS.getValue(S.ConfigDefineNS.rememberProgress.section,S.ConfigDefineNS.rememberProgress.key,S.ConfigDefineNS.rememberProgress.value)){let e=this.media.getXmpMediaAttribute(d.XmpMediaAttr.Position),t=this.media.getXmpMediaAttribute(d.XmpMediaAttr.Duration);O.information("setConfig CONFIGID_STARTPOSITION",e,t),e>3e3&&(t<=0||t-e>3e3)&&this.setConfig(l.APlayerConfigId.CONFIGID_STARTPOSITION,e.toString()).catch()}let c=this.media.getXmpMediaAttribute(d.XmpMediaAttr.PlayUrl);if(o===d.XmpMediaType.Dc){this.fireXmpPlayerEvent(I.XmpEvent.onGetPlayUrl,n,c),i=yield this.aplayer.open(c);let e=this.media.getXmpMediaAttribute(d.XmpMediaAttr.Cid);(!e||e.length<=0)&&(yield f.FileSystemAWNS.existsAW(c))&&(e=yield u.XmpUtilityNS.calculateFileCidAW(c))&&e.length>0&&n===this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId)&&this.media.setXmpMediaAttribute(d.XmpMediaAttr.Cid,e)}else if(o===d.XmpMediaType.LocalUrl){let e=this.media.getXmpMediaAttribute(d.XmpMediaAttr.Url);e&&u.XmpUtilityNS.isLocalPath(e)&&(yield f.FileSystemAWNS.existsAW(e))?(c=e,this.media.setDownloadAndPlayTaskData(null)):this.startQueryTaskInfo(c),this.fireXmpPlayerEvent(I.XmpEvent.onGetPlayUrl,n,c),i=yield this.aplayer.open(c)}-1!==i&&(this.fireXmpPlayerEvent(I.XmpEvent.onOpenSucceededCreateTask,a,r),this.startTimer(r))}while(0);return i})}startTimer(e){clearInterval(this.taskTimer),this.taskTimer=setInterval(()=>n(this,void 0,void 0,function*(){do{if(!e||""===e){clearInterval(this.taskTimer);break}let t=Number(yield this.getConfig(l.APlayerConfigId.CONFIGID_FILESIZE)),i=yield this.getDuration(),n=Number(yield this.getConfig(l.APlayerConfigId.CONFIGID_PLAYSPEED));if(0===t||0===i||0===n)break;let o=t/(i/1e3)*n/100;yield E.client.callServerFunction("SetTaskVideoByteRatio",void 0,-1,o,e),clearInterval(this.taskTimer)}while(0)}),5e3)}close(e=0,t=d.ErrorFrom.XMP,i=!0){return n(this,void 0,void 0,function*(){let n=-1;do{if(!this.media)break;if(this.state===d.XmpMediaState.Invalid)break;if(n=yield this.stop(e,t),this.firstPlay=!0,this.state=d.XmpMediaState.Invalid,t===d.ErrorFrom.Exit)break;i&&this.fireXmpPlayerEvent(I.XmpEvent.onAllStoped,e,t)}while(0);return n})}stop(e=0,t=d.ErrorFrom.XMP){return n(this,void 0,void 0,function*(){let i=-1;do{if(!this.media)break;if(t===d.ErrorFrom.Exit){i=yield this.aplayer.close();break}t!==d.ErrorFrom.Restart&&this.stopQueryTaskInfo();let n=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId),o=this.media.getXmpMediaAttribute(d.XmpMediaAttr.PanFileId);yield this.createSnapShot(_.Stop,n);let r=this.state;yield this.setStatInfo(n),this.fireXmpPlayerEvent(I.XmpEvent.onPreStop,n,r,e,t),this.state=d.XmpMediaState.Ready,i=yield this.aplayer.close(),this.fireXmpPlayerEvent(I.XmpEvent.onStop,n,r,e,o)}while(0);return i})}setStatInfo(e){return n(this,void 0,void 0,function*(){let t={};t.frameDrawn=yield this.getConfig(l.APlayerConfigId.CONFIGID_FRAMESDRAWN),t.readByte=yield this.getConfig(l.APlayerConfigId.CONFIGID_READSIZE),t.stuffReadByte=yield this.getConfig(l.APlayerConfigId.CONFIGID_NETWORK__STUFF_READ_SIZE),t.videoCodec=yield this.getConfig(l.APlayerConfigId.CONFIGID_VIDEOCODEC),t.audioCodec=yield this.getConfig(l.APlayerConfigId.CONFIGID_AUDIOCODEC),t.audioTracksStr=yield this.getConfig(l.APlayerConfigId.CONFIGID_AUDIOINPUTCHANNELS),t.frameDrawStr=yield this.getConfig(l.APlayerConfigId.CONFIGID_FRAMESDRAWN),t.playSpeed=yield this.getConfig(l.APlayerConfigId.CONFIGID_PLAYSPEED),t.fileSize=yield this.getConfig(l.APlayerConfigId.CONFIGID_FILESIZE),t.isSucc=yield this.getConfig(l.APlayerConfigId.CONFIGID_SPEEDUPENABLE),t.firstTime=yield this.getConfig(l.APlayerConfigId.CONFIGID_FISRTFRAMETIME),t.seekIndex=yield this.getConfig(l.APlayerConfigId.CONFIGID_NETWORK__TS_INDEX_STATUS),t.seekTime=yield this.getConfig(l.APlayerConfigId.CONFIGID_SEEK_FRAME_TIME_AVERAGE),t.deviceid=yield this.getConfig(l.APlayerConfigId.CONFIGID_DLNACURRENTDEVICE),t.drawingTime=yield this.getConfig(l.APlayerConfigId.CONFIGID_SEEK_FRAME_TIME_AVERAGE),t.fileTime=(yield this.getDuration()).toString(),t.width=yield this.getVideoWidth(),t.height=yield this.getVideoHeight(),t.aplayerStats=yield this.getConfig(l.APlayerConfigId.CONFIGID_STAT),t.aplayerStats&&(t.aplayerStats=t.aplayerStats.replace(/;/g,",")),yield E.client.callRemoteClientFunction(D.mainRendererContext,b.XmpPlayerFunction.setPlayEndInfo,e,t)})}play(){return n(this,void 0,void 0,function*(){return this.aplayer.play()})}pause(){return n(this,void 0,void 0,function*(){return this.aplayer.pause()})}getVersion(){return n(this,void 0,void 0,function*(){return this.aplayer.getVersion()})}setCustomLogo(e){return n(this,void 0,void 0,function*(){return this.aplayer.setCustomLogo(e)})}getState(){return this.state}getDuration(){return n(this,void 0,void 0,function*(){return this.aplayer.getDuration()})}getPosition(){return n(this,void 0,void 0,function*(){return this.aplayer.getPosition()})}setPosition(e){return n(this,void 0,void 0,function*(){return E.client.callRemoteClientFunction(D.mainRendererContext,b.XmpPlayerFunction.recordStat,"addAPlayerSeekCount").catch(),this.aplayer.setPosition(e)})}getVideoWidth(){return n(this,void 0,void 0,function*(){return this.aplayer.getVideoWidth()})}getVideoHeight(){return n(this,void 0,void 0,function*(){return this.aplayer.getVideoHeight()})}getVolume(){return n(this,void 0,void 0,function*(){return this.aplayer.getVolume()})}setVolume(e){return n(this,void 0,void 0,function*(){return this.fireXmpPlayerEvent(I.XmpEvent.onVolumeChange,e),p.ConfigNS.setValue(S.ConfigDefineNS.mediaVolume.section,S.ConfigDefineNS.mediaVolume.key,e),this.aplayer.setVolume(e)})}isSeeking(){return n(this,void 0,void 0,function*(){return this.aplayer.isSeeking()})}getBufferProgress(){return n(this,void 0,void 0,function*(){return this.aplayer.getBufferProgress()})}getConfig(e){return n(this,void 0,void 0,function*(){return this.aplayer.getConfig(e)})}setConfig(e,t){return n(this,void 0,void 0,function*(){switch(this.fireXmpPlayerEvent(I.XmpEvent.onSetConfig,e,t),e){case l.APlayerConfigId.CONFIGID_IMAGENORMALIZEENABLE:p.ConfigNS.setValue(S.ConfigDefineNS.imageNormalSize.section,S.ConfigDefineNS.imageNormalSize.key,Number(t));break;case l.APlayerConfigId.CONFIGID_PLAYSPEED:p.ConfigNS.setValue(S.ConfigDefineNS.playSpeed.section,S.ConfigDefineNS.playSpeed.key,Number(t));break;case l.APlayerConfigId.CONFIGID_SPEEDUPENABLE:p.ConfigNS.setValue(S.ConfigDefineNS.speedUpEnable.section,S.ConfigDefineNS.speedUpEnable.key,Number(t))}return yield this.aplayer.setConfig(e,t)})}fireXmpPlayerEvent(e,...t){this.event.fireXmpPlayerEvent(e,...t)}onCreateMediaFail(e){return n(this,void 0,void 0,function*(){e===d.CreateError.MediaFileNotFound&&(yield this.createAPlayer(),this.fireXmpPlayerEvent(I.XmpEvent.onCreateMediaError,e,"没有有效的媒体文件"))})}killCheckThunderPauseTimer(){this.checkThunderPauseTimer&&(clearInterval(this.checkThunderPauseTimer),this.checkThunderPauseTimer=null)}attachAPlayerEvent(){this.event.attachListener(I.XmpEvent.onOpenSucceeded,()=>n(this,void 0,void 0,function*(){let e=!1,t=!1;this.media.setXmpMediaAttribute(d.XmpMediaAttr.Played,1);let i=yield this.aplayer.getDuration();this.duration=i;let o=yield this.aplayer.getVideoWidth(),r=yield this.aplayer.getVideoHeight();if(this.media.setXmpMediaAttribute(d.XmpMediaAttr.Width,o),this.media.setXmpMediaAttribute(d.XmpMediaAttr.Height,r),0!==i){i!==this.media.getXmpMediaAttribute(d.XmpMediaAttr.Duration)&&this.media.setXmpMediaAttribute(d.XmpMediaAttr.Duration,i);let e=this.media.getXmpMediaAttribute(d.XmpMediaAttr.PlayPercent);O.information("setPosition",i,e),e>=0&&this.setPosition(Math.round(i*e/100)).catch()}this.positionTimer&&(clearInterval(this.positionTimer),this.positionTimer=null),this.timer&&(clearInterval(this.timer),this.timer=null);let a=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId),s=yield this.aplayer.getPosition();this.fireXmpPlayerEvent(I.XmpEvent.onTimeDesChange,a,s,i),this.positionTimer=setInterval(()=>n(this,void 0,void 0,function*(){this.media&&this.state>d.XmpMediaState.Opening&&(s=yield this.aplayer.getPosition())}),50),this.timer=setInterval(()=>n(this,void 0,void 0,function*(){if(this.media&&this.state>d.XmpMediaState.Opening){let i=this.media.getXmpMediaAttribute(d.XmpMediaAttr.Position),n=this.media.getXmpMediaAttribute(d.XmpMediaAttr.Duration),o=yield this.aplayer.getDuration();s&&o&&(o!==n&&this.media.setXmpMediaAttribute(d.XmpMediaAttr.Duration,o),!t&&s>3e3&&(t=!0,this.createSnapShot(_.Satrt,a).catch()),!e&&o-s<1e4&&(e=!0,this.createSnapShot(_.Finished,a).catch()),i!==s&&(this.media.setXmpMediaAttribute(d.XmpMediaAttr.Position,s),this.fireXmpPlayerEvent(I.XmpEvent.onTimeDesChange,a,s,o)))}}),1e3),this.setConfig(l.APlayerConfigId.CONFIGID_PICTUREEVRCPLINEAR,"1").catch(),this.media&&!this.media.getXmpMediaAttribute(d.XmpMediaAttr.Cid)&&(this.media.getXmpMediaAttribute(d.XmpMediaAttr.Type),d.XmpMediaType.Gvod)})),this.event.attachListener(I.XmpEvent.onStateChanged,(e,t)=>n(this,void 0,void 0,function*(){do{if(!this.media)break;if(t===d.XmpMediaState.Ready){this.timer&&(clearInterval(this.timer),this.timer=null),this.positionTimer&&(clearInterval(this.positionTimer),this.positionTimer=null);let t=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId);this.fireXmpPlayerEvent(I.XmpEvent.onTimeDesChange,t,0,0);let i=void 0,n=yield this.getConfig(l.APlayerConfigId.CONFIGID_PLAYRESULT);n&&(i=Number(n))<0&&(i=4294967296+i),0===i?yield this.onPlayCompleted():1===i||(yield this.setStatInfo(t),d.XmpMediaState.Opening<=e?this.onOpenFailed(i):this.onPlayFailed(i))}else{if(this.state===d.XmpMediaState.Invalid)break;if(t===d.XmpMediaState.Paused){if(this.state=d.XmpMediaState.Paused,this.media){let e=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId);d.XmpMediaState.Opening,this.fireXmpPlayerEvent(I.XmpEvent.onPaused,e)}}else t===d.XmpMediaState.Playing?this.onPlaying():this.state=t}this.media&&this.media.setXmpMediaState(t),O.information("OnStateChanged update state:",this.state)}while(0)})),this.event.attachListener(I.XmpEvent.onBuffer,e=>n(this,void 0,void 0,function*(){O.information("[Thunder.DapIpcControl] XmpEvent.onBuffer percent:",e,this.media.getXmpMediaAttribute(d.XmpMediaAttr.Type)),100!==e&&this.media.getXmpMediaAttribute(d.XmpMediaAttr.Type)===d.XmpMediaType.LocalUrl?yield this.checkThunderTaskStop():100===e&&this.killCheckThunderPauseTimer()})),this.event.attachListener(I.XmpEvent.onStop,()=>{O.information("[Thunder.DapIpcControl] XmpEvent.onStop"),this.killCheckThunderPauseTimer()}),this.event.attachListener(I.XmpEvent.onPlaying,()=>{O.information("[Thunder.DapIpcControl] XmpEvent.onPlaying"),this.killCheckThunderPauseTimer()}),this.aplayer.attachListener(v.XmpPlayerIPCEvent.onCrash,()=>n(this,void 0,void 0,function*(){if(this.hostWnd=0,this.fireXmpPlayerEvent(I.XmpEvent.onXmpAplayerCrash),this.media)if(O.warning("APlayer crashed! this.state:",this.state),this.state===d.XmpMediaState.Play||this.state===d.XmpMediaState.Playing||this.state===d.XmpMediaState.Paused||this.state===d.XmpMediaState.Pausing)if(O.warning("this.crashTime:",this.crashTime),E.client.callRemoteClientFunction(D.mainRendererContext,b.XmpPlayerFunction.recordStat,"recEndType","crash").catch(),this.crashTime<3){this.crashTime++,yield this.createAPlayer();let e=this.media.getXmpMediaAttribute(d.XmpMediaAttr.PlayUrl);if(e){let t=this.media.getXmpMediaAttribute(d.XmpMediaAttr.Position),i=this.media.getXmpMediaAttribute(d.XmpMediaAttr.Duration);t>3e3&&i-t>3e3&&this.setConfig(l.APlayerConfigId.CONFIGID_STARTPOSITION,t.toString()).catch(),this.aplayer.open(e).catch()}}else{this.crashTime=0;let e=this.state,t=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId),i=305419896;this.fireXmpPlayerEvent(I.XmpEvent.onPreStop,t,e,i,d.ErrorFrom.Crash),this.state=d.XmpMediaState.Invalid,this.fireXmpPlayerEvent(I.XmpEvent.onStop,t,e,i),this.fireXmpPlayerEvent(I.XmpEvent.onAllStoped,i,d.ErrorFrom.Crash)}else if(this.state<d.XmpMediaState.Ready&&this.state>d.XmpMediaState.Invalid||this.state===d.XmpMediaState.Opening){this.crashTime=0;let e=this.state,t=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId),i=305419896;this.fireXmpPlayerEvent(I.XmpEvent.onPreStop,t,e,i,d.ErrorFrom.Crash),this.state=d.XmpMediaState.Invalid,this.fireXmpPlayerEvent(I.XmpEvent.onStop,t,e,i),this.fireXmpPlayerEvent(I.XmpEvent.onAllStoped,i,d.ErrorFrom.Crash)}})),this.event.attachListener(I.XmpEvent.onEvent,(e,t)=>n(this,void 0,void 0,function*(){O.warning("cqm onEvent eventCode",e,"eventParam",t),e===l.APlayerEventCode.EVENTCODE_PLAYCOMPLETE&&(yield this.onPlayCompleted())})),setInterval(()=>{this.crashTime=0},6e4)}onPlayCompleted(){return n(this,void 0,void 0,function*(){do{if(!this.media)break;let e=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId);yield this.setStatInfo(e),yield this.aplayer.close(),this.fireXmpPlayerEvent(I.XmpEvent.onPreStop,e,d.XmpMediaState.Completed);let t=d.XmpMediaState.Completed;this.state=d.XmpMediaState.Invalid,this.fireXmpPlayerEvent(I.XmpEvent.onStop,e,t),this.firstPlay=!0,this.fireXmpPlayerEvent(I.XmpEvent.onPlayCompleted,e),this.state===d.XmpMediaState.Invalid&&this.fireXmpPlayerEvent(I.XmpEvent.onAllStoped,0,d.ErrorFrom.XMP)}while(0)})}onOpenFailed(e){do{if(!this.media)break;this.state=d.XmpMediaState.Error;let t=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId);this.fireXmpPlayerEvent(I.XmpEvent.onOpenFailed,t,e),this.fireXmpPlayerEvent(I.XmpEvent.onError,t,e),this.lastErrorTaskId=this.taskOrPanId,this.lastErrorCode=e,this.close(e,d.ErrorFrom.APlayer).catch()}while(0)}onPlayFailed(e){do{if(!this.media)break;this.state=d.XmpMediaState.Error;let t=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId);this.fireXmpPlayerEvent(I.XmpEvent.onPlayFailed,t,e),this.fireXmpPlayerEvent(I.XmpEvent.onError,t,e),this.lastErrorTaskId=this.taskOrPanId,this.lastErrorCode=e,this.close(e,d.ErrorFrom.APlayer).catch()}while(0)}getLastPlayError(){return{taskId:this.lastErrorTaskId,error:this.lastErrorCode}}clearLastPlayError(){this.lastErrorTaskId="",this.lastErrorCode=0,this.fireXmpPlayerEvent(I.XmpEvent.onClearError)}setPlayingTaskId(e){this.taskOrPanId=e}setPlayingPanFileId(e){this.taskOrPanId=e}onPlaying(){do{if(!this.media)break;this.state=d.XmpMediaState.Playing;let e=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId);this.fireXmpPlayerEvent(I.XmpEvent.onPlaying,e,this.firstPlay),this.firstPlay=!1}while(0)}showAPlayerWindow(e){if(this.hostWnd){let t=h.Uflag.SWP_NOSIZE|h.Uflag.SWP_NOMOVE|h.Uflag.SWP_NOZORDER;t|=e?h.Uflag.SWP_SHOWWINDOW:h.Uflag.SWP_HIDEWINDOW,O.warning("showAPlayerWindow show",e,"hostWnd",this.hostWnd,"flag",t),c.ThunderHelper.setWindowPosEx(this.hostWnd,0,0,0,0,0,t)}}isPlayMusic(){return n(this,void 0,void 0,function*(){let e=!1;do{if(!this.media)break;0!==(yield this.getVideoWidth())&&0!==(yield this.getVideoHeight())||(e=!0)}while(0);return e})}addWindowMessageFilter(e){this.aplayer&&this.aplayer.addWindowMessageFilter(e)}removeWindowMessageFilter(e){this.aplayer&&this.aplayer.removeWindowMessageFilter(e)}clearWindowMessageFilter(){this.aplayer&&this.aplayer.clearWindowMessageFilter()}setChangeViewSize(e){this.aplayer&&this.aplayer.setChangeViewSize(e)}setWindowResizeRect(e){this.aplayer&&this.aplayer.setWindowResizeRect(e)}setWindowCaptionMove(e){this.aplayer&&this.aplayer.setWindowCaptionMove(e)}setMainWnd(e){this.aplayer&&this.aplayer.setMainWnd(e)}getAPlayerHostWindow(){return this.hostWnd}setAudioTime(e){return n(this,void 0,void 0,function*(){let t=0;return t=yield this.setConfig(l.APlayerConfigId.CONFIGID_AUDIOTIMESHIFT,e),this.media.setXmpMediaAttribute(d.XmpMediaAttr.AudioTime,Number(e)),t})}setProportion(e,t){return n(this,void 0,void 0,function*(){let i=0;return t?(yield this.setConfig(l.APlayerConfigId.CONFIGID_VIDEOTARGETPOSITION,"0;0;0;0"),this.media.setXmpMediaAttribute(d.XmpMediaAttr.Proportion,"fullfill")):this.media.setXmpMediaAttribute(d.XmpMediaAttr.Proportion,e),"normal"===e&&(e=yield this.getConfig(l.APlayerConfigId.CONFIGID_ASPECTRATIONATIVE)),i=yield this.setConfig(l.APlayerConfigId.CONFIGID_ASPECTRATIOCUSTOM,e)})}setFrameFlipH(e){return n(this,void 0,void 0,function*(){let t=0,i=yield this.getConfig(l.APlayerConfigId.CONFIGID_RENDERMODECURRENT);do{if(1===p.ConfigNS.getValue(S.ConfigDefineNS.speedUpEnable.section,S.ConfigDefineNS.speedUpEnable.key,S.ConfigDefineNS.speedUpEnable.value)&&"4"!==i){yield g.LeftTopVideoTipManagerNS.showTip(y.XmpVideoTipItemIdNS.videoTipItemConfigChanged,"硬件加速时无法进行画面翻转",5e3);break}t=yield this.setConfig(l.APlayerConfigId.CONFIGID_IMAGEFLIPH,e),this.media.setXmpMediaAttribute(d.XmpMediaAttr.FlipH,Number(e));let n=this.getState();if("4"===i||n===d.XmpMediaState.Playing||n===d.XmpMediaState.Play)break;let o=yield this.getPosition();t=yield this.setPosition(o+5)}while(0);return t})}setFrameFlipV(e){return n(this,void 0,void 0,function*(){let t=0,i=yield this.getConfig(l.APlayerConfigId.CONFIGID_RENDERMODECURRENT);do{if(1===p.ConfigNS.getValue(S.ConfigDefineNS.speedUpEnable.section,S.ConfigDefineNS.speedUpEnable.key,S.ConfigDefineNS.speedUpEnable.value)&&"4"!==i){yield g.LeftTopVideoTipManagerNS.showTip(y.XmpVideoTipItemIdNS.videoTipItemConfigChanged,"硬件加速时无法进行画面翻转",5e3);break}t=yield this.setConfig(l.APlayerConfigId.CONFIGID_IMAGEFLIPV,e),this.media.setXmpMediaAttribute(d.XmpMediaAttr.FlipV,Number(e));let n=this.getState();if("4"===i||n===d.XmpMediaState.Playing||n===d.XmpMediaState.Play)break;let o=yield this.getPosition();t=yield this.setPosition(o+5)}while(0);return t})}updateFullFill(){if(!this.media)return;let e;if("fullfill"!==(e=this.media.getXmpMediaAttribute(d.XmpMediaAttr.Proportion)))return;if(this.getState()<=d.XmpMediaState.Opening)return;let t=this.getAPlayerHostWindow(),i=c.ThunderHelper.getChildWindow(t);if(c.ThunderHelper.isWindowVisible(i)){let e=c.ThunderHelper.getWindowRect(i);this.setProportion(e.width+";"+e.height,!0).catch()}}setFrameRotate(e){return n(this,void 0,void 0,function*(){let t=0,i=yield this.getConfig(l.APlayerConfigId.CONFIGID_RENDERMODECURRENT);do{if(1===p.ConfigNS.getValue(S.ConfigDefineNS.speedUpEnable.section,S.ConfigDefineNS.speedUpEnable.key,S.ConfigDefineNS.speedUpEnable.value)&&"4"!==i){yield g.LeftTopVideoTipManagerNS.showTip(y.XmpVideoTipItemIdNS.videoTipItemConfigChanged,"硬件加速时无法进行画面旋转",5e3);break}let n=Number(yield this.getConfig(l.APlayerConfigId.CONFIGID_IMAGEROTATE));if(0===e?n=0:n+=Number(e),1!==(yield this.setConfig(l.APlayerConfigId.CONFIGID_IMAGEROTATE,n.toString())))break;let o=this.media.getXmpMediaAttribute(d.XmpMediaAttr.Proportion);if(o&&"string"==typeof o||(o="normal"),"fullfill"===o)this.updateFullFill();else if("normal"!==o){if(90===Math.abs(n)||270===Math.abs(n)){let e=o.indexOf(";");-1!==e&&(o=o.substring(e+1)+";"+o.substring(0,e))}yield this.setConfig(l.APlayerConfigId.CONFIGID_ASPECTRATIOCUSTOM,o)}this.media.setXmpMediaAttribute(d.XmpMediaAttr.Rorate,n);let r=this.getState();if("4"===i||r===d.XmpMediaState.Playing||r===d.XmpMediaState.Play)break;let a=yield this.getPosition();t=yield this.setPosition(a+5)}while(0);return t})}setAudioTrack(e){return n(this,void 0,void 0,function*(){let t=0;return 1===(t=yield this.setConfig(l.APlayerConfigId.CONFIGID_AUDIOTRACKCURRENT,e.toString()))&&this.media.setXmpMediaAttribute(d.XmpMediaAttr.AudioTrack,Number(e)),t})}setLocalAudioTrack(e){return n(this,void 0,void 0,function*(){let t=0;if(1===(t=yield this.setConfig(l.APlayerConfigId.CONFIGID_AUDIOLOADTRACK,e))){let t=this.media.getXmpMediaAttribute(d.XmpMediaAttr.LocalAudioTrack);t&&t.length>0?t+="|"+e:t=e,this.media.setXmpMediaAttribute(d.XmpMediaAttr.LocalAudioTrack,t);let i=yield this.getConfig(l.APlayerConfigId.CONFIGID_AUDIOTRACKCURRENT),n=parseInt(i,10);this.media.setXmpMediaAttribute(d.XmpMediaAttr.AudioTrack,n),g.LeftTopVideoTipManagerNS.showTip("loadAudioTrackResult","载入音轨成功",5e3).catch()}else g.LeftTopVideoTipManagerNS.showTip("loadAudioTrackResult","载入失败，音轨文件格式错误",5e3).catch();return t})}setAPoint(e){this.aPosition=e}setBPoint(e){this.bPosition=e}getAPoint(){return this.aPosition}getBPoint(){return this.bPosition}positionChanged(e,t,i=0,o){return n(this,void 0,void 0,function*(){let n=0;if(!e)return n;let r=yield this.getPosition();do{let a=this.getState();if((-1===this.aPosition||-1===this.bPosition)&&"0"===t&&a<=d.XmpMediaState.Paused&&a>=d.XmpMediaState.Pausing){yield this.setConfig(l.APlayerConfigId.CONFIGID_KEYFRAMESEEK,t);let i="1";e<0&&(i="-1"),n=yield this.setConfig(l.APlayerConfigId.CONFIGID_FRAMESTEP,i),r=yield this.getPosition();break}if(t="1",0===p.ConfigNS.getValue(S.ConfigDefineNS.keyboardSeekMode.section,S.ConfigDefineNS.keyboardSeekMode.key,S.ConfigDefineNS.keyboardSeekMode.value)?0===i?(O.information("[Test] 精细帧首次按下 changed=",e),yield this.setConfig(l.APlayerConfigId.CONFIGID_KEYFRAMESEEK,"0"),yield this.setConfig(l.APlayerConfigId.CONFIGID_MOUSEFRAMESEEK,"0")):(O.information("[Test] 精细帧连续按下 changed=",e," downtimes=",i),yield this.setConfig(l.APlayerConfigId.CONFIGID_KEYFRAMESEEK,"1"),yield this.setConfig(l.APlayerConfigId.CONFIGID_MOUSEFRAMESEEK,"1")):(O.information("[Test] 关键帧按下 changed=",e),yield this.setConfig(l.APlayerConfigId.CONFIGID_KEYFRAMESEEK,"1"),yield this.setConfig(l.APlayerConfigId.CONFIGID_MOUSEFRAMESEEK,o?"0":"1")),-1!==this.aPosition&&-1!==this.bPosition)do{if(r+e>=this.bPosition&&r<=this.bPosition)e=r+e-this.bPosition,r=this.aPosition+e;else if(r+e<=this.aPosition&&r>=this.aPosition)e=0,r=this.aPosition;else if(r+e<this.aPosition||r+e>this.bPosition)break;t="0",yield this.setConfig(l.APlayerConfigId.CONFIGID_KEYFRAMESEEK,t),t="1"}while(0);(r+=e)<0&&(r=0),r>this.duration&&(r=this.duration),n=yield this.setPosition(r)}while(0);let a=yield this.getDuration(),s=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId);return this.fireXmpPlayerEvent(I.XmpEvent.onPositionChanged,s,r,a,e,t),n})}cancelDownloadCodecs(){return n(this,void 0,void 0,function*(){return yield this.close(168965206,d.ErrorFrom.CancelDownloadCodecs),this.aplayer.cancelDownloadCodecs()})}getCachedDownloadCodecInfo(){return this.aplayer.getCachedDownloadCodecInfo()}checkThunderTaskStop(){return n(this,void 0,void 0,function*(){do{if(!this.media)break;if(this.media.getXmpMediaAttribute(d.XmpMediaAttr.Type)!==d.XmpMediaType.LocalUrl)break;this.checkThunderPauseTimer||(this.checkThunderPauseBufferTimeStamp=(new Date).getTime(),O.information("[Thunder.DapIpcControl] xmpplayer"),this.checkThunderPauseTimer=setInterval(()=>n(this,void 0,void 0,function*(){(new Date).getTime()-this.checkThunderPauseBufferTimeStamp>3e3&&(this.killCheckThunderPauseTimer(),1===this.media.getXmpMediaAttribute(d.XmpMediaAttr.TaskStop)&&(yield g.LeftTopVideoTipManagerNS.showTip(y.XmpVideoTipItemIdNS.videoTipItemTaskStoped,"下载任务已暂停，无法为您边下边播，请继续进行下载并重新播放视频",5e3)))}),1e3))}while(0)})}startQueryTaskInfo(e){do{if(this.queryTimer&&(clearInterval(this.queryTimer),this.queryTimer=null),!u.XmpUtilityNS.isLocalUrl(e))break;if(!this.media)break;let t=this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId),i=()=>{this.queryDownloadAndPlayTaskInfo(e,(e,n)=>{this.media&&this.media.getXmpMediaAttribute(d.XmpMediaAttr.MediaId)===t&&200===e&&n?(this.media.setDownloadAndPlayTaskData(n),6===n.status||7===n.status?this.queryTimer=null:this.queryTimer=setTimeout(i,1e3)):this.queryTimer=null}).catch()};this.queryTimer=setTimeout(i,1e3)}while(0)}stopQueryTaskInfo(){this.queryTimer&&(clearInterval(this.queryTimer),this.queryTimer=null),this.media&&(this.media.setDownloadAndPlayTaskData(null),this.media.getXmpMediaInfo().taskId)}queryDownloadAndPlayTaskInfo(e,t){return n(this,void 0,void 0,function*(){try{let i=P.parse(e),n=Buffer.from("querytaskinfo=15"),o={hostname:i.hostname,port:i.port,path:i.path,method:"POST",headers:{Connection:"Close","Content-Length":n.length,Accept:"*/*"}},r=w.request(o,e=>{let i=null;e.on("data",e=>{i=i?Buffer.concat([i,e]):e}),e.on("end",()=>{O.information("http end. res:",e);let n=null;try{n=JSON.parse(i.toString())}catch(e){O.warning(e)}t(e.statusCode,n)})});r.on("error",e=>{O.warning("http error. err:",e),t(0,null)}),r.on("timeout",()=>{r.abort()}),r.write(n),r.end()}catch(e){O.information("queryDownloadAndPlayTaskInfo error:",e)}})}attachTaskStatusChanged(){}createSnapShot(e,t,i){return n(this,void 0,void 0,function*(){let n=!1;do{if("1"!==(yield this.getConfig(l.APlayerConfigId.CONFIGID_SNAPSHOTUSABLE)))break;let r=this.getState();if(r!==d.XmpMediaState.Play&&r!==d.XmpMediaState.Playing&&r!==d.XmpMediaState.Paused&&r!==d.XmpMediaState.Pausing)break;if(e===_.Satrt){let e=this.media.getXmpMediaAttribute(d.XmpMediaAttr.ImgSrc);if(e&&(yield f.FileSystemAWNS.existsAW(e)))break}if(!i){let e=o.join(__xmpProfilesDir,"MediaData");if(!(yield f.FileSystemAWNS.existsAW(e))&&!(yield f.FileSystemAWNS.mkdirsAW(e))){O.information("创建文件夹失败 path:",e);break}let n=Math.floor((new Date).getTime()/1e3);i=o.join(e,t.toString()+"_"+n+".jpg")}let a=this.getCurrentMedia();if(!a)break;if(a.getXmpMediaAttribute(d.XmpMediaAttr.MediaId)!==t)break;let s=yield this.getVideoWidth(),u=yield this.getVideoHeight();if(0===s||0===u)break;let c=p.ConfigNS.getValue(S.ConfigDefineNS.picIncludeSub.section,S.ConfigDefineNS.picIncludeSub.key,S.ConfigDefineNS.picIncludeSub.value);if(yield this.setConfig(l.APlayerConfigId.CONFIGID_SNAPSHOTSUBTITLE,c.toString()),yield this.setConfig(l.APlayerConfigId.CONFIGID_SNAPSHOTFORMAT,"2"),yield this.setConfig(l.APlayerConfigId.CONFIGID_SNAPSHOTWIDTH,"90"),yield this.setConfig(l.APlayerConfigId.CONFIGID_SNAPSHOTHEIGHT,"60"),yield this.setConfig(l.APlayerConfigId.CONFIGID_SNAPSHOTIMAGE,i),_.Stop,n=yield f.FileSystemAWNS.existsAW(i)){let e=a.getXmpMediaAttribute(d.XmpMediaAttr.ImgSrc);a.setXmpMediaAttribute(d.XmpMediaAttr.ImgSrc,i),this.fireXmpPlayerEvent(I.XmpEvent.onSnapShotCreated,t,i),e&&f.FileSystemAWNS.existsAW(e)&&(yield f.FileSystemAWNS.unlinkAW(e))}}while(0);return n})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APlayerEvent=void 0;const n=i(24),o=i(5);t.APlayerEvent=class extends n.default{constructor(){super()}fireXmpPlayerEvent(e,...t){this.fireEvent(e,...t),this.fireEvent(o.XmpEvent.onXmpPlayerEvent,e,...t)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmpVideoTipFactoryAW=void 0;const n=i(55),o=i(95);t.XmpVideoTipFactoryAW=class{constructor(e){this.xmpVideoTipFactory=null,this.xmpVideoTipFactory=e}init(){return new Promise(e=>{this.xmpVideoTipFactory.init(()=>{e()})})}uninit(){return new Promise(e=>{this.xmpVideoTipFactory.uninit(()=>{e()})})}getObject(){return this.xmpVideoTipFactory}getVideoTipWnd(e,t=!0){return new Promise(i=>{this.xmpVideoTipFactory.getVideoTipWnd(e,t,e=>{i(e?new n.XmpVideoTipWndAW(e):null)})})}destroyVideoTipWnd(e){return this.xmpVideoTipFactory.destroyVideoTipWnd(e)}getVideoTipContainer(e,t=!0){return new Promise(i=>{this.xmpVideoTipFactory.getVideoTipContainer(e,t,e=>{i(e?new o.XmpVideoTipContainerAW(e):null)})})}destroyVideoTipContainer(e){return this.xmpVideoTipFactory.destroyVideoTipContainer(e)}getAllVideoTipWnd(){let e=[];return this.xmpVideoTipFactory.getAllVideoTipWnd().forEach(t=>{e.push(new n.XmpVideoTipWndAW(t))}),e}getAllVideoTipContainer(){let e=[];return this.xmpVideoTipFactory.getAllVideoTipContainer().forEach(t=>{e.push(new o.XmpVideoTipContainerAW(t))}),e}destroyAllVideoTipWnd(){return new Promise(e=>{this.xmpVideoTipFactory.destroyAllVideoTipWnd(()=>{e()})})}destroyAllVideoTipContainer(){return new Promise(e=>{this.xmpVideoTipFactory.destroyAllVideoTipContainer(()=>{e()})})}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.XmpVideoTipContainerAW=void 0;const o=i(54),r=i(36),a=i(96),s=i(55),l=i(97),d=i(98);t.XmpVideoTipContainerAW=class{constructor(e){this.xmpVideoTipContainer=null,this.xmpVideoTipContainer=e}getId(){return this.xmpVideoTipContainer.getId()}addImageItem(e,t=""){return n(this,void 0,void 0,function*(){return new Promise(i=>{this.xmpVideoTipContainer.addImageItem(e,t,e=>{i(e?new d.XmpVideoTipImageItemAW(e):null)})})})}getObject(){return this.xmpVideoTipContainer}addItem(e,t=""){return new Promise(i=>{this.xmpVideoTipContainer.addItem(e,t,e=>{i(e?new r.XmpVideoTipItemAW(e):null)})})}addLinkItem(e,t=""){return new Promise(i=>{this.xmpVideoTipContainer.addLinkItem(e,t,e=>{i(e?new a.XmpVideoTipLinkItemAW(e):null)})})}addButtonItem(e,t=""){return new Promise(i=>{this.xmpVideoTipContainer.addButtonItem(e,t,e=>{i(e?new l.XmpVideoTipButtonItemAW(e):null)})})}getItem(e){return n(this,void 0,void 0,function*(){return new Promise(t=>{this.xmpVideoTipContainer.getItem(e,e=>{if(e){let i=new r.XmpVideoTipItemAW(e),n=i.getType();n===o.XmpVideoTipItemType.Normal?t(i):n===o.XmpVideoTipItemType.Link?t(new a.XmpVideoTipLinkItemAW(e)):n===o.XmpVideoTipItemType.Button?t(new l.XmpVideoTipButtonItemAW(e)):t(null)}else t(null)})})})}getAllItems(){return n(this,void 0,void 0,function*(){return new Promise(e=>{this.xmpVideoTipContainer.getAllItems(t=>{let i=[];if(t&&t.length>0)for(let e=0;e<t.length;++e){let n=new r.XmpVideoTipItemAW(t[e]),s=n.getType();s===o.XmpVideoTipItemType.Normal?i.push(n):s===o.XmpVideoTipItemType.Link?i.push(new a.XmpVideoTipLinkItemAW(t[e])):s===o.XmpVideoTipItemType.Button&&i.push(new l.XmpVideoTipButtonItemAW(t[e]))}e(i)})})})}removeItem(e){return n(this,void 0,void 0,function*(){return new Promise(t=>{this.xmpVideoTipContainer&&this.xmpVideoTipContainer.removeItem(e),t(!0)})})}clear(){this.xmpVideoTipContainer.clear()}setBkgId(e,t){this.xmpVideoTipContainer.setBkgId(e,t)}getBindWnd(){return n(this,void 0,void 0,function*(){return new Promise(e=>{this.xmpVideoTipContainer.getBindWnd(t=>{e(t?new s.XmpVideoTipWndAW(t):null)})})})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmpVideoTipLinkItemAW=void 0;const n=i(36);t.XmpVideoTipLinkItemAW=class extends n.XmpVideoTipItemAW{constructor(e){super(e),this.xmpVideoTipLinkItem=null,this.xmpVideoTipLinkItem=e}setTextLinkColor(e,t){this.xmpVideoTipLinkItem.setTextLinkColor(e,t)}setTextLinkFont(e,t){this.xmpVideoTipLinkItem.setTextLinkFont(e,t)}setTextLinkFontFaceName(e,t){this.xmpVideoTipLinkItem.setTextLinkFontFaceName(e,t)}setTextLinkFontHeight(e,t){this.xmpVideoTipLinkItem.setTextFontHeight(e,t)}setTextLinkFontBold(e,t){this.xmpVideoTipLinkItem.setTextLinkFontBold(e,t)}setTextLinkFontItalic(e,t){this.xmpVideoTipLinkItem.setTextLinkFontItalic(e,t)}setTextLinkFontUnderline(e,t){this.xmpVideoTipLinkItem.setTextLinkFontUnderline(e,t)}setTextLinkFontStrikeout(e,t){this.xmpVideoTipLinkItem.setTextLinkFontStrikeout(e,t)}setHyperLink(e){this.xmpVideoTipLinkItem.setHyperLink(e)}getHyperLink(){return new Promise(e=>{this.xmpVideoTipLinkItem.getHyperLink(t=>{e(t)})})}setClickHandler(e){this.xmpVideoTipLinkItem.setClickHandler(e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmpVideoTipButtonItemAW=void 0;const n=i(36);t.XmpVideoTipButtonItemAW=class extends n.XmpVideoTipItemAW{constructor(e){super(e),this.xmpVideoTipButtonItem=null,this.xmpVideoTipButtonItem=e}setImageListId(e,t){this.xmpVideoTipButtonItem.setImageListId(e,t)}setNormalBkgId(e,t){this.xmpVideoTipButtonItem.setNormalBkgId(e,t)}setHoverBkgId(e,t){this.xmpVideoTipButtonItem.setHoverBkgId(e,t)}setDownBkgId(e,t){this.xmpVideoTipButtonItem.setDownBkgId(e,t)}setDisableBkgId(e,t){this.xmpVideoTipButtonItem.setDisableBkgId(e,t)}setBkgCorner(e){this.xmpVideoTipButtonItem.setBkgCorner(e)}setIcon(e,t,i){this.xmpVideoTipButtonItem.setIcon(e,t,i)}setTextPos(e,t){this.xmpVideoTipButtonItem.setTextPos(e,t)}setClickHandler(e){this.xmpVideoTipButtonItem.setClickHandler(e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XmpVideoTipImageItemAW=void 0;const n=i(36);t.XmpVideoTipImageItemAW=class extends n.XmpVideoTipItemAW{constructor(e){super(e),this.xmpVideoTipImageItem=null,this.xmpVideoTipImageItem=e}setImagePath(e,t){this.xmpVideoTipImageItem.setImagePath(e,t)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=i(28);const r=new class{constructor(){this.screen=null}init(){return n(this,void 0,void 0,function*(){this.screen=yield o.electron.screen.__resolve()})}getAllDisplays(){return n(this,void 0,void 0,function*(){return this.screen||(yield this.init()),this.screen.getAllDisplays()})}getCursorScreenPoint(){return n(this,void 0,void 0,function*(){return this.screen||(yield this.init()),this.screen.getCursorScreenPoint()})}getDisplayMatching(e){return n(this,void 0,void 0,function*(){return this.screen||(yield this.init()),this.screen.getDisplayMatching(e)})}getDisplayNearestPoint(e){return n(this,void 0,void 0,function*(){return this.screen||(yield this.init()),this.screen.getDisplayNearestPoint(e)})}getMenuBarHeight(){return n(this,void 0,void 0,function*(){return this.screen||(yield this.init()),this.screen.getMenuBarHeight()})}getPrimaryDisplay(){return n(this,void 0,void 0,function*(){return this.screen||(yield this.init()),this.screen.getPrimaryDisplay()})}};t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(23),o=i(42),r=i(12),a=i(101),s=i(6);t.Server=class extends r.EventEmitter{constructor(){super(),this.server=o.createServer(e=>this.handleConnection(e)),this.productId=""}getProductId(){return this.productId}listen(e,t){let i=s.getSockPath(t);this.productId=t||s.getDefaultPrex(),n.existsSync(i)&&n.unlinkSync(i),this.server.listen({path:i,readableAll:!0,writableAll:!0},e)}handleConnection(e){const t=new a.Client({socket:e});t.on("message",e=>{this.handleRequest(e,t)}),t.on("end",()=>{this.emit("end",t)}),t.on("error",()=>{}),this.emit("connect",t)}handleRequest(e,t){this.emit("message",e,t)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(42),o=i(12),r=i(35),a=i(51),s=i(6);t.Client=class extends o.EventEmitter{constructor(e){if(e=e||{},super(),this.inprocess=!1,this.context=void 0,e.context&&(this.context=Object.assign({},e.context),this.context.productId=e.socketPrex),e.socket)this.socket=e.socket,this.bind();else if(global.__xdasIPCServer&&global.__xdasIPCServer.getProductId().toLowerCase()===e.socketPrex.toLowerCase())this.inprocess=!0;else{let t=s.getSockPath(e.socketPrex);this.socket=n.connect(t),this.bind()}}isInprocess(){return this.inprocess}getContext(){return this.context}bind(){const e=new a.Parser,t=this.socket;t.on("data",t=>{e.feed(t)}),t.on("connect",()=>{this.emit("connect")}),t.on("end",()=>{r.information("socket is ended"),this.socket=null,this.emit("end")}),t.on("error",e=>{this.socket=null,this.emit("error",e)}),e.on("message",e=>{this.emit("message",e)}),this.parser=e}send(e){if(this.socket)try{this.socket.write(this.parser.encode(e))}catch(e){r.error(e.message)}else r.information("This socket has been ended by the other party",this.context&&this.context.name)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.stopServer=t.XmpPlayerIPC=t.XmpPlayerIPCEvent=t.XmpPlayerIPCId=void 0;const o=i(22),r=i(1),a=i(103),s=i(9),l=i(0),d=i(24),u=i(16),c=i(13),h=i(11),p=i(5),f=i(4),m=i(25),g=i(2),S=i(3),y=i(43),C=i(6),I=s.default(r.join(__rootDir,"../bin/ThunderHelper.node")),v=a.XLIPCManagerNS.getManager(),T=l.default.getLogger("XMP.XmpPlayerIPC");var E,b;!function(e){e.onAcceptSession="OnAcceptSession",e.onDisconnect="OnDisconnect"}(E||(E={})),function(e){e.xmpPlayer="XmpPlayerAplayer",e.snapshot="SnapshotAplayer",e.blackBand="BlackBandAPlayer",e.preView="PreView",e.subtitleSupress="SubtitleSupress",e.vsr="Vsr",e.sharePic="SharePic"}(t.XmpPlayerIPCId||(t.XmpPlayerIPCId={})),function(e){e.onCrash="OnCrash"}(b=t.XmpPlayerIPCEvent||(t.XmpPlayerIPCEvent={}));class P extends d.default{constructor(){super(...arguments),this.stoping=!1}startServer(){let e=!1;do{if(P.xlipcServer)e=!0;else{let t=v.getFactory();if(!t)break;if(P.xlipcServer=t.createIPCServer(P.serverId),!P.xlipcServer){T.error("createIPCServer failed!");break}let i=P.xlipcServer.start();if(0!==i){T.error("xlipcServer start failed! ret:",i);break}this.stoping=!1,P.xlipcServer.onAccept(e=>{this.fireEvent(E.onAcceptSession,e)}),P.xlipcServer.onDisconnect((e,t)=>{this.stoping||this.fireEvent(E.onDisconnect,e,t)}),e=!0}}while(0);return e}stopServer(){do{if(!P.xlipcServer)break;this.stoping=!0,P.xlipcServer.close(),P.xlipcServer=null}while(0)}connect(e){return n(this,void 0,void 0,function*(){return this.startServer()?new Promise(t=>{let i=null,n=o=>{let r=o.getClientId();T.information("onAcceptSessionListerner clientId:",r),o&&e===r&&(i&&(clearTimeout(i),i=null),this.detachListener(E.onAcceptSession,n),t(o))};this.attachListener(E.onAcceptSession,n);let o=r.join(__dirname,"bin/APlayer.exe");I.asyncShellExecute(0,"open",o,`--server-id="${P.serverId}" --client-id="${e}" --process-id=${process.pid}`,"","SW_HIDE",r=>{T.error("asyncShellExecute ret",r),r<=32?(T.error("shellExecute APlayer.exe failed! ret:",r," id:",e," aplayerPath:",o),this.detachListener(E.onAcceptSession,n),t(null)):i=setTimeout(()=>{T.error("Connect timeout! id:",e),this.detachListener(E.onAcceptSession,n),t(null)},P.connectTimeout)})}):null})}disconnect(e){do{if(!P.xlipcServer)break;P.xlipcServer.closeClient(e)}while(0)}attachDisconnectListener(e,t){let i=n=>{n===e&&(this.detachListener(E.onDisconnect,i),t(status))};return this.attachListener(E.onDisconnect,i),i}}P.xlipcServer=null,P.serverId=a.XLIPCManagerNS.xlipcXmpPlayerId,P.connectTimeout=3e4;const w=new P;t.XmpPlayerIPC=class extends d.default{constructor(e,t){super(),this.id=void 0,this.event=null,this.connectSession=null,this.aplayerWnd=void 0,this.stopFrameQuery=!1,this.seekTimeout=null,this.curFrame=0,this.stop=!1,this.taskId=0,this.savePath="",this.filePath="",this.startTime=0,this.onDisconnectListener=null,this.cacheDownloadCodceInfo={downloading:!1,name:"",progress:0},this.id=e,this.event=t,g.client.attachServerEvent("OnTaskDetailChanged",this.onTaskDetailChanged.bind(this)),g.client.attachServerEvent("OnTaskStatusChanged",this.onTaskStatusChanged.bind(this))}getCachedDownloadCodecInfo(){return this.cacheDownloadCodceInfo}createAPlayer(){return n(this,void 0,void 0,function*(){let e=!1;do{if(this.connectSession){e=!0,T.warning("Already connected!");break}if(T.information("xmpPlayerIPCServer.connect",this.id),this.connectSession=yield w.connect(this.id),!this.connectSession)break;let t=yield m.default.getWindowHandle(),i=yield this.callReply("CreateAPlayer",t);if(!i||!i[0]||!i[1]){T.error("CreateAPlayer failed! createResult:",i);break}this.aplayerWnd=i[1],this.initAPlayerConfig().catch(),this.registerInterfaces(),this.onDisconnectListener=w.attachDisconnectListener(this.connectSession,this.onDisconnect.bind(this)),e=!0,T.information("CreateAPlayer success. createResult:",i,this.id)}while(0);return e})}destroyAPlayer(){do{if(!this.connectSession){T.warning("destroyAPlayer failed,not connectSession",this.id);break}this.onDisconnectListener&&(w.detachListener(E.onDisconnect,this.onDisconnectListener),this.onDisconnectListener=null),w.disconnect(this.connectSession),this.connectSession=null,this.aplayerWnd=void 0,T.information("destroyAPlayer succ",this.id)}while(0)}getAPlayerWnd(){return this.aplayerWnd}open(e){return n(this,void 0,void 0,function*(){let t=(new Date).getTime();g.client.callRemoteClientFunction(C.mainRendererContext,S.XmpPlayerFunction.recordStat,"setBeforeOpenTime",t).catch(),this.stop=!1;let i=yield this.callReply("Open",e);if(i)return i[1]})}openEx(e){return n(this,void 0,void 0,function*(){return yield this.open(e),this.waitingOpenSucced()})}close(){return n(this,void 0,void 0,function*(){this.stop=!0;let e=yield this.callReply("Close");if(e)return e[1]})}closeEx(){return n(this,void 0,void 0,function*(){return yield this.close(),this.waitingForClosed()})}play(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("Play");if(e)return e[1]})}pause(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("Pause");if(e)return e[1]})}getVersion(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("GetVersion");if(e)return e[1]})}setCustomLogo(e){return n(this,void 0,void 0,function*(){let t=yield this.callReply("SetCustomLogo",e);if(t)return t[1]})}getState(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("GetState");if(e)return e[1]})}getDuration(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("GetDuration");if(e)return e[1]})}getPosition(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("GetPosition");if(e)return e[1]})}setPosition(e){return n(this,void 0,void 0,function*(){let t=yield this.callReply("SetPosition",e);if(t)return t[1]})}getVideoWidth(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("GetVideoWidth");if(e)return e[1]})}getVideoHeight(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("GetVideoHeight");if(e)return e[1]})}getVolume(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("GetVolume");if(e)return e[1]})}setVolume(e){return n(this,void 0,void 0,function*(){let t=yield this.callReply("SetVolume",e);if(t)return t[1]})}isSeeking(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("IsSeeking");if(e)return e[1]})}getBufferProgress(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("GetBufferProgress");if(e)return e[1]})}getConfig(e){return n(this,void 0,void 0,function*(){let t=yield this.callReply("GetConfig",e);if(t)return t[1]})}setConfig(e,t){return n(this,void 0,void 0,function*(){let i=yield this.callReply("SetConfig",e,t);if(i)return i[1]})}getHostWnd(){return n(this,void 0,void 0,function*(){let e=yield this.callReply("GetHostWnd");if(e)return e[1]})}addWindowMessageFilter(e){return this.call("AddWindowMessageFilter",e)}removeWindowMessageFilter(e){return this.call("RemoveWindowMessageFilter",e)}clearWindowMessageFilter(){return this.call("ClearWindowMessageFilter")}setChangeViewSize(e){return this.call("SetChangeViewSize",e)}setWindowResizeRect(e){return this.call("SetWindowResizeRect",e)}setWindowCaptionMove(e){return this.call("SetWindowCaptionMove",e)}setMainWnd(e){return this.call("SetMainWnd",e)}waitingForClosed(e){return n(this,void 0,void 0,function*(){return!!this.event&&new Promise(t=>{let i=!1,o=null,r=(e,n)=>{i||e===f.XmpMediaState.Closeing&&n===f.XmpMediaState.Ready&&(o&&clearTimeout(o),this.event.detachListener(p.XmpEvent.onStateChanged,r),i=!0,t(!0))};(()=>n(this,void 0,void 0,function*(){(yield this.getState())===f.XmpMediaState.Ready?t(!0):(this.event.attachListener(p.XmpEvent.onStateChanged,r),e||(e=1e4),o=setTimeout(()=>{i||(i=!0,this.event.detachListener(p.XmpEvent.onStateChanged,r),t(!1))},e))}))().catch()})})}waitingOpenSucced(e){return n(this,void 0,void 0,function*(){return!!this.event&&new Promise(t=>{let i=!1,o=void 0,r=null,a=null,s=null;r=(()=>{i||(i=!0,o=!0,s&&clearTimeout(s),this.event.detachListener(p.XmpEvent.onOpenFailed,a),t(o))}),a=(()=>{i||(i=!0,o=!1,s&&clearTimeout(s),this.event.detachListener(p.XmpEvent.onOpenSucceeded,r),t(o))}),(()=>n(this,void 0,void 0,function*(){let n=yield this.getState();n===f.XmpMediaState.Play||n===f.XmpMediaState.Playing?t(!0):(this.event.attachOnceListener(p.XmpEvent.onOpenSucceeded,r),this.event.attachOnceListener(p.XmpEvent.onOpenFailed,a),e||(e=1e4),s=setTimeout(()=>{i||(i=!0,o=!1,this.event.detachListener(p.XmpEvent.onOpenFailed,a),this.event.detachListener(p.XmpEvent.onOpenSucceeded,r),t(o))},e))}))().catch()})})}waitingSeekCompletedEvent(e,t){return n(this,void 0,void 0,function*(){return!!this.event&&new Promise(i=>n(this,void 0,void 0,function*(){let n=null,o=()=>{n&&(clearTimeout(n),n=null),i(!0)};this.event.attachOnceListener(p.XmpEvent.onSeekCompleted,o),t||(t=1e4),n=setTimeout(()=>{this.event.detachListener(p.XmpEvent.onSeekCompleted,o),i(!0)},t),yield this.setPosition(e)}))})}waitingSeekCompleted(e,t){return n(this,void 0,void 0,function*(){return!!this.event&&new Promise(i=>n(this,void 0,void 0,function*(){let n=yield this.getConfig(h.APlayerConfigId.CONFIGID_FRAMESDRAWN);this.curFrame=parseInt(n,10),this.setPosition(e).catch();let o=()=>{this.stopFrameQuery=!0,this.event.detachListener(p.XmpEvent.onAplayerSeekFrameChanged,o),this.seekTimeout&&(clearTimeout(this.seekTimeout),this.seekTimeout=null),i(!0)};this.event.attachListener(p.XmpEvent.onAplayerSeekFrameChanged,o),this.stopFrameQuery=!1,this.frameQueryTick().catch(),this.seekTimeout&&(clearTimeout(this.seekTimeout),this.seekTimeout=null),t||(t=1e4),this.seekTimeout=setTimeout(()=>{this.stopFrameQuery=!0,this.event.detachListener(p.XmpEvent.onAplayerSeekFrameChanged,o),i(!0)},t)}))})}frameQueryTick(){return n(this,void 0,void 0,function*(){if(!this.event)return;let e=yield this.getConfig(h.APlayerConfigId.CONFIGID_FRAMESDRAWN),t=parseInt(e,10);this.curFrame!==t?this.event.fireEvent(p.XmpEvent.onAplayerSeekFrameChanged):this.stopFrameQuery||requestAnimationFrame(this.frameQueryTick.bind(this))})}call(e,...t){let i=!1;do{if(!this.connectSession)break;i=0===this.connectSession.call(e,...t)}while(0);return i}callReply(e,...t){return n(this,void 0,void 0,function*(){let i=null;do{if(!this.connectSession)break;i=yield new Promise(i=>{0!==this.connectSession.callReply(e,...t,(e,...t)=>{i(t)})&&i(null)})}while(0);return i})}onDisconnect(){T.error("XmpPlayerIPC onDisconnect"),this.connectSession=null,this.aplayerWnd=void 0,this.fireEvent(b.onCrash)}setCodecsPath(){return n(this,void 0,void 0,function*(){let e=yield u.XmpUtilityNS.getXmpCodecsPath();(yield c.FileSystemAWNS.existsAW(e))||(yield c.FileSystemAWNS.mkdirAW(e)),T.information("[TestCodec] 解码器路径:",e),yield this.callReply("SetConfig",h.APlayerConfigId.CONFIGID_CODECSPATH,e)})}initAPlayerConfig(){return n(this,void 0,void 0,function*(){do{if(!this.connectSession)break;yield Promise.all([this.setCodecsPath()])}while(0)})}registerInterfaces(){do{if(!this.connectSession)break;this.connectSession.registerInterfaces([{name:"OnStateChanged",func:this.onStateChanged.bind(this)},{name:"OnWindowMessage",func:this.onWindowMessage.bind(this)},{name:"OnOpenSucceeded",func:this.onOpenSucceeded.bind(this)},{name:"OnSeekCompleted",func:this.onSeekCompleted.bind(this)},{name:"OnBuffer",func:this.onBuffer.bind(this)},{name:"OnVideoSizeChanged",func:this.onVideoSizeChanged.bind(this)},{name:"OnDownloadCodec",func:this.onDownloadCodec.bind(this)},{name:"OnEvent",func:this.onEvent.bind(this)},{name:"OnDropFiles",func:this.onDropFiles.bind(this)}])}while(0)}onStateChanged(e,t,i){T.information("onStateChanged",t,i),this.event.fireXmpPlayerEvent(p.XmpEvent.onStateChanged,t,i)}onWindowMessage(e,t,i,n){512!==t&&T.information("onWindowMessage",t,i,n),this.event.fireXmpPlayerEvent(p.XmpEvent.onWindowMessage,t,i,n)}onOpenSucceeded(e){T.information("onOpenSucceeded"),this.event.fireXmpPlayerEvent(p.XmpEvent.onOpenSucceeded)}onSeekCompleted(e,t){T.information("onSeekCompleted",t),this.event.fireXmpPlayerEvent(p.XmpEvent.onSeekCompleted,t)}onBuffer(e,t){T.information("onBuffer",t),this.event.fireXmpPlayerEvent(p.XmpEvent.onBuffer,t)}onVideoSizeChanged(e){T.information("onVideoSizeChanged"),this.event.fireXmpPlayerEvent(p.XmpEvent.onVideoSizeChanged)}onEvent(e,t,i){T.information("onEvent",t,i),this.event.fireXmpPlayerEvent(p.XmpEvent.onEvent,t,i)}onDropFiles(e,t){T.information("onDropFiles",t),this.event.fireXmpPlayerEvent(p.XmpEvent.onDropFiles,t)}onDownloadCodec(e,t){return n(this,void 0,void 0,function*(){if(T.information("onDownloadCodec codecsPath",t,"stop",this.stop),this.stop){let e=(new Date).getTime()-this.startTime,i=r.basename(t);yield this.decoderDownloadRes(i,!1,e)}else this.cacheDownloadCodceInfo.downloading=!0,this.event.fireXmpPlayerEvent(p.XmpEvent.onDownloadCodec,t),yield this.setConfig(h.APlayerConfigId.CONFIGID_DOWNLOADCODECSYNC,"0"),T.information("onDownloadCodec codecsPath",t),yield this.downloadCodecs(t)})}decoderStartDownload(e){let t="decoder_name="+e;T.information("[发送统计] complement_decoder_download_start extData:",t)}decoderDownloadRes(e,t,i){return n(this,void 0,void 0,function*(){let n="decoder_name="+e+",result="+(t?"succ":"fail")+",time="+i;yield g.client.callServerFunction("TrackEvent","core_event","complement_decoder_download_result","",0,0,0,0,n),T.information("[发送统计] complement_decoder_download_result extData:",n)})}getCodecsUrl(e){let t="",i=e.match("codecs(.+)");return t=(t=i?"https://xmp.down.sandai.net/xmp/codecs3"+i[1]:"https://xmp.down.sandai.net/xmp/system32/vista/"+r.basename(e)).replace(/\\/g,"/")}getProgress(e){let t=0,i=e.taskStatus,n=e.fileSize,o=e.downloadSize;return 0!==n&&0!==o&&(i===y.DownloadKernel.TaskStatus.Succeeded||i===y.DownloadKernel.TaskStatus.Seeding||o>=n?t=100:(t=o/n*100,t=parseInt(t.toString(),10))),t}onTaskDetailChanged(e,t,i){return n(this,void 0,void 0,function*(){do{if(!t)return;let e=JSON.parse(t)[this.taskId],i=r.basename(this.filePath);if(!e)return;let n=e.taskId;if(this.taskId!==n)return;let o=this.getProgress(e);this.cacheDownloadCodceInfo.name=i,this.cacheDownloadCodceInfo.progress=o,this.event.fireXmpPlayerEvent(p.XmpEvent.onDownloadCodecProgress,i,o);let a=e.taskStatus;if(a===y.DownloadKernel.TaskStatus.Succeeded||a===y.DownloadKernel.TaskStatus.Seeding){if(this.cacheDownloadCodceInfo.name===i&&(this.cacheDownloadCodceInfo.downloading=!1,this.cacheDownloadCodceInfo.progress=0),yield c.FileSystemAWNS.existsAW(this.savePath)){let e=yield c.FileSystemAWNS.lstatAW(this.savePath),t=r.join(this.filePath,"..");(yield c.FileSystemAWNS.existsAW(t))||(yield c.FileSystemAWNS.mkdirsAW(t)),T.information("savePath",this.savePath,"filePath",this.filePath),e.isDirectory()?yield c.FileSystemAWNS.copyDirsAW(this.savePath,this.filePath):yield c.FileSystemAWNS.copyFileAW(this.savePath,this.filePath)}let e=(new Date).getTime()-this.startTime;yield this.decoderDownloadRes(i,!0,e),setTimeout(()=>{this.setConfig(h.APlayerConfigId.CONFIGID_DOWNLOADCODECCOMPLETED,"1").catch()},500)}break}while(0)})}onTaskStatusChanged(e,t){return n(this,void 0,void 0,function*(){do{let e=JSON.parse(t)[this.taskId];if(!e)return;let i=e.taskId;if(this.taskId!==i)return;let n=e.taskStatus;n===y.DownloadKernel.TaskStatus.Succeeded||y.DownloadKernel.TaskStatus.Seeding;break}while(0)})}asyncDownloadFile(e,t,i,o){return n(this,void 0,void 0,function*(){this.filePath=e,this.savePath=i;let n=r.basename(i),a=r.dirname(e),s="decoder_name="+n;yield g.client.callServerFunction("TrackEvent","core_event","complement_decoder_download_start","",0,0,0,0,s);let l={taskBaseInfo:{savePath:a,taskName:n},p2spTaskInfo:{url:t,useOriginResourceOnly:1},isBackground:o};this.taskId=yield g.client.callServerFunction("CreateTask",y.DownloadKernel.TaskType.P2sp,l);let d=yield g.client.callServerFunction("StartTask",this.taskId);return T.information("taskId",this.taskId,"StartTask ret",d),d})}downloadCodecs(e){return n(this,void 0,void 0,function*(){T.information("downloadCodecs filePath=",e);let t=!1,i=this.getCodecsUrl(e),n=this.getDownloadCodecsSavePath(e),o=r.basename(e);return this.decoderStartDownload(o),this.startTime=(new Date).getTime(),this.cacheDownloadCodceInfo.name=o,this.cacheDownloadCodceInfo.progress=0,this.event.fireXmpPlayerEvent(p.XmpEvent.onDownloadCodecProgress,o,0),(yield c.FileSystemAWNS.existsAW(n))&&(yield c.FileSystemAWNS.unlinkAW(n)),t=yield this.asyncDownloadFile(e,i,n,!0)})}getDownloadCodecsSavePath(e){let t="",i=e.match("codecs(.+)");if(i)t=r.join(o.tmpdir(),"Xmp\\Codecs",i[1]);else{let i=r.basename(e);t=r.join(o.tmpdir(),"Xmp\\System32",i)}return t}cancelDownloadCodecs(){return n(this,void 0,void 0,function*(){return g.client.callServerFunction("DeleteTask",this.taskId,!0)})}},t.stopServer=function(){return n(this,void 0,void 0,function*(){w.stopServer()})}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XLIPCManagerNS=void 0;const n=i(1),o=i(9).default(n.join(__rootDir,"../bin/ThunderHelper.node"));!function(e){class t{constructor(){this.xlipcFactory=null}getFactory(){return this.xlipcFactory||(this.xlipcFactory=o.xlipcFactory),this.xlipcFactory}}e.Manager=t;let i=null;e.getManager=function(){return i||(i=new t),i},e.xlipcXmpPlayerId="XmplitePlayer"}(t.XLIPCManagerNS||(t.XLIPCManagerNS={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModeEvent=void 0;const n=i(24),o=i(5);t.ModeEvent=class extends n.default{constructor(){super()}fireModeEvent(e,...t){this.fireEvent(e,...t),this.fireEvent(o.XmpEvent.onModeEvent,e,...t)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.MessageBox=void 0;const o=i(19),r=i(28);!function(e){let t;!function(e){e.Info="info",e.Warning="warning",e.Error="error",e.Success="success"}(t=e.ConfirmType||(e.ConfirmType={})),e.confirm=function(e,t={}){return n(this,void 0,void 0,function*(){return e.boxId=String(Math.random()).replace(/\D/,""),o.ipcRenderer.send("xmp-message-box-confirm-create",{dialogConf:t,options:e}),(yield r.electron.ipcMain.__resolve()).once(`xmp-message-box-init-${e.boxId}`,t=>{t.sender.send("xmp-message-box-init-reply",{popType:"confirm",options:e})}),new Promise(t=>n(this,void 0,void 0,function*(){(yield r.electron.ipcMain.__resolve()).once(`xmp-message-box-resolve-${e.boxId}`,(e,i,n)=>{t({action:i,checkboxChecked:n})})}))})},e.pop=function(e,t={}){return n(this,void 0,void 0,function*(){let i=String(Math.random()).replace(/\D/,"");return o.ipcRenderer.send("xmp-message-box-pop-create",{dialogConf:t,boxId:i}),(yield r.electron.ipcMain.__resolve()).once(`xmp-message-box-init-${i}`,t=>{t.sender.send("xmp-message-box-init-reply",{popType:"message-box",options:e})}),new Promise(e=>n(this,void 0,void 0,function*(){(yield r.electron.ipcMain.__resolve()).once(`xmp-message-box-resolve-${i}`,(t,i,n)=>{e({action:i,formData:n})})}))})},e.custom=function(e,t={},i={}){return n(this,void 0,void 0,function*(){let a=String(Math.random()).replace(/\D/,"");return t.boxId=a,o.ipcRenderer.send("xmp-message-box-custom-create",{popType:e,dialogConf:i,boxId:a,options:t}),(yield r.electron.ipcMain.__resolve()).once(`xmp-message-box-init-${a}`,n=>{n.sender.send("xmp-message-box-init-reply",{popType:e,options:t,dialogConf:i})}),new Promise(e=>n(this,void 0,void 0,function*(){(yield r.electron.ipcMain.__resolve()).once(`xmp-message-box-resolve-${a}`,(t,i,n)=>{e({action:i,args:n})})}))})}}(t.MessageBox||(t.MessageBox={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.XLStatNS=void 0;const o=i(1),r=i(9),a=i(0).default.getLogger("XLStat");let s=r.default(o.join(__rootDir,"../bin/ThunderHelper.node"));function l(e=""){let t;if("string"==typeof e)t=e;else if(d(e)&&"object"==typeof e){let i=[];for(let t in e)d(e[t])&&i.push(t+"="+encodeURIComponent(e[t]));t=i.join(",")}return t}function d(e){return void 0!==e&&null!==e}!function(e){let t=null;function i(){return t||(t=s.xlstat4),t}function o(e,t=0){do{if(void 0===e)break;"browser"!==process.type&&i().trackClick(e,t)}while(0)}e.asyncTrackEvent=function(e,t="",o="",r=0,s=0,d=0,u=0,c="",h=0){return n(this,void 0,void 0,function*(){let n=0;do{if(void 0===e){n=1;break}let p=l(c);n="browser"===process.type?yield new Promise(a=>{n=i().asyncTrackEvent(e,t,o,r,s,d,u,p,h,e=>{a(e)})}):i().trackEvent(e,t,o,r,s,d,u,p,h),a.information(e,t,o,r,s,d,u,p,h)}while(0);return n})},e.trackEvent=function(e,t="",i="",n=0,o=0,r=0,a=0,s="",l=0){},e.trackClick=o,e.trackShow=function(e,t=0){o(e,t)},e.setUserID=function(e=0,t=0){"browser"!==process.type&&i().setUserID(e,t)},e.initParam=function(e){return n(this,void 0,void 0,function*(){let t=-1;return t="browser"===process.type?yield new Promise(t=>{i().asyncInitParam(e,(e,i)=>{t(e?i:-1)})}):yield new Promise(t=>{i().initParamRemote(e,e=>{t(e)})})})},e.asyncUninit=function(e){return n(this,void 0,void 0,function*(){"browser"===process.type?yield new Promise(t=>{i().asyncUninit(e,()=>{t()})}):yield new Promise(t=>{i().uninitRemote(e,()=>{t()})})})},e.uninit=function(){"browser"===process.type&&i().waitFinish()}}(t.XLStatNS||(t.XLStatNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.EmbedSubtitle=void 0;const o=i(21),r=i(38),a=i(0).default.getLogger("Subtitle.Embed");class s extends r.LocalSubtitle{constructor(e,t,i){super(e,".",i),this.initLanguageList(t).catch()}getType(){return o.SubtitleType.Embed}initLanguageList(e){return n(this,void 0,void 0,function*(){do{if(a.information("initLanguageList:",e),!e||e.length<=0)break;let t=[],i=(e+";").split(";");a.information("initLanguageList languages:",i);for(let e=0;e<i.length;++e){let n=i[e];0!==n.length&&t.push(n)}this.setLanguageList(t)}while(0)})}clone(e){return new s(this.subtitleManager,this.languageList.join(";"),e)}}t.EmbedSubtitle=s},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.Subtitle=void 0;const o=i(4),r=i(7),a=i(11),s=i(21),l=i(0),d=i(15),u=i(17),c=l.default.getLogger("Subtitle.Base"),h=r.XmpMediaManagerNS.getXmpMediaManager().getXmpPlayer();t.Subtitle=class{constructor(e,t){this.subtitleManager=null,this.path=void 0,this.languageList=[],this.currentLanguageIndex=0,this.secondSubtitle=!1,this.loadTimeStamp=0,this.realShowTime=0,this.subtitleManager=e,this.secondSubtitle=!!t}getType(){return s.SubtitleType.None}isSecondSubtitle(){return this.secondSubtitle}load(e){return n(this,void 0,void 0,function*(){return!1})}getPath(){return this.path}getLanguageList(){return this.languageList}getLoadTimeStamp(){return this.loadTimeStamp}getRealShowTime(){return this.realShowTime}updateShowTime(){this.realShowTime++}resetData(){this.realShowTime=0}setLanguageList(e){this.languageList=e}getLanguageCount(){return this.languageList?this.languageList.length:0}getLanguageByIndex(e){if(!(!this.languageList||e<0||e>=this.languageList.length))return this.languageList[e]}setLanguageIndex(e){return n(this,void 0,void 0,function*(){let t=!1;do{if(!this.languageList||e<0||e>=this.languageList.length)break;let i=h.getCurrentMedia();if(!i)break;this.currentLanguageIndex!==e&&(this.currentLanguageIndex=e,this.isSecondSubtitle()?i.setXmpMediaAttribute(o.XmpMediaAttr.Subtitle2Language,e):i.setXmpMediaAttribute(o.XmpMediaAttr.SubtitleLanguage,e)),c.information("load language index:",e),this.isSecondSubtitle()||(yield this.subtitleManager.isSettingDefaultSecondSubtitle())?yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLE2LANGUAGECURRENT,e.toString()):yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLELANGUAGECURRENT,e.toString()),t=!0}while(0);return t})}getLanguageIndex(){return this.currentLanguageIndex}getPosition(){return n(this,void 0,void 0,function*(){let e=95,t=h.getCurrentMedia();do{if(!t)break;e=d.ConfigNS.getValue(u.ConfigDefineNS.playSettingAll.section,u.ConfigDefineNS.playSettingAll.key,u.ConfigDefineNS.playSettingAll.value)?this.isSecondSubtitle()?d.ConfigNS.getValue(u.ConfigDefineNS.position2.section,u.ConfigDefineNS.position2.key,u.ConfigDefineNS.position2.value):d.ConfigNS.getValue(u.ConfigDefineNS.position.section,u.ConfigDefineNS.position.key,u.ConfigDefineNS.position.value):this.isSecondSubtitle()?t.getXmpMediaAttribute(o.XmpMediaAttr.Subtitle2Position):t.getXmpMediaAttribute(o.XmpMediaAttr.SubtitlePosition)}while(0);return null!==e&&void 0!==e||(e=100),e})}getSize(){return n(this,void 0,void 0,function*(){let e=void 0,t=h.getCurrentMedia();do{if(!t)break;e=d.ConfigNS.getValue(u.ConfigDefineNS.playSettingAll.section,u.ConfigDefineNS.playSettingAll.key,u.ConfigDefineNS.playSettingAll.value)?this.isSecondSubtitle()?d.ConfigNS.getValue(u.ConfigDefineNS.size2.section,u.ConfigDefineNS.size2.key,u.ConfigDefineNS.size2.value):d.ConfigNS.getValue(u.ConfigDefineNS.size.section,u.ConfigDefineNS.size.key,u.ConfigDefineNS.size.value):this.isSecondSubtitle()?t.getXmpMediaAttribute(o.XmpMediaAttr.Subtitle2Size):t.getXmpMediaAttribute(o.XmpMediaAttr.SubtitleSize)}while(0);return e})}getColor(){return n(this,void 0,void 0,function*(){let e=void 0,t=h.getCurrentMedia();do{if(!t)break;e=d.ConfigNS.getValue(u.ConfigDefineNS.playSettingAll.section,u.ConfigDefineNS.playSettingAll.key,u.ConfigDefineNS.playSettingAll.value)?this.isSecondSubtitle()?d.ConfigNS.getValue(u.ConfigDefineNS.color2.section,u.ConfigDefineNS.color2.key,u.ConfigDefineNS.color2.value):d.ConfigNS.getValue(u.ConfigDefineNS.color.section,u.ConfigDefineNS.color.key,u.ConfigDefineNS.color.value):this.isSecondSubtitle()?t.getXmpMediaAttribute(o.XmpMediaAttr.Subtitle2Color):t.getXmpMediaAttribute(o.XmpMediaAttr.SubtitleColor)}while(0);return e})}getFont(){return n(this,void 0,void 0,function*(){let e=void 0,t=h.getCurrentMedia();do{if(!t)break;e=d.ConfigNS.getValue(u.ConfigDefineNS.playSettingAll.section,u.ConfigDefineNS.playSettingAll.key,u.ConfigDefineNS.playSettingAll.value)?this.isSecondSubtitle()?d.ConfigNS.getValue(u.ConfigDefineNS.font2.section,u.ConfigDefineNS.font2.key,u.ConfigDefineNS.font2.value):d.ConfigNS.getValue(u.ConfigDefineNS.font.section,u.ConfigDefineNS.font.key,u.ConfigDefineNS.font.value):this.isSecondSubtitle()?t.getXmpMediaAttribute(o.XmpMediaAttr.Subtitle2Font):t.getXmpMediaAttribute(o.XmpMediaAttr.SubtitleFont)}while(0);return e})}setPosition(e){return n(this,void 0,void 0,function*(){this.isSecondSubtitle()||(yield this.subtitleManager.isSettingDefaultSecondSubtitle())?yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLE2PLACEMENT,"1;50;"+e):yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLEPLACEMENT,"1;50;"+e)})}setFontStyle(e,t,i){return n(this,void 0,void 0,function*(){do{if(void 0===e&&void 0===t&&void 0===i){this.isSecondSubtitle()||(yield this.subtitleManager.isSettingDefaultSecondSubtitle())?yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLE2FONT,""):yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLEFONT,"");break}i||(i="默认"),t||(t="FFFFFFFF"),e||(e=16);let n=parseInt(t,16).toString(),o=i+";"+e.toString()+";"+n+";0";c.information("Subtitle SetConfig 508 fontConfig:",o),this.isSecondSubtitle()||(yield this.subtitleManager.isSettingDefaultSecondSubtitle())?yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLE2FONT,o):yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLEFONT,o)}while(0)})}setTimming(){return n(this,void 0,void 0,function*(){do{let e=h.getCurrentMedia();if(!e)break;let t=0,i=(t=this.isSecondSubtitle()?e.getXmpMediaAttribute(o.XmpMediaAttr.Subtitle2Timming):e.getXmpMediaAttribute(o.XmpMediaAttr.SubtitleTimming)).toString()+";1000;1000";this.isSecondSubtitle()||(yield this.subtitleManager.isSettingDefaultSecondSubtitle())?yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLE2TIMING,i):yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLETIMING,i)}while(0)})}set3DMode(){return n(this,void 0,void 0,function*(){do{let e=h.getCurrentMedia();if(!e)break;let t=0;t=this.isSecondSubtitle()?e.getXmpMediaAttribute(o.XmpMediaAttr.Subtitle23D):e.getXmpMediaAttribute(o.XmpMediaAttr.Subtitle3D),c.information("set3DMode:",t),this.isSecondSubtitle()||(yield this.subtitleManager.isSettingDefaultSecondSubtitle())?yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLE23D,t.toString()):yield h.setConfig(a.APlayerConfigId.CONFIGID_SUBTITLE3D,t.toString())}while(0)})}isShow(){return n(this,void 0,void 0,function*(){return this.isSecondSubtitle()||(yield this.subtitleManager.isSettingDefaultSecondSubtitle())?"0"!==(yield h.getConfig(a.APlayerConfigId.CONFIGID_SUBTITLE2SHOW)):"0"!==(yield h.getConfig(a.APlayerConfigId.CONFIGID_SUBTITLESHOW))})}clone(e){return null}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.fetchRequest=t.fetchxl9Res=t.fetchYingShiKuRes=t.fetchAdspRes=t.fetchPCRes=t.fetchSlRes=t.fetchAdspServer=t.fetchFromApiProxy=void 0;const o=i(52),r=i(0),a=i(110),s=i(20),l=i(17),d=i(2),u=i(3),c=r.default.getLogger("FetchRes"),h={mock:"http://easy-mock.com/mock/59f0652c1bd72e7a888988ab/sl",test:"http://test.api-shoulei-ssl.xunlei.com",prod:"http://api-shoulei-ssl.xunlei.com",adsp:"http://api-mcp.adsp.xunlei.com",adsptest:"http://pre-mcp.adsp.xunlei.com",yingshiku:"http://api-yingshiku-ssl.xunlei.com",apixl9:"http://api-xl9-ssl.xunlei.com"};function p({url:e,data:t,method:o="get"},r="prod",l=!0){return n(this,arguments,void 0,function*(){c.information("fetchFromApiProxy",arguments);try{let n=["0","0"];c.information("fetchFromApiProxy login:",l),l&&(n=yield Promise.all([d.client.callServerFunction(u.LoginFunction.getUserID),d.client.callServerFunction(u.LoginFunction.getSessionID)])),c.information("fetchFromApiProxy login finish");let h=yield d.client.callServerFunction(u.XmpPluginFunction.getPeerID);const[p,f]=n;let m={_h:Object.assign({"Account-Id":p,"Peer-Id":h,"User-Id":p,"Session-Id":f,"App-Type":"pc_xmp"},t&&t._h||{})},g=[];g.push("accesskey=pc.xmp","nonce="+Math.floor(99999999*Math.random()).toString(),"timestamp="+Math.floor((new Date).getTime()/1e3).toString()),Object.assign(g,t&&t._h||[]),t&&t._h&&delete t._h;let S={};"get"===o&&(S=t,t=null);for(let e in S)s.isObject(S[e])||g.push(e+"="+S[e]);g.sort();let y=encodeURIComponent(e),C=o.toUpperCase()+"&"+y+"&",I="";for(let e=0;e<g.length-1;++e)I+=g[e]+"&";I+=g[g.length-1];let v=C+(I=encodeURIComponent(I));!t||"post"!==o&&"put"!==o||(v+="%26"+JSON.stringify(t)),c.information("message: ",v);let T,E=Buffer.alloc(v.length);E.write(v),T="test"===r?"c9879c94a55474304cca0abafb867653":"89917368930f3fea5bafebe704d6b623";let b=a.ToolsUtilitiesAWNS.encryptHmacBuffer("sha1",T,E,"base64");b=(b=b.replace(/\+/g,"-")).replace(/\//g,"_"),g.push("sig="+b);let P=e+"?";for(let e=0;e<g.length-1;++e)P+=g[e]+"&";P+=g[g.length-1],c.information("fetchFromApiProxy method",o,", uri",P,", extraParams",S,", data",t,", headers",m._h);const w=yield i(26);return w.defaults.adapter=i(32),"post"===o&&(w.defaults.headers["Content-Type"]="application/json"),w.request({method:o,url:P,extraParams:S,data:t,headers:m._h}).then(e=>(c.information("fetchFromApiProxy success",e),e)).catch(e=>(c.information("fetchFromApiProxy failed",e),{error:e}))}catch(e){return{error:e}}})}function f({url:e,data:t,method:i="get",contentType:r},p="prod",f=!0){return n(this,void 0,void 0,function*(){c.information("fetchAdspServer login:",f);let i=yield d.client.callServerFunction(u.XmpPluginFunction.getPeerID);s.isObject(t)&&(t.appId=1008,t.deviceId=i,f&&(t.userId=yield d.client.callServerFunction(u.LoginFunction.getUserID))),t.sig=function(e){let t=[];for(const i in e)e.hasOwnProperty(i)&&t.push(i+"="+e[i]);c.information("sign obj:",t),t.sort();let i="";for(const e in t)t.hasOwnProperty(e)&&(c.information("sign key:",e," value:",t[e]),i+=t[e]);return c.information("sign before ：",i),i+="d025b6ee269a7b9f55862f5eeb1bec29",a.ToolsUtilitiesAWNS.genarateMd5(i)}(t);let n=h.adsp,p=yield o.ConfigHelperNS.getValue(l.ConfigDefineNS.configOtherSection,l.ConfigDefineNS.otherKey.testServer,l.ConfigDefineNS.otherValue.testServer);return c.information("是否测试: testServ:",p," type: ",typeof p),1===p&&(n=h.adsptest),g({url:n+e,data:t,method:"get",contentType:r})})}function m({url:e,data:t,method:i="get"},r="prod",a=!0){return n(this,void 0,void 0,function*(){let n=h[r];c.information("remoteURL:",n);let s=yield o.ConfigHelperNS.getValue(l.ConfigDefineNS.configOtherSection,l.ConfigDefineNS.otherKey.testServer,l.ConfigDefineNS.otherValue.testServer);return 1===s&&(n=h.test),c.information("当前fetchSlRes 是否测试服:",s," 远程地址:",n),p({url:`${n}${e}`,data:t,method:i},r,a)})}function g({url:e,data:t,method:o="get",contentType:r}){return n(this,arguments,void 0,function*(){c.information("fetchRequest",arguments);try{const n=yield i(26);return n.defaults.adapter=i(32),"post"===o&&(n.defaults.headers["Content-Type"]="application/json"),r&&(n.defaults.headers["Content-Type"]=r),n.request({method:o,url:e,params:"get"===o&&t?t:{},data:"post"===o&&t?t:{}}).then(e=>(c.information("fetchRequest success",e),e)).catch(e=>(c.information("fetchRequest fail",e),{error:e}))}catch(e){return{error:e}}})}t.fetchFromApiProxy=p,t.fetchAdspServer=f,t.fetchSlRes=m,t.fetchPCRes=function({url:e,data:t,method:i="get"},o="prod"){return n(this,void 0,void 0,function*(){return m({url:e,data:t,method:i},o)})},t.fetchAdspRes=function({url:e,data:t,method:i="get",contentType:o},r="adsp",a=!0){return n(this,void 0,void 0,function*(){return f({url:e,data:t,method:i,contentType:o},r,a)})},t.fetchYingShiKuRes=function({url:e,data:t,method:i="get"},o="yingshiku"){return n(this,void 0,void 0,function*(){let n=yield d.client.callServerFunction(u.XmpPluginFunction.getPeerID);return s.isObject(t)&&(t.deviceid=n),g({url:`${h.yingshiku}${e}`,data:t,method:i})})},t.fetchxl9Res=function({url:e,data:t,method:i="get"},o="apixl9"){return n(this,void 0,void 0,function*(){return g({url:`${h[o]}${e}`,data:t,method:i})})},t.fetchRequest=g},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.ToolsUtilitiesAWNS=void 0;const o=i(66),r=i(23),a=i(13),s=i(0).default.getLogger("Thunder.base.tools-utilities");!function(e){function t(e){return n(this,void 0,void 0,function*(){let t;if(e&&(yield a.FileSystemAWNS.existsAW(e))){let i=r.createReadStream(e),n=o.createHash("md5");i.on("data",e=>{n.update(e)}),t=new Promise(e=>{i.on("end",()=>{let t=n.digest("hex");t=t.toUpperCase(),e(t)})})}else t=new Promise(e=>{e(void 0)});return t})}e.genarateMd5=function(e){let t=void 0,i=o.createHash("md5");return null!==i&&(t=i.update(e).digest("hex")),t},e.matchFileMd5=function(e,i){return n(this,void 0,void 0,function*(){let n=!1,o=yield t(e);return void 0!==o&&o===i.toUpperCase()&&(s.information("check full md5 sucessful"),n=!0),n})},e.calculateFileMd5=t,e.encryptBuffer=function(e,t){let i=null;try{let n=o.createCipheriv("aes-128-ecb",t,""),r=n.update(e),a=n.final();i=Buffer.concat([r,a])}catch(e){s.error("encryptBuffer",e)}return i},e.encryptSha1Buffer=function(e){let t=null;try{t=o.createHash("sha1").update(e).digest("hex")}catch(e){s.error("encryptSha1Buffer",e)}return t},e.decryptBuffer=function(e,t){let i=null;try{let n=o.createDecipheriv("aes-128-ecb",t,""),r=n.update(e),a=n.final();i=Buffer.concat([r,a])}catch(e){s.error("decryptBuffer",e)}return i},e.encryptHmacBuffer=function(e,t,i,n="hex"){let r=null;try{r=o.createHmac(e,t).update(i).digest(n)}catch(e){s.error("encryptSha1Buffer",e)}return r},e.setForegroundWindow=function(e,t){return n(this,void 0,void 0,function*(){if(null!==e&&null!==t){let i=(yield t.getNativeWindowHandle()).readUIntLE(0,4);e.setForegroundWindow(i)?s.information("sucessful"):s.information("failed")}})},e.setForegroundWindowMain=function(e,t){if(null!==e&&null!==t){let i=t.getNativeWindowHandle().readUIntLE(0,4);e.setForegroundWindow(i)?s.information("sucessful"):s.information("failed")}},e.getOSVersion=function(e){let t="other";if(null===e||void 0===e)return t;let i=e.getOSVersion().split(".");return i&&i.length>0&&(t="5"===i[0]?"xp":"6"===i[0]&&"0"===i[1]?"vista":"6"===i[0]&&"1"===i[1]?"win7":"6"===i[0]&&"2"===i[1]?"win8":"6"===i[0]&&"3"===i[1]?"win8.1":"10"===i[0]&&"0"===i[1]?"win10":"other"),t},e.isWin10OrGreater=function(e){let t=!1;if(null===e||void 0===e)return t;let i=e.getOSVersion().split(".");return i&&i.length>0&&parseInt(i[0],10)>=10&&(t=!0),t}}(t.ToolsUtilitiesAWNS||(t.ToolsUtilitiesAWNS={}))},function(e,t,i){"use strict";var n=i(14),o=i(67),r=i(113),a=i(47);function s(e){var t=new r(e),i=o(r.prototype.request,t);return n.extend(i,r.prototype,t),n.extend(i,t),i}var l=s(a);l.Axios=r,l.create=function(e){return s(n.merge(a,e))},l.Cancel=i(70),l.CancelToken=i(126),l.isCancel=i(69),l.all=function(e){return Promise.all(e)},l.spread=i(127),e.exports=l,e.exports.default=l},function(e,t){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,i){"use strict";var n=i(47),o=i(14),r=i(121),a=i(122);function s(e){this.defaults=e,this.interceptors={request:new r,response:new r}}s.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),(e=o.merge(n,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[a,void 0],i=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)i=i.then(t.shift(),t.shift());return i},o.forEach(["delete","get","head","options"],function(e){s.prototype[e]=function(t,i){return this.request(o.merge(i||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){s.prototype[e]=function(t,i,n){return this.request(o.merge(n||{},{method:e,url:t,data:i}))}}),e.exports=s},function(e,t,i){"use strict";var n=i(14);e.exports=function(e,t){n.forEach(e,function(i,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=i,delete e[n])})}},function(e,t,i){"use strict";var n=i(68);e.exports=function(e,t,i){var o=i.config.validateStatus;i.status&&o&&!o(i.status)?t(n("Request failed with status code "+i.status,i.config,null,i.request,i)):e(i)}},function(e,t,i){"use strict";e.exports=function(e,t,i,n,o){return e.config=t,i&&(e.code=i),e.request=n,e.response=o,e}},function(e,t,i){"use strict";var n=i(14);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,i){if(!t)return e;var r;if(i)r=i(t);else if(n.isURLSearchParams(t))r=t.toString();else{var a=[];n.forEach(t,function(e,t){null!==e&&void 0!==e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(o(t)+"="+o(e))}))}),r=a.join("&")}return r&&(e+=(-1===e.indexOf("?")?"?":"&")+r),e}},function(e,t,i){"use strict";var n=i(14),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,i,r,a={};return e?(n.forEach(e.split("\n"),function(e){if(r=e.indexOf(":"),t=n.trim(e.substr(0,r)).toLowerCase(),i=n.trim(e.substr(r+1)),t){if(a[t]&&o.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([i]):a[t]?a[t]+", "+i:i}}),a):a}},function(e,t,i){"use strict";var n=i(14);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");function o(e){var n=e;return t&&(i.setAttribute("href",n),n=i.href),i.setAttribute("href",n),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}return e=o(window.location.href),function(t){var i=n.isString(t)?o(t):t;return i.protocol===e.protocol&&i.host===e.host}}():function(){return!0}},function(e,t,i){"use strict";var n=i(14);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,i,o,r,a){var s=[];s.push(e+"="+encodeURIComponent(t)),n.isNumber(i)&&s.push("expires="+new Date(i).toGMTString()),n.isString(o)&&s.push("path="+o),n.isString(r)&&s.push("domain="+r),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,i){"use strict";var n=i(14);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){n.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=o},function(e,t,i){"use strict";var n=i(14),o=i(123),r=i(69),a=i(47),s=i(124),l=i(125);function d(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return d(e),e.baseURL&&!s(e.url)&&(e.url=l(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||a.adapter)(e).then(function(t){return d(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return r(t)||(d(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,i){"use strict";var n=i(14);e.exports=function(e,t,i){return n.forEach(i,function(i){e=i(e,t)}),e}},function(e,t,i){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,i){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,i){"use strict";var n=i(70);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var i=this;e(function(e){i.reason||(i.reason=new n(e),t(i.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o(function(t){e=t}),cancel:e}},e.exports=o},function(e,t,i){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ManualSubtitle=void 0;const n=i(21),o=i(38),r=i(0).default.getLogger("Subtitle.Manual");class a extends o.LocalSubtitle{constructor(e,t,i){r.information("ManualSubtitle constructor"),super(e,t,i)}getType(){return n.SubtitleType.Manual}clone(e){return new a(this.subtitleManager,this.path,e)}}t.ManualSubtitle=a},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.OnlineSubtitle=void 0;const o=i(4),r=i(7),a=i(21),s=i(38),l=i(16),d=i(13),u=i(1),c=i(130),h=i(0).default.getLogger("Subtitle.Online"),p=r.XmpMediaManagerNS.getXmpMediaManager().getXmpPlayer();class f extends s.LocalSubtitle{constructor(e,t,i){super(e,t,i),this.attribute=null}getType(){return a.SubtitleType.Online}isAutoLoad(){let e=!1;do{if(!this.attribute)break;e=this.attribute.autoLoad}while(0);return e}setPath(e){this.path=e}setAttribute(e){this.attribute=e}getAttribute(){return this.attribute}load(e){const t=Object.create(null,{load:{get:()=>super.load}});return n(this,void 0,void 0,function*(){h.information("load path:",this.path);let i=!1;do{if(yield d.FileSystemAWNS.existsAW(this.path))h.information("load cached online subtitle, path=",this.path),i=yield t.load.call(this,e);else{if(!this.attribute||!this.attribute.url||this.attribute.url.length<=0)break;let n=this.attribute.url;h.information("下载在线字幕, url = ",n),(yield c.AxiosNS.downloadFileAW(n,this.path))?i=yield t.load.call(this,e):h.information("download subtitle file failed! url: ",n,"path:",this.path)}}while(0);return i})}static getSubInfoIndex(e){let t=0;do{if(1!==e.type)break;for(let i=0;i<e.fileinfo.length;++i){let n=e.fileinfo[i];if("sub"===n.ext||".sub"===n.ext){t=i;break}}}while(0);return t}static query(e,t){return n(this,void 0,void 0,function*(){let i=[];do{let n=t.getXmpMediaAttribute(o.XmpMediaAttr.Cid);h.information("query online subtitle cid:",n);let r=t.getXmpMediaAttribute(o.XmpMediaAttr.Name);if(r&&(r=encodeURI(r)),!n||40!==n.length){h.information("invalid cid:",n);break}let a=u.join(__xmpProfilesDir,"Subtitle/Query/"+n+".json"),s="http://subtitle.kankan.xunlei.com:8000/submatch/"+n.substr(0,2)+"/"+n.substr(-2)+"/"+n+".json?name="+r+"&xmpver="+l.XmpUtilityNS.getXmpBuildNum(),m=yield p.getDuration();m&&(s=s+"&videolength="+m);let g=t.getXmpMediaAttribute(o.XmpMediaAttr.Ext);if(g&&(s=s+"&sext="+g),h.information("QueryOnlineSub savePath:",a,", url:",s),!(yield c.AxiosNS.downloadFileAW(s,a))){h.information("downloadFileAW failed!");break}let S=yield d.FileSystemAWNS.readFileAW(a);if(!S){h.information("readFileAW failed!");break}let y=null;try{y=JSON.parse(S.toString())}catch(e){h.warning(e)}if(h.information("QueryOnlineSub load js file:",a),!y||!y.sublist||y.sublist.length<=0){h.information("get onlineMatchResult failed! onlineMatchResult:",y);break}let C=y.sublist;h.information("QueryOnlineSub return ",C.length," subtitles");let I=u.join(__xmpProfilesDir,"Subtitle\\Query\\"+n+"\\");(yield d.FileSystemAWNS.existsAW(I))||(yield d.FileSystemAWNS.mkdirAW(I));for(let t=0;t<C.length;++t){let n=C[t],o=n.sname;if(!o||o.length>1){h.information("!subNameList || subNameList > 1, not support.",n);continue}let r=o[0];if(l.XmpUtilityNS.isSubtitleFile(r)){let t={autoLoad:y.autoload,type:0,fileinfo:[{cid:n.scid,ext:u.extname(r)}],language:n.language,url:n.surl[0],simility:0,name:u.basename(r),displayname:n.display};h.information("onlineSubtitleAttribute:",t);let o=f.getSubInfoIndex(t),a=t.fileinfo[o].cid,s=t.fileinfo[o].ext,l=u.join(I,a+s),d=new f(e,l);d.setAttribute(t),d.setLanguageList(t.language),i.push(d)}else h.information("isSubtitleFile false, subName:",r)}}while(0);return i})}static search(e,t){return n(this,void 0,void 0,function*(){let i=[];do{h.information("QueryOnlineSub Online Similar Subtitles");let n=t.getXmpMediaAttribute(o.XmpMediaAttr.Cid);h.information("search online subtitle cid:",n);let r=t.getXmpMediaAttribute(o.XmpMediaAttr.Name);r&&(r=encodeURI(r));let a="http://subtitle.kankan.xunlei.com:8000/search.json/mname="+r,s=yield p.getDuration();s&&(a=a+"&videolength="+s);let l=u.join(__xmpProfilesDir,"Subtitle/Search/"+n+".js");if(!(yield c.AxiosNS.downloadFileAW(a,l))){h.information("downloadFileAW failed!");break}let m=yield d.FileSystemAWNS.readFileAW(l);if(!m){h.information("readFileAW failed!");break}let g=null;try{g=JSON.parse(m.toString())}catch(e){h.warning(e)}if(!g||!g.sublist){h.information("search failed! onlineSearchResult:",g);break}let S=g.sublist,y=u.join(__xmpProfilesDir,"Subtitle\\Query\\"+n+"\\");(yield d.FileSystemAWNS.existsAW(y))||(yield d.FileSystemAWNS.mkdirAW(y));for(let t=0;t<S.length;++t){let n=S[t];if(!n.surl)continue;let o={autoLoad:!1,type:0,fileinfo:[{cid:n.scid,ext:"."+n.sext}],language:[n.language],url:n.surl,simility:parseFloat(n.simility),name:n.sname},r=f.getSubInfoIndex(o),a=o.fileinfo[r].cid,s=o.fileinfo[r].ext;s||(s=u.extname(o.url),o.fileinfo[r].ext=s);let l=u.join(y,a+s),d=new f(e,l);d.setAttribute(o),d.setLanguageList(o.language),!isNaN(o.simility)&&o.simility>0&&(o.displayname=t+1+". "+o.name+"  匹配度："+Math.floor(100*o.simility)+"%"),i.push(d)}}while(0);return i})}clone(e){return new f(this.subtitleManager,this.path,e)}}t.OnlineSubtitle=f},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.AxiosNS=void 0;const o=i(45),r=i(1),a=i(13),s=i(0).default.getLogger("Axios.Helper");!function(e){e.getFileSizeWithUrlAW=function(e){return n(this,void 0,void 0,function*(){let t=0;do{let n=o.parse(e);if("https:"!==n.protocol&&"http:"!==n.protocol)break;let r=null;try{r=yield(yield i(26)).get(e,{responseType:"arraybuffer"})}catch(e){s.warning(e)}if(null!==r&&void 0!==r.status&&200===r.status){let e=r.headers["content-length"];void 0!==e&&(t=parseInt(e,10))}}while(0);return t})},e.downloadFileAW=function(e,t){return n(this,void 0,void 0,function*(){let n=!1;do{let o=null;try{o=yield(yield i(26)).get(e,{responseType:"arraybuffer"})}catch(e){s.information(e);break}if(null!==o&&void 0!==o.status&&200===o.status&&void 0!==o.data&&null!==o.data&&""!==o.data){let e=r.dirname(t),i=yield a.FileSystemAWNS.mkdirsAW(e);i&&(i=yield a.FileSystemAWNS.writeFileAW(t,Buffer.from(o.data)))&&(n=!0)}}while(0);return n})}}(t.AxiosNS||(t.AxiosNS={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VipLevel=void 0,function(e){e[e.NonVip=0]="NonVip",e[e.NormalVip=2]="NormalVip",e[e.BJVip=3]="BJVip",e[e.SuperVip=5]="SuperVip"}(t.VipLevel||(t.VipLevel={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.IpcPlayControlNS=void 0;const o=i(8),r=i(20),a=i(5),s=i(3),l=i(0),d=i(7),u=i(2),c=i(4),h=i(11),p=i(16),f=i(15),m=i(17),g=i(71),S=i(37),y=i(10),C=i(6),I=l.default.getLogger("IpcPlayCtrl"),v=d.XmpMediaManagerNS.getXmpMediaManager(),T=v.getXmpPlayer(),E=g.XmpHotKeyManagerNS.getXmpHotKeyManager();!function(e){const t=new class{constructor(){this.isRegister=!1}registerPluginFunction(){if(I.information("registerPluginFunction"),!this.isRegister){this.isRegister=!0;let e={[s.XmpPlayerFunction.openMedia]:this.openMedia.bind(this),[s.XmpPlayerFunction.stop]:this.stop,[s.XmpPlayerFunction.play]:this.play,[s.XmpPlayerFunction.pause]:this.pause,[s.XmpPlayerFunction.close]:this.close,[s.XmpPlayerFunction.showAPlayerWindow]:this.showAPlayerWindow,[s.XmpPlayerFunction.getState]:this.getState,[s.XmpPlayerFunction.isPlaying]:this.isPlaying,[s.XmpPlayerFunction.getDuration]:this.getDuration,[s.XmpPlayerFunction.getPosition]:this.getPosition,[s.XmpPlayerFunction.setPosition]:this.setPosition,[s.XmpPlayerFunction.getVideoWidth]:this.getVideoWidth,[s.XmpPlayerFunction.getVideoHeight]:this.getVideoHeight,[s.XmpPlayerFunction.getVolume]:this.getVolume,[s.XmpPlayerFunction.setVolume]:this.setVolume,[s.XmpPlayerFunction.isSeeking]:this.isSeeking,[s.XmpPlayerFunction.getBufferProgress]:this.getBufferProgress,[s.XmpPlayerFunction.getConfig]:this.getConfig,[s.XmpPlayerFunction.setConfig]:this.setConfig,[s.XmpPlayerFunction.setCurrentMedia]:this.setCurrentMedia,[s.XmpPlayerFunction.getCurrentMedia]:this.getCurrentMedia,[s.XmpPlayerFunction.getMediaAttribute]:this.getMediaAttribute,[s.XmpPlayerFunction.getCurrentMediaAttribute]:this.getCurrentMediaAttribute,[s.XmpPlayerFunction.clearCurrentMedia]:this.clearCurrentMedia,[s.XmpPlayerFunction.getMediasInfo]:this.getMediasInfo,[s.XmpPlayerFunction.setPlayForward]:this.setPlayForward,[s.XmpPlayerFunction.postionChange]:this.postionChange,[s.XmpPlayerFunction.getBufferRange]:this.getBufferRange,[s.XmpPlayerFunction.fireKeyDown]:this.fireKeyDown,[s.XmpPlayerFunction.fireKeyUp]:this.fireKeyUp,[s.XmpPlayerFunction.setVlomue]:this.setVlomue,[s.XmpPlayerFunction.recordStat]:this.recordStat,[s.XmpPlayerFunction.getHostWnd]:this.getHostWnd,[s.XmpPlayerFunction.getVideoDuration]:this.getVideoDuration,[s.XmpPlayerFunction.handleVipPlaySpeed]:this.handleVipPlaySpeed,[s.XmpPlayerFunction.getMediaInfo]:this.getMediaInfo,[s.XmpPlayerFunction.getCurrentMediaInfo]:this.getCurrentMediaInfo,[s.XmpPlayerFunction.setMediaAttribute]:this.setMediaAttribute,[s.XmpPlayerFunction.setPlaySpeed]:this.setPlaySpeed,[s.XmpPlayerFunction.getPlaySpeed]:this.getPlaySpeed,[s.XmpPlayerFunction.getXmpPlayType]:this.getXmpPlayType,[s.XmpPlayerFunction.getDownloadAndPlayTaskData]:this.getDownloadAndPlayTaskData,[s.XmpPlayerFunction.switchSilent]:this.switchSilent,[s.XmpPlayerFunction.isSilent]:this.isSilent,[s.XmpPlayerFunction.cancelDownloadCodecs]:this.cancelDownloadCodecs,[s.XmpPlayerFunction.getCachedDownloadCodecInfo]:this.getCachedDownloadCodecInfo,[s.XmpPlayerFunction.userLogout]:this.userLogout.bind(this),[s.XmpPlayerFunction.getLastPlayError]:this.getLastPlayError.bind(this),[s.XmpPlayerFunction.getMediaById]:this.getMediaById.bind(this),[s.XmpPlayerFunction.setPlayEndInfo]:this.setPlayEndInfo.bind(this)};u.client.registerFunctions(e)}T.attachListener(a.XmpEvent.onXmpPlayerEvent,(e,...t)=>{o.server.fireClientEvent(e,...t)})}stop(e,...t){return n(this,void 0,void 0,function*(){return T.stop()})}play(e,...t){return n(this,void 0,void 0,function*(){return T.play()})}pause(e,...t){return n(this,void 0,void 0,function*(){return T.pause()})}close(e,...t){return n(this,void 0,void 0,function*(){T.clearLastPlayError(),u.client.broadcastEvent(a.XmpEvent.onXmpClose)})}getState(e,...t){return T.getState()}isPlaying(e,...t){let i=T.getState();return!(i<c.XmpMediaState.Pausing||i>c.XmpMediaState.Play)}showAPlayerWindow(e,...t){let i=!0;t&&t.length>0&&(i=t[0]),I.information("showAPlayerWindow",e,i,...t),T.showAPlayerWindow(i)}getDuration(e,...t){return n(this,void 0,void 0,function*(){return yield T.getDuration()})}getPosition(e,...t){return n(this,void 0,void 0,function*(){return T.getPosition()})}setPosition(e,...t){return n(this,void 0,void 0,function*(){if(!r.isNullOrUndefined(t)&&!r.isNullOrUndefined(t[0]))return T.setPosition(t[0])})}getVideoWidth(e,...t){return n(this,void 0,void 0,function*(){return T.getVideoWidth()})}getVideoHeight(e,...t){return n(this,void 0,void 0,function*(){return T.getVideoHeight()})}getVolume(e,...t){return n(this,void 0,void 0,function*(){return T.getVolume()})}setVolume(e,...t){return n(this,void 0,void 0,function*(){if(!r.isNullOrUndefined(t)&&!r.isNullOrUndefined(t[0]))return T.setVolume(t[0])})}isSeeking(e,...t){return n(this,void 0,void 0,function*(){return T.isSeeking()})}getBufferProgress(e,...t){return n(this,void 0,void 0,function*(){return T.getBufferProgress()})}getConfig(e,...t){return n(this,void 0,void 0,function*(){if(!r.isNullOrUndefined(t)&&!r.isNullOrUndefined(t[0]))return T.getConfig(t[0])})}setConfig(e,...t){return n(this,void 0,void 0,function*(){if(!(r.isNullOrUndefined(t)||r.isNullOrUndefined(t[0])||r.isNullOrUndefined(t[1])))return T.setConfig(t[0],t[1])})}setPlayForward(e,...t){return n(this,void 0,void 0,function*(){if(r.isNullOrUndefined(t)||r.isNullOrUndefined(t[0]))return;let e=T.getPosition()+t[0];return e<0&&(e=0),T.setPosition(e)})}postionChange(e,...t){return n(this,void 0,void 0,function*(){if(!(r.isNullOrUndefined(t)||r.isNullOrUndefined(t[0])||r.isNullOrUndefined(t[1])))return T.positionChanged(t[0],t[1],t[2],t[3])})}getHostWnd(e,...t){return n(this,void 0,void 0,function*(){return T.getAPlayerHostWindow()})}recordStat(e,...t){if(r.isNullOrUndefined(t)||r.isNullOrUndefined(t[0]))return;if("string"!=typeof t[0])return;let i=t[1];switch(t[0]){case"recEndType":S.playStat.recEndType(i);break;case"addAPlayerSeekCount":S.playStat.addAPlayerSeekCount();break;case"setBeforeOpenTime":S.playStat.setBeforeOpenTime(i);break;case"setclickStartTime":S.playStat.setclickStartTime(i);break;case"setYunDownloadId":S.playStat.setYunDownloadId(i)}}clearCurrentMedia(e,...t){d.XmpMediaManagerNS.getXmpMediaManager().clearCurrentMedia()}setCurrentMedia(e,...t){r.isNullOrUndefined(t)||r.isNullOrUndefined(t[0])||d.XmpMediaManagerNS.getXmpMediaManager().setCurrentMedia(t[0])}getCurrentMedia(e,...t){let i=d.XmpMediaManagerNS.getXmpMediaManager().getCurrentMedia(),n=v.getMedia(i),o=[];if(n){let e=n.getXmpMediaAttribute(c.XmpMediaAttr.Name);o.push(i),o.push(e)}return o}getMediaAttribute(e,...t){if(r.isNullOrUndefined(t)||r.isNullOrUndefined(t[0])||r.isNullOrUndefined(t[1]))return;let i=t[1],n=t[0],o=v.getMedia(n);return o?o.getXmpMediaAttribute(i):void 0}getCurrentMediaAttribute(e,...t){if(r.isNullOrUndefined(t)||r.isNullOrUndefined(t[0]))return;let i=t[0],n=d.XmpMediaManagerNS.getXmpMediaManager().getCurrentMedia(),o=v.getMedia(n);return o?o.getXmpMediaAttribute(i):void 0}setMediaAttribute(e,...t){if(r.isNullOrUndefined(t)||r.isNullOrUndefined(t[0]))return;let i=t[0];i&&-1!==i||(i=v.getCurrentMedia());let n=t[1],o=v.getMedia(i);return o?o.setXmpMediaAttribute(n,t[2]):"error: can not get media"}setPlaySpeed(e,...t){return n(this,void 0,void 0,function*(){let e=t[0],i=v.getCurrentMedia(),n=v.getMedia(i);return n&&n.setXmpMediaAttribute(c.XmpMediaAttr.PlaySpeed,e),T.setConfig(h.APlayerConfigId.CONFIGID_PLAYSPEED,e)})}getPlaySpeed(e,...t){return n(this,void 0,void 0,function*(){return f.ConfigNS.getValue(m.ConfigDefineNS.playSpeed.section,m.ConfigDefineNS.playSpeed.key,"100")})}getXmpPlayType(e,...t){let i=s.XmpPlayType.unKnow;do{let e=v.getCurrentMedia(),t=v.getMedia(e);if(!t)break;let n=t.getXmpMediaInfo();if(n.panFileId){i=s.XmpPlayType.yunBo;break}if(n.playUrl.startsWith("http://127.0.0.1")){i=s.XmpPlayType.downloadAndPlay;let e=t.getDownloadAndPlayTaskData();e&&100===e.progress&&(i=s.XmpPlayType.localFile);break}i=s.XmpPlayType.localFile}while(0);return i}getDownloadAndPlayTaskData(e,...t){let i=null;do{let e=v.getCurrentMedia(),t=v.getMedia(e);if(!t)break;i=t.getDownloadAndPlayTaskData()}while(0);return i}getMediaInfo(e,t){do{if(!t)break;let e=t;if(!e)break;let i=v.getMedia(e);if(i)return i.getXmpMediaInfo()}while(0)}getCurrentMediaInfo(e,t){let i=void 0;do{let e=v.getCurrentMedia(),t=v.getMedia(e);if(!t)break;i=t.getXmpMediaInfo()}while(0);return i}getMediasInfo(e,...t){do{if(!t)break;let e=t[0];if(!e)break;let i=[];for(let t=0;t<e.length;++t){let n=v.getMedia(e[t]);if(!n)continue;let o=n.getXmpMediaInfo();o&&i.push(o)}return JSON.stringify(i)}while(0)}getBufferRange(e,...t){let i=t[0];i||(i=v.getCurrentMedia());let n=null,o=v.getMedia(i);o&&(n=o.getDownloadAndPlayTaskData());let r=void 0;return n&&(r=JSON.stringify(n)),r}handleVipPlaySpeed(e,...t){return n(this,void 0,void 0,function*(){let e=t[0];return!!e&&(T.setConfig(h.APlayerConfigId.CONFIGID_PLAYSPEED,e.toString()).catch(),o.server.fireClientEvent(a.XmpEvent.onSpeedChange,e),!0)})}getVideoDuration(e,...t){return n(this,void 0,void 0,function*(){let e=0;if(!t[0])return e;do{let i=yield p.XmpUtilityNS.getMediaInfo(t[0]),n=i.indexOf('"时长 = ');if(-1===n)break;if(n+="时长 = '".length,n=(i=i.substring(n,i.length-1)).indexOf('",'),-1!==(n=(i=i.substring(0,n).replace(/\s+/g,"")).indexOf("h"))){let t=i.substring(0,n);e+=60*Number(t)*60,i=i.substring(n+1,i.length)}if(-1!==(n=i.indexOf("mn"))){let t=i.substring(0,n);e+=60*Number(t),i=i.substring(n+2,i.length)}-1!==(n=i.indexOf("s"))&&(i=i.substring(0,n),e+=Number(i))}while(0);return 1e3*e})}fireKeyDown(e,...t){""!==t[0]&&(I.information("fireKeyDown key",t[0]),E.fireWindowEvent(t[0]).catch())}fireKeyUp(e,...t){}setVlomue(e,...t){return n(this,void 0,void 0,function*(){t[0]})}openMedia(e,...t){return n(this,void 0,void 0,function*(){if(!r.isNullOrUndefined(t)&&!r.isNullOrUndefined(t[0]))return yield v.open(t[0],t[1],t[2])})}switchSilent(e,...t){return n(this,void 0,void 0,function*(){let e=yield T.getConfig(h.APlayerConfigId.CONFIGID_SOUNDSILENT);T.setConfig(h.APlayerConfigId.CONFIGID_SOUNDSILENT,"0"===e?"1":"0").catch()})}isSilent(e,...t){return n(this,void 0,void 0,function*(){return"1"===(yield T.getConfig(h.APlayerConfigId.CONFIGID_SOUNDSILENT))})}cancelDownloadCodecs(e,...t){return n(this,void 0,void 0,function*(){return T.cancelDownloadCodecs()})}getCachedDownloadCodecInfo(e,...t){return n(this,void 0,void 0,function*(){return T.getCachedDownloadCodecInfo()})}userLogout(e,...t){return n(this,void 0,void 0,function*(){let e=(yield u.client.callRemoteClientFunction(C.mainRendererContext,s.XmpPlayerFunction.getPlayingSoure))[0];I.warning("userLogout playSoure",e),e&&e===y.XmpPlaySoure.PLAY_BY_PAN&&(yield u.client.callRemoteClientFunction(C.mainRendererContext,s.XmpPlayerFunction.recordStat,"recEndType","other").catch(),yield this.close(null))})}getLastPlayError(e,...t){return T.getLastPlayError()}getMediaById(e,t){return v.getMedia(t)}setPlayEndInfo(e,t,i){S.playStat.setInfo(t,i)}};e.registerPluginFunction=function(){t.registerPluginFunction()}}(t.IpcPlayControlNS||(t.IpcPlayControlNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.PluginFunctionSubtitleNS=void 0;const o=i(8),r=i(1),a=i(21),s=i(3),l=i(64),d=i(4),u=i(16),c=i(7),h=i(31),p=i(0),f=l.XmpSubtitleNS.getSubtitleManager(),m=c.XmpMediaManagerNS.getXmpMediaManager().getXmpPlayer(),g=p.default.getLogger("XMP.ContextMenu.Subtitle");!function(e){const t=new class{constructor(){this.isRegister=!1}registerPluginFunction(){if(!this.isRegister){g.information("registerPluginFunction"),this.isRegister=!0;let e={[s.SubtitleFunction.loadSubtitle]:this.loadSubtitle.bind(this),[s.SubtitleFunction.onlineSubtitleMatch]:this.onlineSubtitleMatch.bind(this),[s.SubtitleFunction.showOrHideSubtitle]:this.showOrHideSubtitle.bind(this),[s.SubtitleFunction.isEnableHideSubtitle]:this.isEnableHideSubtitle.bind(this),[s.SubtitleFunction.isSubtitleHided]:this.isSubtitleHided.bind(this),[s.SubtitleFunction.loadEmbedSubtitle]:this.loadEmbedSubtitle.bind(this),[s.SubtitleFunction.loadOnlineSubtitle]:this.loadOnlineSubtitle.bind(this),[s.SubtitleFunction.loadLocalSubtitle]:this.loadLocalSubtitle.bind(this),[s.SubtitleFunction.getEmbedSubtitleList]:this.getEmbedSubtitleList.bind(this),[s.SubtitleFunction.getOnlineSubtitleList]:this.getOnlineSubtitleList.bind(this),[s.SubtitleFunction.getLocalSubtitleList]:this.getLocalSubtitleList.bind(this),[s.SubtitleFunction.getManualSubtitleList]:this.getManualSubtitleList.bind(this),[s.SubtitleFunction.getCurrentTitle]:this.getCurrentTitle.bind(this),[s.SubtitleFunction.getCurrentTitle2]:this.getCurrentTitle2.bind(this)};o.server.registerFunctions(e)}}loadSubtitle(e,t,...i){return n(this,void 0,void 0,function*(){do{let e=m.getCurrentMedia();if(!e)break;let t=u.XmpUtilityNS.getSubtitleFormatExt().join(";");t=t.replace(/\./g,"");let i=e.getXmpMediaAttribute(d.XmpMediaAttr.PlayUrl);i=u.XmpUtilityNS.isLocalPath(i)||u.XmpUtilityNS.isLanPath(i)?r.dirname(i):yield u.XmpUtilityNS.getXmpCachePath();let n=yield(yield h.rpc.getDialog()).showOpenDialog(null,{title:"选择字幕文件",defaultPath:i,properties:["openFile","multiSelections"],filters:[{extensions:t.split(";"),name:"字幕文件"}]});if(n.filePaths){let t,i=!1;for(let o=n.filePaths.length-1;o>=0;o--)(t=yield f.loadSubtitleFile(e,n.filePaths[o],a.SubtitleType.Manual,!1))&&(i=!0);i?(f.showSubtitle().catch(),f.showTips("成功加载指定字幕").catch()):f.showTips("加载指定字幕失败").catch()}}while(0)})}onlineSubtitleMatch(e,t,...i){return n(this,void 0,void 0,function*(){f.showTips("正在匹配在线字幕...").catch(),(yield f.queryOnlineSubtitle()).length<=0&&f.showTips("没有匹配的在线字幕").catch()})}loadEmbedSubtitle(e,t,...i){return n(this,void 0,void 0,function*(){{if(!i||i.length<1)return;let e=i[0],t=f.getEmbedSubtitleList()[0];(yield t.setLanguageIndex(e).catch())&&(yield f.loadSubtitle(t))}})}loadOnlineSubtitle(e,t,...i){return n(this,void 0,void 0,function*(){{if(!i||i.length<1)return;let e=i[0],t=f.getOnlineSubtitleList();if(e>=t.length)return;f.loadSubtitle(t[e]).catch()}})}loadLocalSubtitle(e,t,...i){return n(this,void 0,void 0,function*(){{if(!i||i.length<1)return;let e=i[0],t=f.getLocalSubtitleList();if(e>=(t=t.concat(f.getManualSubtitleList())).length)return;f.loadSubtitle(t[e]).catch()}})}showOrHideSubtitle(e,t,...i){return n(this,void 0,void 0,function*(){!i||i.length<1||(i[0]?(f.showSubtitle().catch(),f.showSubtitle2().catch(),f.showTips("字幕显示开启").catch()):(f.hideSubtitle().catch(),f.hideSubtitle2().catch(),f.showTips("字幕显示关闭").catch()))})}isSubtitleHided(e,t,...i){return n(this,void 0,void 0,function*(){let e=!1;do{let t=f.getCurrentSubtitle();if(!t)break;e=!(yield t.isShow()),g.information("onMenuCheckedInitHideSubtitle hideSubtitleChecked:",e)}while(0);return e})}isEnableHideSubtitle(e,t,...i){return n(this,void 0,void 0,function*(){let e=!1;do{if(!f.getCurrentSubtitle())break;e=!0}while(0);return e})}getOnlineSubtitleList(e,t,...i){return n(this,void 0,void 0,function*(){{let e=f.getOnlineSubtitleList(),t=[];for(let i=0;i<e.length;i++){let n=this.subtitle2ISubtitleBaseInfo(e[i],i);t.push(n)}return t}})}getEmbedSubtitleList(e,t,...i){return n(this,void 0,void 0,function*(){{let e=f.getEmbedSubtitleList(),t=[];for(let i=0;i<e.length;i++){let n=this.subtitle2ISubtitleBaseInfo(e[i],i);t.push(n)}return t}})}getLocalSubtitleList(e,t,...i){return n(this,void 0,void 0,function*(){{let e=f.getLocalSubtitleList(),t=[];for(let i=0;i<e.length;i++){let n=this.subtitle2ISubtitleBaseInfo(e[i],i);t.push(n)}return t}})}getManualSubtitleList(e,t,...i){return n(this,void 0,void 0,function*(){{let e=f.getManualSubtitleList(),t=[];for(let i=0;i<e.length;i++){let n=this.subtitle2ISubtitleBaseInfo(e[i],i);t.push(n)}return t}})}getCurrentTitle(e,t,...i){return n(this,void 0,void 0,function*(){{let e,t=f.getCurrentSubtitle();if(!t)return null;t.getType()===a.SubtitleType.Embed?e=f.getEmbedSubtitleList():t.getType()===a.SubtitleType.Online?e=f.getOnlineSubtitleList():t.getType()!==a.SubtitleType.Local&&t.getType()!==a.SubtitleType.Manual||(e=(e=f.getLocalSubtitleList()).concat(f.getManualSubtitleList()));for(let i=0;i<e.length;i++)if(e[i]===t)return this.subtitle2ISubtitleBaseInfo(t,i);return null}})}getCurrentTitle2(e,t,...i){return n(this,void 0,void 0,function*(){{let e=f.getCurrentSubtitle2();return this.subtitle2ISubtitleBaseInfo(e,0)}})}subtitle2ISubtitleBaseInfo(e,t){let i={type:e.getType(),index:t};return i.type===a.SubtitleType.Online&&(i.displayname=e.getAttribute().displayname,i.name=e.getAttribute().name),i.languageIndex=e.getLanguageIndex(),i.languageList=e.getLanguageList(),i.path=e.getPath(),i}};e.registerPluginFunction=function(){t.registerPluginFunction()}}(t.PluginFunctionSubtitleNS||(t.PluginFunctionSubtitleNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.PluginFunctionNS=void 0;const o=i(8),r=i(3),a=i(20),s=i(72),l=i(136);!function(e){const t=new class{constructor(){this.isRegister=!1}registerPluginFunction(){if(!this.isRegister){this.isRegister=!0;let e={[r.XmpPluginFunction.activeDevice]:this.activeDevice,[r.XmpPluginFunction.searchDevice]:this.searchDevice,[r.XmpPluginFunction.getCurrentDevice]:this.getCurrentDevice,[r.XmpPluginFunction.setCurrentDevice]:this.setCurrentDevice,[r.XmpPluginFunction.isDeviceSupport]:this.isDeviceSupport,[r.XmpPluginFunction.getDeviceList]:this.getDeviceList,[r.XmpPlayerFunction.setZOrderCheckerWindowHandle]:this.setZOrderCheckerWindowHandle};o.server.registerFunctions(e)}}activeDevice(e,t,...i){return n(this,void 0,void 0,function*(){if(!a.isNullOrUndefined(e)&&!a.isNullOrUndefined(i)&&!a.isNullOrUndefined(i[0]))return s.deviceHelper.activeDevice(i[0])})}searchDevice(e,t,...i){return n(this,void 0,void 0,function*(){a.isNullOrUndefined(e)||s.deviceHelper.searchDevice().catch()})}getCurrentDevice(e,t,...i){return n(this,void 0,void 0,function*(){return a.isNullOrUndefined(e)?"":s.deviceHelper.getCurrentDevice(i[0])})}setCurrentDevice(e,t,...i){return n(this,void 0,void 0,function*(){if(!a.isNullOrUndefined(e)&&!a.isNullOrUndefined(i))return i[1]&&""!==i[1]?s.deviceHelper.connectDevice(i[0],i[1],i[2],i[3]):s.deviceHelper.disConnectDevice(i[0],i[1])})}getDeviceList(e,t,...i){return n(this,void 0,void 0,function*(){return a.isNullOrUndefined(e)?[]:s.deviceHelper.getDeviceList()})}isDeviceSupport(e,t,...i){return n(this,void 0,void 0,function*(){return!a.isNullOrUndefined(e)&&!a.isNullOrUndefined(i)&&s.deviceHelper.isDeviceSupport(i[0],i[1])})}setZOrderCheckerWindowHandle(e,t,...i){return n(this,void 0,void 0,function*(){if(!(a.isNullOrUndefined(i)||a.isNullOrUndefined(i[0])||a.isNullOrUndefined(i[1])||a.isNullOrUndefined(i[2])))return l.default.setZOrderCheckerWindowHandle(i[0],i[1],i[2])})}};e.registerPluginFunction=function(){t.registerPluginFunction()}}(t.PluginFunctionNS||(t.PluginFunctionNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.widi=void 0;const o=i(62),r=i(7),a=i(0),s=i(11),l=i(4),d=i(8),u=i(5),c=r.XmpMediaManagerNS.getXmpMediaManager().getXmpPlayer(),h=a.default.getLogger("widi-device");t.widi=new class extends o.Device{constructor(){super(...arguments),this.registFunc=[],this.widiData=[],this.curDeviceId=""}init(){this.isEnable()&&this.getDeviceList().catch(),c.attachListener(u.XmpEvent.onEvent,(e,t)=>{e===s.APlayerEventCode.EVENTCODE_WIDI&&this.onWidiEvent(t)})}activeDevice(e){return n(this,void 0,void 0,function*(){yield c.setConfig(s.APlayerConfigId.CONFIGID_WIDIENABLE,e?"1":"0")})}connectDevice(e,t,i){return n(this,void 0,void 0,function*(){h.information("选中设备,deviceId:",e," 设备支持格式:",t);let n=c.getState();if(n>l.XmpMediaState.Opening){let e=yield c.getPosition();setTimeout(()=>{c.setPosition(e).catch()},1e3)}""!==e&&(yield this.activeDevice(!0),c.setConfig(s.APlayerConfigId.CONFIGID_WIDICONNECT,e).catch(),this.curDeviceId=e,d.server.fireClientEvent(u.XmpEvent.onSetCurrentDevice,e,i),n===l.XmpMediaState.Paused&&c.play().catch())})}disConnectDevice(e){c.setConfig(s.APlayerConfigId.CONFIGID_WIDIDISCONNECT,e).catch()}getCurrentDevice(){return n(this,void 0,void 0,function*(){return this.curDeviceId})}searchDevice(){c.setConfig(s.APlayerConfigId.CONFIGID_WIDISEARCHDEVICE,"0").catch()}getDeviceList(){return n(this,void 0,void 0,function*(){let e=yield c.getConfig(s.APlayerConfigId.CONFIGID_WIDIADAPTERLIST);return h.information("获取WIDI设备列表:",e),this.generateDeviceList(e),this.widiData})}registNotify(e){this.registFunc.push(e)}isDeviceSupport(e){return n(this,void 0,void 0,function*(){let t=c.getCurrentMedia(),i="";if(!t)return!1;i=t.getXmpMediaInfo().ext,h.information(" 当前视频格式:",i);let n=!0;return e&&-1===e.search(i)&&(n=!1),n})}isEnable(){return n(this,void 0,void 0,function*(){return"1"===(yield c.getConfig(s.APlayerConfigId.CONFIGID_WIDIENABLE))})}onWidiEvent(e){switch(e){case 0:this.searchDevice();break;case 6:case 3:this.getDeviceList().then(e=>{this.widiData=e,this.registFunc.forEach(e=>{"function"==typeof e&&e()})}).catch()}}generateDeviceList(e){if(!e)return void h.information("无设备列表");let t=e.split("\r\n");t&&0!==t.length?(this.widiData=[],t.forEach(e=>{this.generateDeviceItem(e)})):h.error("无法获取到设备列表信息")}generateDeviceItem(e){if(!e)return;let t=e.split(";");t&&3===t.length?this.widiData.push({id:t[0].trim(),name:t[1].trim(),supportExts:t[2],deviceType:"WIDI"}):h.error("获取设备信息错误")}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const o=i(1),r=i(25),a=i(9),s=i(5),l=i(8),d=a.default(o.join(__rootDir,"../bin/ThunderHelper.node"));const u=new class{constructor(){this.initd=!1}startWindowZorderChecker(){return n(this,void 0,void 0,function*(){if(!this.initd){this.initd=!0;let e=yield r.default.getWindowHandle();d.startZorderChecker(e,(e,t)=>{l.server.fireClientEvent(s.XmpEvent.onWindowZOrderChanged,e,t)})}})}stopWindowZorderChecker(){d.stopZorderChecker()}setZOrderCheckerWindowHandle(e,t,i){d.setZorderWindow(e,t,i)}};t.default=u},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.VipStuck=t.PluginName=void 0;const o=i(138),r=i(144),a=i(2),s=i(145),l=i(73),d=i(33),u=i(75),c=i(39),h=i(27),p=i(0),f=i(40),m=i(8),g=p.default.getLogger("vip-stuck");var S,y;!function(e){e.VipDownload="vip-download-webview"}(S=t.PluginName||(t.PluginName={})),function(e){e[e.PreOpen=0]="PreOpen",e[e.Nature=1]="Nature",e[e.Drag=2]="Drag"}(y||(y={}));const C=9999,I=8,v=6;var T;!function(e){e[e.None=0]="None",e[e.Play=1]="Play",e[e.Pause=2]="Pause"}(T||(T={}));class E{constructor(){this.xmpStuckConfig=null,this.dragStuckCount=0,this.natureStuckCount=0,this.canIncreaseStuckCount=!0,this.struckType=null,this.stuckOk=void 0,this.trackStart=!1,this.preChangeModeTimeHandle=null,this.forceLoading=0,this.forceingTimer=null,this.bufferBeginTick=0,this.isDragBuffer=!1,this.bufferStuckData=null,this.preOpenTick=0,this.preOpenSucTick=0,this.vipStruckState=T.None,this.loopTimer=null}changePlayVideo(){this.dragStuckCount=0,this.natureStuckCount=0,this.canIncreaseStuckCount=!0}initVipPlugHelper(e){return n(this,void 0,void 0,function*(){let t=yield a.client.callServerFunction("GetThunderVersion"),i=0,n=t.split(".");if(n&&4===n.length){let e=Number(n[0]).valueOf(),t=Number(n[1]).valueOf(),o=Number(n[2]).valueOf();i=128*Math.pow(2,24)+e*Math.pow(2,16)+t*Math.pow(2,8)+o}h.default.setPluginInfo(t,i,e)})}init(e){return n(this,void 0,void 0,function*(){yield this.initVipPlugHelper(e);let t={GetVideoStuckVipData:this.getVideoStuckVipData.bind(this),ActionPreOpen:this.onActionPreOpen.bind(this),OpenPayVipUrl:this.openPayVipUrl.bind(this),BufferClickVipBtn:this.onBufferClickVipBtn.bind(this),IsForceloading:this.isForceloading.bind(this),VipStruckPlay:this.vipStruckPlay.bind(this),VipStruckPause:this.vipStruckPause.bind(this),GetVipStruckState:this.getVipStruckState.bind(this)};g.information("registerFunctions","GetVideoStuckVipData"),a.client.registerFunctions(t),this.attachPlayerEvent().catch();let i=new r.VipNetWorkData.Request.XmpStuckConfig;this.xmpStuckConfig=yield o.default.xmpStuckConfig(i)})}attachPlayerEvent(){return n(this,void 0,void 0,function*(){[c.XmpEvent.onPreOpen,c.XmpEvent.onOpenSucceeded,c.XmpEvent.onBuffer].forEach(e=>{a.client.attachServerEvent(e,(t,...i)=>n(this,void 0,void 0,function*(){if(e===c.XmpEvent.onPreOpen&&(this.vipStruckState!==T.None&&(this.vipStruckNone(),this.callVipStruckState()),0!==this.forceLoading&&(this.forceLoading=0,m.server.fireClientEvent(c.XmpEvent.onForceLoadingState,this.forceLoading))),yield f.CommonNS.isPlayAndDownload())switch(e){case c.XmpEvent.onPreOpen:this.changePlayVideo(),this.preOpenTick=(new Date).getTime(),g.information("onXmpEvent",e);break;case c.XmpEvent.onOpenSucceeded:g.information("onXmpEvent",e),(new Date).getTime()-this.preOpenSucTick>2e3&&(this.preOpenSucTick=(new Date).getTime(),this.onPreOpenStuck().catch());break;case c.XmpEvent.onBuffer:this.onBufferStuck(i[0]).catch()}}))})})}isForceloading(...e){return g.information("isForceloading",this.forceLoading),this.forceLoading}vipStruckPlay(...e){g.information("vipStruckPlay"),this.vipStruckState=T.Play,m.server.fireClientEvent(c.XmpEvent.onVipStruckPlayState,this.vipStruckState)}vipStruckPause(...e){g.information("vipStruckPause"),this.vipStruckState=T.Pause,m.server.fireClientEvent(c.XmpEvent.onVipStruckPlayState,this.vipStruckState)}vipStruckNone(...e){g.information("vipStruckNone"),this.vipStruckState=T.None,m.server.fireClientEvent(c.XmpEvent.onVipStruckPlayState,this.vipStruckState)}getVipStruckState(...e){return this.vipStruckState}callVipStruckState(...e){switch(g.information("callVipStruckState"),this.vipStruckState){case T.None:f.CommonNS.callXmp(c.XmpPlayerFunction.play).catch();break;case T.Pause:f.CommonNS.callXmp(c.XmpPlayerFunction.pause).catch();break;case T.Play:f.CommonNS.callXmp(c.XmpPlayerFunction.play).catch()}this.vipStruckNone()}onPreOpenStuck(){return n(this,void 0,void 0,function*(){this.stuckOk=void 0;let e=yield f.CommonNS.callXmp(c.XmpPlayerFunction.getPlayingTaskId);g.information("收到onOpenSucceeded消息, taskId:",e);let t=yield this.getVideoStuckVipData(e,y.PreOpen);this.forceingTimer&&(clearTimeout(this.forceingTimer),this.forceingTimer=null),g.information("bufferData",t),this.vipStruckNone(),t.enableStuck?(this.onActionPreOpen(!0).catch(),this.forceLoading=1,f.CommonNS.callXmp(c.XmpPlayerFunction.pause).catch(),g.information("XmpPlayerFunction.pause"),this.forceingTimer=setTimeout(()=>{this.forceLoading=0,this.callVipStruckState(),g.information("onForceLoadingState",this.forceLoading),m.server.fireClientEvent(c.XmpEvent.onForceLoadingState,this.forceLoading)},t.stuckTime)):(this.forceLoading=0,this.onActionPreOpen(!1).catch()),g.information("onForceLoadingState",this.forceLoading),m.server.fireClientEvent(c.XmpEvent.onForceLoadingState,this.forceLoading)})}onBufferStuck(e){return n(this,void 0,void 0,function*(){if(this.stuckOk=void 0,0===e){this.vipStruckNone(),this.forceingTimer&&(clearTimeout(this.forceingTimer),this.forceingTimer=null);let e=yield f.CommonNS.callXmp(c.XmpPlayerFunction.getPlayingTaskId);this.isDragBuffer=yield f.CommonNS.callXmp(c.XmpPlayerFunction.isCurrentBuffingIsByDrag),this.bufferBeginTick=(new Date).getTime(),this.bufferStuckData=yield this.getVideoStuckVipData(e,this.isDragBuffer?y.Drag:y.Nature)}else if(100===e)if(this.bufferStuckData&&this.bufferStuckData.enableStuck){let e=(new Date).getTime();if(this.bufferBeginTick+this.bufferStuckData.stuckOverAllTime<e){this.isDragBuffer?this.onActionDrag(!0):this.onActionNature(!0),f.CommonNS.callXmp(c.XmpPlayerFunction.pause).catch();let t=Math.min(this.bufferStuckData.stuckTime,this.bufferStuckData.stuckOverAllTime-(e-this.bufferBeginTick));this.forceLoading=2,m.server.fireClientEvent(c.XmpEvent.onForceLoadingState,this.forceLoading),this.forceingTimer=setTimeout(()=>{this.forceLoading=0,this.callVipStruckState(),m.server.fireClientEvent(c.XmpEvent.onForceLoadingState,this.forceLoading)},t)}else this.isDragBuffer?this.onActionDrag(!1):this.onActionNature(!1);this.bufferStuckData=null}else this.isDragBuffer?this.onActionDrag(!1):this.onActionNature(!1)})}clickVipBtn(){return n(this,void 0,void 0,function*(){if(d.default.isVip);else{this.loopTimer&&(clearInterval(this.loopTimer),this.loopTimer=void 0),this.loopTimer=setInterval(()=>n(this,void 0,void 0,function*(){do{if(this.struckType===y.PreOpen&&void 0===this.stuckOk)break;if(void 0===this.stuckOk&&this.bufferStuckData&&this.bufferStuckData.enableStuck){let e=(new Date).getTime();if(this.bufferBeginTick+this.bufferStuckData.stuckOverAllTime<e)break}clearInterval(this.loopTimer),this.struckType===y.PreOpen?u.VipStatNS.firstBufferClick(yield f.CommonNS.getCurrentTaskGcid(),this.stuckOk?1:0).catch():u.VipStatNS.bxbbStuckClick(this.struckType===y.Nature?1:0,this.stuckOk?1:0).catch()}while(0)}),200);let e="";if(yield f.CommonNS.isYunBo())e="https://pay.xunlei.com/pay.html?referfrom=v_pc_xl11_hytq_yp_yunbo&aidfrom=kadun_wzl";else{let t="";switch(this.struckType){case y.PreOpen:t=this.stuckOk?"buffer_qp_delay":"buffer_qp";break;case y.Nature:t=this.stuckOk?"buffer_nature_delay":"buffer_nature";break;case y.Drag:t=this.stuckOk?"buffer_forward_delay":"buffer_forward"}e="https://pay.xunlei.com/pay.html?referfrom=v_pc_xl11_hytq_bxbb&aidfrom="+t}f.CommonNS.callXmp(c.XmpPlayerFunction.leaveFullScreen).catch(),this.openPayVipUrl("Self",e)}})}onBufferClickVipBtn(e){this.clickVipBtn().catch()}getVideoStuckVipData(e,t){return n(this,void 0,void 0,function*(){let i={enableStuck:!1,stuckTime:0,stuckOverAllTime:0};this.struckType=t;let n="";do{if(!this.xmpStuckConfig||!this.xmpStuckConfig.halt_switch){n=this.xmpStuckConfig?"配置关闭":"配置未获取";break}if(d.default.isVip){n="会员";break}if(yield f.CommonNS.isYunBo()){n="云播";break}let o=yield l.default.getTaskBaseInfo(e);if(o){if(o.downloadSpeed/1024/1024>2){n="任务速度>2MB/s";break}if(o.downloadSize/o.fileSize>.8){n="任务下载进度>80%";break}}let r=yield a.client.callRemoteClientFunction(S.VipDownload,"GetVipTaskInfo",Number(e));if(r&&r[0]){let e=!1,o=r[0];if(o.baotuanDetail)switch(o.baotuanDetail.baotuanXgt){case s.VipDownloadDefineNS.BaotuanXgt.Doing_Succeed:case s.VipDownloadDefineNS.BaotuanXgt.Doing_SucceedCutLineOut:case s.VipDownloadDefineNS.BaotuanXgt.Doing_SucceedOpenAuto:e=!0}if(e){n="任务在抱团下载中";break}let a=!1;switch(o.enterType){case s.VipDownloadDefineNS.VipTaskType.Try:a=!0}if(a){n="任务在高速试用中";break}let l=(yield this.getTodayStuckCount())<3;if(l||3===(yield this.getTodayStuckCount())&&y.Drag===this.struckType&&(l=!0),l)switch(t){case y.PreOpen:(yield this.isTodayFirstPreOpen())?(i.stuckOverAllTime=C,i.stuckTime=this.xmpStuckConfig.open_halt,i.enableStuck=!0):n="非当天第一次正在打开";break;case y.Nature:this.natureStuckCount<1?(i.stuckOverAllTime=I,i.stuckTime=this.xmpStuckConfig.first_cache_halt,i.enableStuck=!0):n="非当天第一次自然缓冲";break;case y.Drag:this.dragStuckCount<3?(i.stuckOverAllTime=v,i.stuckTime=this.xmpStuckConfig.no_cache_halt,i.enableStuck=!0):n="当前任务拖动缓冲超过3次"}else n="当天卡顿过的视频超过3个"}}while(0);return i.stuckOverAllTime=1e3*i.stuckOverAllTime,i.stuckTime=1e3*i.stuckTime,g.information("getVideoStuckVipData",e,t,yield h.default.getXmpMode(),n,i),i})}openPayVipUrl(e,t){a.client.callRemoteClientFunction(S.VipDownload,"OpenPayVipUrl",t).catch()}onActionPreOpen(e){return n(this,void 0,void 0,function*(){g.information("onActionPreOpen",e),this.stuckOk=e,e&&(this.setFirstPreOpenDate().catch(),this.increaseTodayStuckCount().catch()),u.VipStatNS.firstBufferShow(yield f.CommonNS.getCurrentTaskGcid(),e?1:0).catch()})}onActionNature(e){g.information("onActionNature",e),this.stuckOk=e,e&&(this.natureStuckCount++,this.increaseTodayStuckCount().catch()),u.VipStatNS.bxbbStuckShow(1,e?1:0).catch()}onActionDrag(e){g.information("onActionDrag",e),this.stuckOk=e,e&&(this.dragStuckCount++,this.increaseTodayStuckCount().catch()),u.VipStatNS.bxbbStuckShow(0,e?1:0).catch()}getTodayStuckCount(){return n(this,void 0,void 0,function*(){return(yield a.client.callServerFunction("GetValue","XmpVipDownload","StruckDate",""))!==(new Date).toDateString()?(yield a.client.callServerFunction("SetValue","XmpVipDownload","StuckCount",0),yield this.setStruckDate(),0):yield a.client.callServerFunction("GetValue","XmpVipDownload","StuckCount",0)})}isTodayFirstPreOpen(){return n(this,void 0,void 0,function*(){return(yield a.client.callServerFunction("GetValue","XmpVipDownload","LastPreOpenDate",""))!==(new Date).toDateString()})}setFirstPreOpenDate(){return n(this,void 0,void 0,function*(){let e=(new Date).toDateString();a.client.callServerFunction("SetValue","XmpVipDownload","LastPreOpenDate",e).catch()})}setStruckDate(){return n(this,void 0,void 0,function*(){let e=(new Date).toDateString();a.client.callServerFunction("SetValue","XmpVipDownload","StruckDate",e).catch()})}increaseTodayStuckCount(){return n(this,void 0,void 0,function*(){if(!this.canIncreaseStuckCount)return;this.canIncreaseStuckCount=!1;let e=yield this.getTodayStuckCount();a.client.callServerFunction("SetValue","XmpVipDownload","StuckCount",e+1).catch()})}}t.VipStuck=E,t.default=new E},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.VipNetWorkApi=void 0;const o=i(33),r=i(27),a=i(74),s=i(141),l=i(0).default.getLogger("xmp-vip-net-work-api");class d{prepare(e){return n(this,void 0,void 0,function*(){let t=new s.HttpSession,i=r.default.currentTime,n=++d.sequence,u=a.HttpJsonCryptoNS.getUriParam(n,i);if(t.retries=2,t.timeout=2e4,t.host="team.speed.cdn.vip.xunlei.com",t.path=e.getApiName()+"?"+u,t.auth=a.HttpJsonCryptoNS.getAuthorization(o.default.userId,yield o.default.getSessionId()),t.accept=a.HttpJsonCryptoNS.getAccept(),e.userId=o.default.userId,e.peerId=yield o.default.getPeerId(),l.information(e.getDescript(),e.getApiName(),"request",e),"post"===e.getMethod()){return t.body=yield e.createBody(),new Promise(i=>{t.post(t=>{let n=null;if(l.information(e.getDescript(),e.getApiName(),"data",t),!e.careUserId||o.default.userId===e.userId){let e=t.headers["random-num"];if(200===t.statusCode&&t.body&&e){n={r:Number(e).valueOf(),body:t.body}}}i(n)},t=>{l.information(e.getDescript(),e.getApiName(),"error",t),i(null)})})}return new Promise(i=>{t.get(t=>{let n=null;if(l.information(e.getDescript(),e.getApiName(),"data",t),!e.careUserId||o.default.userId===e.userId){let e=t.headers["random-num"];if(200===t.statusCode&&t.body&&e){n={r:Number(e).valueOf(),body:t.body}}}i(n)},t=>{l.information(e.getDescript(),e.getApiName(),"error",t),i(null)})})})}xmpStuckConfig(e){return n(this,void 0,void 0,function*(){let t=yield this.prepare(e),i=null;return t&&(i=e.parse(t.r,t.body)),i})}}t.VipNetWorkApi=d,d.sequence=0,t.default=new d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadKernel=void 0,function(e){let t,i,n,o,r,a,s,l,d,u,c,h,p,f,m,g,S,y,C;!function(e){e[e.Unkown=0]="Unkown",e[e.Create=1]="Create",e[e.InvaldParam=2]="InvaldParam",e[e.InvaldLink=3]="InvaldLink",e[e.InvaldConfig=4]="InvaldConfig",e[e.Timeout=5]="Timeout",e[e.VerifyData=6]="VerifyData",e[e.Forbidden=7]="Forbidden",e[e.RangeDispatch=8]="RangeDispatch",e[e.FilePathOverRanging=9]="FilePathOverRanging",e[e.FileCreate=201]="FileCreate",e[e.FileWrite=202]="FileWrite",e[e.FileRead=203]="FileRead",e[e.FileRename=204]="FileRename",e[e.FileFull=205]="FileFull",e[e.BtUploadExist=601]="BtUploadExist",e[e.ForbinddenResource=701]="ForbinddenResource",e[e.ForbinddenAccount=702]="ForbinddenAccount",e[e.ForbinddenArea=703]="ForbinddenArea",e[e.ForbinddenCopyright=704]="ForbinddenCopyright",e[e.ForbinddenReaction=705]="ForbinddenReaction",e[e.ForbinddenPorn=706]="ForbinddenPorn",e[e.DownloadSDKCrash=10001]="DownloadSDKCrash"}(t=e.TaskError||(e.TaskError={})),function(e){e[e.Unkown=-1]="Unkown",e[e.Success=0]="Success",e[e.QueryFailed=1]="QueryFailed",e[e.ServerError=2]="ServerError",e[e.ResourceNotFound=3]="ResourceNotFound",e[e.AuthorizingFailed=4]="AuthorizingFailed",e[e.ForbidByCopyright=5]="ForbidByCopyright",e[e.ForbidByPorNoGraphy=6]="ForbidByPorNoGraphy",e[e.ForbidByReactionary=7]="ForbidByReactionary",e[e.ForbidByOtherFilter=8]="ForbidByOtherFilter"}(i=e.DcdnStatusCode||(e.DcdnStatusCode={})),function(e){e[e.Begin=-1]="Begin",e[e.Unkown=0]="Unkown",e[e.StandBy=1]="StandBy",e[e.PreDownloading=2]="PreDownloading",e[e.StartWaiting=3]="StartWaiting",e[e.StartPending=4]="StartPending",e[e.Started=5]="Started",e[e.StopPending=6]="StopPending",e[e.Stopped=7]="Stopped",e[e.Succeeded=8]="Succeeded",e[e.Failed=9]="Failed",e[e.Seeding=10]="Seeding",e[e.DestroyPending=11]="DestroyPending",e[e.End=12]="End"}(n=e.TaskStatus||(e.TaskStatus={})),function(e){e[e.Begin=-1]="Begin",e[e.StandBy=0]="StandBy",e[e.Stopped=1]="Stopped",e[e.Started=2]="Started",e[e.Complete=3]="Complete",e[e.Forbidden=4]="Forbidden",e[e.Error=5]="Error",e[e.End=6]="End"}(o=e.BtFileStatus||(e.BtFileStatus={})),function(e){e[e.DispatchStrategyNone=0]="DispatchStrategyNone",e[e.DispatchStrategyOrigin=1]="DispatchStrategyOrigin",e[e.DispatchStrategyP2s=2]="DispatchStrategyP2s",e[e.DispatchStrategyP2p=4]="DispatchStrategyP2p",e[e.DispatchStrategyAll=-1]="DispatchStrategyAll"}(r=e.DispatchStrategy||(e.DispatchStrategy={})),function(e){e[e.Unkown=0]="Unkown",e[e.P2sp=1]="P2sp",e[e.Bt=2]="Bt",e[e.Emule=3]="Emule",e[e.Group=4]="Group",e[e.Magnet=5]="Magnet"}(a=e.TaskType||(e.TaskType={})),function(e){e.Unkown="Unkown",e.Downloading="Downloading",e.Completed="Completed",e.Recycle="Recycle"}(s=e.CategroyViewID||(e.CategroyViewID={})),function(e){e[e.Unknow=0]="Unknow",e[e.TaskCreated=1]="TaskCreated",e[e.InsertToCategoryView=2]="InsertToCategoryView",e[e.RemoveFromCategoryView=3]="RemoveFromCategoryView",e[e.StatusChanged=4]="StatusChanged",e[e.DetailChanged=5]="DetailChanged",e[e.ChannelInfoChanged=6]="ChannelInfoChanged",e[e.DcdnStatusChanged=7]="DcdnStatusChanged",e[e.TaskDescriptionChanged=8]="TaskDescriptionChanged",e[e.TaskUserRead=9]="TaskUserRead",e[e.TaskRenamed=10]="TaskRenamed",e[e.TaskMovedEnd=11]="TaskMovedEnd",e[e.TaskMovingStateChange=12]="TaskMovingStateChange",e[e.BtSubFileDetailChanged=13]="BtSubFileDetailChanged",e[e.BtSubFileLoaded=14]="BtSubFileLoaded",e[e.BtSubFileForbidden=15]="BtSubFileForbidden",e[e.BtSubFileDcdnStatusChanged=16]="BtSubFileDcdnStatusChanged",e[e.TaskCategoryMovedEnd=17]="TaskCategoryMovedEnd",e[e.GroupTaskSubFileDetailChanged=18]="GroupTaskSubFileDetailChanged",e[e.TaskDestroying=19]="TaskDestroying",e[e.TaskDestroyed=20]="TaskDestroyed"}(l=e.TaskEventType||(e.TaskEventType={})),function(e){e[e.NumberStrart=0]="NumberStrart",e[e.TaskId=1]="TaskId",e[e.VirtualId=2]="VirtualId",e[e.SrcTotal=3]="SrcTotal",e[e.SrcUsing=4]="SrcUsing",e[e.FileSize=5]="FileSize",e[e.ReceivedSize=6]="ReceivedSize",e[e.DownloadSize=7]="DownloadSize",e[e.CreateTime=8]="CreateTime",e[e.CompletionTime=9]="CompletionTime",e[e.DownloadingPeriod=10]="DownloadingPeriod",e[e.Progress=11]="Progress",e[e.RecycleTime=12]="RecycleTime",e[e.FileCreated=13]="FileCreated",e[e.Forbidden=14]="Forbidden",e[e.CategoryId=15]="CategoryId",e[e.UserRead=16]="UserRead",e[e.OpenOnComplete=17]="OpenOnComplete",e[e.GroupTaskId=18]="GroupTaskId",e[e.DownloadSubTask=19]="DownloadSubTask",e[e.NameType=20]="NameType",e[e.OwnerProduct=21]="OwnerProduct",e[e.FileIndex=22]="FileIndex",e[e.NumberEnd=23]="NumberEnd",e[e.BooleanStart=24]="BooleanStart",e[e.Destroyed=25]="Destroyed",e[e.Background=26]="Background",e[e.Moving=27]="Moving",e[e.BooleanEnd=28]="BooleanEnd",e[e.StringStart=29]="StringStart",e[e.TaskName=30]="TaskName",e[e.SavePath=31]="SavePath",e[e.RelativePath=32]="RelativePath",e[e.TaskUrl=33]="TaskUrl",e[e.RefUrl=34]="RefUrl",e[e.Cid=35]="Cid",e[e.Gcid=36]="Gcid",e[e.Cookie=37]="Cookie",e[e.ProductInfo=38]="ProductInfo",e[e.Origin=39]="Origin",e[e.Description=40]="Description",e[e.UserData=41]="UserData",e[e.StringEnd=42]="StringEnd",e[e.ObjectStart=43]="ObjectStart",e[e.ObjectEnd=44]="ObjectEnd",e[e.CategoryViewId=45]="CategoryViewId",e[e.TaskType=46]="TaskType",e[e.ErrorCode=47]="ErrorCode"}(d=e.TaskAttribute||(e.TaskAttribute={})),function(e){e[e.UnKnown=0]="UnKnown",e[e.SrcTotal=1]="SrcTotal",e[e.SrcUsing=2]="SrcUsing",e[e.FileSize=4]="FileSize",e[e.ReceivedSize=8]="ReceivedSize",e[e.DownloadSize=16]="DownloadSize",e[e.CompletionTime=32]="CompletionTime",e[e.DownloadingPeriod=64]="DownloadingPeriod",e[e.Progress=128]="Progress",e[e.RecycleTime=256]="RecycleTime",e[e.FileCreated=512]="FileCreated",e[e.Forbidden=1024]="Forbidden",e[e.UserRead=2048]="UserRead",e[e.OpenOnComplete=4096]="OpenOnComplete",e[e.DownloadSubTask=8192]="DownloadSubTask",e[e.TaskName=16384]="TaskName",e[e.SavePath=32768]="SavePath",e[e.Cid=65536]="Cid",e[e.Gcid=131072]="Gcid",e[e.UserData=262144]="UserData",e[e.CategoryViewId=524288]="CategoryViewId",e[e.ErrorCode=1048576]="ErrorCode",e[e.TaskSpeed=2097152]="TaskSpeed",e[e.ChannelInfo=4194304]="ChannelInfo"}(u=e.TaskDetailChangedFlags||(e.TaskDetailChangedFlags={})),function(e){e[e.UnKnown=0]="UnKnown"}(c=e.BtSubFileDetailChangedFlags||(e.BtSubFileDetailChangedFlags={})),function(e){e[e.UnKnown=0]="UnKnown"}(h=e.GroupTaskSubFileDetailChangedFlags||(e.GroupTaskSubFileDetailChangedFlags={})),function(e){e[e.NumberStrart=0]="NumberStrart",e[e.TaskId=1]="TaskId",e[e.FileStatus=2]="FileStatus",e[e.DownloadSize=3]="DownloadSize",e[e.FileSize=4]="FileSize",e[e.EnableDcdn=5]="EnableDcdn",e[e.ErrorCode=6]="ErrorCode",e[e.DcdnStatus=7]="DcdnStatus",e[e.RealIndex=8]="RealIndex",e[e.FileOffset=9]="FileOffset",e[e.Visible=10]="Visible",e[e.Download=11]="Download",e[e.NumberEnd=12]="NumberEnd",e[e.StringStart=13]="StringStart",e[e.FinalName=14]="FinalName",e[e.RelativePath=15]="RelativePath",e[e.FileName=16]="FileName",e[e.FilePath=17]="FilePath",e[e.Cid=18]="Cid",e[e.Gcid=19]="Gcid",e[e.StringEnd=20]="StringEnd"}(p=e.BtFileAttribute||(e.BtFileAttribute={})),function(e){e[e.P2spUrl=0]="P2spUrl",e[e.BtInfoId=1]="BtInfoId",e[e.EmuleFileHash=2]="EmuleFileHash",e[e.MagnetUrl=3]="MagnetUrl",e[e.GroupTaskName=4]="GroupTaskName"}(f=e.KeyType||(e.KeyType={})),function(e){e[e.NameInclude=1]="NameInclude",e[e.BtDisplayNameInclude=2]="BtDisplayNameInclude"}(m=e.SearchKeyType||(e.SearchKeyType={})),function(e){e[e.ExtEqual=1]="ExtEqual",e[e.NameLikeAndExtEqual=2]="NameLikeAndExtEqual",e[e.TaskTypeEqual=4]="TaskTypeEqual"}(g=e.FilterKeyType||(e.FilterKeyType={})),function(e){e[e.All=0]="All",e[e.CommonForeground=1]="CommonForeground",e[e.CommonBackground=2]="CommonBackground",e[e.Temporary=3]="Temporary",e[e.PreDownload=4]="PreDownload",e[e.PrivateForeground=5]="PrivateForeground"}(S=e.KeyFilter||(e.KeyFilter={})),function(e){e[e.Unknown=-1]="Unknown",e[e.LoadTaskBasic=0]="LoadTaskBasic",e[e.Create=1]="Create",e[e.Recycle=2]="Recycle",e[e.Recover=3]="Recover",e[e.ReDownload=4]="ReDownload",e[e.MoveThoughCategory=5]="MoveThoughCategory"}(y=e.TaskInsertReason||(e.TaskInsertReason={})),function(e){e[e.Unknown=-1]="Unknown",e[e.ContextMenu=0]="ContextMenu",e[e.Button=1]="Button",e[e.TaskDetail=2]="TaskDetail",e[e.DownloadMagnet=3]="DownloadMagnet",e[e.ToolbarButton=4]="ToolbarButton",e[e.SelectDownloadLists=5]="SelectDownloadLists",e[e.DeleteTask=6]="DeleteTask"}(C=e.TaskStopReason||(e.TaskStopReason={}))}(t.DownloadKernel||(t.DownloadKernel={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.ToolsUtilitiesAWNS=void 0;const o=i(66),r=i(23),a=i(63),s=i(0).default.getLogger("xmp-vip-tools-utilities");!function(e){e.genarateMd5=function(e){let t=void 0,i=o.createHash("md5");return null!==i&&(t=i.update(e).digest("hex")),t},e.calculateFileMd5Ex=function(e){return n(this,void 0,void 0,function*(){let t;if(e&&(yield a.FileSystemAWNS.existsAW(e))){let i=r.createReadStream(e),n=o.createHash("md5");i.on("data",e=>{n.update(e)}),t=new Promise(e=>{i.on("end",()=>{let t=n.digest("hex");t=t.toUpperCase(),e(t)})})}else t=new Promise(e=>{e(void 0)});return t})},e.encryptBuffer=function(e,t){let i=null;try{let n=o.createCipheriv("aes-128-ecb",t,""),r=n.update(e),a=n.final();i=Buffer.concat([r,a])}catch(e){s.error("encryptBuffer",e)}return i},e.decryptBuffer=function(e,t){let i=null;try{let n=o.createDecipheriv("aes-128-ecb",t,""),r=n.update(e),a=n.final();i=Buffer.concat([r,a])}catch(e){s.error("decryptBuffer",e)}return i},e.encryptSha1Buffer=function(e){let t=null;try{t=o.createHash("sha1").update(e).digest("hex")}catch(e){s.error("encryptSha1Buffer",e)}return t}}(t.ToolsUtilitiesAWNS||(t.ToolsUtilitiesAWNS={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpSession=t.Protocol=void 0;const n=i(45),o=i(58),r=i(142),a=i(143),s=i(0).default.getLogger("xmp-vip-http-session"),{isDef:l}=a.ThunderUtil;var d;!function(e){e.HTTP="HTTP",e.HTTPS="HTTPS"}(d=t.Protocol||(t.Protocol={}));t.HttpSession=class{constructor(){this.mRetries=0,this.mHost=void 0,this.mPort=void 0,this.mPath=void 0,this.mAuth=void 0,this.mAccept=void 0,this.mBody=null,this.mUrl=void 0,this.mProtocol=d.HTTP,this.mTimeout=void 0,this.mCurRetries=0}set host(e){this.mHost=e}get host(){return this.mHost}set port(e){this.mPort=e}get port(){let e=void 0;return e=l(this.mPort)?this.mPort:this.protocol===d.HTTPS?443:80}set path(e){this.mPath=e}get path(){return this.mPath}set url(e){this.mUrl=e}get protocol(){return this.mProtocol}set protocol(e){this.mProtocol=e}get url(){return this.mUrl}set auth(e){this.mAuth=e}get auth(){return this.mAuth}set accept(e){this.mAccept=e}get accept(){return this.mAccept}set body(e){this.mBody=e}get body(){return this.mBody}set retries(e){this.mRetries=e}get retries(){return this.mRetries}set timeout(e){this.mTimeout=e}get timeout(){return this.mTimeout}post(e,t){do{let i=this.body;if(!i){s.information("body is empty"),t(null);break}let n=this.auth,o=this.accept,r={hostname:this.host,port:this.port,path:this.path||"/",method:"POST",auth:n||void 0,headers:{"Content-Length":i?i.length:0,Accept:o||"*/*"}};s.information("option",r);try{this.postImpl(i,r,e,i=>{this.mCurRetries<this.retries?(this.mCurRetries++,s.information("mCurRetries",this.mCurRetries),this.post(e,t)):t(i)})}catch(e){s.warning("error ",e),t(null)}}while(0)}get(e,t){let i=null;if(this.url){let e=n.parse(this.url,!0);e&&"https:"===e.protocol?this.protocol=d.HTTPS:this.protocol=d.HTTP,i=this.url}else i={hostname:this.host,port:this.port,path:this.path||"/",method:"GET"};s.information("option",i);try{this.getImpl(i,e,i=>{this.mCurRetries<this.retries?(this.mCurRetries++,s.information("mCurRetries",this.mCurRetries),this.get(e,t)):t(i)})}catch(e){s.warning("error ",e),t(null)}}postImpl(e,t,i,n){let a=(this.protocol===d.HTTPS?r:o).request(t,e=>{let t=null;e.on("data",e=>{t=t?Buffer.concat([t,e]):e}),e.on("end",()=>{s.information("statusCode",e.statusCode),s.information("headers",e.headers),i({statusCode:e.statusCode,headers:e.headers,body:t})})});a.on("error",e=>{n(e)}),a.on("timeout",()=>{a.abort()}),this.timeout&&a.setTimeout(this.timeout),a.write(e),a.end()}getImpl(e,t,i){(this.protocol===d.HTTPS?r:o).get(e,e=>{let i=null;e.on("data",e=>{i=i?Buffer.concat([i,e]):e}),e.on("end",()=>{s.information("statusCode",e.statusCode),s.information("headers",e.headers),t({statusCode:e.statusCode,headers:e.headers,body:i})})}).on("error",e=>{i(e)})}}},function(e,t){e.exports=require("https")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.ThunderUtil=void 0;const o=i(19),r=i(1),a=i(0),s=i(13),l=i(18),d=i(2),u=i(3),c=a.default.getLogger("Thunder.Util"),h="Thunder Network\\Xmp6\\";function p(e){let t=e;return 0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1?t=e.substring(1,e.length-1):0===e.indexOf("'")&&e.lastIndexOf("'")===e.length-1&&(t=e.substring(1,e.length-1)),t}!function(e){function t(){let e=l.ThunderHelper.getSystemTempPath(),t=l.ThunderHelper.getLogicalDriveStrings(),i=0;for(let n=0;n<t.length;n++){let o=l.ThunderHelper.getDriveInfo(t[n]);3===o.type&&i<o.freeBytes&&t[n]!==e&&(i=o.freeBytes,e=t[n])}return e.substring(0,1)+":\\迅雷下载"}function a(e){let t="00";return t=e>=10?e.toString():"0"+e.toString()}function f(e){let t=(e.style.webkitTransform||getComputedStyle(e,"").getPropertyValue("-webkit-transform")||e.style.transform||getComputedStyle(e,"").getPropertyValue("transform")).match(/\-?[0-9]+\.?[0-9]*/g);return{x:parseInt(t&&(t[12]||t[4])||"0",10),y:parseInt(t&&(t[13]||t[5])||"0",10)}}function m(e){let t=null;do{if(void 0===e||null===e)break;t=e.match(/[\/]?([^?]*)\?([^\s]*)/)?RegExp.$2:""}while(0);return t}function g(e){let t={};do{if(void 0===e||null===e)break;let i=/([^&=?]+)=([^&]*)/g;for(;i.exec(e);)t[RegExp.$1]=RegExp.$2}while(0);return t}e.formatSize=function(e,t){t=t||2;let i="0B";if("number"==typeof e&&e>0){let n=["B","KB","MB","GB","TB"],o=0,r=e;for(;r>=1e3&&!(o>=4);)r/=1024,o+=1;i=-1===String(r).indexOf(".")?r+n[o]:r.toFixed(t)+n[o]}return i},e.isDigital=function(e){let t=!1;return/^\d+$/.test(e)&&(t=!0),t},e.isAlpha=function(e){let t=!1;return/[A-Za-z]/.test(e)&&(t=!0),t},e.isUpperCase=function(e){let t=!1;return/[A-Z]/.test(e)&&(t=!0),t},e.isLowerCase=function(e){let t=!1;return/[a-z]/.test(e)&&(t=!0),t},e.isChinese=function(e){let t=!1;return/[\u4E00-\u9FA5]/.test(e)&&(t=!0),t},e.replaceNonDigital=function(e){return e.replace(/[^\d]/g,"")},e.replaceNonAlpha=function(e){return e.replace(/[^A-Za-z]/g,"")},e.replaceNonWord=function(e){return e.replace(/[^\W]/g,"")},e.getConfigValueAW=function(e,t,i){return n(this,void 0,void 0,function*(){return d.client.callServerFunction(u.ConfigFunction.getConfigValue,e,t,i)})},e.getDefaultDownloadDir=t,e.getMaxFreeDriver=function(){return t().substring(0,1)},e.deepCopy=function(e){let t=JSON.stringify(e),i=null;try{i=JSON.parse(t)}catch(e){c.warning(e)}return i},e.swap=function(e,t,i){do{if(t<0||t>=e.length)break;if(i<0||i>=e.length)break;if(t===i)break;e[t]=e.splice(i,1,e[t])[0]}while(0);return e},e.compareNocase=function(e,t){let i=!1;do{if(void 0===e&&void 0===t){i=!0;break}if(void 0===e||void 0===t)break;if("string"!=typeof e||"string"!=typeof t)break;i=e.toLowerCase()===t.toLowerCase()}while(0);return i},e.parseCommandLine=function(e){let t=0,i="",n=!1,o=[],r=e.length;for(let a=0;a<r;a++){let s=e[a];if('"'!==s&&"'"!==s||(""===i?(n=!0,i=s):i===s&&(n=!1,i=""))," "!==s||n||a===r-1){if(a===r-1){let i=e.substring(t);""!==i.trim()&&o.push(p(i))}}else{let i=e.substring(t,a);""!==i.trim()&&o.push(p(i)),t=a+1}}return o},e.getXmpTempPath=function(e,t){return n(this,void 0,void 0,function*(){const n=yield Promise.resolve().then(()=>i(22));let o=r.join(n.tmpdir(),h);return t&&(o=r.join(o,t)),void 0!==e&&e&&(yield s.FileSystemAWNS.mkdirsAW(o)),o})},e.setQueryString=function(e,t){return Object.keys(t).forEach((i,n)=>{e+=0===n?"?":"&",e+=`${i}=${encodeURIComponent(t[i])}`}),e},e.getQueryString=function(e,t){let i="";if(e&&t){i=e.match(new RegExp(`(^${t}|[?|&]${t})=([^&#]+)`))?RegExp.$2:"";try{i=decodeURIComponent(i)}catch(e){}}return i},e.isClipboardTextFormatAvailable=function(){let e=!1,t=o.clipboard.availableFormats();for(let i of t)if("text/plain"===i){e=!0;break}return e},e.resizeToFitContent=function(){let e=document.querySelector(".td-dialog");window.resizeTo(e.offsetWidth,e.offsetHeight)},e.keywordsHighLight=function(e,t,i){if(!e)return"";if(!t)return e;if(0===e.length)return e;if(0===t.length)return e;let n=/\\/,o=t.split(" ");if(0===(o=o.filter(e=>e.trim().length>0)).length)return e;for(let t=0;t<o.length;t++)if(o[t].search(n)>0)return e;i=void 0===i||null===i?"#FF0000":i;let r="",a=["\\[","\\^","\\*","\\(","\\)","\\|","\\?","\\$","\\.","\\+"],s="",l="|";for(let e=0;e<o.length;e++){for(let t=0;t<a.length;t++){let i=new RegExp(a[t],"g");o[e]=o[e].replace(i,a[t])}e===o.length-1&&(l=""),s=s.concat(o[e],l)}let d=new RegExp(s,"gi");return r=e.replace(d,e=>'<span style= "color:'+i+'">'+e+"</span>")},e.convertTimeToMinutes=function(e,t,i){return 3600*e+60*t+i},e.convertMinuteToTime=function(e){return[Math.floor(e/3600),Math.floor(e/60%60),Math.floor(e%60)]},e.formatTimeNumber=a,e.createGUID=function(){let e;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t,i)=>(e=16*Math.random()|0,("x"===t?e:3&e|8).toString(16)))},e.formatDate=function(e,t){let i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(let t in i)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?i[t]:("00"+i[t]).substr((""+i[t]).length)));return e},e.formatMilliSecondTime2=function(e){let t=((e=Math.floor(e))%1e3).toString();1===t.length?t="00"+t:2===t.length&&(t="0"+t),e=Math.floor(e/1e3);let i=[];for(;e>0;){let t=Math.floor(e/60);if(i.push(e-60*t),e=t,i.length>=3)break}let n="";return n=1===i.length?a(i[0])+"秒":2===i.length?a(i[1])+"分"+a(i[0])+"秒":3===i.length?a(i[2])+"时"+a(i[1])+"分"+a(i[0])+"秒":"0秒"},e.formatMilliSecondTime=function(e,t,i=":"){let n=((e=Math.floor(e))%1e3).toString();1===n.length?n="00"+n:2===n.length&&(n="0"+n),e=Math.floor(e/1e3);let o=[];for(;e>0;){let t=Math.floor(e/60);if(o.push(e-60*t),e=t,o.length>=3)break}let r="";return r=1===o.length?`00${i}00${i}`+a(o[0]):2===o.length?`00${i}`+a(o[1])+`${i}`+a(o[0]):3===o.length?a(o[2])+i+a(o[1])+i+a(o[0]):`00${i}00${i}00`,t&&(r+=i+n),r},e.formatSeconds=function(e){let t="";do{if(e<=0){t="00分00秒";break}let i=Math.floor(e/3600),n=Math.floor(e/60)%60,o=Math.floor(e%60);i>0&&(t=i<10?"0"+i+"时":i+"时"),t=(t+=n<10?"0"+n+"分":n+"分")+(o<10?"0"+o:""+o)+"秒"}while(0);return t},e.isDef=function(e){return void 0!==e&&null!==e},e.isUndef=function(e){return void 0===e||null===e},e.setStyle=function(e,t){Object.entries(t).forEach(([t,i])=>{e.style[t]=i})},e.setCSSProperties=function(e,t){Object.entries(t).forEach(([t,i])=>{e.style.setProperty(t,i)})},e.versionCompare=function(e,t){let i=e.split("."),n=t.split("."),o=0;for(let e=0;e<i.length;e++){if(Number(i[e])-Number(n[e])>0){o=1;break}if(Number(i[e])-Number(n[e])<0){o=-1;break}}return o},e.throttle=function(e,t){let i,n=0;return(...o)=>{const r=Date.now();clearTimeout(i),r-n>t?(e(...o),n=r):i=setTimeout(()=>{e(...o),n=r},t)}},e.getElementFixed=function(e){let t=e.offsetLeft,i=e.offsetTop,n=e.offsetParent;for(;null!==n;){let e=f(n);t+=n.offsetLeft+e.x,i+=n.offsetTop+e.y,n=n.offsetParent}return{x:t,y:i}},e.getElementRelative=function(e){let t=e.offsetLeft,i=e.offsetTop,n=e.offsetParent;for(;null!==n;)t+=n.offsetLeft,i+=n.offsetTop,n=n.offsetParent;return{x:t,y:i}},e.getCmdParam=function(e,t,i){if(!e)return{};let n,o={};for(let r=0;r<e.length;r++)if(e[r].includes(t)){o.key=t,o.index=r,i&&(n=e[r].split(i))&&(o.val=n[1]);break}return o},e.parseDynamicUrlPath=m,e.parseDynamicUrlArgs=g,e.getUrlArgs=function(e){return g(m(e))},e.debounce=function(e,t){let i=null;return(...n)=>{i&&clearTimeout(i),i=setTimeout(()=>{e(...n)},t)}}}(t.ThunderUtil||(t.ThunderUtil={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.VipNetWorkData=void 0;const o=i(74),r=i(27),a=i(0).default.getLogger("xmp-vip-net-work-data");!function(e){let t;!function(e){class t{constructor(e,t,i){this.apiName=e,this.descript=t,this.method=i||"post",this.debug=!1}getApiName(){return this.apiName}getDescript(){return this.descript}getMethod(){return this.method}parse(e,t){let i=null;try{i=this.debug?JSON.parse(t.toString()):this.decryptBuffer(e,t)}catch(e){a.warning(e)}return a.information(this.descript,this.apiName,"response",i),i}decryptBuffer(e,t){let i=o.HttpJsonCryptoNS.getKey(this.userId,e);return o.HttpJsonCryptoNS.decryptHttpBuffer(t,i)}createBody(){return n(this,void 0,void 0,function*(){return null})}}e.Base=t;e.XmpStuckConfig=class extends t{constructor(){super("/xplayer/config","边下边播配置","post")}createBody(){return n(this,void 0,void 0,function*(){let e={peer_id:this.peerId},t=null;if(this.debug)t=Buffer.from(JSON.stringify(e));else{let i=o.HttpJsonCryptoNS.getKey(this.userId,r.default.currentTime);t=o.HttpJsonCryptoNS.encryptHttpBuffer(e,i)}return t})}}}(t=e.Request||(e.Request={}))}(t.VipNetWorkData||(t.VipNetWorkData={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VipDownloadDefineNS=void 0,function(e){let t,i,n,o,r,a,s,l,d;!function(e){e.Unkown="XgtType.Unkown",e.Try="XgtType.Try",e.Ad="XgtType.Ad",e.Baotuan="XgtType.Baotuan",e.PlayGame="XgtType.PlayGame"}(t=e.XgtType||(e.XgtType={})),function(e){e.Unkown="XgtState.Unkown",e.Ready="XgtState.Ready",e.Show="XgtState.Show",e.Background="XgtState.Background",e.Exit="XgtState.Exit"}(i=e.XgtState||(e.XgtState={})),function(e){e[e.NoVip=-1]="NoVip",e[e.Vip=0]="Vip",e[e.Try=1]="Try",e[e.Ad=2]="Ad"}(n=e.VipTaskType||(e.VipTaskType={})),function(e){e[e.PlatinumVip=0]="PlatinumVip",e[e.SuperVip=1]="SuperVip",e[e.MixVip=2]="MixVip"}(o=e.TryType||(e.TryType={})),function(e){e[e.Unkown=-1]="Unkown",e[e.Init=0]="Init",e[e.CommitWait=1]="CommitWait",e[e.Commiting=2]="Commiting",e[e.CommitFailed=3]="CommitFailed",e[e.CommitSuccess=4]="CommitSuccess",e[e.AcclerateWait=5]="AcclerateWait",e[e.SearchResource=6]="SearchResource",e[e.AcclerateFailed=7]="AcclerateFailed",e[e.AcclerateStoped=8]="AcclerateStoped",e[e.Acclerating=9]="Acclerating",e[e.Finished=10]="Finished"}(r=e.VipTaskStatus||(e.VipTaskStatus={})),function(e){e[e.StatusOnly=1]="StatusOnly",e[e.TokenOnly=2]="TokenOnly",e[e.Others=3]="Others"}(a=e.QueryOption||(e.QueryOption={})),function(e){e[e.Before_All=0]="Before_All",e[e.Before_Novice=1]="Before_Novice",e[e.Before_Join=2]="Before_Join",e[e.Before_CutLine=3]="Before_CutLine",e[e.Doing_CutLineOut=4]="Doing_CutLineOut",e[e.Doing_Succeed=5]="Doing_Succeed",e[e.Doing_SucceedCutLineOut=6]="Doing_SucceedCutLineOut",e[e.Doing_SucceedOpenAuto=7]="Doing_SucceedOpenAuto",e[e.Doing_KickOut=8]="Doing_KickOut"}(s=e.BaotuanXgt||(e.BaotuanXgt={})),function(e){e.clickJoinBtn="clickJoinBtn",e.clickJoinBtnByWeb="clickJoinBtnByWeb",e.clickJoinBtnByMenu="clickJoinBtnByMenu",e.clickCutLineBtn="clickCutLineBtn",e.teamImmediately="teamImmediately",e.statusCallbackEndAutoJoin="statusCallbackEndAutoJoin",e.statusCallbackEndEnter="statusCallbackEndEnter",e.authority="authority",e.loginAutoJoin="loginAutoJoin",e.taskStarted="taskStarted",e.grayAutoJoin="grayAutoJoin",e.restartAppJoin="restartAppJoin"}(l=e.BaotuanEnterBy||(e.BaotuanEnterBy={})),function(e){e[e.Unkown=0]="Unkown",e[e.Showing=1]="Showing",e[e.Hiding=2]="Hiding",e[e.Clicked=3]="Clicked"}(d=e.PlayGameXgtState||(e.PlayGameXgtState={}))}(t.VipDownloadDefineNS||(t.VipDownloadDefineNS={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcConfigControlNS=void 0;const n=i(0),o=i(2),r=i(3),a=i(15),s=n.default.getLogger("IpcConfigontrol");!function(e){const t=new class{constructor(){this.isRegister=!1}registerPluginFunction(){if(s.information("registerPluginFunction isRegister",this.isRegister),!this.isRegister){this.isRegister=!0;let e={[r.ConfigFunction.saveConfig]:this.saveConfig.bind(this),[r.ConfigFunction.getConfigValue]:this.getConfigValue.bind(this)};o.client.registerFunctions(e)}}saveConfig(e,...t){t&&t.length>2&&a.ConfigNS.setValue(t[0],t[1],t[2])}getConfigValue(e,...t){return t&&t.length>2?a.ConfigNS.getValue(t[0],t[1],t[2]):null}};e.registerPluginFunction=function(){t.registerPluginFunction()}}(t.IpcConfigControlNS||(t.IpcConfigControlNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.QuitHandlerNS=void 0;const o=i(1),r=i(148),a=i(17),s=i(4),l=i(15),d=i(7),u=i(44),c=i(9),h=i(72),p=i(1),f=i(13),m=c.default(o.join(__rootDir,"../bin/ThunderHelper.node")),g=d.XmpMediaManagerNS.getXmpMediaManager().getXmpPlayer(),S=i(30),y=i(0),C=i(18),I=i(37),v=i(2),T=i(6),E=i(3),b=y.default.getLogger("XmpPlugin.quit-handler");!function(e){function t(){return n(this,void 0,void 0,function*(){b.information("quitThunderHelp enter");do{if(!g.getCurrentMedia())break;let e=!!l.ConfigNS.getValue(a.ConfigDefineNS.clearPlayRecord.section,a.ConfigDefineNS.clearPlayRecord.key,a.ConfigDefineNS.clearPlayRecord.value),t=!!l.ConfigNS.getValue(a.ConfigDefineNS.clearPlayRecord.section,a.ConfigDefineNS.clearPlayRecord.key,a.ConfigDefineNS.clearPlayRecord.value);(e||t)&&(yield i()),yield h.deviceHelper.disConnectDevice("DLNA","")}while(0);b.information("quitThunderHelp leave")})}function i(){return n(this,void 0,void 0,function*(){let e=p.join(__profilesDir,"PreView");b.information("subtitle clearPreViewSnapshot",e),(yield f.FileSystemAWNS.existsAW(e))&&(yield f.FileSystemAWNS.rmdirsAW(e))})}function o(){return n(this,void 0,void 0,function*(){b.information("quitThunderHelp enter"),m.stopZorderChecker(),b.information("quitThunderHelp leave")})}function d(){return n(this,void 0,void 0,function*(){b.information("quitXmpShowMode enter"),b.information("quitXmpShowMode leave")})}function c(){return n(this,void 0,void 0,function*(){b.information("quitConfig enter"),!!l.ConfigNS.getValue(a.ConfigDefineNS.clearPlayRecord.section,a.ConfigDefineNS.clearPlayRecord.key,a.ConfigDefineNS.clearPlayRecord.value)&&l.ConfigNS.setValue(a.ConfigDefineNS.syncThunder.section,a.ConfigDefineNS.syncThunder.key,0),yield l.ConfigNS.save(),b.information("quitConfig leave")})}function y(){return n(this,void 0,void 0,function*(){b.information("uninitSideBar enter"),yield C.ThunderHelper.uninitSideBar(),b.information("uninitSideBar leave")})}function P(){return n(this,void 0,void 0,function*(){b.information("quitAPlayer enter"),yield v.client.callRemoteClientFunction(T.mainRendererContext,E.XmpPlayerFunction.thunderQuit),yield g.close(0,s.ErrorFrom.Exit),yield g.destroyAPlayer(),b.information("quitAPlayer leave")})}function w(){return n(this,void 0,void 0,function*(){b.information("quitPlayStat enter");do{if(!g)break;if(g.getState()<=s.XmpMediaState.Opening)break;yield I.playStat.sendBeforeQuit()}while(0);b.information("quitPlayStat leave")})}function D(){return n(this,void 0,void 0,function*(){b.information("clearVideoTip enter"),yield S.LeftTopVideoTipManagerNS.getLeftTopVideoTipManager().clear(),b.information("clearVideoTip leave")})}function O(){return n(this,void 0,void 0,function*(){b.information("quitVideoTip enter"),yield u.VideoTipManagerNS.getVideoTipManager().uninit(),b.information("quitVideoTip leave")})}e.addQuitHandler=function(){r.quitPromises.add(w,!0),r.quitPromises.add(t),r.quitPromises.add(D),r.quitPromises.add(o),r.quitPromises.add(d),r.quitPromises.add(c),r.quitPromises.add(y),r.quitPromises.add(P),r.quitPromises.add(O)}}(t.QuitHandlerNS||(t.QuitHandlerNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.quitPromises=void 0;const o=i(2),r=i(0).default.getLogger("xmp-quit-promises");t.quitPromises=new class{constructor(){this.promiseFuncArray=[],this.promiseOrderedFuncArray=[],this.isGoingQuit=!1,o.client.callServerFunction("AddQuitPromise",()=>n(this,void 0,void 0,function*(){r.information("quit xmp plugin enter"),yield this.run(),r.information("quit xmp plugin leave")})).catch()}add(e,t){t?this.promiseOrderedFuncArray.push(e):this.promiseFuncArray.push(e)}run(){return n(this,void 0,void 0,function*(){if(r.information("enter time=",Date.now()),this.isGoingQuit)return;this.isGoingQuit=!0;for(let e of this.promiseOrderedFuncArray)"function"==typeof e&&(yield e());let e=[];for(let t of this.promiseFuncArray)"function"==typeof t&&e.push(t());return new Promise(t=>{Promise.all(e).then(()=>n(this,void 0,void 0,function*(){r.information("normal quit time=",Date.now()),t()})).catch(e=>n(this,void 0,void 0,function*(){r.information("error quit time=",Date.now()),t()}))})})}isGoingToQuit(){return this.isGoingQuit}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IpcUIFunctionControlNS=void 0;const n=i(0),o=i(2),r=i(3),a=n.default.getLogger("IpcUIFunctionCtrl");!function(e){const t=new class{constructor(){this.mapFuncCall=new Map,this.isRegister=!1}registerPluginFunction(){if(a.information("registerPluginFunction isRegister",this.isRegister),!this.isRegister){this.isRegister=!0;let e={[r.UIFunction.registerFunctionCall]:this.registerFunctionCall.bind(this),[r.UIFunction.executeFunctionCall]:this.executeFunctionCall.bind(this)};o.client.registerFunctions(e)}}registerFunctionCall(e,t){t.codecDesc&&t.func&&this.mapFuncCall.set(t.codecDesc,t.func)}executeFunctionCall(e,t){let i=this.mapFuncCall.get(t);return"function"==typeof i&&(i(),!0)}};e.registerPluginFunction=function(){t.registerPluginFunction()}}(t.IpcUIFunctionControlNS||(t.IpcUIFunctionControlNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.VipMenuNS=void 0;const o=i(33),r=i(0),a=i(40),s=i(75),l=i(39),d=r.default.getLogger("vip-menu");!function(e){function t(){return n(this,void 0,void 0,function*(){do{let e=yield a.CommonNS.callXmp(l.XmpPlayerFunction.getPlaySpeed),t=Number(e);if(o.default.isVip){a.CommonNS.callXmp(l.XmpPlayerFunction.setPlaySpeed,`${e}`).catch(),d.information(`vip checkVipMenu, set speed ${e}`);break}if(yield a.CommonNS.isYunBo()){if(t>100){d.information(`checkVipMenu in yunbo, change speed from ${e} to 100`),a.CommonNS.callXmp(l.XmpPlayerFunction.setPlaySpeed,"100").catch();break}}else if(((yield a.CommonNS.isLocalPlay())||(yield a.CommonNS.isPlayAndDownload()))&&200===t){d.information(`checkVipMenu, change speed from ${e} to 100`),a.CommonNS.callXmp(l.XmpPlayerFunction.setPlaySpeed,"100").catch();break}a.CommonNS.callXmp(l.XmpPlayerFunction.setPlaySpeed,`${e}`).catch(),d.information(`novip checkVipMenu, set speed ${e}`)}while(0)})}e.clickSpeedMenu=function(e,t){let i="";i=t?"https://pay.xunlei.com/pay.html?referfrom=v_pc_xlx_hytq_yp_play_speed&aidfrom=operation_bar":"https://pay.xunlei.com/pay.html?referfrom=v_pc_xl11_hytq_bsbf&aidfrom=play_speed_opt";let n=!0,r="";switch(e){case"125":t&&(r="1.25");break;case"150":t&&(r="1.5");break;case"175":t&&(r="1.75");break;case"200":r="2.0"}return r&&(s.VipStatNS.playSpeedClick(r).catch(),o.default.isVip||(a.CommonNS.openPayVipUrl(i),n=!1)),d.information("clickSpeedMenu",e,t,n),n},e.monitorVipMenu=function(){o.default.addListener(o.UserEventNS.authorityChanged,()=>{t().catch()})},e.checkVipMenu=t}(t.VipMenuNS||(t.VipMenuNS={}))},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.IAplayerWindowMessageHelperNS=void 0;const o=i(11),r=i(4),a=i(10),s=i(19),l=i(1),d=i(9),u=i(0),c=i(152),h=i(34),p=i(2),f=i(153),m=i(5),g=i(3),S=i(8),y=i(154),C=i(31),I=i(7),v=i(6),T=i(71),E=i(41),b=i(18),P=i(46),w=i(59),D=I.XmpMediaManagerNS.getXmpMediaManager().getXmpPlayer(),O=T.XmpHotKeyManagerNS.getXmpHotKeyManager(),N=u.default.getLogger("Aplayer-Window-Message-Helper"),_=d.default(l.join(__rootDir,"../bin/ThunderHelper.node"));!function(e){const t=new class{constructor(){this.mainHwnd=0,this.lastx=0,this.lasty=0,this.firstMove=!1,this.lastClickTimeStamp=0,this.timerWaitNextClick=null,this.lbuttonDown=!1,this.lbuttonDownTimes=0,this.isMouseLeave=!1,this.dbClickFlag=!1,this.fullWindowMouseEnter=!1,this.inited=!1,this.forceLoading=!1,this.timer=null,this.mouseHideTimer=null,this.cursorShow=!0,this.isFullScreen=!1,this.lastMouseMovePointer=null,this.isPlayMusic=!1,this.isAvailThrottle=!1}onOpenSucceeded(){return n(this,void 0,void 0,function*(){this.updateAPlayerWindowCaption().catch(),this.isPlayMusic=yield I.xmpPlayer.isPlayMusic()})}onPlaying(){return n(this,void 0,void 0,function*(){let e=yield E.IpcModeControlNS.calcWindowShowState();N.warning("cqm onPlaying showAplayerAndFloatWindow canShow",e),e&&(yield E.IpcModeControlNS.showAplayerAndFloatWindow(),E.IpcModeControlNS.setAplayerPosition())})}onAllStoped(){D.showAPlayerWindow(!1)}onError(){D.showAPlayerWindow(!1)}onOpenFailed(){D.showAPlayerWindow(!1)}updateAPlayerWindowCaption(){return n(this,void 0,void 0,function*(){let e=w.XmpModeNS.getCurrentMode()===a.XmpMode.INDEPENDENT_MODE,t=w.XmpModeNS.getParentWndHandle();t&&D.setMainWnd(t);let i=!1,n=w.XmpModeNS.getParentWindow();n&&(i=yield n.isMaximized()),N.information("updateAPlayerWindowCaption",t,e,i),D.setWindowCaptionMove(!this.isFullScreen&&e&&!i)})}showCursor(e){e!==this.cursorShow&&(this.cursorShow=e,s.ipcRenderer.send(h.ThunderChannelList.channelRMShowCursor,this.cursorShow))}onMouseWheel(e,t){return n(this,void 0,void 0,function*(){let t=(yield p.client.callRemoteClientFunction(v.mainRendererContext,g.XmpPlayerFunction.getVolume))[0];N.information("cqm volume",t,"wParam",e),e>0?t+=5:t-=5,t=Math.max(0,t),t=Math.min(1e3,t),p.client.callRemoteClientFunction(v.mainRendererContext,g.XmpPlayerFunction.setVolume,Math.floor(t)).catch()})}onAltDown(e,t){return n(this,void 0,void 0,function*(){yield this.getKeyDownStr(e,t)})}getKeyDownStr(e,t){return n(this,void 0,void 0,function*(){let i="";_.getKeyState(a.VirtualKeyCode.VK_CONTROL)<0&&(i="ctrl+"),_.getKeyState(a.VirtualKeyCode.VK_MENU)<0&&(i+="alt+");do{if(e>=a.VirtualKeyCode.VK_F1&&e<=a.VirtualKeyCode.VK_F12){i+="f"+(e-a.VirtualKeyCode.VK_F1+1);break}switch(e){case a.VirtualKeyCode.VK_SPACE:i+=" ";break;case a.VirtualKeyCode.VK_RETURN:i+="enter";break;case a.VirtualKeyCode.VK_UP:i+="arrowup";break;case a.VirtualKeyCode.VK_DOWN:i+="arrowdown";break;case a.VirtualKeyCode.VK_LEFT:i+="arrowleft";break;case a.VirtualKeyCode.VK_RIGHT:i+="arrowright";break;case a.VirtualKeyCode.VK_PRIOR:i+="pageup";break;case a.VirtualKeyCode.VK_NEXT:i+="pagedown";break;case a.VirtualKeyCode.VK_PROCESSKEY:{let e=t>>16&255;26===e?i+="[":27===e&&(i+="]")}break;case a.VirtualKeyCode.VK_OEM_4:i+="[";break;case a.VirtualKeyCode.VK_OEM_6:i+="]";break;case a.VirtualKeyCode.VK_ESCAPE:i+="esc";break;default:i+=String.fromCharCode(e).toLocaleLowerCase()}}while(0);N.information("keydown",i),yield O.fireWindowEvent(i)})}onKeyDown(e,t){return n(this,void 0,void 0,function*(){yield this.getKeyDownStr(e,t)})}onKeyUp(e,t){return n(this,void 0,void 0,function*(){if(_.getKeyState(a.VirtualKeyCode.VK_CONTROL)<0&&e===a.VirtualKeyCode.VK_F12){let e=yield C.rpc.getCurrentWindow();y.ThunderToolsNS.openDevTool(e,{mode:"undocked"}).catch()}})}onLButtonDbClick(){return n(this,void 0,void 0,function*(){if(!(this.lbuttonDownTimes<2)){this.dbClickFlag=!0;do{this.lastClickTimeStamp=Date.now(),this.timerWaitNextClick&&(c.clearTimeout(this.timerWaitNextClick),this.timerWaitNextClick=null);let e=yield D.getConfig(o.APlayerConfigId.CONFIGID_TIMEISFRAME);if("1"===e){N.information("onLButtonDbClick isTimeFrame:",e);break}N.warning("isFullScreen",this.isFullScreen);let t=this.getCurrentMode();this.isFullScreen?(t+=",button=double_click_exit_full_screen",yield p.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,t),p.client.callRemoteClientFunction(v.mainRendererContext,g.XmpPlayerFunction.leaveFullScreen).catch()):(t+=",button=double_click_full_screen",yield p.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,t),p.client.callRemoteClientFunction(v.mainRendererContext,g.XmpPlayerFunction.enterFullScreen).catch())}while(0)}})}onLButtonDown(e,t){this.lbuttonDown=!0,this.showCursor(!0),this.lbuttonDownTimes++}onLButtonUp(e,t){return n(this,void 0,void 0,function*(){do{if(!this.lbuttonDown)break;this.lbuttonDown=!1;let e=Date.now(),t=b.ThunderHelper.getDoubleClickTime();if(0!==this.lastClickTimeStamp&&e-this.lastClickTimeStamp<=t+50)break;this.lastClickTimeStamp=e,this.timerWaitNextClick&&c.clearTimeout(this.timerWaitNextClick),this.timerWaitNextClick=c.setTimeout(()=>n(this,void 0,void 0,function*(){do{let e=D.getState();if(e<r.XmpMediaState.Pausing||e>r.XmpMediaState.Play)break;if("1"===(yield D.getConfig(o.APlayerConfigId.CONFIGID_TIMEISFRAME)))break;let t=this.getCurrentMode();e===r.XmpMediaState.Play||e===r.XmpMediaState.Playing?(t+=",button=single_click_pause",yield p.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,t),this.forceLoading?yield p.client.callRemoteClientFunction(v.mainRendererContext,"VipStruckPause"):yield D.pause()):(this.forceLoading?yield p.client.callRemoteClientFunction(v.mainRendererContext,"VipStruckPlay"):yield D.play(),t+=",button=single_click_play",yield p.client.callServerFunction("TrackEvent","core_event","player_function_click","",0,0,0,0,t))}while(0)}),220)}while(0);this.showCursor(!0)})}getCurrentMode(){let e="",t=E.IpcModeControlNS.getCurrentMode();return t===a.XmpMode.EMBED_MODE&&(e=",components_type=embed"),t===a.XmpMode.INDEPENDENT_MODE&&(e=",components_type=independent"),e}throttle(e,t){this.isAvailThrottle=!0,this.isAvailThrottle&&(e(),this.isAvailThrottle=!1,c.setTimeout(()=>{this.isAvailThrottle=!0},t))}fireAplayerEvent(){S.server.fireClientEvent("OnAplayerMouseMoveEvent")}onMouseMove(e,t){return n(this,void 0,void 0,function*(){if(D.getState()<=r.XmpMediaState.Opening)return;let e=b.ThunderHelper.getCursorPos();this.lastMouseMovePointer&&this.lastMouseMovePointer.x===e.x&&this.lastMouseMovePointer.y===e.y||(this.showCursor(!0),this.lastMouseMovePointer=e);let i=65535&t,n=t>>16&65535,o=0;this.firstMove&&this.lastx===i&&o++,this.firstMove&&this.lasty===n&&o++,2!==o&&(Math.abs(this.lastx-i)<5&&Math.abs(this.lasty-n)<5||(this.throttle(this.fireAplayerEvent,1e3),this.firstMove=!0,this.lastx=i,this.lasty=n))})}onMessage(e,t,i){return n(this,void 0,void 0,function*(){e===a.WindowMessage.WM_RBUTTONUP||(e===a.WindowMessage.WM_KEYDOWN?yield this.onKeyDown(t,i):e===a.WindowMessage.WM_LBUTTONDBLCLK?yield this.onLButtonDbClick():e===a.WindowMessage.WM_LBUTTONDOWN?this.onLButtonDown(t,i):e===a.WindowMessage.WM_LBUTTONUP?yield this.onLButtonUp(t,i):e===a.WindowMessage.WM_MOUSEMOVE?(this.isMouseLeave=!1,yield this.onMouseMove(t,i)):e===a.WindowMessage.WM_SYSKEYDOWN?yield this.onAltDown(t,i):e===a.WindowMessage.WM_MOUSELEAVE?(this.isMouseLeave=!0,this.lastMouseMovePointer=null):e===a.WindowMessage.WM_MOUSEWHEEL?this.isMouseLeave||this.onMouseWheel(t,i).catch():e===a.WindowMessage.WM_KEYUP&&(yield this.onKeyUp(t,i)))})}isMouseInAPlayer(){let e=D.getAPlayerHostWindow();if(!e)return!1;if(!b.ThunderHelper.isWindowVisible(e))return!1;if(!b.ThunderHelper.isWindowEnable(e))return!1;let t=b.ThunderHelper.getWindowRect(e),i=b.ThunderHelper.getCursorPos();return i.x>=t.x&&i.y>=t.y&&i.x<=t.x+t.width&&i.y<=t.y+t.height}checkForceground(){let e=b.ThunderHelper.getForegroundWindow(),t=P.default.getFloatWindowHandle();return e===w.XmpModeNS.getParentWndHandle()||t===e}setCursorVisibleTimer(){if(this.mouseHideTimer)return;let e=b.ThunderHelper.getCursorPos();this.mouseHideTimer=c.setInterval(()=>n(this,void 0,void 0,function*(){let t=!1,i=b.ThunderHelper.getCursorPos();do{if(f.globalHelper.isMenuShow()){t=!0;break}if(!this.isFullScreen){t=!0;break}if(P.default.isPointerFloatPanelArea()){t=!0;break}if(!this.isMouseInAPlayer()){t=!0;break}if(!this.checkForceground()){t=!0;break}if(i.x!==e.x||i.y!==e.y){t=!0;break}if(D.getState()<=r.XmpMediaState.Opening){t=!0;break}if(!b.ThunderHelper.isWindowEnable(w.XmpModeNS.getParentWndHandle())){t=!0;break}}while(0);e=i,this.showCursor(t)}),2e3)}killCursorVisibleTimer(){null!==this.mouseHideTimer&&(c.clearInterval(this.mouseHideTimer),this.mouseHideTimer=null,this.showCursor(!0))}addAPlayerMessageFilter(){D.addWindowMessageFilter(a.WindowMessage.WM_RBUTTONUP),D.addWindowMessageFilter(a.WindowMessage.WM_KEYDOWN),D.addWindowMessageFilter(a.WindowMessage.WM_KEYUP),D.addWindowMessageFilter(a.WindowMessage.WM_LBUTTONDBLCLK),D.addWindowMessageFilter(a.WindowMessage.WM_LBUTTONDOWN),D.addWindowMessageFilter(a.WindowMessage.WM_LBUTTONUP),D.addWindowMessageFilter(a.WindowMessage.WM_MOUSEMOVE),D.addWindowMessageFilter(a.WindowMessage.WM_SYSKEYDOWN),D.addWindowMessageFilter(a.WindowMessage.WM_MOUSEWHEEL),D.addWindowMessageFilter(a.WindowMessage.WM_MOUSELEAVE)}init(){return n(this,void 0,void 0,function*(){this.inited||(N.information("APlayerView init"),D.getAPlayerHostWindow()?this.addAPlayerMessageFilter():D.attachListener(m.XmpEvent.onAPlayerCreated,()=>{this.addAPlayerMessageFilter()}),D.attachListener(m.XmpEvent.onWindowMessage,this.onMessage.bind(this)),D.attachListener(m.XmpEvent.onOpenSucceeded,this.onOpenSucceeded.bind(this)),D.attachListener(m.XmpEvent.onPlaying,this.onPlaying.bind(this)),D.attachListener(m.XmpEvent.onAllStoped,this.onAllStoped.bind(this)),D.attachListener(m.XmpEvent.onError,this.onError.bind(this)),D.attachListener(m.XmpEvent.onOpenFailed,this.onOpenFailed.bind(this)),p.client.attachServerEvent(m.ModeChangeEvent.onXmpEnterFullScreen,()=>{this.isFullScreen=!0,this.isPlayMusic||this.setCursorVisibleTimer(),this.updateAPlayerWindowCaption().catch()}),p.client.attachServerEvent(m.ModeChangeEvent.onXmpLeaveFullScreen,()=>{this.isFullScreen=!1,this.killCursorVisibleTimer(),this.updateAPlayerWindowCaption().catch()}),p.client.attachServerEvent(m.ModeChangeEvent.onXmpModeChanged,()=>{this.updateAPlayerWindowCaption().catch()}),p.client.attachServerEvent(m.XmpEvent.onMaxmized,()=>{this.updateAPlayerWindowCaption().catch()}),p.client.attachServerEvent(m.XmpEvent.onUnMaxmized,()=>{this.updateAPlayerWindowCaption().catch()}),w.XmpModeNS.getIsFullScreen()&&!this.isPlayMusic&&this.setCursorVisibleTimer(),this.inited=!0)})}uninit(){N.information("APlayerView destroyed"),D.clearWindowMessageFilter(),D.detachListener(m.XmpEvent.onWindowMessage,this.onMessage),this.timer&&(c.clearInterval(this.timer),this.timer=null),this.mouseHideTimer&&(c.clearInterval(this.mouseHideTimer),this.mouseHideTimer=null)}};e.init=function(){return n(this,void 0,void 0,function*(){yield t.init()})},e.uninit=function(){t.uninit()}}(t.IAplayerWindowMessageHelperNS||(t.IAplayerWindowMessageHelperNS={}))},function(e,t){e.exports=require("timers")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalHelper=void 0;t.globalHelper=new class{constructor(){this.isMenuShowing=!1,this.isWindowShowing=!1}setMenuShowFlag(e){this.isMenuShowing=e}isMenuShow(){return this.isMenuShowing}setProgressColor(e){this.progressColor=e}getProgressColor(){return this.progressColor}setWindowShowFlag(e){this.isWindowShowing=e}isPopWindowShow(){return this.isWindowShowing}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function s(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}l((n=n.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.ThunderToolsNS=void 0;const o=i(13),r=i(2),a=i(1),s=i(9),l=i(3),d=i(31),u=s.default(a.join(__rootDir,"../bin/ThunderHelper.node"));!function(e){function t(e,t){return n(this,void 0,void 0,function*(){if(null!==e){let i=e.webContents;(yield i.isDevToolsOpened())?yield i.closeDevTools():yield i.openDevTools(t)}})}e.openDevTool=t,e.enableDevTools=function(e){return n(this,void 0,void 0,function*(){(yield o.FileSystemAWNS.existsAW(a.resolve(__rootDir,"../../enableDevTools")))&&window.addEventListener("keyup",i=>n(this,void 0,void 0,function*(){"F12"===i.key&&i.ctrlKey&&t(yield d.rpc.getCurrentWindow(),e).catch()}),!0)})},e.enableDragOpenFile=function(e){void 0===e&&(e=!1),document.addEventListener("dragover",e=>{e.preventDefault()},!1),document.addEventListener("drop",e=>n(this,void 0,void 0,function*(){e.preventDefault();let t=e.dataTransfer,i=t.files,n=t.items;if(void 0!==n&&null!==n&&n.length>0)for(let e=0;e<n.length;e++){let t=n[e];"string"===t.kind&&"text/uri-list"===t.type?t.getAsString(e=>{r.client.callServerFunctionEx(l.XmpPluginFunction.dropOpenUrl,e).catch()}):t.kind}if(void 0!==i&&null!==i&&i.length>0){let e=[];for(let t=0;t<i.length;t++){let n=i[t].path;void 0!==n&&null!==n&&""!==n&&e.push(n)}e.length>0&&r.client.callServerFunctionEx(l.XmpPluginFunction.dropOpenFiles,e).catch()}}),!1)},e.setBugreportUrlInfo=function(){return n(this,void 0,void 0,function*(){let e=yield d.rpc.getCurrentWindow();if(e&&!(yield e.isDestroyed())){let t=yield e.webContents.getURL();u.setBugreportCustomInfo(t)}})},e.setBugreportCustomInfo=function(e){u.setBugreportCustomInfo(e||"xmp-xdas-renderer")},e.setBugreportSilentMode=function(){u.setBugreportShowMode(1)}}(t.ThunderToolsNS||(t.ThunderToolsNS={}))},function(e){e.exports=JSON.parse('{"name":"XmpPlugin","version":"0.0.2","author":"Xunlei","license":"","main":"0.0.2/loadPlugin.js","clear":true,"monitor":false}')}]);